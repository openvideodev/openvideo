const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BGXPt29z.js","./NyUCyhAm.js","./BXaCBwVl.js","./QQapFv0N.js","./u5l6FkBV.js","./DffiAYRW.js","./BF8-Ztvu.js","./D27uM9Tp.js","./error-404.CxiQM6UX.css","./DXNJEFAP.js","./error-500.CEJqasKx.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();function Dg(t){const e=Object.create(null);for(const i of t.split(","))e[i]=1;return i=>i in e}const Ye={},Vr=[],Oi=()=>{},nb=()=>!1,ko=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Lg=t=>t.startsWith("onUpdate:"),yt=Object.assign,Ng=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},tC=Object.prototype.hasOwnProperty,Le=(t,e)=>tC.call(t,e),ge=Array.isArray,$r=t=>Sl(t)==="[object Map]",ob=t=>Sl(t)==="[object Set]",pe=t=>typeof t=="function",Qe=t=>typeof t=="string",as=t=>typeof t=="symbol",Ke=t=>t!==null&&typeof t=="object",ab=t=>(Ke(t)||pe(t))&&pe(t.then)&&pe(t.catch),lb=Object.prototype.toString,Sl=t=>lb.call(t),iC=t=>Sl(t).slice(8,-1),cb=t=>Sl(t)==="[object Object]",Cl=t=>Qe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,nr=Dg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tl=t=>{const e=Object.create(null);return(i=>e[i]||(e[i]=t(i)))},sC=/-\w/g,Ht=Tl(t=>t.replace(sC,e=>e.slice(1).toUpperCase())),rC=/\B([A-Z])/g,Hs=Tl(t=>t.replace(rC,"-$1").toLowerCase()),kl=Tl(t=>t.charAt(0).toUpperCase()+t.slice(1)),xa=Tl(t=>t?`on${kl(t)}`:""),Fs=(t,e)=>!Object.is(t,e),lc=(t,...e)=>{for(let i=0;i<t.length;i++)t[i](...e)},ub=(t,e,i,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:i})},nC=t=>{const e=parseFloat(t);return isNaN(e)?t:e},oC=t=>{const e=Qe(t)?Number(t):NaN;return isNaN(e)?t:e};let Q0;const Al=()=>Q0||(Q0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Gs(t){if(ge(t)){const e={};for(let i=0;i<t.length;i++){const s=t[i],r=Qe(s)?uC(s):Gs(s);if(r)for(const n in r)e[n]=r[n]}return e}else if(Qe(t)||Ke(t))return t}const aC=/;(?![^(]*\))/g,lC=/:([^]+)/,cC=/\/\*[^]*?\*\//g;function uC(t){const e={};return t.replace(cC,"").split(aC).forEach(i=>{if(i){const s=i.split(lC);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Ao(t){let e="";if(Qe(t))e=t;else if(ge(t))for(let i=0;i<t.length;i++){const s=Ao(t[i]);s&&(e+=s+" ")}else if(Ke(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}function Ni(t){if(!t)return null;let{class:e,style:i}=t;return e&&!Qe(e)&&(t.class=Ao(e)),i&&(t.style=Gs(i)),t}const hC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",dC=Dg(hC);function hb(t){return!!t||t===""}const db=t=>!!(t&&t.__v_isRef===!0),fC=t=>Qe(t)?t:t==null?"":ge(t)||Ke(t)&&(t.toString===lb||!pe(t.toString))?db(t)?fC(t.value):JSON.stringify(t,fb,2):String(t),fb=(t,e)=>db(e)?fb(t,e.value):$r(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[s,r],n)=>(i[cc(s,n)+" =>"]=r,i),{})}:ob(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>cc(i))}:as(e)?cc(e):Ke(e)&&!ge(e)&&!cb(e)?String(e):e,cc=(t,e="")=>{var i;return as(t)?`Symbol(${(i=t.description)!=null?i:e})`:t};let St;class pb{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=St,!e&&St&&(this.index=(St.scopes||(St.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=St;try{return St=this,e()}finally{St=i}}}on(){++this._on===1&&(this.prevScope=St,St=this)}off(){this._on>0&&--this._on===0&&(St=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(this.effects.length=0,i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function Hg(t){return new pb(t)}function Il(){return St}function mb(t,e=!1){St&&St.cleanups.push(t)}let qe;const uc=new WeakSet;class gb{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,St&&St.active&&St.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,uc.has(this)&&(uc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vb(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ey(this),xb(this);const e=qe,i=xi;qe=this,xi=!0;try{return this.fn()}finally{bb(this),qe=e,xi=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Vg(e);this.deps=this.depsTail=void 0,ey(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?uc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Cm(this)&&this.run()}get dirty(){return Cm(this)}}let yb=0,qn,Yn;function vb(t,e=!1){if(t.flags|=8,e){t.next=Yn,Yn=t;return}t.next=qn,qn=t}function Gg(){yb++}function Wg(){if(--yb>0)return;if(Yn){let e=Yn;for(Yn=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let t;for(;qn;){let e=qn;for(qn=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=i}}if(t)throw t}function xb(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function bb(t){let e,i=t.depsTail,s=i;for(;s;){const r=s.prevDep;s.version===-1?(s===i&&(i=r),Vg(s),pC(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=i}function Cm(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(_b(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function _b(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ao)||(t.globalVersion=ao,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Cm(t))))return;t.flags|=2;const e=t.dep,i=qe,s=xi;qe=t,xi=!0;try{xb(t);const r=t.fn(t._value);(e.version===0||Fs(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{qe=i,xi=s,bb(t),t.flags&=-3}}function Vg(t,e=!1){const{dep:i,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),i.subs===t&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let n=i.computed.deps;n;n=n.nextDep)Vg(n,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function pC(t){const{prevDep:e,nextDep:i}=t;e&&(e.nextDep=i,t.prevDep=void 0),i&&(i.prevDep=e,t.nextDep=void 0)}let xi=!0;const wb=[];function ts(){wb.push(xi),xi=!1}function is(){const t=wb.pop();xi=t===void 0?!0:t}function ey(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const i=qe;qe=void 0;try{e()}finally{qe=i}}}let ao=0;class mC{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Pl{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!qe||!xi||qe===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==qe)i=this.activeLink=new mC(qe,this),qe.deps?(i.prevDep=qe.depsTail,qe.depsTail.nextDep=i,qe.depsTail=i):qe.deps=qe.depsTail=i,Sb(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const s=i.nextDep;s.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=s),i.prevDep=qe.depsTail,i.nextDep=void 0,qe.depsTail.nextDep=i,qe.depsTail=i,qe.deps===i&&(qe.deps=s)}return i}trigger(e){this.version++,ao++,this.notify(e)}notify(e){Gg();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{Wg()}}}function Sb(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Sb(s)}const i=t.dep.subs;i!==t&&(t.prevSub=i,i&&(i.nextSub=t)),t.dep.subs=t}}const $a=new WeakMap,or=Symbol(""),Tm=Symbol(""),lo=Symbol("");function Ct(t,e,i){if(xi&&qe){let s=$a.get(t);s||$a.set(t,s=new Map);let r=s.get(i);r||(s.set(i,r=new Pl),r.map=s,r.key=i),r.track()}}function Ji(t,e,i,s,r,n){const o=$a.get(t);if(!o){ao++;return}const a=l=>{l&&l.trigger()};if(Gg(),e==="clear")o.forEach(a);else{const l=ge(t),u=l&&Cl(i);if(l&&i==="length"){const c=Number(s);o.forEach((h,f)=>{(f==="length"||f===lo||!as(f)&&f>=c)&&a(h)})}else switch((i!==void 0||o.has(void 0))&&a(o.get(i)),u&&a(o.get(lo)),e){case"add":l?u&&a(o.get("length")):(a(o.get(or)),$r(t)&&a(o.get(Tm)));break;case"delete":l||(a(o.get(or)),$r(t)&&a(o.get(Tm)));break;case"set":$r(t)&&a(o.get(or));break}}Wg()}function gC(t,e){const i=$a.get(t);return i&&i.get(e)}function Sr(t){const e=Be(t);return e===t?e:(Ct(e,"iterate",lo),ni(t)?e:e.map(rs))}function $g(t){return Ct(t=Be(t),"iterate",lo),t}function _s(t,e){return ss(t)?co(ar(t)?rs(e):e):rs(e)}const yC={__proto__:null,[Symbol.iterator](){return hc(this,Symbol.iterator,t=>_s(this,t))},concat(...t){return Sr(this).concat(...t.map(e=>ge(e)?Sr(e):e))},entries(){return hc(this,"entries",t=>(t[1]=_s(this,t[1]),t))},every(t,e){return qi(this,"every",t,e,void 0,arguments)},filter(t,e){return qi(this,"filter",t,e,i=>i.map(s=>_s(this,s)),arguments)},find(t,e){return qi(this,"find",t,e,i=>_s(this,i),arguments)},findIndex(t,e){return qi(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return qi(this,"findLast",t,e,i=>_s(this,i),arguments)},findLastIndex(t,e){return qi(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return qi(this,"forEach",t,e,void 0,arguments)},includes(...t){return dc(this,"includes",t)},indexOf(...t){return dc(this,"indexOf",t)},join(t){return Sr(this).join(t)},lastIndexOf(...t){return dc(this,"lastIndexOf",t)},map(t,e){return qi(this,"map",t,e,void 0,arguments)},pop(){return vn(this,"pop")},push(...t){return vn(this,"push",t)},reduce(t,...e){return ty(this,"reduce",t,e)},reduceRight(t,...e){return ty(this,"reduceRight",t,e)},shift(){return vn(this,"shift")},some(t,e){return qi(this,"some",t,e,void 0,arguments)},splice(...t){return vn(this,"splice",t)},toReversed(){return Sr(this).toReversed()},toSorted(t){return Sr(this).toSorted(t)},toSpliced(...t){return Sr(this).toSpliced(...t)},unshift(...t){return vn(this,"unshift",t)},values(){return hc(this,"values",t=>_s(this,t))}};function hc(t,e,i){const s=$g(t),r=s[e]();return s!==t&&!ni(t)&&(r._next=r.next,r.next=()=>{const n=r._next();return n.done||(n.value=i(n.value)),n}),r}const vC=Array.prototype;function qi(t,e,i,s,r,n){const o=$g(t),a=o!==t&&!ni(t),l=o[e];if(l!==vC[e]){const h=l.apply(t,n);return a?rs(h):h}let u=i;o!==t&&(a?u=function(h,f){return i.call(this,_s(t,h),f,t)}:i.length>2&&(u=function(h,f){return i.call(this,h,f,t)}));const c=l.call(o,u,s);return a&&r?r(c):c}function ty(t,e,i,s){const r=$g(t);let n=i;return r!==t&&(ni(t)?i.length>3&&(n=function(o,a,l){return i.call(this,o,a,l,t)}):n=function(o,a,l){return i.call(this,o,_s(t,a),l,t)}),r[e](n,...s)}function dc(t,e,i){const s=Be(t);Ct(s,"iterate",lo);const r=s[e](...i);return(r===-1||r===!1)&&Fl(i[0])?(i[0]=Be(i[0]),s[e](...i)):r}function vn(t,e,i=[]){ts(),Gg();const s=Be(t)[e].apply(t,i);return Wg(),is(),s}const xC=Dg("__proto__,__v_isRef,__isVue"),Cb=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(as));function bC(t){as(t)||(t=String(t));const e=Be(this);return Ct(e,"has",t),e.hasOwnProperty(t)}class Tb{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,s){if(i==="__v_skip")return e.__v_skip;const r=this._isReadonly,n=this._isShallow;if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_isShallow")return n;if(i==="__v_raw")return s===(r?n?Mb:Eb:n?Pb:Ib).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=ge(e);if(!r){let l;if(o&&(l=yC[i]))return l;if(i==="hasOwnProperty")return bC}const a=Reflect.get(e,i,je(e)?e:s);if((as(i)?Cb.has(i):xC(i))||(r||Ct(e,"get",i),n))return a;if(je(a)){const l=o&&Cl(i)?a:a.value;return r&&Ke(l)?qa(l):l}return Ke(a)?r?qa(a):ci(a):a}}class kb extends Tb{constructor(e=!1){super(!1,e)}set(e,i,s,r){let n=e[i];const o=ge(e)&&Cl(i);if(!this._isShallow){const u=ss(n);if(!ni(s)&&!ss(s)&&(n=Be(n),s=Be(s)),!o&&je(n)&&!je(s))return u||(n.value=s),!0}const a=o?Number(i)<e.length:Le(e,i),l=Reflect.set(e,i,s,je(e)?e:r);return e===Be(r)&&(a?Fs(s,n)&&Ji(e,"set",i,s):Ji(e,"add",i,s)),l}deleteProperty(e,i){const s=Le(e,i);e[i];const r=Reflect.deleteProperty(e,i);return r&&s&&Ji(e,"delete",i,void 0),r}has(e,i){const s=Reflect.has(e,i);return(!as(i)||!Cb.has(i))&&Ct(e,"has",i),s}ownKeys(e){return Ct(e,"iterate",ge(e)?"length":or),Reflect.ownKeys(e)}}class Ab extends Tb{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const _C=new kb,wC=new Ab,SC=new kb(!0),CC=new Ab(!0),km=t=>t,Uo=t=>Reflect.getPrototypeOf(t);function TC(t,e,i){return function(...s){const r=this.__v_raw,n=Be(r),o=$r(n),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=r[t](...s),c=i?km:e?co:rs;return!e&&Ct(n,"iterate",l?Tm:or),yt(Object.create(u),{next(){const{value:h,done:f}=u.next();return f?{value:h,done:f}:{value:a?[c(h[0]),c(h[1])]:c(h),done:f}}})}}function Bo(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function kC(t,e){const i={get(r){const n=this.__v_raw,o=Be(n),a=Be(r);t||(Fs(r,a)&&Ct(o,"get",r),Ct(o,"get",a));const{has:l}=Uo(o),u=e?km:t?co:rs;if(l.call(o,r))return u(n.get(r));if(l.call(o,a))return u(n.get(a));n!==o&&n.get(r)},get size(){const r=this.__v_raw;return!t&&Ct(Be(r),"iterate",or),r.size},has(r){const n=this.__v_raw,o=Be(n),a=Be(r);return t||(Fs(r,a)&&Ct(o,"has",r),Ct(o,"has",a)),r===a?n.has(r):n.has(r)||n.has(a)},forEach(r,n){const o=this,a=o.__v_raw,l=Be(a),u=e?km:t?co:rs;return!t&&Ct(l,"iterate",or),a.forEach((c,h)=>r.call(n,u(c),u(h),o))}};return yt(i,t?{add:Bo("add"),set:Bo("set"),delete:Bo("delete"),clear:Bo("clear")}:{add(r){!e&&!ni(r)&&!ss(r)&&(r=Be(r));const n=Be(this);return Uo(n).has.call(n,r)||(n.add(r),Ji(n,"add",r,r)),this},set(r,n){!e&&!ni(n)&&!ss(n)&&(n=Be(n));const o=Be(this),{has:a,get:l}=Uo(o);let u=a.call(o,r);u||(r=Be(r),u=a.call(o,r));const c=l.call(o,r);return o.set(r,n),u?Fs(n,c)&&Ji(o,"set",r,n):Ji(o,"add",r,n),this},delete(r){const n=Be(this),{has:o,get:a}=Uo(n);let l=o.call(n,r);l||(r=Be(r),l=o.call(n,r)),a&&a.call(n,r);const u=n.delete(r);return l&&Ji(n,"delete",r,void 0),u},clear(){const r=Be(this),n=r.size!==0,o=r.clear();return n&&Ji(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{i[r]=TC(r,t,e)}),i}function El(t,e){const i=kC(t,e);return(s,r,n)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(Le(i,r)&&r in s?i:s,r,n)}const AC={get:El(!1,!1)},IC={get:El(!1,!0)},PC={get:El(!0,!1)},EC={get:El(!0,!0)},Ib=new WeakMap,Pb=new WeakMap,Eb=new WeakMap,Mb=new WeakMap;function MC(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function FC(t){return t.__v_skip||!Object.isExtensible(t)?0:MC(iC(t))}function ci(t){return ss(t)?t:Ml(t,!1,_C,AC,Ib)}function Dr(t){return Ml(t,!1,SC,IC,Pb)}function qa(t){return Ml(t,!0,wC,PC,Eb)}function Cr(t){return Ml(t,!0,CC,EC,Mb)}function Ml(t,e,i,s,r){if(!Ke(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=FC(t);if(n===0)return t;const o=r.get(t);if(o)return o;const a=new Proxy(t,n===2?s:i);return r.set(t,a),a}function ar(t){return ss(t)?ar(t.__v_raw):!!(t&&t.__v_isReactive)}function ss(t){return!!(t&&t.__v_isReadonly)}function ni(t){return!!(t&&t.__v_isShallow)}function Fl(t){return t?!!t.__v_raw:!1}function Be(t){const e=t&&t.__v_raw;return e?Be(e):t}function Fb(t){return!Le(t,"__v_skip")&&Object.isExtensible(t)&&ub(t,"__v_skip",!0),t}const rs=t=>Ke(t)?ci(t):t,co=t=>Ke(t)?qa(t):t;function je(t){return t?t.__v_isRef===!0:!1}function K(t){return Rb(t,!1)}function uo(t){return Rb(t,!0)}function Rb(t,e){return je(t)?t:new RC(t,e)}class RC{constructor(e,i){this.dep=new Pl,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:Be(e),this._value=i?e:rs(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,s=this.__v_isShallow||ni(e)||ss(e);e=s?e:Be(e),Fs(e,i)&&(this._rawValue=e,this._value=s?e:rs(e),this.dep.trigger())}}function M(t){return je(t)?t.value:t}function Ft(t){return pe(t)?t():M(t)}const zC={get:(t,e,i)=>e==="__v_raw"?t:M(Reflect.get(t,e,i)),set:(t,e,i,s)=>{const r=t[e];return je(r)&&!je(i)?(r.value=i,!0):Reflect.set(t,e,i,s)}};function zb(t){return ar(t)?t:new Proxy(t,zC)}class UC{constructor(e){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new Pl,{get:s,set:r}=e(i.track.bind(i),i.trigger.bind(i));this._get=s,this._set=r}get value(){return this._value=this._get()}set value(e){this._set(e)}}function BC(t){return new UC(t)}function Hi(t){const e=ge(t)?new Array(t.length):{};for(const i in t)e[i]=Ub(t,i);return e}class OC{constructor(e,i,s){this._object=e,this._key=i,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Be(e);let r=!0,n=e;if(!ge(e)||!Cl(String(i)))do r=!Fl(n)||ni(n);while(r&&(n=n.__v_raw));this._shallow=r}get value(){let e=this._object[this._key];return this._shallow&&(e=M(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&je(this._raw[this._key])){const i=this._object[this._key];if(je(i)){i.value=e;return}}this._object[this._key]=e}get dep(){return gC(this._raw,this._key)}}class DC{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function qg(t,e,i){return je(t)?t:pe(t)?new DC(t):Ke(t)&&arguments.length>1?Ub(t,e,i):K(t)}function Ub(t,e,i){return new OC(t,e,i)}class LC{constructor(e,i,s){this.fn=e,this.setter=i,this._value=void 0,this.dep=new Pl(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ao-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&qe!==this)return vb(this,!0),!0}get value(){const e=this.dep.track();return _b(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function NC(t,e,i=!1){let s,r;return pe(t)?s=t:(s=t.get,r=t.set),new LC(s,r,i)}const Oo={},Ya=new WeakMap;let Js;function HC(t,e=!1,i=Js){if(i){let s=Ya.get(i);s||Ya.set(i,s=[]),s.push(t)}}function GC(t,e,i=Ye){const{immediate:s,deep:r,once:n,scheduler:o,augmentJob:a,call:l}=i,u=x=>r?x:ni(x)||r===!1||r===0?Cs(x,1):Cs(x);let c,h,f,d,p=!1,m=!1;if(je(t)?(h=()=>t.value,p=ni(t)):ar(t)?(h=()=>u(t),p=!0):ge(t)?(m=!0,p=t.some(x=>ar(x)||ni(x)),h=()=>t.map(x=>{if(je(x))return x.value;if(ar(x))return u(x);if(pe(x))return l?l(x,2):x()})):pe(t)?e?h=l?()=>l(t,2):t:h=()=>{if(f){ts();try{f()}finally{is()}}const x=Js;Js=c;try{return l?l(t,3,[d]):t(d)}finally{Js=x}}:h=Oi,e&&r){const x=h,_=r===!0?1/0:r;h=()=>Cs(x(),_)}const g=Il(),y=()=>{c.stop(),g&&g.active&&Ng(g.effects,c)};if(n&&e){const x=e;e=(..._)=>{x(..._),y()}}let b=m?new Array(t.length).fill(Oo):Oo;const v=x=>{if(!(!(c.flags&1)||!c.dirty&&!x))if(e){const _=c.run();if(r||p||(m?_.some((S,T)=>Fs(S,b[T])):Fs(_,b))){f&&f();const S=Js;Js=c;try{const T=[_,b===Oo?void 0:m&&b[0]===Oo?[]:b,d];b=_,l?l(e,3,T):e(...T)}finally{Js=S}}}else c.run()};return a&&a(v),c=new gb(h),c.scheduler=o?()=>o(v,!1):v,d=x=>HC(x,!1,c),f=c.onStop=()=>{const x=Ya.get(c);if(x){if(l)l(x,4);else for(const _ of x)_();Ya.delete(c)}},e?s?v(!0):b=c.run():o?o(v.bind(null,!0),!0):c.run(),y.pause=c.pause.bind(c),y.resume=c.resume.bind(c),y.stop=y,y}function Cs(t,e=1/0,i){if(e<=0||!Ke(t)||t.__v_skip||(i=i||new Map,(i.get(t)||0)>=e))return t;if(i.set(t,e),e--,je(t))Cs(t.value,e,i);else if(ge(t))for(let s=0;s<t.length;s++)Cs(t[s],e,i);else if(ob(t)||$r(t))t.forEach(s=>{Cs(s,e,i)});else if(cb(t)){for(const s in t)Cs(t[s],e,i);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Cs(t[s],e,i)}return t}function Io(t,e,i,s){try{return s?t(...s):t()}catch(r){ln(r,e,i)}}function Gi(t,e,i,s){if(pe(t)){const r=Io(t,e,i,s);return r&&ab(r)&&r.catch(n=>{ln(n,e,i)}),r}if(ge(t)){const r=[];for(let n=0;n<t.length;n++)r.push(Gi(t[n],e,i,s));return r}}function ln(t,e,i,s=!0){const r=e?e.vnode:null,{errorHandler:n,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ye;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${i}`;for(;a;){const c=a.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](t,l,u)===!1)return}a=a.parent}if(n){ts(),Io(n,null,10,[t,l,u]),is();return}}WC(t,i,r,s,o)}function WC(t,e,i,s=!0,r=!1){if(r)throw t;console.error(t)}const It=[];let Ri=-1;const qr=[];let ws=null,Er=0;const Bb=Promise.resolve();let Xa=null;function Rt(t){const e=Xa||Bb;return t?e.then(this?t.bind(this):t):e}function VC(t){let e=Ri+1,i=It.length;for(;e<i;){const s=e+i>>>1,r=It[s],n=ho(r);n<t||n===t&&r.flags&2?e=s+1:i=s}return e}function Yg(t){if(!(t.flags&1)){const e=ho(t),i=It[It.length-1];!i||!(t.flags&2)&&e>=ho(i)?It.push(t):It.splice(VC(e),0,t),t.flags|=1,Ob()}}function Ob(){Xa||(Xa=Bb.then(Db))}function Am(t){ge(t)?qr.push(...t):ws&&t.id===-1?ws.splice(Er+1,0,t):t.flags&1||(qr.push(t),t.flags|=1),Ob()}function iy(t,e,i=Ri+1){for(;i<It.length;i++){const s=It[i];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;It.splice(i,1),i--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function ja(t){if(qr.length){const e=[...new Set(qr)].sort((i,s)=>ho(i)-ho(s));if(qr.length=0,ws){ws.push(...e);return}for(ws=e,Er=0;Er<ws.length;Er++){const i=ws[Er];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}ws=null,Er=0}}const ho=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Db(t){try{for(Ri=0;Ri<It.length;Ri++){const e=It[Ri];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Io(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ri<It.length;Ri++){const e=It[Ri];e&&(e.flags&=-2)}Ri=-1,It.length=0,ja(),Xa=null,(It.length||qr.length)&&Db()}}let Pt=null,Lb=null;function Ka(t){const e=Pt;return Pt=t,Lb=t&&t.type.__scopeId||null,e}function ae(t,e=Pt,i){if(!e||t._n)return t;const s=(...r)=>{s._d&&Qa(-1);const n=Ka(e);let o;try{o=t(...r)}finally{Ka(n),s._d&&Qa(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function zi(t,e,i,s){const r=t.dirs,n=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];n&&(a.oldValue=n[o].value);let l=a.dir[s];l&&(ts(),Gi(l,i,8,[t.el,a,t,e]),is())}}function Rl(t,e){if(mt){let i=mt.provides;const s=mt.parent&&mt.parent.provides;s===i&&(i=mt.provides=Object.create(s)),i[t]=e}}function Rs(t,e,i=!1){const s=hi();if(s||cr){let r=cr?cr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return i&&pe(e)?e.call(s&&s.proxy):e}}function Xg(){return!!(hi()||cr)}const $C=Symbol.for("v-scx"),qC=()=>Rs($C);function Tt(t,e){return zl(t,null,e)}function Nb(t,e){return zl(t,null,{flush:"post"})}function lt(t,e,i){return zl(t,e,i)}function zl(t,e,i=Ye){const{immediate:s,deep:r,flush:n,once:o}=i,a=yt({},i),l=e&&s||!e&&n!=="post";let u;if(en){if(n==="sync"){const d=qC();u=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Oi,d.resume=Oi,d.pause=Oi,d}}const c=mt;a.call=(d,p,m)=>Gi(d,c,p,m);let h=!1;n==="post"?a.scheduler=d=>{wt(d,c&&c.suspense)}:n!=="sync"&&(h=!0,a.scheduler=(d,p)=>{p?d():Yg(d)}),a.augmentJob=d=>{e&&(d.flags|=4),h&&(d.flags|=2,c&&(d.id=c.uid,d.i=c))};const f=GC(t,e,a);return en&&(u?u.push(f):l&&f()),f}function YC(t,e,i){const s=this.proxy,r=Qe(t)?t.includes(".")?Hb(s,t):()=>s[t]:t.bind(s,s);let n;pe(e)?n=e:(n=e.handler,i=e);const o=Po(this),a=zl(r,n.bind(s),i);return o(),a}function Hb(t,e){const i=e.split(".");return()=>{let s=t;for(let r=0;r<i.length&&s;r++)s=s[i[r]];return s}}const Gb=Symbol("_vte"),XC=t=>t.__isTeleport,Xn=t=>t&&(t.disabled||t.disabled===""),sy=t=>t&&(t.defer||t.defer===""),ry=t=>typeof SVGElement<"u"&&t instanceof SVGElement,ny=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,Im=(t,e)=>{const i=t&&t.to;return Qe(i)?e?e(i):null:i},Wb={name:"Teleport",__isTeleport:!0,process(t,e,i,s,r,n,o,a,l,u){const{mc:c,pc:h,pbc:f,o:{insert:d,querySelector:p,createText:m,createComment:g}}=u,y=Xn(e.props);let{shapeFlag:b,children:v,dynamicChildren:x}=e;if(t==null){const _=e.el=m(""),S=e.anchor=m("");d(_,i,s),d(S,i,s);const T=(w,k)=>{b&16&&c(v,w,k,r,n,o,a,l)},A=()=>{const w=e.target=Im(e.props,p),k=Vb(w,e,m,d);w&&(o!=="svg"&&ry(w)?o="svg":o!=="mathml"&&ny(w)&&(o="mathml"),r&&r.isCE&&(r.ce._teleportTargets||(r.ce._teleportTargets=new Set)).add(w),y||(T(w,k),ba(e,!1)))};y&&(T(i,S),ba(e,!0)),sy(e.props)?(e.el.__isMounted=!1,wt(()=>{A(),delete e.el.__isMounted},n)):A()}else{if(sy(e.props)&&t.el.__isMounted===!1){wt(()=>{Wb.process(t,e,i,s,r,n,o,a,l,u)},n);return}e.el=t.el,e.targetStart=t.targetStart;const _=e.anchor=t.anchor,S=e.target=t.target,T=e.targetAnchor=t.targetAnchor,A=Xn(t.props),w=A?i:S,k=A?_:T;if(o==="svg"||ry(S)?o="svg":(o==="mathml"||ny(S))&&(o="mathml"),x?(f(t.dynamicChildren,x,w,r,n,o,a),t0(t,e,!0)):l||h(t,e,w,k,r,n,o,a,!1),y)A?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Do(e,i,_,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const F=e.target=Im(e.props,p);F&&Do(e,F,null,u,0)}else A&&Do(e,S,T,u,1);ba(e,y)}},remove(t,e,i,{um:s,o:{remove:r}},n){const{shapeFlag:o,children:a,anchor:l,targetStart:u,targetAnchor:c,target:h,props:f}=t;if(h&&(r(u),r(c)),n&&r(l),o&16){const d=n||!Xn(f);for(let p=0;p<a.length;p++){const m=a[p];s(m,e,i,d,!!m.dynamicChildren)}}},move:Do,hydrate:jC};function Do(t,e,i,{o:{insert:s},m:r},n=2){n===0&&s(t.targetAnchor,e,i);const{el:o,anchor:a,shapeFlag:l,children:u,props:c}=t,h=n===2;if(h&&s(o,e,i),(!h||Xn(c))&&l&16)for(let f=0;f<u.length;f++)r(u[f],e,i,2);h&&s(a,e,i)}function jC(t,e,i,s,r,n,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:u,createText:c}},h){function f(m,g,y,b){g.anchor=h(o(m),g,a(m),i,s,r,n),g.targetStart=y,g.targetAnchor=b}const d=e.target=Im(e.props,l),p=Xn(e.props);if(d){const m=d._lpa||d.firstChild;if(e.shapeFlag&16)if(p)f(t,e,m,m&&o(m));else{e.anchor=o(t);let g=m;for(;g;){if(g&&g.nodeType===8){if(g.data==="teleport start anchor")e.targetStart=g;else if(g.data==="teleport anchor"){e.targetAnchor=g,d._lpa=e.targetAnchor&&o(e.targetAnchor);break}}g=o(g)}e.targetAnchor||Vb(d,e,c,u),h(m&&o(m),e,d,i,s,r,n)}ba(e,p)}else p&&e.shapeFlag&16&&f(t,e,t,o(t));return e.anchor&&o(e.anchor)}const KC=Wb;function ba(t,e){const i=t.ctx;if(i&&i.ut){let s,r;for(e?(s=t.el,r=t.anchor):(s=t.targetStart,r=t.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",i.uid),s=s.nextSibling;i.ut()}}function Vb(t,e,i,s){const r=e.targetStart=i(""),n=e.targetAnchor=i("");return r[Gb]=n,t&&(s(r,t),s(n,t)),n}const ZC=Symbol("_leaveCb");function jg(t,e){t.shapeFlag&6&&t.component?(t.transition=e,jg(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function be(t,e){return pe(t)?yt({name:t.name},e,{setup:t}):t}function JC(){const t=hi();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function Kg(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Za=new WeakMap;function Yr(t,e,i,s,r=!1){if(ge(t)){t.forEach((p,m)=>Yr(p,e&&(ge(e)?e[m]:e),i,s,r));return}if(lr(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Yr(t,e,i,s.component.subTree);return}const n=s.shapeFlag&4?r0(s.component):s.el,o=r?null:n,{i:a,r:l}=t,u=e&&e.r,c=a.refs===Ye?a.refs={}:a.refs,h=a.setupState,f=Be(h),d=h===Ye?nb:p=>Le(f,p);if(u!=null&&u!==l){if(oy(e),Qe(u))c[u]=null,d(u)&&(h[u]=null);else if(je(u)){u.value=null;const p=e;p.k&&(c[p.k]=null)}}if(pe(l))Io(l,a,12,[o,c]);else{const p=Qe(l),m=je(l);if(p||m){const g=()=>{if(t.f){const y=p?d(l)?h[l]:c[l]:l.value;if(r)ge(y)&&Ng(y,n);else if(ge(y))y.includes(n)||y.push(n);else if(p)c[l]=[n],d(l)&&(h[l]=c[l]);else{const b=[n];l.value=b,t.k&&(c[t.k]=b)}}else p?(c[l]=o,d(l)&&(h[l]=o)):m&&(l.value=o,t.k&&(c[t.k]=o))};if(o){const y=()=>{g(),Za.delete(t)};y.id=-1,Za.set(t,y),wt(y,i)}else oy(t),g()}}}function oy(t){const e=Za.get(t);e&&(e.flags|=8,Za.delete(t))}let ay=!1;const Tr=()=>{ay||(console.error("Hydration completed but contains mismatches."),ay=!0)},QC=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",eT=t=>t.namespaceURI.includes("MathML"),Lo=t=>{if(t.nodeType===1){if(QC(t))return"svg";if(eT(t))return"mathml"}},Lr=t=>t.nodeType===8;function tT(t){const{mt:e,p:i,o:{patchProp:s,createText:r,nextSibling:n,parentNode:o,remove:a,insert:l,createComment:u}}=t,c=(v,x)=>{if(!x.hasChildNodes()){i(null,v,x),ja(),x._vnode=v;return}h(x.firstChild,v,null,null,null),ja(),x._vnode=v},h=(v,x,_,S,T,A=!1)=>{A=A||!!x.dynamicChildren;const w=Lr(v)&&v.data==="[",k=()=>m(v,x,_,S,T,w),{type:F,ref:O,shapeFlag:V,patchFlag:W}=x;let ie=v.nodeType;x.el=v,W===-2&&(A=!1,x.dynamicChildren=null);let R=null;switch(F){case ur:ie!==3?x.children===""?(l(x.el=r(""),o(v),v),R=v):R=k():(v.data!==x.children&&(Tr(),v.data=x.children),R=n(v));break;case Jt:b(v)?(R=n(v),y(x.el=v.content.firstChild,v,_)):ie!==8||w?R=k():R=n(v);break;case _a:if(w&&(v=n(v),ie=v.nodeType),ie===1||ie===3){R=v;const I=!x.children.length;for(let E=0;E<x.staticCount;E++)I&&(x.children+=R.nodeType===1?R.outerHTML:R.data),E===x.staticCount-1&&(x.anchor=R),R=n(R);return w?n(R):R}else k();break;case pt:w?R=p(v,x,_,S,T,A):R=k();break;default:if(V&1)(ie!==1||x.type.toLowerCase()!==v.tagName.toLowerCase())&&!b(v)?R=k():R=f(v,x,_,S,T,A);else if(V&6){x.slotScopeIds=T;const I=o(v);if(w?R=g(v):Lr(v)&&v.data==="teleport start"?R=g(v,v.data,"teleport end"):R=n(v),e(x,I,null,_,S,Lo(I),A),lr(x)&&!x.type.__asyncResolved){let E;w?(E=oe(pt),E.anchor=R?R.previousSibling:I.lastChild):E=v.nodeType===3?el(""):oe("div"),E.el=v,x.component.subTree=E}}else V&64?ie!==8?R=k():R=x.type.hydrate(v,x,_,S,T,A,t,d):V&128&&(R=x.type.hydrate(v,x,_,S,Lo(o(v)),T,A,t,h))}return O!=null&&Yr(O,null,S,x),R},f=(v,x,_,S,T,A)=>{A=A||!!x.dynamicChildren;const{type:w,props:k,patchFlag:F,shapeFlag:O,dirs:V,transition:W}=x,ie=w==="input"||w==="option";if(ie||F!==-1){V&&zi(x,null,_,"created");let R=!1;if(b(v)){R=f_(null,W)&&_&&_.vnode.props&&_.vnode.props.appear;const E=v.content.firstChild;if(R){const U=E.getAttribute("class");U&&(E.$cls=U),W.beforeEnter(E)}y(E,v,_),x.el=v=E}if(O&16&&!(k&&(k.innerHTML||k.textContent))){let E=d(v.firstChild,x,v,_,S,T,A);for(;E;){No(v,1)||Tr();const U=E;E=E.nextSibling,a(U)}}else if(O&8){let E=x.children;E[0]===`
`&&(v.tagName==="PRE"||v.tagName==="TEXTAREA")&&(E=E.slice(1));const{textContent:U}=v;U!==E&&U!==E.replace(/\r\n|\r/g,`
`)&&(No(v,0)||Tr(),v.textContent=x.children)}if(k){if(ie||!A||F&48){const E=v.tagName.includes("-");for(const U in k)(ie&&(U.endsWith("value")||U==="indeterminate")||ko(U)&&!nr(U)||U[0]==="."||E&&!nr(U))&&s(v,U,null,k[U],void 0,_)}else if(k.onClick)s(v,"onClick",null,k.onClick,void 0,_);else if(F&4&&ar(k.style))for(const E in k.style)k.style[E]}let I;(I=k&&k.onVnodeBeforeMount)&&ti(I,_,x),V&&zi(x,null,_,"beforeMount"),((I=k&&k.onVnodeMounted)||V||R)&&v_(()=>{I&&ti(I,_,x),R&&W.enter(v),V&&zi(x,null,_,"mounted")},S)}return v.nextSibling},d=(v,x,_,S,T,A,w)=>{w=w||!!x.dynamicChildren;const k=x.children,F=k.length;for(let O=0;O<F;O++){const V=w?k[O]:k[O]=Yt(k[O]),W=V.type===ur;v?(W&&!w&&O+1<F&&Yt(k[O+1]).type===ur&&(l(r(v.data.slice(V.children.length)),_,n(v)),v.data=V.children),v=h(v,V,S,T,A,w)):W&&!V.children?l(V.el=r(""),_):(No(_,1)||Tr(),i(null,V,_,null,S,T,Lo(_),A))}return v},p=(v,x,_,S,T,A)=>{const{slotScopeIds:w}=x;w&&(T=T?T.concat(w):w);const k=o(v),F=d(n(v),x,k,_,S,T,A);return F&&Lr(F)&&F.data==="]"?n(x.anchor=F):(Tr(),l(x.anchor=u("]"),k,F),F)},m=(v,x,_,S,T,A)=>{if(No(v.parentElement,1)||Tr(),x.el=null,A){const F=g(v);for(;;){const O=n(v);if(O&&O!==F)a(O);else break}}const w=n(v),k=o(v);return a(v),i(null,x,k,w,_,S,Lo(k),T),_&&(_.vnode.el=x.el,Ol(_,x.el)),w},g=(v,x="[",_="]")=>{let S=0;for(;v;)if(v=n(v),v&&Lr(v)&&(v.data===x&&S++,v.data===_)){if(S===0)return n(v);S--}return v},y=(v,x,_)=>{const S=x.parentNode;S&&S.replaceChild(v,x);let T=_;for(;T;)T.vnode.el===x&&(T.vnode.el=T.subTree.el=v),T=T.parent},b=v=>v.nodeType===1&&v.tagName==="TEMPLATE";return[c,h]}const ly="data-allow-mismatch",iT={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function No(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(ly);)t=t.parentElement;const i=t&&t.getAttribute(ly);if(i==null)return!1;if(i==="")return!0;{const s=i.split(",");return e===0&&s.includes("children")?!0:s.includes(iT[e])}}Al().requestIdleCallback;Al().cancelIdleCallback;function sT(t,e){if(Lr(t)&&t.data==="["){let i=1,s=t.nextSibling;for(;s;){if(s.nodeType===1){if(e(s)===!1)break}else if(Lr(s))if(s.data==="]"){if(--i===0)break}else s.data==="["&&i++;s=s.nextSibling}}else e(t)}const lr=t=>!!t.type.__asyncLoader;function cy(t){pe(t)&&(t={loader:t});const{loader:e,loadingComponent:i,errorComponent:s,delay:r=200,hydrate:n,timeout:o,suspensible:a=!0,onError:l}=t;let u=null,c,h=0;const f=()=>(h++,u=null,d()),d=()=>{let p;return u||(p=u=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),l)return new Promise((g,y)=>{l(m,()=>g(f()),()=>y(m),h+1)});throw m}).then(m=>p!==u&&u?u:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return be({name:"AsyncComponentWrapper",__asyncLoader:d,__asyncHydrate(p,m,g){let y=!1;(m.bu||(m.bu=[])).push(()=>y=!0);const b=()=>{y||g()},v=n?()=>{const x=n(b,_=>sT(p,_));x&&(m.bum||(m.bum=[])).push(x)}:b;c?v():d().then(()=>!m.isUnmounted&&v())},get __asyncResolved(){return c},setup(){const p=mt;if(Kg(p),c)return()=>Ho(c,p);const m=v=>{u=null,ln(v,p,13,!s)};if(a&&p.suspense||en)return d().then(v=>()=>Ho(v,p)).catch(v=>(m(v),()=>s?oe(s,{error:v}):null));const g=K(!1),y=K(),b=K(!!r);return r&&setTimeout(()=>{b.value=!1},r),o!=null&&setTimeout(()=>{if(!g.value&&!y.value){const v=new Error(`Async component timed out after ${o}ms.`);m(v),y.value=v}},o),d().then(()=>{g.value=!0,p.parent&&Zg(p.parent.vnode)&&p.parent.update()}).catch(v=>{m(v),y.value=v}),()=>{if(g.value&&c)return Ho(c,p);if(y.value&&s)return oe(s,{error:y.value});if(i&&!b.value)return Ho(i,p)}}})}function Ho(t,e){const{ref:i,props:s,children:r,ce:n}=e.vnode,o=oe(t,s,r);return o.ref=i,o.ce=n,delete e.vnode.ce,o}const Zg=t=>t.type.__isKeepAlive;function $b(t,e){Yb(t,"a",e)}function qb(t,e){Yb(t,"da",e)}function Yb(t,e,i=mt){const s=t.__wdc||(t.__wdc=()=>{let r=i;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Ul(e,s,i),i){let r=i.parent;for(;r&&r.parent;)Zg(r.parent.vnode)&&rT(s,e,i,r),r=r.parent}}function rT(t,e,i,s){const r=Ul(e,t,s,!0);_r(()=>{Ng(s[e],r)},i)}function Ul(t,e,i=mt,s=!1){if(i){const r=i[t]||(i[t]=[]),n=e.__weh||(e.__weh=(...o)=>{ts();const a=Po(i),l=Gi(e,i,t,o);return a(),is(),l});return s?r.unshift(n):r.push(n),n}}const ls=t=>(e,i=mt)=>{(!en||t==="sp")&&Ul(t,(...s)=>e(...s),i)},nT=ls("bm"),br=ls("m"),oT=ls("bu"),aT=ls("u"),Jg=ls("bum"),_r=ls("um"),lT=ls("sp"),cT=ls("rtg"),uT=ls("rtc");function Xb(t,e=mt){Ul("ec",t,e)}const jb="components";function E7(t,e){return Zb(jb,t,!0,e)||t}const Kb=Symbol.for("v-ndc");function hT(t){return Qe(t)?Zb(jb,t,!1)||t:t||Kb}function Zb(t,e,i=!0,s=!1){const r=Pt||mt;if(r){const n=r.type;{const a=ZT(n,!1);if(a&&(a===e||a===Ht(e)||a===kl(Ht(e))))return n}const o=uy(r[t]||n[t],e)||uy(r.appContext[t],e);return!o&&s?n:o}}function uy(t,e){return t&&(t[e]||t[Ht(e)]||t[kl(Ht(e))])}function Re(t,e,i={},s,r){if(Pt.ce||Pt.parent&&lr(Pt.parent)&&Pt.parent.ce){const u=Object.keys(i).length>0;return fe(),_e(pt,null,[oe("slot",i,s&&s())],u?-2:64)}let n=t[e];n&&n._c&&(n._d=!1),fe();const o=n&&Jb(n(i)),a=i.key||o&&o.key,l=_e(pt,{key:(a&&!as(a)?a:`_${e}`)+(!o&&s?"_fb":"")},o||(s?s():[]),o&&t._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),n&&n._c&&(n._d=!0),l}function Jb(t){return t.some(e=>Qr(e)?!(e.type===Jt||e.type===pt&&!Jb(e.children)):!0)?t:null}const Pm=t=>t?w_(t)?r0(t):Pm(t.parent):null,jn=yt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Pm(t.parent),$root:t=>Pm(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>t_(t),$forceUpdate:t=>t.f||(t.f=()=>{Yg(t.update)}),$nextTick:t=>t.n||(t.n=Rt.bind(t.proxy)),$watch:t=>YC.bind(t)}),fc=(t,e)=>t!==Ye&&!t.__isScriptSetup&&Le(t,e),dT={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:s,data:r,props:n,accessCache:o,type:a,appContext:l}=t;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return i[e];case 3:return n[e]}else{if(fc(s,e))return o[e]=1,s[e];if(r!==Ye&&Le(r,e))return o[e]=2,r[e];if(Le(n,e))return o[e]=3,n[e];if(i!==Ye&&Le(i,e))return o[e]=4,i[e];Mm&&(o[e]=0)}}const u=jn[e];let c,h;if(u)return e==="$attrs"&&Ct(t.attrs,"get",""),u(t);if((c=a.__cssModules)&&(c=c[e]))return c;if(i!==Ye&&Le(i,e))return o[e]=4,i[e];if(h=l.config.globalProperties,Le(h,e))return h[e]},set({_:t},e,i){const{data:s,setupState:r,ctx:n}=t;return fc(r,e)?(r[e]=i,!0):s!==Ye&&Le(s,e)?(s[e]=i,!0):Le(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:s,appContext:r,props:n,type:o}},a){let l;return!!(i[a]||t!==Ye&&a[0]!=="$"&&Le(t,a)||fc(e,a)||Le(n,a)||Le(s,a)||Le(jn,a)||Le(r.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:Le(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function Em(t){return ge(t)?t.reduce((e,i)=>(e[i]=null,e),{}):t}function Qb(t,e){const i=Em(t);for(const s in e){if(s.startsWith("__skip"))continue;let r=i[s];r?ge(r)||pe(r)?r=i[s]={type:r,default:e[s]}:r.default=e[s]:r===null&&(r=i[s]={default:e[s]}),r&&e[`__skip_${s}`]&&(r.skipFactory=!0)}return i}let Mm=!0;function fT(t){const e=t_(t),i=t.proxy,s=t.ctx;Mm=!1,e.beforeCreate&&hy(e.beforeCreate,t,"bc");const{data:r,computed:n,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:h,mounted:f,beforeUpdate:d,updated:p,activated:m,deactivated:g,beforeDestroy:y,beforeUnmount:b,destroyed:v,unmounted:x,render:_,renderTracked:S,renderTriggered:T,errorCaptured:A,serverPrefetch:w,expose:k,inheritAttrs:F,components:O,directives:V,filters:W}=e;if(u&&pT(u,s,null),o)for(const I in o){const E=o[I];pe(E)&&(s[I]=E.bind(i))}if(r){const I=r.call(i,i);Ke(I)&&(t.data=ci(I))}if(Mm=!0,n)for(const I in n){const E=n[I],U=pe(E)?E.bind(i,i):pe(E.get)?E.get.bind(i,i):Oi,Z=!pe(E)&&pe(E.set)?E.set.bind(i):Oi,se=me({get:U,set:Z});Object.defineProperty(s,I,{enumerable:!0,configurable:!0,get:()=>se.value,set:te=>se.value=te})}if(a)for(const I in a)e_(a[I],s,i,I);if(l){const I=pe(l)?l.call(i):l;Reflect.ownKeys(I).forEach(E=>{Rl(E,I[E])})}c&&hy(c,t,"c");function R(I,E){ge(E)?E.forEach(U=>I(U.bind(i))):E&&I(E.bind(i))}if(R(nT,h),R(br,f),R(oT,d),R(aT,p),R($b,m),R(qb,g),R(Xb,A),R(uT,S),R(cT,T),R(Jg,b),R(_r,x),R(lT,w),ge(k))if(k.length){const I=t.exposed||(t.exposed={});k.forEach(E=>{Object.defineProperty(I,E,{get:()=>i[E],set:U=>i[E]=U,enumerable:!0})})}else t.exposed||(t.exposed={});_&&t.render===Oi&&(t.render=_),F!=null&&(t.inheritAttrs=F),O&&(t.components=O),V&&(t.directives=V),w&&Kg(t)}function pT(t,e,i=Oi){ge(t)&&(t=Fm(t));for(const s in t){const r=t[s];let n;Ke(r)?"default"in r?n=Rs(r.from||s,r.default,!0):n=Rs(r.from||s):n=Rs(r),je(n)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):e[s]=n}}function hy(t,e,i){Gi(ge(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,i)}function e_(t,e,i,s){let r=s.includes(".")?Hb(i,s):()=>i[s];if(Qe(t)){const n=e[t];pe(n)&&lt(r,n)}else if(pe(t))lt(r,t.bind(i));else if(Ke(t))if(ge(t))t.forEach(n=>e_(n,e,i,s));else{const n=pe(t.handler)?t.handler.bind(i):e[t.handler];pe(n)&&lt(r,n,t)}}function t_(t){const e=t.type,{mixins:i,extends:s}=e,{mixins:r,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,a=n.get(e);let l;return a?l=a:!r.length&&!i&&!s?l=e:(l={},r.length&&r.forEach(u=>Ja(l,u,o,!0)),Ja(l,e,o)),Ke(e)&&n.set(e,l),l}function Ja(t,e,i,s=!1){const{mixins:r,extends:n}=e;n&&Ja(t,n,i,!0),r&&r.forEach(o=>Ja(t,o,i,!0));for(const o in e)if(!(s&&o==="expose")){const a=mT[o]||i&&i[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const mT={data:dy,props:fy,emits:fy,methods:zn,computed:zn,beforeCreate:kt,created:kt,beforeMount:kt,mounted:kt,beforeUpdate:kt,updated:kt,beforeDestroy:kt,beforeUnmount:kt,destroyed:kt,unmounted:kt,activated:kt,deactivated:kt,errorCaptured:kt,serverPrefetch:kt,components:zn,directives:zn,watch:yT,provide:dy,inject:gT};function dy(t,e){return e?t?function(){return yt(pe(t)?t.call(this,this):t,pe(e)?e.call(this,this):e)}:e:t}function gT(t,e){return zn(Fm(t),Fm(e))}function Fm(t){if(ge(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function kt(t,e){return t?[...new Set([].concat(t,e))]:e}function zn(t,e){return t?yt(Object.create(null),t,e):e}function fy(t,e){return t?ge(t)&&ge(e)?[...new Set([...t,...e])]:yt(Object.create(null),Em(t),Em(e??{})):e}function yT(t,e){if(!t)return e;if(!e)return t;const i=yt(Object.create(null),t);for(const s in e)i[s]=kt(t[s],e[s]);return i}function i_(){return{app:null,config:{isNativeTag:nb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let vT=0;function xT(t,e){return function(s,r=null){pe(s)||(s=yt({},s)),r!=null&&!Ke(r)&&(r=null);const n=i_(),o=new WeakSet,a=[];let l=!1;const u=n.app={_uid:vT++,_component:s,_props:r,_container:null,_context:n,_instance:null,version:QT,get config(){return n.config},set config(c){},use(c,...h){return o.has(c)||(c&&pe(c.install)?(o.add(c),c.install(u,...h)):pe(c)&&(o.add(c),c(u,...h))),u},mixin(c){return n.mixins.includes(c)||n.mixins.push(c),u},component(c,h){return h?(n.components[c]=h,u):n.components[c]},directive(c,h){return h?(n.directives[c]=h,u):n.directives[c]},mount(c,h,f){if(!l){const d=u._ceVNode||oe(s,r);return d.appContext=n,f===!0?f="svg":f===!1&&(f=void 0),h&&e?e(d,c):t(d,c,f),l=!0,u._container=c,c.__vue_app__=u,r0(d.component)}},onUnmount(c){a.push(c)},unmount(){l&&(Gi(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,h){return n.provides[c]=h,u},runWithContext(c){const h=cr;cr=u;try{return c()}finally{cr=h}}};return u}}let cr=null;const bT=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Ht(e)}Modifiers`]||t[`${Hs(e)}Modifiers`];function _T(t,e,...i){if(t.isUnmounted)return;const s=t.vnode.props||Ye;let r=i;const n=e.startsWith("update:"),o=n&&bT(s,e.slice(7));o&&(o.trim&&(r=i.map(c=>Qe(c)?c.trim():c)),o.number&&(r=i.map(nC)));let a,l=s[a=xa(e)]||s[a=xa(Ht(e))];!l&&n&&(l=s[a=xa(Hs(e))]),l&&Gi(l,t,6,r);const u=s[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Gi(u,t,6,r)}}const wT=new WeakMap;function s_(t,e,i=!1){const s=i?wT:e.emitsCache,r=s.get(t);if(r!==void 0)return r;const n=t.emits;let o={},a=!1;if(!pe(t)){const l=u=>{const c=s_(u,e,!0);c&&(a=!0,yt(o,c))};!i&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!n&&!a?(Ke(t)&&s.set(t,null),null):(ge(n)?n.forEach(l=>o[l]=null):yt(o,n),Ke(t)&&s.set(t,o),o)}function Bl(t,e){return!t||!ko(e)?!1:(e=e.slice(2).replace(/Once$/,""),Le(t,e[0].toLowerCase()+e.slice(1))||Le(t,Hs(e))||Le(t,e))}function pc(t){const{type:e,vnode:i,proxy:s,withProxy:r,propsOptions:[n],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:h,data:f,setupState:d,ctx:p,inheritAttrs:m}=t,g=Ka(t);let y,b;try{if(i.shapeFlag&4){const x=r||s,_=x;y=Yt(u.call(_,x,c,h,d,f,p)),b=a}else{const x=e;y=Yt(x.length>1?x(h,{attrs:a,slots:o,emit:l}):x(h,null)),b=e.props?a:CT(a)}}catch(x){Kn.length=0,ln(x,t,1),y=oe(Jt)}let v=y;if(b&&m!==!1){const x=Object.keys(b),{shapeFlag:_}=v;x.length&&_&7&&(n&&x.some(Lg)&&(b=TT(b,n)),v=fr(v,b,!1,!0))}return i.dirs&&(v=fr(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(i.dirs):i.dirs),i.transition&&jg(v,i.transition),y=v,Ka(g),y}function ST(t,e=!0){let i;for(let s=0;s<t.length;s++){const r=t[s];if(Qr(r)){if(r.type!==Jt||r.children==="v-if"){if(i)return;i=r}}else return}return i}const CT=t=>{let e;for(const i in t)(i==="class"||i==="style"||ko(i))&&((e||(e={}))[i]=t[i]);return e},TT=(t,e)=>{const i={};for(const s in t)(!Lg(s)||!(s.slice(9)in e))&&(i[s]=t[s]);return i};function kT(t,e,i){const{props:s,children:r,component:n}=t,{props:o,children:a,patchFlag:l}=e,u=n.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&l>=0){if(l&1024)return!0;if(l&16)return s?py(s,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let h=0;h<c.length;h++){const f=c[h];if(o[f]!==s[f]&&!Bl(u,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?py(s,o,u):!0:!!o;return!1}function py(t,e,i){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const n=s[r];if(e[n]!==t[n]&&!Bl(i,n))return!0}return!1}function Ol({vnode:t,parent:e},i){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=i,e=e.parent;else break}}const r_={},n_=()=>Object.create(r_),o_=t=>Object.getPrototypeOf(t)===r_;function AT(t,e,i,s=!1){const r={},n=n_();t.propsDefaults=Object.create(null),a_(t,e,r,n);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);i?t.props=s?r:Dr(r):t.type.props?t.props=r:t.props=n,t.attrs=n}function IT(t,e,i,s){const{props:r,attrs:n,vnode:{patchFlag:o}}=t,a=Be(r),[l]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let h=0;h<c.length;h++){let f=c[h];if(Bl(t.emitsOptions,f))continue;const d=e[f];if(l)if(Le(n,f))d!==n[f]&&(n[f]=d,u=!0);else{const p=Ht(f);r[p]=Rm(l,a,p,d,t,!1)}else d!==n[f]&&(n[f]=d,u=!0)}}}else{a_(t,e,r,n)&&(u=!0);let c;for(const h in a)(!e||!Le(e,h)&&((c=Hs(h))===h||!Le(e,c)))&&(l?i&&(i[h]!==void 0||i[c]!==void 0)&&(r[h]=Rm(l,a,h,void 0,t,!0)):delete r[h]);if(n!==a)for(const h in n)(!e||!Le(e,h))&&(delete n[h],u=!0)}u&&Ji(t.attrs,"set","")}function a_(t,e,i,s){const[r,n]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(nr(l))continue;const u=e[l];let c;r&&Le(r,c=Ht(l))?!n||!n.includes(c)?i[c]=u:(a||(a={}))[c]=u:Bl(t.emitsOptions,l)||(!(l in s)||u!==s[l])&&(s[l]=u,o=!0)}if(n){const l=Be(i),u=a||Ye;for(let c=0;c<n.length;c++){const h=n[c];i[h]=Rm(r,l,h,u[h],t,!Le(u,h))}}return o}function Rm(t,e,i,s,r,n){const o=t[i];if(o!=null){const a=Le(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&pe(l)){const{propsDefaults:u}=r;if(i in u)s=u[i];else{const c=Po(r);s=u[i]=l.call(null,e),c()}}else s=l;r.ce&&r.ce._setProp(i,s)}o[0]&&(n&&!a?s=!1:o[1]&&(s===""||s===Hs(i))&&(s=!0))}return s}const PT=new WeakMap;function l_(t,e,i=!1){const s=i?PT:e.propsCache,r=s.get(t);if(r)return r;const n=t.props,o={},a=[];let l=!1;if(!pe(t)){const c=h=>{l=!0;const[f,d]=l_(h,e,!0);yt(o,f),d&&a.push(...d)};!i&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!n&&!l)return Ke(t)&&s.set(t,Vr),Vr;if(ge(n))for(let c=0;c<n.length;c++){const h=Ht(n[c]);my(h)&&(o[h]=Ye)}else if(n)for(const c in n){const h=Ht(c);if(my(h)){const f=n[c],d=o[h]=ge(f)||pe(f)?{type:f}:yt({},f),p=d.type;let m=!1,g=!0;if(ge(p))for(let y=0;y<p.length;++y){const b=p[y],v=pe(b)&&b.name;if(v==="Boolean"){m=!0;break}else v==="String"&&(g=!1)}else m=pe(p)&&p.name==="Boolean";d[0]=m,d[1]=g,(m||Le(d,"default"))&&a.push(h)}}const u=[o,a];return Ke(t)&&s.set(t,u),u}function my(t){return t[0]!=="$"&&!nr(t)}const Qg=t=>t==="_"||t==="_ctx"||t==="$stable",e0=t=>ge(t)?t.map(Yt):[Yt(t)],ET=(t,e,i)=>{if(e._n)return e;const s=ae((...r)=>e0(e(...r)),i);return s._c=!1,s},c_=(t,e,i)=>{const s=t._ctx;for(const r in t){if(Qg(r))continue;const n=t[r];if(pe(n))e[r]=ET(r,n,s);else if(n!=null){const o=e0(n);e[r]=()=>o}}},u_=(t,e)=>{const i=e0(e);t.slots.default=()=>i},h_=(t,e,i)=>{for(const s in e)(i||!Qg(s))&&(t[s]=e[s])},MT=(t,e,i)=>{const s=t.slots=n_();if(t.vnode.shapeFlag&32){const r=e._;r?(h_(s,e,i),i&&ub(s,"_",r,!0)):c_(e,s)}else e&&u_(t,e)},FT=(t,e,i)=>{const{vnode:s,slots:r}=t;let n=!0,o=Ye;if(s.shapeFlag&32){const a=e._;a?i&&a===1?n=!1:h_(r,e,i):(n=!e.$stable,c_(e,r)),o=e}else e&&(u_(t,e),o={default:1});if(n)for(const a in r)!Qg(a)&&o[a]==null&&delete r[a]},wt=v_;function RT(t){return d_(t)}function zT(t){return d_(t,tT)}function d_(t,e){const i=Al();i.__VUE__=!0;const{insert:s,remove:r,patchProp:n,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:h,nextSibling:f,setScopeId:d=Oi,insertStaticContent:p}=t,m=(C,P,z,H=null,D=null,L=null,X=void 0,Y=null,$=!!P.dynamicChildren)=>{if(C===P)return;C&&!Ts(C,P)&&(H=ce(C),te(C,D,L,!0),C=null),P.patchFlag===-2&&($=!1,P.dynamicChildren=null);const{type:G,ref:de,shapeFlag:ee}=P;switch(G){case ur:g(C,P,z,H);break;case Jt:y(C,P,z,H);break;case _a:C==null&&b(P,z,H,X);break;case pt:O(C,P,z,H,D,L,X,Y,$);break;default:ee&1?_(C,P,z,H,D,L,X,Y,$):ee&6?V(C,P,z,H,D,L,X,Y,$):(ee&64||ee&128)&&G.process(C,P,z,H,D,L,X,Y,$,Ue)}de!=null&&D?Yr(de,C&&C.ref,L,P||C,!P):de==null&&C&&C.ref!=null&&Yr(C.ref,null,L,C,!0)},g=(C,P,z,H)=>{if(C==null)s(P.el=a(P.children),z,H);else{const D=P.el=C.el;P.children!==C.children&&u(D,P.children)}},y=(C,P,z,H)=>{C==null?s(P.el=l(P.children||""),z,H):P.el=C.el},b=(C,P,z,H)=>{[C.el,C.anchor]=p(C.children,P,z,H,C.el,C.anchor)},v=({el:C,anchor:P},z,H)=>{let D;for(;C&&C!==P;)D=f(C),s(C,z,H),C=D;s(P,z,H)},x=({el:C,anchor:P})=>{let z;for(;C&&C!==P;)z=f(C),r(C),C=z;r(P)},_=(C,P,z,H,D,L,X,Y,$)=>{if(P.type==="svg"?X="svg":P.type==="math"&&(X="mathml"),C==null)S(P,z,H,D,L,X,Y,$);else{const G=C.el&&C.el._isVueCE?C.el:null;try{G&&G._beginPatch(),w(C,P,D,L,X,Y,$)}finally{G&&G._endPatch()}}},S=(C,P,z,H,D,L,X,Y)=>{let $,G;const{props:de,shapeFlag:ee,transition:ue,dirs:ye}=C;if($=C.el=o(C.type,L,de&&de.is,de),ee&8?c($,C.children):ee&16&&A(C.children,$,null,H,D,mc(C,L),X,Y),ye&&zi(C,null,H,"created"),T($,C,C.scopeId,X,H),de){for(const Ve in de)Ve!=="value"&&!nr(Ve)&&n($,Ve,null,de[Ve],L,H);"value"in de&&n($,"value",null,de.value,L),(G=de.onVnodeBeforeMount)&&ti(G,H,C)}ye&&zi(C,null,H,"beforeMount");const Pe=f_(D,ue);Pe&&ue.beforeEnter($),s($,P,z),((G=de&&de.onVnodeMounted)||Pe||ye)&&wt(()=>{G&&ti(G,H,C),Pe&&ue.enter($),ye&&zi(C,null,H,"mounted")},D)},T=(C,P,z,H,D)=>{if(z&&d(C,z),H)for(let L=0;L<H.length;L++)d(C,H[L]);if(D){let L=D.subTree;if(P===L||g_(L.type)&&(L.ssContent===P||L.ssFallback===P)){const X=D.vnode;T(C,X,X.scopeId,X.slotScopeIds,D.parent)}}},A=(C,P,z,H,D,L,X,Y,$=0)=>{for(let G=$;G<C.length;G++){const de=C[G]=Y?Ss(C[G]):Yt(C[G]);m(null,de,P,z,H,D,L,X,Y)}},w=(C,P,z,H,D,L,X)=>{const Y=P.el=C.el;let{patchFlag:$,dynamicChildren:G,dirs:de}=P;$|=C.patchFlag&16;const ee=C.props||Ye,ue=P.props||Ye;let ye;if(z&&Ys(z,!1),(ye=ue.onVnodeBeforeUpdate)&&ti(ye,z,P,C),de&&zi(P,C,z,"beforeUpdate"),z&&Ys(z,!0),(ee.innerHTML&&ue.innerHTML==null||ee.textContent&&ue.textContent==null)&&c(Y,""),G?k(C.dynamicChildren,G,Y,z,H,mc(P,D),L):X||E(C,P,Y,null,z,H,mc(P,D),L,!1),$>0){if($&16)F(Y,ee,ue,z,D);else if($&2&&ee.class!==ue.class&&n(Y,"class",null,ue.class,D),$&4&&n(Y,"style",ee.style,ue.style,D),$&8){const Pe=P.dynamicProps;for(let Ve=0;Ve<Pe.length;Ve++){const He=Pe[Ve],Bt=ee[He],_t=ue[He];(_t!==Bt||He==="value")&&n(Y,He,Bt,_t,D,z)}}$&1&&C.children!==P.children&&c(Y,P.children)}else!X&&G==null&&F(Y,ee,ue,z,D);((ye=ue.onVnodeUpdated)||de)&&wt(()=>{ye&&ti(ye,z,P,C),de&&zi(P,C,z,"updated")},H)},k=(C,P,z,H,D,L,X)=>{for(let Y=0;Y<P.length;Y++){const $=C[Y],G=P[Y],de=$.el&&($.type===pt||!Ts($,G)||$.shapeFlag&198)?h($.el):z;m($,G,de,null,H,D,L,X,!0)}},F=(C,P,z,H,D)=>{if(P!==z){if(P!==Ye)for(const L in P)!nr(L)&&!(L in z)&&n(C,L,P[L],null,D,H);for(const L in z){if(nr(L))continue;const X=z[L],Y=P[L];X!==Y&&L!=="value"&&n(C,L,Y,X,D,H)}"value"in z&&n(C,"value",P.value,z.value,D)}},O=(C,P,z,H,D,L,X,Y,$)=>{const G=P.el=C?C.el:a(""),de=P.anchor=C?C.anchor:a("");let{patchFlag:ee,dynamicChildren:ue,slotScopeIds:ye}=P;ye&&(Y=Y?Y.concat(ye):ye),C==null?(s(G,z,H),s(de,z,H),A(P.children||[],z,de,D,L,X,Y,$)):ee>0&&ee&64&&ue&&C.dynamicChildren&&C.dynamicChildren.length===ue.length?(k(C.dynamicChildren,ue,z,D,L,X,Y),(P.key!=null||D&&P===D.subTree)&&t0(C,P,!0)):E(C,P,z,de,D,L,X,Y,$)},V=(C,P,z,H,D,L,X,Y,$)=>{P.slotScopeIds=Y,C==null?P.shapeFlag&512?D.ctx.activate(P,z,H,X,$):W(P,z,H,D,L,X,$):ie(C,P,$)},W=(C,P,z,H,D,L,X)=>{const Y=C.component=qT(C,H,D);if(Zg(C)&&(Y.ctx.renderer=Ue),YT(Y,!1,X),Y.asyncDep){if(D&&D.registerDep(Y,R,X),!C.el){const $=Y.subTree=oe(Jt);y(null,$,P,z),C.placeholder=$.el}}else R(Y,C,P,z,D,L,X)},ie=(C,P,z)=>{const H=P.component=C.component;if(kT(C,P,z))if(H.asyncDep&&!H.asyncResolved){I(H,P,z);return}else H.next=P,H.update();else P.el=C.el,H.vnode=P},R=(C,P,z,H,D,L,X)=>{const Y=()=>{if(C.isMounted){let{next:ee,bu:ue,u:ye,parent:Pe,vnode:Ve}=C;{const Gt=p_(C);if(Gt){ee&&(ee.el=Ve.el,I(C,ee,X)),Gt.asyncDep.then(()=>{C.isUnmounted||Y()});return}}let He=ee,Bt;Ys(C,!1),ee?(ee.el=Ve.el,I(C,ee,X)):ee=Ve,ue&&lc(ue),(Bt=ee.props&&ee.props.onVnodeBeforeUpdate)&&ti(Bt,Pe,ee,Ve),Ys(C,!0);const _t=pc(C),pi=C.subTree;C.subTree=_t,m(pi,_t,h(pi.el),ce(pi),C,D,L),ee.el=_t.el,He===null&&Ol(C,_t.el),ye&&wt(ye,D),(Bt=ee.props&&ee.props.onVnodeUpdated)&&wt(()=>ti(Bt,Pe,ee,Ve),D)}else{let ee;const{el:ue,props:ye}=P,{bm:Pe,m:Ve,parent:He,root:Bt,type:_t}=C,pi=lr(P);if(Ys(C,!1),Pe&&lc(Pe),!pi&&(ee=ye&&ye.onVnodeBeforeMount)&&ti(ee,He,P),Ys(C,!0),ue&&Ee){const Gt=()=>{C.subTree=pc(C),Ee(ue,C.subTree,C,D,null)};pi&&_t.__asyncHydrate?_t.__asyncHydrate(ue,C,Gt):Gt()}else{Bt.ce&&Bt.ce._def.shadowRoot!==!1&&Bt.ce._injectChildStyle(_t);const Gt=C.subTree=pc(C);m(null,Gt,z,H,C,D,L),P.el=Gt.el}if(Ve&&wt(Ve,D),!pi&&(ee=ye&&ye.onVnodeMounted)){const Gt=P;wt(()=>ti(ee,He,Gt),D)}(P.shapeFlag&256||He&&lr(He.vnode)&&He.vnode.shapeFlag&256)&&C.a&&wt(C.a,D),C.isMounted=!0,P=z=H=null}};C.scope.on();const $=C.effect=new gb(Y);C.scope.off();const G=C.update=$.run.bind($),de=C.job=$.runIfDirty.bind($);de.i=C,de.id=C.uid,$.scheduler=()=>Yg(de),Ys(C,!0),G()},I=(C,P,z)=>{P.component=C;const H=C.vnode.props;C.vnode=P,C.next=null,IT(C,P.props,H,z),FT(C,P.children,z),ts(),iy(C),is()},E=(C,P,z,H,D,L,X,Y,$=!1)=>{const G=C&&C.children,de=C?C.shapeFlag:0,ee=P.children,{patchFlag:ue,shapeFlag:ye}=P;if(ue>0){if(ue&128){Z(G,ee,z,H,D,L,X,Y,$);return}else if(ue&256){U(G,ee,z,H,D,L,X,Y,$);return}}ye&8?(de&16&&j(G,D,L),ee!==G&&c(z,ee)):de&16?ye&16?Z(G,ee,z,H,D,L,X,Y,$):j(G,D,L,!0):(de&8&&c(z,""),ye&16&&A(ee,z,H,D,L,X,Y,$))},U=(C,P,z,H,D,L,X,Y,$)=>{C=C||Vr,P=P||Vr;const G=C.length,de=P.length,ee=Math.min(G,de);let ue;for(ue=0;ue<ee;ue++){const ye=P[ue]=$?Ss(P[ue]):Yt(P[ue]);m(C[ue],ye,z,null,D,L,X,Y,$)}G>de?j(C,D,L,!0,!1,ee):A(P,z,H,D,L,X,Y,$,ee)},Z=(C,P,z,H,D,L,X,Y,$)=>{let G=0;const de=P.length;let ee=C.length-1,ue=de-1;for(;G<=ee&&G<=ue;){const ye=C[G],Pe=P[G]=$?Ss(P[G]):Yt(P[G]);if(Ts(ye,Pe))m(ye,Pe,z,null,D,L,X,Y,$);else break;G++}for(;G<=ee&&G<=ue;){const ye=C[ee],Pe=P[ue]=$?Ss(P[ue]):Yt(P[ue]);if(Ts(ye,Pe))m(ye,Pe,z,null,D,L,X,Y,$);else break;ee--,ue--}if(G>ee){if(G<=ue){const ye=ue+1,Pe=ye<de?P[ye].el:H;for(;G<=ue;)m(null,P[G]=$?Ss(P[G]):Yt(P[G]),z,Pe,D,L,X,Y,$),G++}}else if(G>ue)for(;G<=ee;)te(C[G],D,L,!0),G++;else{const ye=G,Pe=G,Ve=new Map;for(G=Pe;G<=ue;G++){const Wt=P[G]=$?Ss(P[G]):Yt(P[G]);Wt.key!=null&&Ve.set(Wt.key,G)}let He,Bt=0;const _t=ue-Pe+1;let pi=!1,Gt=0;const yn=new Array(_t);for(G=0;G<_t;G++)yn[G]=0;for(G=ye;G<=ee;G++){const Wt=C[G];if(Bt>=_t){te(Wt,D,L,!0);continue}let Ai;if(Wt.key!=null)Ai=Ve.get(Wt.key);else for(He=Pe;He<=ue;He++)if(yn[He-Pe]===0&&Ts(Wt,P[He])){Ai=He;break}Ai===void 0?te(Wt,D,L,!0):(yn[Ai-Pe]=G+1,Ai>=Gt?Gt=Ai:pi=!0,m(Wt,P[Ai],z,null,D,L,X,Y,$),Bt++)}const K0=pi?UT(yn):Vr;for(He=K0.length-1,G=_t-1;G>=0;G--){const Wt=Pe+G,Ai=P[Wt],Z0=P[Wt+1],J0=Wt+1<de?Z0.el||m_(Z0):H;yn[G]===0?m(null,Ai,z,J0,D,L,X,Y,$):pi&&(He<0||G!==K0[He]?se(Ai,z,J0,2):He--)}}},se=(C,P,z,H,D=null)=>{const{el:L,type:X,transition:Y,children:$,shapeFlag:G}=C;if(G&6){se(C.component.subTree,P,z,H);return}if(G&128){C.suspense.move(P,z,H);return}if(G&64){X.move(C,P,z,Ue);return}if(X===pt){s(L,P,z);for(let ee=0;ee<$.length;ee++)se($[ee],P,z,H);s(C.anchor,P,z);return}if(X===_a){v(C,P,z);return}if(H!==2&&G&1&&Y)if(H===0)Y.beforeEnter(L),s(L,P,z),wt(()=>Y.enter(L),D);else{const{leave:ee,delayLeave:ue,afterLeave:ye}=Y,Pe=()=>{C.ctx.isUnmounted?r(L):s(L,P,z)},Ve=()=>{L._isLeaving&&L[ZC](!0),ee(L,()=>{Pe(),ye&&ye()})};ue?ue(L,Pe,Ve):Ve()}else s(L,P,z)},te=(C,P,z,H=!1,D=!1)=>{const{type:L,props:X,ref:Y,children:$,dynamicChildren:G,shapeFlag:de,patchFlag:ee,dirs:ue,cacheIndex:ye}=C;if(ee===-2&&(D=!1),Y!=null&&(ts(),Yr(Y,null,z,C,!0),is()),ye!=null&&(P.renderCache[ye]=void 0),de&256){P.ctx.deactivate(C);return}const Pe=de&1&&ue,Ve=!lr(C);let He;if(Ve&&(He=X&&X.onVnodeBeforeUnmount)&&ti(He,P,C),de&6)J(C.component,z,H);else{if(de&128){C.suspense.unmount(z,H);return}Pe&&zi(C,null,P,"beforeUnmount"),de&64?C.type.remove(C,P,z,Ue,H):G&&!G.hasOnce&&(L!==pt||ee>0&&ee&64)?j(G,P,z,!1,!0):(L===pt&&ee&384||!D&&de&16)&&j($,P,z),H&&q(C)}(Ve&&(He=X&&X.onVnodeUnmounted)||Pe)&&wt(()=>{He&&ti(He,P,C),Pe&&zi(C,null,P,"unmounted")},z)},q=C=>{const{type:P,el:z,anchor:H,transition:D}=C;if(P===pt){he(z,H);return}if(P===_a){x(C);return}const L=()=>{r(z),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(C.shapeFlag&1&&D&&!D.persisted){const{leave:X,delayLeave:Y}=D,$=()=>X(z,L);Y?Y(C.el,L,$):$()}else L()},he=(C,P)=>{let z;for(;C!==P;)z=f(C),r(C),C=z;r(P)},J=(C,P,z)=>{const{bum:H,scope:D,job:L,subTree:X,um:Y,m:$,a:G}=C;gy($),gy(G),H&&lc(H),D.stop(),L&&(L.flags|=8,te(X,C,P,z)),Y&&wt(Y,P),wt(()=>{C.isUnmounted=!0},P)},j=(C,P,z,H=!1,D=!1,L=0)=>{for(let X=L;X<C.length;X++)te(C[X],P,z,H,D)},ce=C=>{if(C.shapeFlag&6)return ce(C.component.subTree);if(C.shapeFlag&128)return C.suspense.next();const P=f(C.anchor||C.el),z=P&&P[Gb];return z?f(z):P};let we=!1;const ke=(C,P,z)=>{let H;C==null?P._vnode&&(te(P._vnode,null,null,!0),H=P._vnode.component):m(P._vnode||null,C,P,null,null,null,z),P._vnode=C,we||(we=!0,iy(H),ja(),we=!1)},Ue={p:m,um:te,m:se,r:q,mt:W,mc:A,pc:E,pbc:k,n:ce,o:t};let Xe,Ee;return e&&([Xe,Ee]=e(Ue)),{render:ke,hydrate:Xe,createApp:xT(ke,Xe)}}function mc({type:t,props:e},i){return i==="svg"&&t==="foreignObject"||i==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Ys({effect:t,job:e},i){i?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function f_(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function t0(t,e,i=!1){const s=t.children,r=e.children;if(ge(s)&&ge(r))for(let n=0;n<s.length;n++){const o=s[n];let a=r[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[n]=Ss(r[n]),a.el=o.el),!i&&a.patchFlag!==-2&&t0(o,a)),a.type===ur&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=n+(t.type===pt?1:0)),a.type===Jt&&!a.el&&(a.el=o.el)}}function UT(t){const e=t.slice(),i=[0];let s,r,n,o,a;const l=t.length;for(s=0;s<l;s++){const u=t[s];if(u!==0){if(r=i[i.length-1],t[r]<u){e[s]=r,i.push(s);continue}for(n=0,o=i.length-1;n<o;)a=n+o>>1,t[i[a]]<u?n=a+1:o=a;u<t[i[n]]&&(n>0&&(e[s]=i[n-1]),i[n]=s)}}for(n=i.length,o=i[n-1];n-- >0;)i[n]=o,o=e[o];return i}function p_(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:p_(e)}function gy(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}function m_(t){if(t.placeholder)return t.placeholder;const e=t.component;return e?m_(e.subTree):null}const g_=t=>t.__isSuspense;let zm=0;const BT={name:"Suspense",__isSuspense:!0,process(t,e,i,s,r,n,o,a,l,u){if(t==null)DT(e,i,s,r,n,o,a,l,u);else{if(n&&n.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}LT(t,e,i,s,r,o,a,l,u)}},hydrate:NT,normalize:HT},OT=BT;function fo(t,e){const i=t.props&&t.props[e];pe(i)&&i()}function DT(t,e,i,s,r,n,o,a,l){const{p:u,o:{createElement:c}}=l,h=c("div"),f=t.suspense=y_(t,r,s,e,h,i,n,o,a,l);u(null,f.pendingBranch=t.ssContent,h,null,s,f,n,o),f.deps>0?(fo(t,"onPending"),fo(t,"onFallback"),u(null,t.ssFallback,e,i,s,null,n,o),Xr(f,t.ssFallback)):f.resolve(!1,!0)}function LT(t,e,i,s,r,n,o,a,{p:l,um:u,o:{createElement:c}}){const h=e.suspense=t.suspense;h.vnode=e,e.el=t.el;const f=e.ssContent,d=e.ssFallback,{activeBranch:p,pendingBranch:m,isInFallback:g,isHydrating:y}=h;if(m)h.pendingBranch=f,Ts(m,f)?(l(m,f,h.hiddenContainer,null,r,h,n,o,a),h.deps<=0?h.resolve():g&&(y||(l(p,d,i,s,r,null,n,o,a),Xr(h,d)))):(h.pendingId=zm++,y?(h.isHydrating=!1,h.activeBranch=m):u(m,r,h),h.deps=0,h.effects.length=0,h.hiddenContainer=c("div"),g?(l(null,f,h.hiddenContainer,null,r,h,n,o,a),h.deps<=0?h.resolve():(l(p,d,i,s,r,null,n,o,a),Xr(h,d))):p&&Ts(p,f)?(l(p,f,i,s,r,h,n,o,a),h.resolve(!0)):(l(null,f,h.hiddenContainer,null,r,h,n,o,a),h.deps<=0&&h.resolve()));else if(p&&Ts(p,f))l(p,f,i,s,r,h,n,o,a),Xr(h,f);else if(fo(e,"onPending"),h.pendingBranch=f,f.shapeFlag&512?h.pendingId=f.component.suspenseId:h.pendingId=zm++,l(null,f,h.hiddenContainer,null,r,h,n,o,a),h.deps<=0)h.resolve();else{const{timeout:b,pendingId:v}=h;b>0?setTimeout(()=>{h.pendingId===v&&h.fallback(d)},b):b===0&&h.fallback(d)}}function y_(t,e,i,s,r,n,o,a,l,u,c=!1){const{p:h,m:f,um:d,n:p,o:{parentNode:m,remove:g}}=u;let y;const b=GT(t);b&&e&&e.pendingBranch&&(y=e.pendingId,e.deps++);const v=t.props?oC(t.props.timeout):void 0,x=n,_={vnode:t,parent:e,parentComponent:i,namespace:o,container:s,hiddenContainer:r,deps:0,pendingId:zm++,timeout:typeof v=="number"?v:-1,activeBranch:null,pendingBranch:null,isInFallback:!c,isHydrating:c,isUnmounted:!1,effects:[],resolve(S=!1,T=!1){const{vnode:A,activeBranch:w,pendingBranch:k,pendingId:F,effects:O,parentComponent:V,container:W,isInFallback:ie}=_;let R=!1;_.isHydrating?_.isHydrating=!1:S||(R=w&&k.transition&&k.transition.mode==="out-in",R&&(w.transition.afterLeave=()=>{F===_.pendingId&&(f(k,W,n===x?p(w):n,0),Am(O),ie&&A.ssFallback&&(A.ssFallback.el=null))}),w&&(m(w.el)===W&&(n=p(w)),d(w,V,_,!0),!R&&ie&&A.ssFallback&&wt(()=>A.ssFallback.el=null,_)),R||f(k,W,n,0)),Xr(_,k),_.pendingBranch=null,_.isInFallback=!1;let I=_.parent,E=!1;for(;I;){if(I.pendingBranch){I.effects.push(...O),E=!0;break}I=I.parent}!E&&!R&&Am(O),_.effects=[],b&&e&&e.pendingBranch&&y===e.pendingId&&(e.deps--,e.deps===0&&!T&&e.resolve()),fo(A,"onResolve")},fallback(S){if(!_.pendingBranch)return;const{vnode:T,activeBranch:A,parentComponent:w,container:k,namespace:F}=_;fo(T,"onFallback");const O=p(A),V=()=>{_.isInFallback&&(h(null,S,k,O,w,null,F,a,l),Xr(_,S))},W=S.transition&&S.transition.mode==="out-in";W&&(A.transition.afterLeave=V),_.isInFallback=!0,d(A,w,null,!0),W||V()},move(S,T,A){_.activeBranch&&f(_.activeBranch,S,T,A),_.container=S},next(){return _.activeBranch&&p(_.activeBranch)},registerDep(S,T,A){const w=!!_.pendingBranch;w&&_.deps++;const k=S.vnode.el;S.asyncDep.catch(F=>{ln(F,S,0)}).then(F=>{if(S.isUnmounted||_.isUnmounted||_.pendingId!==S.suspenseId)return;S.asyncResolved=!0;const{vnode:O}=S;Bm(S,F),k&&(O.el=k);const V=!k&&S.subTree.el;T(S,O,m(k||S.subTree.el),k?null:p(S.subTree),_,o,A),V&&(O.placeholder=null,g(V)),Ol(S,O.el),w&&--_.deps===0&&_.resolve()})},unmount(S,T){_.isUnmounted=!0,_.activeBranch&&d(_.activeBranch,i,S,T),_.pendingBranch&&d(_.pendingBranch,i,S,T)}};return _}function NT(t,e,i,s,r,n,o,a,l){const u=e.suspense=y_(e,s,i,t.parentNode,document.createElement("div"),null,r,n,o,a,!0),c=l(t,u.pendingBranch=e.ssContent,i,u,n,o);return u.deps===0&&u.resolve(!1,!0),c}function HT(t){const{shapeFlag:e,children:i}=t,s=e&32;t.ssContent=yy(s?i.default:i),t.ssFallback=s?yy(i.fallback):oe(Jt)}function yy(t){let e;if(pe(t)){const i=Jr&&t._c;i&&(t._d=!1,fe()),t=t(),i&&(t._d=!0,e=Lt,x_())}return ge(t)&&(t=ST(t)),t=Yt(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(i=>i!==t)),t}function v_(t,e){e&&e.pendingBranch?ge(t)?e.effects.push(...t):e.effects.push(t):Am(t)}function Xr(t,e){t.activeBranch=e;const{vnode:i,parentComponent:s}=t;let r=e.el;for(;!r&&e.component;)e=e.component.subTree,r=e.el;i.el=r,s&&s.subTree===i&&(s.vnode.el=r,Ol(s,r))}function GT(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const pt=Symbol.for("v-fgt"),ur=Symbol.for("v-txt"),Jt=Symbol.for("v-cmt"),_a=Symbol.for("v-stc"),Kn=[];let Lt=null;function fe(t=!1){Kn.push(Lt=t?null:[])}function x_(){Kn.pop(),Lt=Kn[Kn.length-1]||null}let Jr=1;function Qa(t,e=!1){Jr+=t,t<0&&Lt&&e&&(Lt.hasOnce=!0)}function b_(t){return t.dynamicChildren=Jr>0?Lt||Vr:null,x_(),Jr>0&&Lt&&Lt.push(t),t}function dr(t,e,i,s,r,n){return b_(nt(t,e,i,s,r,n,!0))}function _e(t,e,i,s,r){return b_(oe(t,e,i,s,r,!0))}function Qr(t){return t?t.__v_isVNode===!0:!1}function Ts(t,e){return t.type===e.type&&t.key===e.key}const __=({key:t})=>t??null,wa=({ref:t,ref_key:e,ref_for:i})=>(typeof t=="number"&&(t=""+t),t!=null?Qe(t)||je(t)||pe(t)?{i:Pt,r:t,k:e,f:!!i}:t:null);function nt(t,e=null,i=null,s=0,r=null,n=t===pt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&__(e),ref:e&&wa(e),scopeId:Lb,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Pt};return a?(s0(l,i),n&128&&t.normalize(l)):i&&(l.shapeFlag|=Qe(i)?8:16),Jr>0&&!o&&Lt&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Lt.push(l),l}const oe=WT;function WT(t,e=null,i=null,s=0,r=null,n=!1){if((!t||t===Kb)&&(t=Jt),Qr(t)){const a=fr(t,e,!0);return i&&s0(a,i),Jr>0&&!n&&Lt&&(a.shapeFlag&6?Lt[Lt.indexOf(t)]=a:Lt.push(a)),a.patchFlag=-2,a}if(JT(t)&&(t=t.__vccOpts),e){e=cs(e);let{class:a,style:l}=e;a&&!Qe(a)&&(e.class=Ao(a)),Ke(l)&&(Fl(l)&&!ge(l)&&(l=yt({},l)),e.style=Gs(l))}const o=Qe(t)?1:g_(t)?128:XC(t)?64:Ke(t)?4:pe(t)?2:0;return nt(t,e,i,s,r,o,n,!0)}function cs(t){return t?Fl(t)||o_(t)?yt({},t):t:null}function fr(t,e,i=!1,s=!1){const{props:r,ref:n,patchFlag:o,children:a,transition:l}=t,u=e?vt(r||{},e):r,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&__(u),ref:e&&e.ref?i&&n?ge(n)?n.concat(wa(e)):[n,wa(e)]:wa(e):n,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==pt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&fr(t.ssContent),ssFallback:t.ssFallback&&fr(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&jg(c,l.clone(c)),c}function el(t=" ",e=0){return oe(ur,null,t,e)}function i0(t="",e=!1){return e?(fe(),_e(Jt,null,t)):oe(Jt,null,t)}function Yt(t){return t==null||typeof t=="boolean"?oe(Jt):ge(t)?oe(pt,null,t.slice()):Qr(t)?Ss(t):oe(ur,null,String(t))}function Ss(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:fr(t)}function s0(t,e){let i=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(ge(e))i=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),s0(t,r()),r._c&&(r._d=!0));return}else{i=32;const r=e._;!r&&!o_(e)?e._ctx=Pt:r===3&&Pt&&(Pt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else pe(e)?(e={default:e,_ctx:Pt},i=32):(e=String(e),s&64?(i=16,e=[el(e)]):i=8);t.children=e,t.shapeFlag|=i}function vt(...t){const e={};for(let i=0;i<t.length;i++){const s=t[i];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=Ao([e.class,s.class]));else if(r==="style")e.style=Gs([e.style,s.style]);else if(ko(r)){const n=e[r],o=s[r];o&&n!==o&&!(ge(n)&&n.includes(o))&&(e[r]=n?[].concat(n,o):o)}else r!==""&&(e[r]=s[r])}return e}function ti(t,e,i,s=null){Gi(t,e,7,[i,s])}const VT=i_();let $T=0;function qT(t,e,i){const s=t.type,r=(e?e.appContext:t.appContext)||VT,n={uid:$T++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:l_(s,r),emitsOptions:s_(s,r),emit:null,emitted:null,propsDefaults:Ye,inheritAttrs:s.inheritAttrs,ctx:Ye,data:Ye,props:Ye,attrs:Ye,slots:Ye,refs:Ye,setupState:Ye,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=_T.bind(null,n),t.ce&&t.ce(n),n}let mt=null;const hi=()=>mt||Pt;let tl,Um;{const t=Al(),e=(i,s)=>{let r;return(r=t[i])||(r=t[i]=[]),r.push(s),n=>{r.length>1?r.forEach(o=>o(n)):r[0](n)}};tl=e("__VUE_INSTANCE_SETTERS__",i=>mt=i),Um=e("__VUE_SSR_SETTERS__",i=>en=i)}const Po=t=>{const e=mt;return tl(t),t.scope.on(),()=>{t.scope.off(),tl(e)}},vy=()=>{mt&&mt.scope.off(),tl(null)};function w_(t){return t.vnode.shapeFlag&4}let en=!1;function YT(t,e=!1,i=!1){e&&Um(e);const{props:s,children:r}=t.vnode,n=w_(t);AT(t,s,n,e),MT(t,r,i||e);const o=n?XT(t,e):void 0;return e&&Um(!1),o}function XT(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,dT);const{setup:s}=i;if(s){ts();const r=t.setupContext=s.length>1?KT(t):null,n=Po(t),o=Io(s,t,0,[t.props,r]),a=ab(o);if(is(),n(),(a||t.sp)&&!lr(t)&&Kg(t),a){if(o.then(vy,vy),e)return o.then(l=>{Bm(t,l)}).catch(l=>{ln(l,t,0)});t.asyncDep=o}else Bm(t,o)}else S_(t)}function Bm(t,e,i){pe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ke(e)&&(t.setupState=zb(e)),S_(t)}function S_(t,e,i){const s=t.type;t.render||(t.render=s.render||Oi);{const r=Po(t);ts();try{fT(t)}finally{is(),r()}}}const jT={get(t,e){return Ct(t,"get",""),t[e]}};function KT(t){const e=i=>{t.exposed=i||{}};return{attrs:new Proxy(t.attrs,jT),slots:t.slots,emit:t.emit,expose:e}}function r0(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(zb(Fb(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in jn)return jn[i](t)},has(e,i){return i in e||i in jn}})):t.proxy}function ZT(t,e=!0){return pe(t)?t.displayName||t.name:t.name||e&&t.__name}function JT(t){return pe(t)&&"__vccOpts"in t}const me=(t,e)=>NC(t,e,en);function Oe(t,e,i){try{Qa(-1);const s=arguments.length;return s===2?Ke(e)&&!ge(e)?Qr(e)?oe(t,null,[e]):oe(t,e):oe(t,null,e):(s>3?i=Array.prototype.slice.call(arguments,2):s===3&&Qr(i)&&(i=[i]),oe(t,e,i))}finally{Qa(1)}}const QT="3.5.27";let Om;const xy=typeof window<"u"&&window.trustedTypes;if(xy)try{Om=xy.createPolicy("vue",{createHTML:t=>t})}catch{}const C_=Om?t=>Om.createHTML(t):t=>t,e3="http://www.w3.org/2000/svg",t3="http://www.w3.org/1998/Math/MathML",Zi=typeof document<"u"?document:null,by=Zi&&Zi.createElement("template"),i3={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,s)=>{const r=e==="svg"?Zi.createElementNS(e3,t):e==="mathml"?Zi.createElementNS(t3,t):i?Zi.createElement(t,{is:i}):Zi.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Zi.createTextNode(t),createComment:t=>Zi.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Zi.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,s,r,n){const o=i?i.previousSibling:e.lastChild;if(r&&(r===n||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),i),!(r===n||!(r=r.nextSibling)););else{by.innerHTML=C_(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=by.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,i)}return[o?o.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},s3=Symbol("_vtc");function r3(t,e,i){const s=t[s3];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const _y=Symbol("_vod"),n3=Symbol("_vsh"),o3=Symbol(""),a3=/(?:^|;)\s*display\s*:/;function l3(t,e,i){const s=t.style,r=Qe(i);let n=!1;if(i&&!r){if(e)if(Qe(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();i[a]==null&&Sa(s,a,"")}else for(const o in e)i[o]==null&&Sa(s,o,"");for(const o in i)o==="display"&&(n=!0),Sa(s,o,i[o])}else if(r){if(e!==i){const o=s[o3];o&&(i+=";"+o),s.cssText=i,n=a3.test(i)}}else e&&t.removeAttribute("style");_y in t&&(t[_y]=n?s.display:"",t[n3]&&(s.display="none"))}const wy=/\s*!important$/;function Sa(t,e,i){if(ge(i))i.forEach(s=>Sa(t,e,s));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const s=c3(t,e);wy.test(i)?t.setProperty(Hs(s),i.replace(wy,""),"important"):t[s]=i}}const Sy=["Webkit","Moz","ms"],gc={};function c3(t,e){const i=gc[e];if(i)return i;let s=Ht(e);if(s!=="filter"&&s in t)return gc[e]=s;s=kl(s);for(let r=0;r<Sy.length;r++){const n=Sy[r]+s;if(n in t)return gc[e]=n}return e}const Cy="http://www.w3.org/1999/xlink";function Ty(t,e,i,s,r,n=dC(e)){s&&e.startsWith("xlink:")?i==null?t.removeAttributeNS(Cy,e.slice(6,e.length)):t.setAttributeNS(Cy,e,i):i==null||n&&!hb(i)?t.removeAttribute(e):t.setAttribute(e,n?"":as(i)?String(i):i)}function ky(t,e,i,s,r){if(e==="innerHTML"||e==="textContent"){i!=null&&(t[e]=e==="innerHTML"?C_(i):i);return}const n=t.tagName;if(e==="value"&&n!=="PROGRESS"&&!n.includes("-")){const a=n==="OPTION"?t.getAttribute("value")||"":t.value,l=i==null?t.type==="checkbox"?"on":"":String(i);(a!==l||!("_value"in t))&&(t.value=l),i==null&&t.removeAttribute(e),t._value=i;return}let o=!1;if(i===""||i==null){const a=typeof t[e];a==="boolean"?i=hb(i):i==null&&a==="string"?(i="",o=!0):a==="number"&&(i=0,o=!0)}try{t[e]=i}catch{}o&&t.removeAttribute(r||e)}function u3(t,e,i,s){t.addEventListener(e,i,s)}function h3(t,e,i,s){t.removeEventListener(e,i,s)}const Ay=Symbol("_vei");function d3(t,e,i,s,r=null){const n=t[Ay]||(t[Ay]={}),o=n[e];if(s&&o)o.value=s;else{const[a,l]=f3(e);if(s){const u=n[e]=g3(s,r);u3(t,a,u,l)}else o&&(h3(t,a,o,l),n[e]=void 0)}}const Iy=/(?:Once|Passive|Capture)$/;function f3(t){let e;if(Iy.test(t)){e={};let s;for(;s=t.match(Iy);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Hs(t.slice(2)),e]}let yc=0;const p3=Promise.resolve(),m3=()=>yc||(p3.then(()=>yc=0),yc=Date.now());function g3(t,e){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;Gi(y3(s,i.value),e,5,[s])};return i.value=t,i.attached=m3(),i}function y3(t,e){if(ge(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Py=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,v3=(t,e,i,s,r,n)=>{const o=r==="svg";e==="class"?r3(t,s,o):e==="style"?l3(t,i,s):ko(e)?Lg(e)||d3(t,e,i,s,n):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):x3(t,e,s,o))?(ky(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ty(t,e,s,o,n,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Qe(s))?ky(t,Ht(e),s,n,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Ty(t,e,s,o))};function x3(t,e,i,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Py(e)&&pe(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Py(e)&&Qe(i)?!1:e in t}const b3=["ctrl","shift","alt","meta"],_3={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>b3.some(i=>t[`${i}Key`]&&!e.includes(i))},w3=(t,e)=>{const i=t._withMods||(t._withMods={}),s=e.join(".");return i[s]||(i[s]=((r,...n)=>{for(let o=0;o<e.length;o++){const a=_3[e[o]];if(a&&a(r,e))return}return t(r,...n)}))},S3={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},C3=(t,e)=>{const i=t._withKeys||(t._withKeys={}),s=e.join(".");return i[s]||(i[s]=(r=>{if(!("key"in r))return;const n=Hs(r.key);if(e.some(o=>o===n||S3[o]===n))return t(r)}))},T_=yt({patchProp:v3},i3);let Zn,Ey=!1;function T3(){return Zn||(Zn=RT(T_))}function k3(){return Zn=Ey?Zn:zT(T_),Ey=!0,Zn}const A3=((...t)=>{const e=T3().createApp(...t),{mount:i}=e;return e.mount=s=>{const r=A_(s);if(!r)return;const n=e._component;!pe(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=i(r,!1,k_(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e}),I3=((...t)=>{const e=k3().createApp(...t),{mount:i}=e;return e.mount=s=>{const r=A_(s);if(r)return i(r,!0,k_(r))},e});function k_(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function A_(t){return Qe(t)?document.querySelector(t):t}const P3=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,E3=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,M3=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function F3(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){R3(t);return}return e}function R3(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function il(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const i=t.trim();if(i.length<=9)switch(i.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!M3.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(P3.test(t)||E3.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,F3)}return JSON.parse(t)}catch(s){if(e.strict)throw s;return t}}const z3=/#/g,U3=/&/g,B3=/\//g,O3=/=/g,n0=/\+/g,D3=/%5e/gi,L3=/%60/gi,N3=/%7c/gi,H3=/%20/gi;function G3(t){return encodeURI(""+t).replace(N3,"|")}function Dm(t){return G3(typeof t=="string"?t:JSON.stringify(t)).replace(n0,"%2B").replace(H3,"+").replace(z3,"%23").replace(U3,"%26").replace(L3,"`").replace(D3,"^").replace(B3,"%2F")}function vc(t){return Dm(t).replace(O3,"%3D")}function sl(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function W3(t){return sl(t.replace(n0," "))}function V3(t){return sl(t.replace(n0," "))}function o0(t=""){const e=Object.create(null);t[0]==="?"&&(t=t.slice(1));for(const i of t.split("&")){const s=i.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;const r=W3(s[1]);if(r==="__proto__"||r==="constructor")continue;const n=V3(s[2]||"");e[r]===void 0?e[r]=n:Array.isArray(e[r])?e[r].push(n):e[r]=[e[r],n]}return e}function $3(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(i=>`${vc(t)}=${Dm(i)}`).join("&"):`${vc(t)}=${Dm(e)}`:vc(t)}function I_(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>$3(e,t[e])).filter(Boolean).join("&")}const q3=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Y3=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,X3=/^([/\\]\s*){2,}[^/\\]/,j3=/^[\s\0]*(blob|data|javascript|vbscript):$/i,K3=/\/$|\/\?|\/#/,Z3=/^\.?\//;function cn(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?q3.test(t):Y3.test(t)||(e.acceptRelative?X3.test(t):!1)}function J3(t){return!!t&&j3.test(t)}function Lm(t="",e){return e?K3.test(t):t.endsWith("/")}function P_(t="",e){if(!e)return(Lm(t)?t.slice(0,-1):t)||"/";if(!Lm(t,!0))return t||"/";let i=t,s="";const r=t.indexOf("#");r!==-1&&(i=t.slice(0,r),s=t.slice(r));const[n,...o]=i.split("?");return((n.endsWith("/")?n.slice(0,-1):n)||"/")+(o.length>0?`?${o.join("?")}`:"")+s}function Nm(t="",e){if(!e)return t.endsWith("/")?t:t+"/";if(Lm(t,!0))return t||"/";let i=t,s="";const r=t.indexOf("#");if(r!==-1&&(i=t.slice(0,r),s=t.slice(r),!i))return s;const[n,...o]=i.split("?");return n+"/"+(o.length>0?`?${o.join("?")}`:"")+s}function Q3(t=""){return t.startsWith("/")}function My(t=""){return Q3(t)?t:"/"+t}function ek(t,e){if(M_(e)||cn(t))return t;const i=P_(e);if(t.startsWith(i)){const s=t[i.length];if(!s||s==="/"||s==="?")return t}return Dl(i,t)}function tk(t,e){if(M_(e))return t;const i=P_(e);if(!t.startsWith(i))return t;const s=t[i.length];if(s&&s!=="/"&&s!=="?")return t;const r=t.slice(i.length);return r[0]==="/"?r:"/"+r}function E_(t,e){const i=z_(t),s={...o0(i.search),...e};return i.search=I_(s),U_(i)}function M_(t){return!t||t==="/"}function ik(t){return t&&t!=="/"}function Dl(t,...e){let i=t||"";for(const s of e.filter(r=>ik(r)))if(i){const r=s.replace(Z3,"");i=Nm(i)+r}else i=s;return i}function F_(...t){const e=/\/(?!\/)/,i=t.filter(Boolean),s=[];let r=0;for(const o of i)if(!(!o||o==="/")){for(const[a,l]of o.split(e).entries())if(!(!l||l===".")){if(l===".."){if(s.length===1&&cn(s[0]))continue;s.pop(),r--;continue}if(a===1&&s[s.length-1]?.endsWith(":/")){s[s.length-1]+="/"+l;continue}s.push(l),r++}}let n=s.join("/");return r>=0?i[0]?.startsWith("/")&&!n.startsWith("/")?n="/"+n:i[0]?.startsWith("./")&&!n.startsWith("./")&&(n="./"+n):n="../".repeat(-1*r)+n,i[i.length-1]?.endsWith("/")&&!n.endsWith("/")&&(n+="/"),n}function sk(t,e,i={}){return i.trailingSlash||(t=Nm(t),e=Nm(e)),i.leadingSlash||(t=My(t),e=My(e)),i.encoding||(t=sl(t),e=sl(e)),t===e}const R_=Symbol.for("ufo:protocolRelative");function z_(t="",e){const i=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(i){const[,h,f=""]=i;return{protocol:h.toLowerCase(),pathname:f,href:h+f,auth:"",host:"",search:"",hash:""}}if(!cn(t,{acceptRelative:!0}))return Fy(t);const[,s="",r,n=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,o="",a=""]=n.match(/([^#/?]*)(.*)?/)||[];s==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:l,search:u,hash:c}=Fy(a);return{protocol:s.toLowerCase(),auth:r?r.slice(0,Math.max(0,r.length-1)):"",host:o,pathname:l,search:u,hash:c,[R_]:!s}}function Fy(t=""){const[e="",i="",s=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:i,hash:s}}function U_(t){const e=t.pathname||"",i=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",s=t.hash||"",r=t.auth?t.auth+"@":"",n=t.host||"";return(t.protocol||t[R_]?(t.protocol||"")+"//":"")+r+n+e+i+s}class rk extends Error{constructor(e,i){super(e,i),this.name="FetchError",i?.cause&&!this.cause&&(this.cause=i.cause)}}function nk(t){const e=t.error?.message||t.error?.toString()||"",i=t.request?.method||t.options?.method||"GET",s=t.request?.url||String(t.request)||"/",r=`[${i}] ${JSON.stringify(s)}`,n=t.response?`${t.response.status} ${t.response.statusText}`:"<no response>",o=`${r}: ${n}${e?` ${e}`:""}`,a=new rk(o,t.error?{cause:t.error}:void 0);for(const l of["request","options","response"])Object.defineProperty(a,l,{get(){return t[l]}});for(const[l,u]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(a,l,{get(){return t.response&&t.response[u]}});return a}const ok=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Ry(t="GET"){return ok.has(t.toUpperCase())}function ak(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.buffer||t instanceof FormData||t instanceof URLSearchParams?!1:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const lk=new Set(["image/svg","application/xml","application/xhtml","application/html"]),ck=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function uk(t=""){if(!t)return"json";const e=t.split(";").shift()||"";return ck.test(e)?"json":e==="text/event-stream"?"stream":lk.has(e)||e.startsWith("text/")?"text":"blob"}function hk(t,e,i,s){const r=dk(e?.headers??t?.headers,i?.headers,s);let n;return(i?.query||i?.params||e?.params||e?.query)&&(n={...i?.params,...i?.query,...e?.params,...e?.query}),{...i,...e,query:n,params:n,headers:r}}function dk(t,e,i){if(!e)return new i(t);const s=new i(e);if(t)for(const[r,n]of Symbol.iterator in t||Array.isArray(t)?t:new i(t))s.set(r,n);return s}async function Go(t,e){if(e)if(Array.isArray(e))for(const i of e)await i(t);else await e(t)}const fk=new Set([408,409,425,429,500,502,503,504]),pk=new Set([101,204,205,304]);function B_(t={}){const{fetch:e=globalThis.fetch,Headers:i=globalThis.Headers,AbortController:s=globalThis.AbortController}=t;async function r(a){const l=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!l){let c;typeof a.options.retry=="number"?c=a.options.retry:c=Ry(a.options.method)?0:1;const h=a.response&&a.response.status||500;if(c>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(h):fk.has(h))){const f=typeof a.options.retryDelay=="function"?a.options.retryDelay(a):a.options.retryDelay||0;return f>0&&await new Promise(d=>setTimeout(d,f)),n(a.request,{...a.options,retry:c-1})}}const u=nk(a);throw Error.captureStackTrace&&Error.captureStackTrace(u,n),u}const n=async function(l,u={}){const c={request:l,options:hk(l,u,t.defaults,i),response:void 0,error:void 0};if(c.options.method&&(c.options.method=c.options.method.toUpperCase()),c.options.onRequest&&(await Go(c,c.options.onRequest),c.options.headers instanceof i||(c.options.headers=new i(c.options.headers||{}))),typeof c.request=="string"&&(c.options.baseURL&&(c.request=ek(c.request,c.options.baseURL)),c.options.query&&(c.request=E_(c.request,c.options.query),delete c.options.query),"query"in c.options&&delete c.options.query,"params"in c.options&&delete c.options.params),c.options.body&&Ry(c.options.method))if(ak(c.options.body)){const d=c.options.headers.get("content-type");typeof c.options.body!="string"&&(c.options.body=d==="application/x-www-form-urlencoded"?new URLSearchParams(c.options.body).toString():JSON.stringify(c.options.body)),d||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json")}else("pipeTo"in c.options.body&&typeof c.options.body.pipeTo=="function"||typeof c.options.body.pipe=="function")&&("duplex"in c.options||(c.options.duplex="half"));let h;if(!c.options.signal&&c.options.timeout){const d=new s;h=setTimeout(()=>{const p=new Error("[TimeoutError]: The operation was aborted due to timeout");p.name="TimeoutError",p.code=23,d.abort(p)},c.options.timeout),c.options.signal=d.signal}try{c.response=await e(c.request,c.options)}catch(d){return c.error=d,c.options.onRequestError&&await Go(c,c.options.onRequestError),await r(c)}finally{h&&clearTimeout(h)}if((c.response.body||c.response._bodyInit)&&!pk.has(c.response.status)&&c.options.method!=="HEAD"){const d=(c.options.parseResponse?"json":c.options.responseType)||uk(c.response.headers.get("content-type")||"");switch(d){case"json":{const p=await c.response.text(),m=c.options.parseResponse||il;c.response._data=m(p);break}case"stream":{c.response._data=c.response.body||c.response._bodyInit;break}default:c.response._data=await c.response[d]()}}return c.options.onResponse&&await Go(c,c.options.onResponse),!c.options.ignoreResponseError&&c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await Go(c,c.options.onResponseError),await r(c)):c.response},o=async function(l,u){return(await n(l,u))._data};return o.raw=n,o.native=(...a)=>e(...a),o.create=(a={},l={})=>B_({...t,...l,defaults:{...t.defaults,...l.defaults,...a}}),o}const rl=(function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")})(),mk=rl.fetch?(...t)=>rl.fetch(...t):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),gk=rl.Headers,yk=rl.AbortController,vk=B_({fetch:mk,Headers:gk,AbortController:yk}),xk=vk,bk=()=>window?.__NUXT__?.config||window?.useNuxtApp?.().payload?.config,a0=()=>bk().app,_k=()=>a0().baseURL,wk=()=>a0().buildAssetsDir,l0=(...t)=>F_(O_(),wk(),...t),O_=(...t)=>{const e=a0(),i=e.cdnURL||e.baseURL;return t.length?F_(i,...t):i};globalThis.__buildAssetsURL=l0,globalThis.__publicAssetsURL=O_;globalThis.$fetch||(globalThis.$fetch=xk.create({baseURL:_k()}));"global"in globalThis||(globalThis.global=globalThis);function Hm(t,e={},i){for(const s in t){const r=t[s],n=i?`${i}:${s}`:s;typeof r=="object"&&r!==null?Hm(r,e,n):typeof r=="function"&&(e[n]=r)}return e}const Sk={run:t=>t()},Ck=()=>Sk,D_=typeof console.createTask<"u"?console.createTask:Ck;function Tk(t,e){const i=e.shift(),s=D_(i);return t.reduce((r,n)=>r.then(()=>s.run(()=>n(...e))),Promise.resolve())}function kk(t,e){const i=e.shift(),s=D_(i);return Promise.all(t.map(r=>s.run(()=>r(...e))))}function xc(t,e){for(const i of[...t])i(e)}let Ak=class{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,i,s={}){if(!e||typeof i!="function")return()=>{};const r=e;let n;for(;this._deprecatedHooks[e];)n=this._deprecatedHooks[e],e=n.to;if(n&&!s.allowDeprecated){let o=n.message;o||(o=`${r} hook has been deprecated`+(n.to?`, please use ${n.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(o)||(console.warn(o),this._deprecatedMessages.add(o))}if(!i.name)try{Object.defineProperty(i,"name",{get:()=>"_"+e.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(i),()=>{i&&(this.removeHook(e,i),i=void 0)}}hookOnce(e,i){let s,r=(...n)=>(typeof s=="function"&&s(),s=void 0,r=void 0,i(...n));return s=this.hook(e,r),s}removeHook(e,i){if(this._hooks[e]){const s=this._hooks[e].indexOf(i);s!==-1&&this._hooks[e].splice(s,1),this._hooks[e].length===0&&delete this._hooks[e]}}deprecateHook(e,i){this._deprecatedHooks[e]=typeof i=="string"?{to:i}:i;const s=this._hooks[e]||[];delete this._hooks[e];for(const r of s)this.hook(e,r)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const i in e)this.deprecateHook(i,e[i])}addHooks(e){const i=Hm(e),s=Object.keys(i).map(r=>this.hook(r,i[r]));return()=>{for(const r of s.splice(0,s.length))r()}}removeHooks(e){const i=Hm(e);for(const s in i)this.removeHook(s,i[s])}removeAllHooks(){for(const e in this._hooks)delete this._hooks[e]}callHook(e,...i){return i.unshift(e),this.callHookWith(Tk,e,...i)}callHookParallel(e,...i){return i.unshift(e),this.callHookWith(kk,e,...i)}callHookWith(e,i,...s){const r=this._before||this._after?{name:i,args:s,context:{}}:void 0;this._before&&xc(this._before,r);const n=e(i in this._hooks?[...this._hooks[i]]:[],s);return n instanceof Promise?n.finally(()=>{this._after&&r&&xc(this._after,r)}):(this._after&&r&&xc(this._after,r),n)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{if(this._before!==void 0){const i=this._before.indexOf(e);i!==-1&&this._before.splice(i,1)}}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{if(this._after!==void 0){const i=this._after.indexOf(e);i!==-1&&this._after.splice(i,1)}}}};function Ik(){return new Ak}function Pk(t={}){let e,i=!1;const s=o=>{if(e&&e!==o)throw new Error("Context conflict")};let r;if(t.asyncContext){const o=t.AsyncLocalStorage||globalThis.AsyncLocalStorage;o?r=new o:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const n=()=>{if(r){const o=r.getStore();if(o!==void 0)return o}return e};return{use:()=>{const o=n();if(o===void 0)throw new Error("Context is not available");return o},tryUse:()=>n(),set:(o,a)=>{a||s(o),e=o,i=!0},unset:()=>{e=void 0,i=!1},call:(o,a)=>{s(o),e=o;try{return r?r.run(o,a):a()}finally{i||(e=void 0)}},async callAsync(o,a){e=o;const l=()=>{e=o},u=()=>e===o?l:void 0;Gm.add(u);try{const c=r?r.run(o,a):a();return i||(e=void 0),await c}finally{Gm.delete(u)}}}}function Ek(t={}){const e={};return{get(i,s={}){return e[i]||(e[i]=Pk({...t,...s})),e[i]}}}const nl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},zy="__unctx__",Mk=nl[zy]||(nl[zy]=Ek()),Fk=(t,e={})=>Mk.get(t,e),Uy="__unctx_async_handlers__",Gm=nl[Uy]||(nl[Uy]=new Set);function L_(t){const e=[];for(const r of Gm){const n=r();n&&e.push(n)}const i=()=>{for(const r of e)r()};let s=t();return s&&typeof s=="object"&&"catch"in s&&(s=s.catch(r=>{throw i(),r})),[s,i]}const By={id:"__nuxt-loader"},F7={componentName:"NuxtLink",prefetch:!0,prefetchOn:{visibility:!0}},Rk="#__nuxt",N_="nuxt-app",Oy=36e5,zk="vite:preloadError";function H_(t=N_){return Fk(t,{asyncContext:!1})}const Uk="__nuxt_plugin";function Bk(t){let e=0;const i={_id:t.id||N_||"nuxt-app",_scope:Hg(),provide:void 0,versions:{get nuxt(){return"4.2.2"},get vue(){return i.vueApp.version}},payload:Dr({...t.ssrContext?.payload||{},data:Dr({}),state:ci({}),once:new Set,_errors:Dr({})}),static:{data:{}},runWithContext(r){return i._scope.active&&!Il()?i._scope.run(()=>Dy(i,r)):Dy(i,r)},isHydrating:!0,deferHydration(){if(!i.isHydrating)return()=>{};e++;let r=!1;return()=>{if(!r&&(r=!0,e--,e===0))return i.isHydrating=!1,i.callHook("app:suspense:resolve")}},_asyncDataPromises:{},_asyncData:Dr({}),_payloadRevivers:{},...t};{const r=window.__NUXT__;if(r)for(const n in r)switch(n){case"data":case"state":case"_errors":Object.assign(i.payload[n],r[n]);break;default:i.payload[n]=r[n]}}i.hooks=Ik(),i.hook=i.hooks.hook,i.callHook=i.hooks.callHook,i.provide=(r,n)=>{const o="$"+r;Wo(i,o,n),Wo(i.vueApp.config.globalProperties,o,n)},Wo(i.vueApp,"$nuxt",i),Wo(i.vueApp.config.globalProperties,"$nuxt",i);{window.addEventListener(zk,n=>{i.callHook("app:chunkError",{error:n.payload}),n.payload.message.includes("Unable to preload CSS")&&n.preventDefault()}),window.useNuxtApp||=xt;const r=i.hook("app:error",(...n)=>{console.error("[nuxt] error caught during app initialization",...n)});i.hook("app:mounted",r)}const s=i.payload.config;return i.provide("config",s),i}function Ok(t,e){e.hooks&&t.hooks.addHooks(e.hooks)}async function Dk(t,e){if(typeof e=="function"){const{provide:i}=await t.runWithContext(()=>e(t))||{};if(i&&typeof i=="object")for(const s in i)t.provide(s,i[s])}}async function Lk(t,e){const i=new Set,s=[],r=[];let n,o=0;async function a(l){const u=l.dependsOn?.filter(c=>e.some(h=>h._name===c)&&!i.has(c))??[];if(u.length>0)s.push([new Set(u),l]);else{const c=Dk(t,l).then(async()=>{l._name&&(i.add(l._name),await Promise.all(s.map(async([h,f])=>{h.has(l._name)&&(h.delete(l._name),h.size===0&&(o++,await a(f)))})))}).catch(h=>{if(!l.parallel&&!t.payload.error)throw h;n||=h});l.parallel?r.push(c):await c}}for(const l of e)Ok(t,l);for(const l of e)await a(l);if(await Promise.all(r),o)for(let l=0;l<o;l++)await Promise.all(r);if(n)throw t.payload.error||n}function Ws(t){if(typeof t=="function")return t;const e=t._name||t.name;return delete t.name,Object.assign(t.setup||(()=>{}),t,{[Uk]:!0,_name:e})}function Dy(t,e,i){const s=()=>e();return H_(t._id).set(t),t.vueApp.runWithContext(s)}function Nk(t){let e;return Xg()&&(e=hi()?.appContext.app.$nuxt),e||=H_(t).tryUse(),e||null}function xt(t){const e=Nk(t);if(!e)throw new Error("[nuxt] instance unavailable");return e}function po(t){return xt().$config}function Wo(t,e,i){Object.defineProperty(t,e,{get:()=>i})}function Hk(t,e){return{ctx:{table:t},matchAll:i=>W_(i,t)}}function G_(t){const e={};for(const i in t)e[i]=i==="dynamic"?new Map(Object.entries(t[i]).map(([s,r])=>[s,G_(r)])):new Map(Object.entries(t[i]));return e}function Gk(t){return Hk(G_(t))}function W_(t,e,i){t.endsWith("/")&&(t=t.slice(0,-1)||"/");const s=[];for(const[n,o]of Ly(e.wildcard))(t===n||t.startsWith(n+"/"))&&s.push(o);for(const[n,o]of Ly(e.dynamic))if(t.startsWith(n+"/")){const a="/"+t.slice(n.length).split("/").splice(2).join("/");s.push(...W_(a,o))}const r=e.static.get(t);return r&&s.push(r),s.filter(Boolean)}function Ly(t){return[...t.entries()].sort((e,i)=>e[0].length-i[0].length)}function bc(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function Wm(t,e,i=".",s){if(!bc(e))return Wm(t,{},i,s);const r=Object.assign({},e);for(const n in t){if(n==="__proto__"||n==="constructor")continue;const o=t[n];o!=null&&(s&&s(r,n,o,i)||(Array.isArray(o)&&Array.isArray(r[n])?r[n]=[...o,...r[n]]:bc(o)&&bc(r[n])?r[n]=Wm(o,r[n],(i?`${i}.`:"")+n.toString(),s):r[n]=o))}return r}function Wk(t){return(...e)=>e.reduce((i,s)=>Wm(i,s,"",t),{})}const V_=Wk();function Vk(t,e){try{return e in t}catch{return!1}}class Ny extends Error{static __h3_error__=!0;statusCode=500;fatal=!1;unhandled=!1;statusMessage;data;cause;constructor(e,i={}){super(e,i),i.cause&&!this.cause&&(this.cause=i.cause)}toJSON(){const e={message:this.message,statusCode:Vm(this.statusCode,500)};return this.statusMessage&&(e.statusMessage=$_(this.statusMessage)),this.data!==void 0&&(e.data=this.data),e}}function $k(t){if(typeof t=="string")return new Ny(t);if(qk(t))return t;const e=new Ny(t.message??t.statusMessage??"",{cause:t.cause||t});if(Vk(t,"stack"))try{Object.defineProperty(e,"stack",{get(){return t.stack}})}catch{try{e.stack=t.stack}catch{}}if(t.data&&(e.data=t.data),t.statusCode?e.statusCode=Vm(t.statusCode,e.statusCode):t.status&&(e.statusCode=Vm(t.status,e.statusCode)),t.statusMessage?e.statusMessage=t.statusMessage:t.statusText&&(e.statusMessage=t.statusText),e.statusMessage){const i=e.statusMessage;$_(e.statusMessage)!==i&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return t.fatal!==void 0&&(e.fatal=t.fatal),t.unhandled!==void 0&&(e.unhandled=t.unhandled),e}function qk(t){return t?.constructor?.__h3_error__===!0}const Yk=/[^\u0009\u0020-\u007E]/g;function $_(t=""){return t.replace(Yk,"")}function Vm(t,e=200){return!t||(typeof t=="string"&&(t=Number.parseInt(t,10)),t<100||t>999)?e:t}const q_=Symbol("route");import.meta.url.replace(/\/app\/.*$/,"/");const pr=()=>xt()?.$router,Y_=()=>Xg()?Rs(q_,xt()._route):xt()._route;const Xk=()=>{try{if(xt()._processingMiddleware)return!0}catch{return!1}return!1},jk=(t,e)=>{t||="/";const i=typeof t=="string"?t:"path"in t?Kk(t):pr().resolve(t).href;if(e?.open){const{target:l="_blank",windowFeatures:u={}}=e.open,c=[];for(const[h,f]of Object.entries(u))f!==void 0&&c.push(`${h.toLowerCase()}=${f}`);return open(i,l,c.join(", ")),Promise.resolve()}const s=cn(i,{acceptRelative:!0}),r=e?.external||s;if(r){if(!e?.external)throw new Error("Navigating to an external URL is not allowed by default. Use `navigateTo(url, { external: true })`.");const{protocol:l}=new URL(i,window.location.href);if(l&&J3(l))throw new Error(`Cannot navigate to a URL with '${l}' protocol.`)}const n=Xk();if(!r&&n){if(e?.replace){if(typeof t=="string"){const{pathname:l,search:u,hash:c}=z_(t);return{path:l,...u&&{query:o0(u)},...c&&{hash:c},replace:!0}}return{...t,replace:!0}}return t}const o=pr(),a=xt();return r?(a._scope.stop(),e?.replace?location.replace(i):location.href=i,n?a.isHydrating?new Promise(()=>{}):!1:Promise.resolve()):e?.replace?o.replace(t):o.push(t)};function Kk(t){return E_(t.path||"",t.query||{})+(t.hash||"")}const X_="__nuxt_error",c0=()=>qg(xt().payload,"error"),Zk=t=>{const e=u0(t);try{const i=c0();xt().hooks.callHook("app:error",e),i.value||=e}catch{throw e}return e},Jk=async(t={})=>{const e=xt(),i=c0();e.callHook("app:error:cleared",t),t.redirect&&await pr().replace(t.redirect),i.value=void 0},Qk=t=>!!t&&typeof t=="object"&&X_ in t,u0=t=>{const e=$k(t);return Object.defineProperty(e,X_,{value:!0,configurable:!1,writable:!1}),e};function eA(t){const e=iA(t),i=new ArrayBuffer(e.length),s=new DataView(i);for(let r=0;r<i.byteLength;r++)s.setUint8(r,e.charCodeAt(r));return i}const tA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function iA(t){t.length%4===0&&(t=t.replace(/==?$/,""));let e="",i=0,s=0;for(let r=0;r<t.length;r++)i<<=6,i|=tA.indexOf(t[r]),s+=6,s===24&&(e+=String.fromCharCode((i&16711680)>>16),e+=String.fromCharCode((i&65280)>>8),e+=String.fromCharCode(i&255),i=s=0);return s===12?(i>>=4,e+=String.fromCharCode(i)):s===18&&(i>>=2,e+=String.fromCharCode((i&65280)>>8),e+=String.fromCharCode(i&255)),e}const sA=-1,rA=-2,nA=-3,oA=-4,aA=-5,lA=-6;function cA(t,e){return uA(JSON.parse(t),e)}function uA(t,e){if(typeof t=="number")return n(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const i=t,s=Array(i.length);let r=null;function n(o,a=!1){if(o===sA)return;if(o===nA)return NaN;if(o===oA)return 1/0;if(o===aA)return-1/0;if(o===lA)return-0;if(a||typeof o!="number")throw new Error("Invalid input");if(o in s)return s[o];const l=i[o];if(!l||typeof l!="object")s[o]=l;else if(Array.isArray(l))if(typeof l[0]=="string"){const u=l[0],c=e&&Object.hasOwn(e,u)?e[u]:void 0;if(c){let h=l[1];if(typeof h!="number"&&(h=i.push(l[1])-1),r??=new Set,r.has(h))throw new Error("Invalid circular reference");return r.add(h),s[o]=c(n(h)),r.delete(h),s[o]}switch(u){case"Date":s[o]=new Date(l[1]);break;case"Set":const h=new Set;s[o]=h;for(let p=1;p<l.length;p+=1)h.add(n(l[p]));break;case"Map":const f=new Map;s[o]=f;for(let p=1;p<l.length;p+=2)f.set(n(l[p]),n(l[p+1]));break;case"RegExp":s[o]=new RegExp(l[1],l[2]);break;case"Object":s[o]=Object(l[1]);break;case"BigInt":s[o]=BigInt(l[1]);break;case"null":const d=Object.create(null);s[o]=d;for(let p=1;p<l.length;p+=2)d[l[p]]=n(l[p+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{if(i[l[1]][0]!=="ArrayBuffer")throw new Error("Invalid data");const p=globalThis[u],m=n(l[1]),g=new p(m);s[o]=l[2]!==void 0?g.subarray(l[2],l[3]):g;break}case"ArrayBuffer":{const p=l[1];if(typeof p!="string")throw new Error("Invalid ArrayBuffer encoding");const m=eA(p);s[o]=m;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":{const p=u.slice(9);s[o]=Temporal[p].from(l[1]);break}case"URL":{const p=new URL(l[1]);s[o]=p;break}case"URLSearchParams":{const p=new URLSearchParams(l[1]);s[o]=p;break}default:throw new Error(`Unknown type ${u}`)}}else{const u=new Array(l.length);s[o]=u;for(let c=0;c<l.length;c+=1){const h=l[c];h!==rA&&(u[c]=n(h))}}else{const u={};s[o]=u;for(const c in l){if(c==="__proto__")throw new Error("Cannot parse an object with a `__proto__` property");const h=l[c];u[c]=n(h)}}return s[o]}return n(0)}const hA=new Set(["link","style","script","noscript"]),dA=new Set(["title","titleTemplate","script","style","noscript"]),Hy=new Set(["base","meta","link","style","script","noscript"]),fA=new Set(["title","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),pA=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),mA=new Set(["key","tagPosition","tagPriority","tagDuplicateStrategy","innerHTML","textContent","processTemplateParams"]),gA=new Set(["templateParams","htmlAttrs","bodyAttrs"]),yA=new Set(["theme-color","google-site-verification","og","article","book","profile","twitter","author"]);function $m(t,e={},i){for(const s in t){const r=t[s],n=i?`${i}:${s}`:s;typeof r=="object"&&r!==null?$m(r,e,n):typeof r=="function"&&(e[n]=r)}return e}const j_=(()=>{if(console.createTask)return console.createTask;const t={run:e=>e()};return()=>t})();function K_(t,e,i,s){for(let r=i;r<t.length;r+=1)try{const n=s?s.run(()=>t[r](...e)):t[r](...e);if(n instanceof Promise)return n.then(()=>K_(t,e,r+1,s))}catch(n){return Promise.reject(n)}}function vA(t,e,i){if(t.length>0)return K_(t,e,0,j_(i))}function xA(t,e,i){if(t.length>0){const s=j_(i);return Promise.all(t.map(r=>s.run(()=>r(...e))))}}function _c(t,e){for(const i of[...t])i(e)}var bA=class{_hooks;_before;_after;_deprecatedHooks;_deprecatedMessages;constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(t,e,i={}){if(!t||typeof e!="function")return()=>{};const s=t;let r;for(;this._deprecatedHooks[t];)r=this._deprecatedHooks[t],t=r.to;if(r&&!i.allowDeprecated){let n=r.message;n||(n=`${s} hook has been deprecated`+(r.to?`, please use ${r.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(n)||(console.warn(n),this._deprecatedMessages.add(n))}if(!e.name)try{Object.defineProperty(e,"name",{get:()=>"_"+t.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[t]=this._hooks[t]||[],this._hooks[t].push(e),()=>{e&&(this.removeHook(t,e),e=void 0)}}hookOnce(t,e){let i,s=(...r)=>(typeof i=="function"&&i(),i=void 0,s=void 0,e(...r));return i=this.hook(t,s),i}removeHook(t,e){const i=this._hooks[t];if(i){const s=i.indexOf(e);s!==-1&&i.splice(s,1),i.length===0&&(this._hooks[t]=void 0)}}deprecateHook(t,e){this._deprecatedHooks[t]=typeof e=="string"?{to:e}:e;const i=this._hooks[t]||[];this._hooks[t]=void 0;for(const s of i)this.hook(t,s)}deprecateHooks(t){for(const e in t)this.deprecateHook(e,t[e])}addHooks(t){const e=$m(t),i=Object.keys(e).map(s=>this.hook(s,e[s]));return()=>{for(const s of i)s();i.length=0}}removeHooks(t){const e=$m(t);for(const i in e)this.removeHook(i,e[i])}removeAllHooks(){this._hooks={}}callHook(t,...e){return this.callHookWith(vA,t,e)}callHookParallel(t,...e){return this.callHookWith(xA,t,e)}callHookWith(t,e,i){const s=this._before||this._after?{name:e,args:i,context:{}}:void 0;this._before&&_c(this._before,s);const r=t(this._hooks[e]?[...this._hooks[e]]:[],i,e);return r instanceof Promise?r.finally(()=>{this._after&&s&&_c(this._after,s)}):(this._after&&s&&_c(this._after,s),r)}beforeEach(t){return this._before=this._before||[],this._before.push(t),()=>{if(this._before!==void 0){const e=this._before.indexOf(t);e!==-1&&this._before.splice(e,1)}}}afterEach(t){return this._after=this._after||[],this._after.push(t),()=>{if(this._after!==void 0){const e=this._after.indexOf(t);e!==-1&&this._after.splice(e,1)}}}};function _A(){return new bA}const wA=["name","property","http-equiv"],SA=new Set(["viewport","description","keywords","robots"]);function Z_(t){const e=t.split(":");return e.length?yA.has(e[1]):!1}function qm(t){const{props:e,tag:i}=t;if(pA.has(i))return i;if(i==="link"&&e.rel==="canonical")return"canonical";if(e.charset)return"charset";if(t.tag==="meta"){for(const s of wA)if(e[s]!==void 0){const r=e[s],n=r&&typeof r=="string"&&r.includes(":"),o=r&&SA.has(r),l=!(n||o)&&t.key?`:key:${t.key}`:"";return`${i}:${r}${l}`}}if(t.key)return`${i}:key:${t.key}`;if(e.id)return`${i}:id:${e.id}`;if(dA.has(i)){const s=t.textContent||t.innerHTML;if(s)return`${i}:content:${s}`}}function Gy(t){const e=t._h||t._d;if(e)return e;const i=t.textContent||t.innerHTML;return i||`${t.tag}:${Object.entries(t.props).map(([s,r])=>`${s}:${String(r)}`).join(",")}`}function ol(t,e,i){typeof t==="function"&&(!i||i!=="titleTemplate"&&!(i[0]==="o"&&i[1]==="n"))&&(t=t());const r=e?e(i,t):t;if(Array.isArray(r))return r.map(n=>ol(n,e));if(r?.constructor===Object){const n={};for(const o of Object.keys(r))n[o]=ol(r[o],e,o);return n}return r}function CA(t,e){const i=t==="style"?new Map:new Set;function s(r){if(r==null||r===void 0)return;const n=String(r).trim();if(n)if(t==="style"){const[o,...a]=n.split(":").map(l=>l?l.trim():"");o&&a.length&&i.set(o,a.join(":"))}else n.split(" ").filter(Boolean).forEach(o=>i.add(o))}return typeof e=="string"?t==="style"?e.split(";").forEach(s):s(e):Array.isArray(e)?e.forEach(r=>s(r)):e&&typeof e=="object"&&Object.entries(e).forEach(([r,n])=>{n&&n!=="false"&&(t==="style"?i.set(String(r).trim(),String(n)):s(r))}),i}function J_(t,e){return t.props=t.props||{},e?t.tag==="templateParams"?(t.props=e,t):(Object.entries(e).forEach(([i,s])=>{if(s===null){t.props[i]=null;return}if(i==="class"||i==="style"){t.props[i]=CA(i,s);return}if(mA.has(i)){if(["textContent","innerHTML"].includes(i)&&typeof s=="object"){let a=e.type;if(e.type||(a="application/json"),!a?.endsWith("json")&&a!=="speculationrules")return;e.type=a,t.props.type=a,t[i]=JSON.stringify(s)}else t[i]=s;return}const r=String(s),n=i.startsWith("data-"),o=t.tag==="meta"&&i==="content";r==="true"||r===""?t.props[i]=n||o?r:!0:!s&&n&&r==="false"?t.props[i]="false":s!==void 0&&(t.props[i]=s)}),t):t}function TA(t,e){const i=typeof e=="object"&&typeof e!="function"?e:{[t==="script"||t==="noscript"||t==="style"?"innerHTML":"textContent"]:e},s=J_({tag:t,props:{}},i);return s.key&&hA.has(s.tag)&&(s.props["data-hid"]=s._h=s.key),s.tag==="script"&&typeof s.innerHTML=="object"&&(s.innerHTML=JSON.stringify(s.innerHTML),s.props.type=s.props.type||"application/json"),Array.isArray(s.props.content)?s.props.content.map(r=>({...s,props:{...s.props,content:r}})):s}function kA(t,e){if(!t)return[];typeof t=="function"&&(t=t());const i=(r,n)=>{for(let o=0;o<e.length;o++)n=e[o](r,n);return n};t=i(void 0,t);const s=[];return t=ol(t,i),Object.entries(t||{}).forEach(([r,n])=>{if(n!==void 0)for(const o of Array.isArray(n)?n:[n])s.push(TA(r,o))}),s.flat()}const Wy=(t,e)=>t._w===e._w?t._p-e._p:t._w-e._w,Vy={base:-10,title:10},AA={critical:-8,high:-1,low:2},$y={meta:{"content-security-policy":-30,charset:-20,viewport:-15},link:{preconnect:20,stylesheet:60,preload:70,modulepreload:70,prefetch:90,"dns-prefetch":90,prerender:90},script:{async:30,defer:80,sync:50},style:{imported:40,sync:60}},IA=/@import/,xn=t=>t===""||t===!0;function PA(t,e){if(typeof e.tagPriority=="number")return e.tagPriority;let i=100;const s=AA[e.tagPriority]||0,r=t.resolvedOptions.disableCapoSorting?{link:{},script:{},style:{}}:$y;if(e.tag in Vy)i=Vy[e.tag];else if(e.tag==="meta"){const n=e.props["http-equiv"]==="content-security-policy"?"content-security-policy":e.props.charset?"charset":e.props.name==="viewport"?"viewport":null;n&&(i=$y.meta[n])}else if(e.tag==="link"&&e.props.rel)i=r.link[e.props.rel];else if(e.tag==="script"){const n=String(e.props.type);xn(e.props.async)?i=r.script.async:e.props.src&&!xn(e.props.defer)&&!xn(e.props.async)&&n!=="module"&&!n.endsWith("json")||e.innerHTML&&!n.endsWith("json")?i=r.script.sync:(xn(e.props.defer)&&e.props.src&&!xn(e.props.async)||n==="module")&&(i=r.script.defer)}else e.tag==="style"&&(i=e.innerHTML&&IA.test(e.innerHTML)?r.style.imported:r.style.sync);return(i||100)+s}function qy(t,e){const i=typeof e=="function"?e(t):e,s=i.key||String(t.plugins.size+1);t.plugins.get(s)||(t.plugins.set(s,i),t.hooks.addHooks(i.hooks||{}))}function EA(t={}){const e=_A();e.addHooks(t.hooks||{});const i=!t.document,s=new Map,r=new Map,n=new Set,o={_entryCount:1,plugins:r,dirty:!1,resolvedOptions:t,hooks:e,ssr:i,entries:s,headEntries(){return[...s.values()]},use:a=>qy(o,a),push(a,l){const u={...l||{}};delete u.head;const c=u._index??o._entryCount++,h={_i:c,input:a,options:u},f={_poll(d=!1){o.dirty=!0,!d&&n.add(c),e.callHook("entries:updated",o)},dispose(){s.delete(c)&&o.invalidate()},patch(d){(!u.mode||u.mode==="server"&&i||u.mode==="client"&&!i)&&(h.input=d,s.set(c,h),f._poll())}};return f.patch(a),f},async resolveTags(){const a={tagMap:new Map,tags:[],entries:[...o.entries.values()]};for(await e.callHook("entries:resolve",a);n.size;){const f=n.values().next().value;n.delete(f);const d=s.get(f);if(d){const p={tags:kA(d.input,t.propResolvers||[]).map(m=>Object.assign(m,d.options)),entry:d};await e.callHook("entries:normalize",p),d._tags=p.tags.map((m,g)=>(m._w=PA(o,m),m._p=(d._i<<10)+g,m._d=qm(m),m))}}let l=!1;a.entries.flatMap(f=>(f._tags||[]).map(d=>({...d,props:{...d.props}}))).sort(Wy).reduce((f,d)=>{const p=String(d._d||d._p);if(!f.has(p))return f.set(p,d);const m=f.get(p);if((d?.tagDuplicateStrategy||(gA.has(d.tag)?"merge":null)||(d.key&&d.key===m.key?"merge":null))==="merge"){const y={...m.props};Object.entries(d.props).forEach(([b,v])=>y[b]=b==="style"?new Map([...m.props.style||new Map,...v]):b==="class"?new Set([...m.props.class||new Set,...v]):v),f.set(p,{...d,props:y})}else d._p>>10===m._p>>10&&d.tag==="meta"&&Z_(p)?(f.set(p,Object.assign([...Array.isArray(m)?m:[m],d],d)),l=!0):(d._w===m._w?d._p>m._p:d?._w<m?._w)&&f.set(p,d);return f},a.tagMap);const u=a.tagMap.get("title"),c=a.tagMap.get("titleTemplate");if(o._title=u?.textContent,c){const f=c?.textContent;if(o._titleTemplate=f,f){let d=typeof f=="function"?f(u?.textContent):f;typeof d=="string"&&!o.plugins.has("template-params")&&(d=d.replace("%s",u?.textContent||"")),u?d===null?a.tagMap.delete("title"):a.tagMap.set("title",{...u,textContent:d}):(c.tag="title",c.textContent=d)}}a.tags=Array.from(a.tagMap.values()),l&&(a.tags=a.tags.flat().sort(Wy)),await e.callHook("tags:beforeResolve",a),await e.callHook("tags:resolve",a),await e.callHook("tags:afterResolve",a);const h=[];for(const f of a.tags){const{innerHTML:d,tag:p,props:m}=f;if(fA.has(p)&&!(Object.keys(m).length===0&&!f.innerHTML&&!f.textContent)&&!(p==="meta"&&!m.content&&!m["http-equiv"]&&!m.charset)){if(p==="script"&&d){if(String(m.type).endsWith("json")){const g=typeof d=="string"?d:JSON.stringify(d);f.innerHTML=g.replace(/</g,"\\u003C")}else typeof d=="string"&&(f.innerHTML=d.replace(new RegExp(`</${p}`,"g"),`<\\/${p}`));f._d=qm(f)}h.push(f)}}return h},invalidate(){for(const a of s.values())n.add(a._i);o.dirty=!0,e.callHook("entries:updated",o)}};return(t?.plugins||[]).forEach(a=>qy(o,a)),o.hooks.callHook("init",o),t.init?.forEach(a=>a&&o.push(a)),o}const MA=(t,e)=>je(e)?Ft(e):e,Q_="usehead";function FA(t){return{install(i){i.config.globalProperties.$unhead=t,i.config.globalProperties.$head=t,i.provide(Q_,t)}}.install}function RA(){if(Xg()){const t=Rs(Q_);if(!t)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return t}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}function R7(t,e={}){const i=e.head||RA();return i.ssr?i.push(t||{},e):zA(i,t,e)}function zA(t,e,i={}){const s=K(!1);let r;return Tt(()=>{const o=s.value?{}:ol(e,MA);r?r.patch(o):r=t.push(o,i)}),hi()&&(Jg(()=>{r.dispose()}),qb(()=>{s.value=!0}),$b(()=>{s.value=!1})),r}let Ca,Ta;function UA(){return Ca=$fetch(l0(`builds/meta/${po().app.buildId}.json`),{responseType:"json"}),Ca.then(t=>{Ta=Gk(t.matcher)}).catch(t=>{console.error("[nuxt] Error fetching app manifest.",t)}),Ca}function Ll(){return Ca||UA()}async function h0(t){const e=typeof t=="string"?t:t.path;if(await Ll(),!Ta)return console.error("[nuxt] Error creating app manifest matcher.",Ta),{};try{return V_({},...Ta.matchAll(e).reverse())}catch(i){return console.error("[nuxt] Error matching route rules.",i),{}}}async function Yy(t,e={}){if(!await t1(t))return null;const s=await OA(t,e);return await e1(s)||null}const BA="_payload.json";async function OA(t,e={}){const i=new URL(t,"http://localhost");if(i.host!=="localhost"||cn(i.pathname,{acceptRelative:!0}))throw new Error("Payload URL must not include hostname: "+t);const s=po(),r=e.hash||(e.fresh?Date.now():s.app.buildId),n=s.app.cdnURL,o=n&&await t1(t)?n:s.app.baseURL;return Dl(o,i.pathname,BA+(r?`?${r}`:""))}async function e1(t){const e=fetch(t,{cache:"force-cache"}).then(i=>i.text().then(i1));try{return await e}catch(i){console.warn("[nuxt] Cannot load payload ",t,i)}return null}async function t1(t=Y_().path){const e=xt();return t=t==="/"?t:t.replace(/\/$/,""),(await Ll()).prerendered.includes(t)?!0:e.runWithContext(async()=>{const s=await h0({path:t});return!!s.prerender&&!s.redirect})}let Xs=null;async function DA(){if(Xs)return Xs;const t=document.getElementById("__NUXT_DATA__");if(!t)return{};const e=await i1(t.textContent||""),i=t.dataset.src?await e1(t.dataset.src):void 0;return Xs={...e,...i,...window.__NUXT__},Xs.config?.public&&(Xs.config.public=ci(Xs.config.public)),Xs}async function i1(t){return await cA(t,xt()._payloadRevivers)}function LA(t,e){xt()._payloadRevivers[t]=e}const NA=[["NuxtError",t=>u0(t)],["EmptyShallowRef",t=>uo(t==="_"?void 0:t==="0n"?BigInt(0):il(t))],["EmptyRef",t=>K(t==="_"?void 0:t==="0n"?BigInt(0):il(t))],["ShallowRef",t=>uo(t)],["ShallowReactive",t=>Dr(t)],["Ref",t=>K(t)],["Reactive",t=>ci(t)]],HA=Ws({name:"nuxt:revive-payload:client",order:-30,async setup(t){let e,i;for(const[s,r]of NA)LA(s,r);Object.assign(t.payload,([e,i]=L_(()=>t.runWithContext(DA)),e=await e,i(),e)),delete window.__NUXT__}});async function d0(t,e={}){const i=e.document||t.resolvedOptions.document;if(!i||!t.dirty)return;const s={shouldRender:!0,tags:[]};if(await t.hooks.callHook("dom:beforeRender",s),!!s.shouldRender)return t._domUpdatePromise||(t._domUpdatePromise=new Promise(async r=>{const n=new Map,o=new Promise(d=>{t.resolveTags().then(p=>{d(p.map(m=>{const g=n.get(m._d)||0,y={tag:m,id:(g?`${m._d}:${g}`:m._d)||Gy(m),shouldRender:!0};return m._d&&Z_(m._d)&&n.set(m._d,g+1),y}))})});let a=t._dom;if(!a){a={title:i.title,elMap:new Map().set("htmlAttrs",i.documentElement).set("bodyAttrs",i.body)};for(const d of["body","head"]){const p=i[d]?.children;for(const m of p){const g=m.tagName.toLowerCase();if(!Hy.has(g))continue;const y=J_({tag:g,props:{}},{innerHTML:m.innerHTML,...m.getAttributeNames().reduce((b,v)=>(b[v]=m.getAttribute(v),b),{})||{}});if(y.key=m.getAttribute("data-hid")||void 0,y._d=qm(y)||Gy(y),a.elMap.has(y._d)){let b=1,v=y._d;for(;a.elMap.has(v);)v=`${y._d}:${b++}`;a.elMap.set(v,m)}else a.elMap.set(y._d,m)}}}a.pendingSideEffects={...a.sideEffects},a.sideEffects={};function l(d,p,m){const g=`${d}:${p}`;a.sideEffects[g]=m,delete a.pendingSideEffects[g]}function u({id:d,$el:p,tag:m}){const g=m.tag.endsWith("Attrs");a.elMap.set(d,p),g||(m.textContent&&m.textContent!==p.textContent&&(p.textContent=m.textContent),m.innerHTML&&m.innerHTML!==p.innerHTML&&(p.innerHTML=m.innerHTML),l(d,"el",()=>{p?.remove(),a.elMap.delete(d)}));for(const y in m.props){if(!Object.prototype.hasOwnProperty.call(m.props,y))continue;const b=m.props[y];if(y.startsWith("on")&&typeof b=="function"){const x=p?.dataset;if(x&&x[`${y}fired`]){const _=y.slice(0,-5);b.call(p,new Event(_.substring(2)))}p.getAttribute(`data-${y}`)!==""&&((m.tag==="bodyAttrs"?i.defaultView:p).addEventListener(y.substring(2),b.bind(p)),p.setAttribute(`data-${y}`,""));continue}const v=`attr:${y}`;if(y==="class"){if(!b)continue;for(const x of b)g&&l(d,`${v}:${x}`,()=>p.classList.remove(x)),!p.classList.contains(x)&&p.classList.add(x)}else if(y==="style"){if(!b)continue;for(const[x,_]of b)l(d,`${v}:${x}`,()=>{p.style.removeProperty(x)}),p.style.setProperty(x,_)}else b!==!1&&b!==null&&(p.getAttribute(y)!==b&&p.setAttribute(y,b===!0?"":String(b)),g&&l(d,v,()=>p.removeAttribute(y)))}}const c=[],h={bodyClose:void 0,bodyOpen:void 0,head:void 0},f=await o;for(const d of f){const{tag:p,shouldRender:m,id:g}=d;if(m){if(p.tag==="title"){i.title=p.textContent,l("title","",()=>i.title=a.title);continue}d.$el=d.$el||a.elMap.get(g),d.$el?u(d):Hy.has(p.tag)&&c.push(d)}}for(const d of c){const p=d.tag.tagPosition||"head";d.$el=i.createElement(d.tag.tag),u(d),h[p]=h[p]||i.createDocumentFragment(),h[p].appendChild(d.$el)}for(const d of f)await t.hooks.callHook("dom:renderTag",d,i,l);h.head&&i.head.appendChild(h.head),h.bodyOpen&&i.body.insertBefore(h.bodyOpen,i.body.firstChild),h.bodyClose&&i.body.appendChild(h.bodyClose);for(const d in a.pendingSideEffects)a.pendingSideEffects[d]();t._dom=a,await t.hooks.callHook("dom:rendered",{renders:f}),r()}).finally(()=>{t._domUpdatePromise=void 0,t.dirty=!1})),t._domUpdatePromise}function GA(t={}){const e=t.domOptions?.render||d0;t.document=t.document||(typeof window<"u"?document:void 0);const i=t.document?.head.querySelector('script[id="unhead:payload"]')?.innerHTML||!1;return EA({...t,plugins:[...t.plugins||[],{key:"client",hooks:{"entries:updated":e}}],init:[i?JSON.parse(i):!1,...t.init||[]]})}function WA(t,e){let i=0;return()=>{const s=++i;e(()=>{i===s&&t()})}}function VA(t={}){const e=GA({domOptions:{render:WA(()=>d0(e),i=>setTimeout(i,0))},...t});return e.install=FA(e),e}const $A={disableDefaults:!0},qA=Ws({name:"nuxt:head",enforce:"pre",setup(t){const e=VA($A);t.vueApp.use(e);{let i=!0;const s=async()=>{i=!1,await d0(e)};e.hooks.hook("dom:beforeRender",r=>{r.shouldRender=!i}),t.hooks.hook("page:start",()=>{i=!0}),t.hooks.hook("page:finish",()=>{t.isHydrating||s()}),t.hooks.hook("app:error",s),t.hooks.hook("app:suspense:resolve",s)}}}),YA=async t=>{let e,i;const s=([e,i]=L_(()=>h0({path:t.path})),e=await e,i(),e);if(s.redirect){const r=s.redirect.includes("#")?s.redirect:s.redirect+t.hash;return cn(r,{acceptRelative:!0})?(window.location.href=r,!1):r}},XA=[YA];function wc(t){const e=t&&typeof t=="object"?t:{};typeof t=="object"&&(t=U_({pathname:t.path||"",search:I_(t.query||{}),hash:t.hash||""}));const i=new URL(t.toString(),window.location.href);return{path:i.pathname,fullPath:t,query:o0(i.search),hash:i.hash,params:e.params||{},name:void 0,matched:e.matched||[],redirectedFrom:void 0,meta:e.meta||{},href:t}}const jA=Ws({name:"nuxt:router",enforce:"pre",setup(t){const e=tk(window.location.pathname,po().app.baseURL)+window.location.search+window.location.hash,i=[],s={"navigate:before":[],"resolve:before":[],"navigate:after":[],error:[]},r=(h,f)=>(s[h].push(f),()=>s[h].splice(s[h].indexOf(f),1)),n=po().app.baseURL,o=ci(wc(e));async function a(h,f){try{const d=wc(h);for(const p of s["navigate:before"]){const m=await p(d,o);if(m===!1||m instanceof Error)return;if(typeof m=="string"&&m.length)return a(m,!0)}for(const p of s["resolve:before"])await p(d,o);Object.assign(o,d),window.history[f?"replaceState":"pushState"]({},"",Dl(n,d.fullPath)),t.isHydrating||await t.runWithContext(Jk);for(const p of s["navigate:after"])await p(d,o)}catch(d){for(const p of s.error)await p(d)}}const u={currentRoute:me(()=>o),isReady:()=>Promise.resolve(),options:{},install:()=>Promise.resolve(),push:h=>a(h,!1),replace:h=>a(h,!0),back:()=>window.history.go(-1),go:h=>window.history.go(h),forward:()=>window.history.go(1),beforeResolve:h=>r("resolve:before",h),beforeEach:h=>r("navigate:before",h),afterEach:h=>r("navigate:after",h),onError:h=>r("error",h),resolve:wc,addRoute:(h,f)=>{i.push(f)},getRoutes:()=>i,hasRoute:h=>i.some(f=>f.name===h),removeRoute:h=>{const f=i.findIndex(d=>d.name===h);f!==-1&&i.splice(f,1)}};t.vueApp.component("RouterLink",be({functional:!0,props:{to:{type:String,required:!0},custom:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:String},setup:(h,{slots:f})=>{const d=()=>a(h.to,h.replace);return()=>{const p=u.resolve(h.to);return h.custom?f.default?.({href:h.to,navigate:d,route:p}):Oe("a",{href:h.to,onClick:m=>(m.preventDefault(),d())},f)}}})),window.addEventListener("popstate",h=>{const f=h.target.location;u.replace(f.href.replace(f.origin,""))}),t._route=o,t._middleware||={global:[],named:{}};const c=t.payload.state._layout;return t.hooks.hookOnce("app:created",async()=>{u.beforeEach(async(h,f)=>{h.meta=ci(h.meta||{}),t.isHydrating&&c&&!ss(h.meta.layout)&&(h.meta.layout=c),t._processingMiddleware=!0;{const d=new Set([...XA,...t._middleware.global]);{const p=await t.runWithContext(()=>h0({path:h.path}));if(p.appMiddleware)for(const m in p.appMiddleware){const g=t._middleware.named[m];if(!g)return;p.appMiddleware[m]?d.add(g):d.delete(g)}}for(const p of d){const m=await t.runWithContext(()=>p(h,f));if(m!==!0&&(m||m===!1))return m}}}),u.afterEach(()=>{delete t._processingMiddleware}),await u.replace(e),sk(o.fullPath,e)||await t.runWithContext(()=>jk(o.fullPath))}),{provide:{route:o,router:u}}}}),Xy=globalThis.requestIdleCallback||(t=>{const e=Date.now(),i={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-e))};return setTimeout(()=>{t(i)},1)}),z7=globalThis.cancelIdleCallback||(t=>{clearTimeout(t)}),f0=t=>{const e=xt();e.isHydrating?e.hooks.hookOnce("app:suspense:resolve",()=>{Xy(()=>t())}):Xy(()=>t())},KA=Ws({name:"nuxt:payload",setup(t){const e=new Set;pr().beforeResolve(async(i,s)=>{if(i.path===s.path)return;const r=await Yy(i.path);if(r){for(const n of e)delete t.static.data[n];for(const n in r.data)n in t.static.data||e.add(n),t.static.data[n]=r.data[n]}}),f0(()=>{t.hooks.hook("link:prefetch",async i=>{const{hostname:s}=new URL(i,window.location.href);s===window.location.hostname&&await Yy(i).catch(()=>{console.warn("[nuxt] Error preloading payload for",i)})}),navigator.connection?.effectiveType!=="slow-2g"&&setTimeout(Ll,1e3)})}}),ZA=Ws(()=>{const t=pr();f0(()=>{t.beforeResolve(async()=>{await new Promise(e=>{setTimeout(e,100),requestAnimationFrame(()=>{setTimeout(e,0)})})})})}),JA=Ws(t=>{let e;async function i(){let s;try{s=await Ll()}catch(r){const n=r;if(!("status"in n&&(n.status===404||n.status===403)))throw n}e&&clearTimeout(e),e=setTimeout(i,Oy);try{const r=await $fetch(l0("builds/latest.json")+`?${Date.now()}`);r.id!==s?.id&&(t.hooks.callHook("app:manifest:update",r),e&&clearTimeout(e))}catch{}}f0(()=>{e=setTimeout(i,Oy)})});function QA(t={}){const e=t.path||window.location.pathname;let i={};try{i=il(sessionStorage.getItem("nuxt:reload")||"{}")}catch{}if(t.force||i?.path!==e||i?.expires<Date.now()){try{sessionStorage.setItem("nuxt:reload",JSON.stringify({path:e,expires:Date.now()+(t.ttl??1e4)}))}catch{}if(t.persistState)try{sessionStorage.setItem("nuxt:reload:state",JSON.stringify({state:xt().payload.state}))}catch{}window.location.pathname!==e?window.location.href=e:window.location.reload()}}const eI=Ws({name:"nuxt:chunk-reload",setup(t){const e=pr(),i=po(),s=new Set;e.beforeEach(()=>{s.clear()}),t.hook("app:chunkError",({error:n})=>{s.add(n)});function r(n){const o=Dl(i.app.baseURL,n.fullPath);QA({path:o,persistState:!0})}t.hook("app:manifest:update",()=>{e.beforeResolve(r)}),e.onError((n,o)=>{s.has(n)&&r(o)})}}),tI=Ws({name:"nuxt:global-components"}),iI=[HA,qA,jA,KA,ZA,JA,eI,tI];function sI(t,e){var i;const s=uo();return Tt(()=>{s.value=t()},{...e,flush:(i=e?.flush)!==null&&i!==void 0?i:"sync"}),qa(s)}function s1(t,e){return Il()?(mb(t,e),!0):!1}function rI(t){let e=!1,i;const s=Hg(!0);return((...r)=>(e||(i=s.run(()=>t(...r)),e=!0),i))}const Vs=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const nI=t=>typeof t<"u",oI=Object.prototype.toString,aI=t=>oI.call(t)==="[object Object]";function Sc(t){return Array.isArray(t)?t:[t]}function lI(t){return hi()}function r1(t){if(!Vs)return t;let e=0,i,s;const r=()=>{e-=1,s&&e<=0&&(s.stop(),i=void 0,s=void 0)};return((...n)=>(e+=1,s||(s=Hg(!0),i=s.run(()=>t(...n))),s1(r),i))}function cI(t){return ci(je(t)?new Proxy({},{get(e,i,s){return M(Reflect.get(t.value,i,s))},set(e,i,s){return je(t.value[i])&&!je(s)?t.value[i].value=s:t.value[i]=s,!0},deleteProperty(e,i){return Reflect.deleteProperty(t.value,i)},has(e,i){return Reflect.has(t.value,i)},ownKeys(){return Object.keys(t.value)},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}}}):t)}function uI(t){return cI(me(t))}function Nl(t,...e){const i=e.flat(),s=i[0];return uI(()=>Object.fromEntries(typeof s=="function"?Object.entries(Hi(t)).filter(([r,n])=>!s(Ft(n),r)):Object.entries(Hi(t)).filter(r=>!i.includes(r[0]))))}function hI(t,e=1e4){return BC((i,s)=>{let r=Ft(t),n;const o=()=>setTimeout(()=>{r=Ft(t),s()},Ft(e));return s1(()=>{clearTimeout(n)}),{get(){return i(),r},set(a){r=a,s(),clearTimeout(n),n=o()}}})}function dI(t,e){lI()&&Jg(t,e)}function fI(t,e,i){return lt(t,e,{...i,immediate:!0})}const p0=Vs?window:void 0;function un(t){var e;const i=Ft(t);return(e=i?.$el)!==null&&e!==void 0?e:i}function Ym(...t){const e=(s,r,n,o)=>(s.addEventListener(r,n,o),()=>s.removeEventListener(r,n,o)),i=me(()=>{const s=Sc(Ft(t[0])).filter(r=>r!=null);return s.every(r=>typeof r!="string")?s:void 0});return fI(()=>{var s,r;return[(s=(r=i.value)===null||r===void 0?void 0:r.map(n=>un(n)))!==null&&s!==void 0?s:[p0].filter(n=>n!=null),Sc(Ft(i.value?t[1]:t[0])),Sc(M(i.value?t[2]:t[1])),Ft(i.value?t[3]:t[2])]},([s,r,n,o],a,l)=>{if(!s?.length||!r?.length||!n?.length)return;const u=aI(o)?{...o}:o,c=s.flatMap(h=>r.flatMap(f=>n.map(d=>e(h,f,d,u))));l(()=>{c.forEach(h=>h())})},{flush:"post"})}function pI(){const t=uo(!1),e=hi();return e&&br(()=>{t.value=!0},e),t}function mI(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function gI(...t){let e,i,s={};t.length===3?(e=t[0],i=t[1],s=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,i=t[0],s=t[1]):(e=t[0],i=t[1]):(e=!0,i=t[0]);const{target:r=p0,eventName:n="keydown",passive:o=!1,dedupe:a=!1}=s,l=mI(e);return Ym(r,n,c=>{c.repeat&&Ft(a)||l(c)&&i(c)},o)}function yI(t){return JSON.parse(JSON.stringify(t))}function m0(t,e,i,s={}){var r,n;const{clone:o=!1,passive:a=!1,eventName:l,deep:u=!1,defaultValue:c,shouldEmit:h}=s,f=hi(),d=i||f?.emit||(f==null||(r=f.$emit)===null||r===void 0?void 0:r.bind(f))||(f==null||(n=f.proxy)===null||n===void 0||(n=n.$emit)===null||n===void 0?void 0:n.bind(f?.proxy));let p=l;e||(e="modelValue"),p=p||`update:${e.toString()}`;const m=b=>o?typeof o=="function"?o(b):yI(b):b,g=()=>nI(t[e])?m(t[e]):c,y=b=>{h?h(b)&&d(p,b):d(p,b)};if(a){const b=K(g());let v=!1;return lt(()=>t[e],x=>{v||(v=!0,b.value=m(x),Rt(()=>v=!1))}),lt(b,x=>{!v&&(x!==t[e]||u)&&y(x)},{deep:u}),b}else return me({get(){return g()},set(b){y(b)}})}const vI=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const jy=t=>t==="";const xI=(...t)=>t.filter((e,i,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===i).join(" ").trim();const Ky=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const bI=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,i,s)=>s?s.toUpperCase():i.toLowerCase());const _I=t=>{const e=bI(t);return e.charAt(0).toUpperCase()+e.slice(1)};var bn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const wI=({name:t,iconNode:e,absoluteStrokeWidth:i,"absolute-stroke-width":s,strokeWidth:r,"stroke-width":n,size:o=bn.width,color:a=bn.stroke,...l},{slots:u})=>Oe("svg",{...bn,...l,width:o,height:o,stroke:a,"stroke-width":jy(i)||jy(s)||i===!0||s===!0?Number(r||n||bn["stroke-width"])*24/Number(o):r||n||bn["stroke-width"],class:xI("lucide",l.class,...t?[`lucide-${Ky(_I(t))}-icon`,`lucide-${Ky(t)}`]:["lucide-icon"]),...!u.default&&!vI(l)&&{"aria-hidden":"true"}},[...e.map(c=>Oe(...c)),...u.default?[u.default()]:[]]);const us=(t,e)=>(i,{slots:s,attrs:r})=>Oe(wI,{...r,...i,iconNode:e,name:t},s);const SI=us("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);const CI=us("file-plus",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);const TI=us("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);const kI=us("keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);const AI=us("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const n1=us("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const II=us("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);const o1=us("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const a1=us("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function PI(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const Eo=typeof document<"u";function hs(t,e){const i=typeof t=="string"&&!e?`${t}Context`:e,s=Symbol(i);return[o=>{const a=Rs(s,o);if(a||a===null)return a;throw new Error(`Injection \`${s.toString()}\` not found. Component must be used within ${Array.isArray(t)?`one of the following components: ${t.join(", ")}`:`\`${t}\``}`)},o=>(Rl(s,o),o)]}function oi(){let t=document.activeElement;if(t==null)return null;for(;t!=null&&t.shadowRoot!=null&&t.shadowRoot.activeElement!=null;)t=t.shadowRoot.activeElement;return t}function l1(t,e,i){const s=i.originalEvent.target,r=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:i});e&&s.addEventListener(t,e,{once:!0}),s.dispatchEvent(r)}function EI(t){return t==null}function g0(t){return t?t.flatMap(e=>e.type===pt?g0(e.children):[e]):[]}const MI=["INPUT","TEXTAREA"];function FI(t,e,i,s={}){if(!e||s.enableIgnoredElement&&MI.includes(e.nodeName))return null;const{arrowKeyOptions:r="both",attributeName:n="[data-reka-collection-item]",itemsArray:o=[],loop:a=!0,dir:l="ltr",preventScroll:u=!0,focus:c=!1}=s,[h,f,d,p,m,g]=[t.key==="ArrowRight",t.key==="ArrowLeft",t.key==="ArrowUp",t.key==="ArrowDown",t.key==="Home",t.key==="End"],y=d||p,b=h||f;if(!m&&!g&&(!y&&!b||r==="vertical"&&b||r==="horizontal"&&y))return null;const v=i?Array.from(i.querySelectorAll(n)):o;if(!v.length)return null;u&&t.preventDefault();let x=null;return b||y?x=c1(v,e,{goForward:y?p:l==="ltr"?h:f,loop:a}):m?x=v.at(0)||null:g&&(x=v.at(-1)||null),c&&x?.focus(),x}function c1(t,e,i,s=t.length){if(--s===0)return null;const r=t.indexOf(e),n=i.goForward?r+1:r-1;if(!i.loop&&(n<0||n>=t.length))return null;const o=(n+t.length)%t.length,a=t[o];return a?a.hasAttribute("disabled")&&a.getAttribute("disabled")!=="false"?c1(t,a,i,s):a:null}const[y0]=hs("ConfigProvider"),RI=r1(()=>{const t=K(new Map),e=K(),i=me(()=>{for(const n of t.value.values())if(n)return!0;return!1}),s=y0({scrollBody:K(!0)}),r=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=e.value??"",e.value=void 0};return lt(i,(n,o)=>{if(!Vs)return;if(!n){o&&r();return}e.value===void 0&&(e.value=document.body.style.overflow);const a=window.innerWidth-document.documentElement.clientWidth,l={padding:a,margin:0},u=s.scrollBody?.value?typeof s.scrollBody.value=="object"?V_({padding:s.scrollBody.value.padding===!0?a:s.scrollBody.value.padding,margin:s.scrollBody.value.margin===!0?a:s.scrollBody.value.margin},l):l:{padding:0,margin:0};a>0&&(document.body.style.paddingRight=typeof u.padding=="number"?`${u.padding}px`:String(u.padding),document.body.style.marginRight=typeof u.margin=="number"?`${u.margin}px`:String(u.margin),document.documentElement.style.setProperty("--scrollbar-width",`${a}px`),document.body.style.overflow="hidden"),Rt(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),t});function zI(t){const e=Math.random().toString(36).substring(2,7),i=RI();i.value.set(e,t??!1);const s=me({get:()=>i.value.get(e)??!1,set:r=>i.value.set(e,r)});return dI(()=>{i.value.delete(e)}),s}function Hl(t){const e=y0({dir:K("ltr")});return me(()=>t?.value||e.dir?.value||"ltr")}function u1(t){const e=hi(),i=e?.type.emits,s={};return i?.length||console.warn(`No emitted event found. Please check component: ${e?.type.__name}`),i?.forEach(r=>{s[xa(Ht(r))]=(...n)=>t(r,...n)}),s}let Cc=0;function UI(){Tt(t=>{if(!Vs)return;const e=document.querySelectorAll("[data-reka-focus-guard]");document.body.insertAdjacentElement("afterbegin",e[0]??Zy()),document.body.insertAdjacentElement("beforeend",e[1]??Zy()),Cc++,t(()=>{Cc===1&&document.querySelectorAll("[data-reka-focus-guard]").forEach(i=>i.remove()),Cc--})})}function Zy(){const t=document.createElement("span");return t.setAttribute("data-reka-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}function Ut(){const t=hi(),e=K(),i=me(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:un(e)),s=Object.assign({},t.exposed),r={};for(const o in t.props)Object.defineProperty(r,o,{enumerable:!0,configurable:!0,get:()=>t.props[o]});if(Object.keys(s).length>0)for(const o in s)Object.defineProperty(r,o,{enumerable:!0,configurable:!0,get:()=>s[o]});Object.defineProperty(r,"$el",{enumerable:!0,configurable:!0,get:()=>t.vnode.el}),t.exposed=r;function n(o){if(e.value=o,!!o&&(Object.defineProperty(r,"$el",{enumerable:!0,configurable:!0,get:()=>o instanceof Element?o:o.$el}),!(o instanceof Element)&&!Object.hasOwn(o,"$el"))){const a=o.$.exposed,l=Object.assign({},r);for(const u in a)Object.defineProperty(l,u,{enumerable:!0,configurable:!0,get:()=>a[u]});t.exposed=l}}return{forwardRef:n,currentRef:e,currentElement:i}}function v0(t){const e=hi(),i=Object.keys(e?.type.props??{}).reduce((r,n)=>{const o=(e?.type.props[n]).default;return o!==void 0&&(r[n]=o),r},{}),s=qg(t);return me(()=>{const r={},n=e?.vnode.props??{};return Object.keys(n).forEach(o=>{r[Ht(o)]=n[o]}),Object.keys({...i,...r}).reduce((o,a)=>(s.value[a]!==void 0&&(o[a]=s.value[a]),o),{})})}function ds(t,e){const i=v0(t),s=e?u1(e):{};return me(()=>({...i.value,...s}))}var BI=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},kr=new WeakMap,Vo=new WeakMap,$o={},Tc=0,h1=function(t){return t&&(t.host||h1(t.parentNode))},OI=function(t,e){return e.map(function(i){if(t.contains(i))return i;var s=h1(i);return s&&t.contains(s)?s:(console.error("aria-hidden",i,"in not contained inside",t,". Doing nothing"),null)}).filter(function(i){return!!i})},DI=function(t,e,i,s){var r=OI(e,Array.isArray(t)?t:[t]);$o[i]||($o[i]=new WeakMap);var n=$o[i],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var c=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))c(f);else try{var d=f.getAttribute(s),p=d!==null&&d!=="false",m=(kr.get(f)||0)+1,g=(n.get(f)||0)+1;kr.set(f,m),n.set(f,g),o.push(f),m===1&&p&&Vo.set(f,!0),g===1&&f.setAttribute(i,"true"),p||f.setAttribute(s,"true")}catch(y){console.error("aria-hidden: cannot operate on ",f,y)}})};return c(e),a.clear(),Tc++,function(){o.forEach(function(h){var f=kr.get(h)-1,d=n.get(h)-1;kr.set(h,f),n.set(h,d),f||(Vo.has(h)||h.removeAttribute(s),Vo.delete(h)),d||h.removeAttribute(i)}),Tc--,Tc||(kr=new WeakMap,kr=new WeakMap,Vo=new WeakMap,$o={})}},LI=function(t,e,i){i===void 0&&(i="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=BI(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),DI(s,r,i,"aria-hidden")):function(){return null}};function NI(t){let e;lt(()=>un(t),i=>{i?e=LI(i):e&&e()}),_r(()=>{e&&e()})}function Mo(t,e="reka"){return t||`${e}-${JC?.()}`}function HI(t){const e=K(),i=me(()=>e.value?.width??0),s=me(()=>e.value?.height??0);return br(()=>{const r=un(t);if(r){e.value={width:r.offsetWidth,height:r.offsetHeight};const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const a=o[0];let l,u;if("borderBoxSize"in a){const c=a.borderBoxSize,h=Array.isArray(c)?c[0]:c;l=h.inlineSize,u=h.blockSize}else l=r.offsetWidth,u=r.offsetHeight;e.value={width:l,height:u}});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else e.value=void 0}),{width:i,height:s}}function GI(t,e){const i=K(t);function s(n){return e[i.value][n]??i.value}return{state:i,dispatch:n=>{i.value=s(n)}}}function WI(t){const e=hI("",1e3);return{search:e,handleTypeaheadSearch:(r,n)=>{e.value=e.value+r;{const o=oi(),a=n.map(f=>({...f,textValue:f.value?.textValue??f.ref.textContent?.trim()??""})),l=a.find(f=>f.ref===o),u=a.map(f=>f.textValue),c=$I(u,e.value,l?.textValue),h=a.find(f=>f.textValue===c);return h&&h.ref.focus(),h?.ref}},resetTypeahead:()=>{e.value=""}}}function VI(t,e){return t.map((i,s)=>t[(e+s)%t.length])}function $I(t,e,i){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,n=i?t.indexOf(i):-1;let o=VI(t,Math.max(n,0));r.length===1&&(o=o.filter(u=>u!==i));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==i?l:void 0}function qI(t,e){const i=K({}),s=K("none"),r=K(t),n=t.value?"mounted":"unmounted";let o;const a=e.value?.ownerDocument.defaultView??p0,{state:l,dispatch:u}=GI(n,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),c=g=>{if(Vs){const y=new CustomEvent(g,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(y)}};lt(t,async(g,y)=>{const b=y!==g;if(await Rt(),b){const v=s.value,x=qo(e.value);g?(u("MOUNT"),c("enter"),x==="none"&&c("after-enter")):x==="none"||x==="undefined"||i.value?.display==="none"?(u("UNMOUNT"),c("leave"),c("after-leave")):y&&v!==x?(u("ANIMATION_OUT"),c("leave")):(u("UNMOUNT"),c("after-leave"))}},{immediate:!0});const h=g=>{const y=qo(e.value),b=y.includes(CSS.escape(g.animationName)),v=l.value==="mounted"?"enter":"leave";if(g.target===e.value&&b&&(c(`after-${v}`),u("ANIMATION_END"),!r.value)){const x=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",o=a?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=x)})}g.target===e.value&&y==="none"&&u("ANIMATION_END")},f=g=>{g.target===e.value&&(s.value=qo(e.value))},d=lt(e,(g,y)=>{g?(i.value=getComputedStyle(g),g.addEventListener("animationstart",f),g.addEventListener("animationcancel",h),g.addEventListener("animationend",h)):(u("ANIMATION_END"),o!==void 0&&a?.clearTimeout(o),y?.removeEventListener("animationstart",f),y?.removeEventListener("animationcancel",h),y?.removeEventListener("animationend",h))},{immediate:!0}),p=lt(l,()=>{const g=qo(e.value);s.value=l.value==="mounted"?g:"none"});return _r(()=>{d(),p()}),{isPresent:me(()=>["mounted","unmountSuspended"].includes(l.value))}}function qo(t){return t&&getComputedStyle(t).animationName||"none"}var YI=be({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(t,{slots:e,expose:i}){const{present:s,forceMount:r}=Hi(t),n=K(),{isPresent:o}=qI(s,n);i({present:o});let a=e.default({present:o.value});a=g0(a||[]);const l=hi();if(a&&a?.length>1){const u=l?.parent?.type.name?`<${l.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${u}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(c=>`  - ${c}`).join(`
`)].join(`
`))}return()=>r.value||s.value||o.value?Oe(e.default({present:o.value})[0],{ref:u=>{const c=un(u);return typeof c?.hasAttribute>"u"||(c?.hasAttribute("data-reka-popper-content-wrapper")?n.value=c.firstElementChild:n.value=c),c}}):null}});const Xm=be({name:"PrimitiveSlot",inheritAttrs:!1,setup(t,{attrs:e,slots:i}){return()=>{if(!i.default)return null;const s=g0(i.default()),r=s.findIndex(l=>l.type!==Jt);if(r===-1)return s;const n=s[r];delete n.props?.ref;const o=n.props?vt(e,n.props):e,a=fr({...n,props:{}},o);return s.length===1?a:(s[r]=a,s)}}}),XI=["area","img","input"],Si=be({name:"Primitive",inheritAttrs:!1,props:{asChild:{type:Boolean,default:!1},as:{type:[String,Object],default:"div"}},setup(t,{attrs:e,slots:i}){const s=t.asChild?"template":t.as;return typeof s=="string"&&XI.includes(s)?()=>Oe(s,e):s!=="template"?()=>Oe(t.as,e,{default:i.default}):()=>Oe(Xm,e,{default:i.default})}});function Jy(){const t=K(),e=me(()=>["#text","#comment"].includes(t.value?.$el.nodeName)?t.value?.$el.nextElementSibling:un(t));return{primitiveElement:t,currentElement:e}}const jI="dismissableLayer.pointerDownOutside",KI="dismissableLayer.focusOutside";function d1(t,e){const i=e.closest("[data-dismissable-layer]"),s=t.dataset.dismissableLayer===""?t:t.querySelector("[data-dismissable-layer]"),r=Array.from(t.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(i&&(s===i||r.indexOf(s)<r.indexOf(i)))}function ZI(t,e,i=!0){const s=e?.value?.ownerDocument??globalThis?.document,r=K(!1),n=K(()=>{});return Tt(o=>{if(!Vs||!Ft(i))return;const a=async u=>{const c=u.target;if(!(!e?.value||!c)){if(d1(e.value,c)){r.value=!1;return}if(u.target&&!r.value){let f=function(){l1(jI,t,h)};const h={originalEvent:u};u.pointerType==="touch"?(s.removeEventListener("click",n.value),n.value=f,s.addEventListener("click",n.value,{once:!0})):f()}else s.removeEventListener("click",n.value);r.value=!1}},l=window.setTimeout(()=>{s.addEventListener("pointerdown",a)},0);o(()=>{window.clearTimeout(l),s.removeEventListener("pointerdown",a),s.removeEventListener("click",n.value)})}),{onPointerDownCapture:()=>{Ft(i)&&(r.value=!0)}}}function JI(t,e,i=!0){const s=e?.value?.ownerDocument??globalThis?.document,r=K(!1);return Tt(n=>{if(!Vs||!Ft(i))return;const o=async a=>{if(!e?.value)return;await Rt(),await Rt();const l=a.target;!e.value||!l||d1(e.value,l)||a.target&&!r.value&&l1(KI,t,{originalEvent:a})};s.addEventListener("focusin",o),n(()=>s.removeEventListener("focusin",o))}),{onFocusCapture:()=>{Ft(i)&&(r.value=!0)},onBlurCapture:()=>{Ft(i)&&(r.value=!1)}}}const Qt=ci({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,originalBodyPointerEvents:void 0,branches:new Set});var QI=be({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(t,{emit:e}){const i=t,s=e,{forwardRef:r,currentElement:n}=Ut(),o=me(()=>n.value?.ownerDocument??globalThis.document),a=me(()=>Qt.layersRoot),l=me(()=>n.value?Array.from(a.value).indexOf(n.value):-1),u=me(()=>Qt.layersWithOutsidePointerEventsDisabled.size>0),c=me(()=>{const d=Array.from(a.value),[p]=[...Qt.layersWithOutsidePointerEventsDisabled].slice(-1),m=d.indexOf(p);return l.value>=m}),h=ZI(async d=>{const p=[...Qt.branches].some(m=>m?.contains(d.target));!c.value||p||(s("pointerDownOutside",d),s("interactOutside",d),await Rt(),d.defaultPrevented||s("dismiss"))},n),f=JI(d=>{[...Qt.branches].some(m=>m?.contains(d.target))||(s("focusOutside",d),s("interactOutside",d),d.defaultPrevented||s("dismiss"))},n);return gI("Escape",d=>{l.value===a.value.size-1&&(s("escapeKeyDown",d),d.defaultPrevented||s("dismiss"))}),Tt(d=>{n.value&&(i.disableOutsidePointerEvents&&(Qt.layersWithOutsidePointerEventsDisabled.size===0&&(Qt.originalBodyPointerEvents=o.value.body.style.pointerEvents,o.value.body.style.pointerEvents="none"),Qt.layersWithOutsidePointerEventsDisabled.add(n.value)),a.value.add(n.value),d(()=>{i.disableOutsidePointerEvents&&Qt.layersWithOutsidePointerEventsDisabled.size===1&&!EI(Qt.originalBodyPointerEvents)&&(o.value.body.style.pointerEvents=Qt.originalBodyPointerEvents)}))}),Tt(d=>{d(()=>{n.value&&(a.value.delete(n.value),Qt.layersWithOutsidePointerEventsDisabled.delete(n.value))})}),(d,p)=>(fe(),_e(M(Si),{ref:M(r),"as-child":d.asChild,as:d.as,"data-dismissable-layer":"",style:Gs({pointerEvents:u.value?c.value?"auto":"none":void 0}),onFocusCapture:M(f).onFocusCapture,onBlurCapture:M(f).onBlurCapture,onPointerdownCapture:M(h).onPointerDownCapture},{default:ae(()=>[Re(d.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),eP=QI;const tP=rI(()=>K([]));function iP(){const t=tP();return{add(e){const i=t.value[0];e!==i&&i?.pause(),t.value=Qy(t.value,e),t.value.unshift(e)},remove(e){t.value=Qy(t.value,e),t.value[0]?.resume()}}}function Qy(t,e){const i=[...t],s=i.indexOf(e);return s!==-1&&i.splice(s,1),i}const kc="focusScope.autoFocusOnMount",Ac="focusScope.autoFocusOnUnmount",ev={bubbles:!1,cancelable:!0};function sP(t,{select:e=!1}={}){const i=oi();for(const s of t)if(ys(s,{select:e}),oi()!==i)return!0}function rP(t){const e=f1(t),i=tv(e,t),s=tv(e.reverse(),t);return[i,s]}function f1(t){const e=[],i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)e.push(i.currentNode);return e}function tv(t,e){for(const i of t)if(!nP(i,{upTo:e}))return i}function nP(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function oP(t){return t instanceof HTMLInputElement&&"select"in t}function ys(t,{select:e=!1}={}){if(t&&t.focus){const i=oi();t.focus({preventScroll:!0}),t!==i&&oP(t)&&e&&t.select()}}var aP=be({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(t,{emit:e}){const i=t,s=e,{currentRef:r,currentElement:n}=Ut(),o=K(null),a=iP(),l=ci({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});Tt(c=>{if(!Vs)return;const h=n.value;if(!i.trapped)return;function f(g){if(l.paused||!h)return;const y=g.target;h.contains(y)?o.value=y:ys(o.value,{select:!0})}function d(g){if(l.paused||!h)return;const y=g.relatedTarget;y!==null&&(h.contains(y)||ys(o.value,{select:!0}))}function p(g){h.contains(o.value)||ys(h)}document.addEventListener("focusin",f),document.addEventListener("focusout",d);const m=new MutationObserver(p);h&&m.observe(h,{childList:!0,subtree:!0}),c(()=>{document.removeEventListener("focusin",f),document.removeEventListener("focusout",d),m.disconnect()})}),Tt(async c=>{const h=n.value;if(await Rt(),!h)return;a.add(l);const f=oi();if(!h.contains(f)){const p=new CustomEvent(kc,ev);h.addEventListener(kc,m=>s("mountAutoFocus",m)),h.dispatchEvent(p),p.defaultPrevented||(sP(f1(h),{select:!0}),oi()===f&&ys(h))}c(()=>{h.removeEventListener(kc,g=>s("mountAutoFocus",g));const p=new CustomEvent(Ac,ev),m=g=>{s("unmountAutoFocus",g)};h.addEventListener(Ac,m),h.dispatchEvent(p),setTimeout(()=>{p.defaultPrevented||ys(f??document.body,{select:!0}),h.removeEventListener(Ac,m),a.remove(l)},0)})});function u(c){if(!i.loop&&!i.trapped||l.paused)return;const h=c.key==="Tab"&&!c.altKey&&!c.ctrlKey&&!c.metaKey,f=oi();if(h&&f){const d=c.currentTarget,[p,m]=rP(d);p&&m?!c.shiftKey&&f===m?(c.preventDefault(),i.loop&&ys(p,{select:!0})):c.shiftKey&&f===p&&(c.preventDefault(),i.loop&&ys(m,{select:!0})):f===d&&c.preventDefault()}}return(c,h)=>(fe(),_e(M(Si),{ref_key:"currentRef",ref:r,tabindex:"-1","as-child":c.asChild,as:c.as,onKeydown:u},{default:ae(()=>[Re(c.$slots,"default")]),_:3},8,["as-child","as"]))}}),lP=aP;const cP="menu.itemSelect",jm=["Enter"," "],uP=["ArrowDown","PageUp","Home"],p1=["ArrowUp","PageDown","End"],hP=[...uP,...p1];[...jm],[...jm];function dP(t){return t?"open":"closed"}function fP(t){const e=oi();for(const i of t)if(i===e||(i.focus(),oi()!==e))return}function pP(t,e){const{x:i,y:s}=t;let r=!1;for(let n=0,o=e.length-1;n<e.length;o=n++){const a=e[n].x,l=e[n].y,u=e[o].x,c=e[o].y;l>s!=c>s&&i<(u-a)*(s-l)/(c-l)+a&&(r=!r)}return r}function mP(t,e){if(!e)return!1;const i={x:t.clientX,y:t.clientY};return pP(i,e)}function Km(t){return t.pointerType==="mouse"}var gP=be({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const e=pI();return(i,s)=>M(e)||i.forceMount?(fe(),_e(KC,{key:0,to:i.to,disabled:i.disabled,defer:i.defer},[Re(i.$slots,"default")],8,["to","disabled","defer"])):i0("v-if",!0)}}),yP=gP;const iv="data-reka-collection-item";function m1(t={}){const{key:e="",isProvider:i=!1}=t,s=`${e}CollectionProvider`;let r;i?(r={collectionRef:K(),itemMap:K(new Map)},Rl(s,r)):r=Rs(s);const n=(c=!1)=>{const h=r.collectionRef.value;if(!h)return[];const f=Array.from(h.querySelectorAll(`[${iv}]`)),p=Array.from(r.itemMap.value.values()).sort((m,g)=>f.indexOf(m.ref)-f.indexOf(g.ref));return c?p:p.filter(m=>m.ref.dataset.disabled!=="")},o=be({name:"CollectionSlot",inheritAttrs:!1,setup(c,{slots:h,attrs:f}){const{primitiveElement:d,currentElement:p}=Jy();return lt(p,()=>{r.collectionRef.value=p.value}),()=>Oe(Xm,{ref:d,...f},h)}}),a=be({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(c,{slots:h,attrs:f}){const{primitiveElement:d,currentElement:p}=Jy();return Tt(m=>{if(p.value){const g=Fb(p.value);r.itemMap.value.set(g,{ref:p.value,value:c.value}),m(()=>r.itemMap.value.delete(g))}}),()=>Oe(Xm,{...f,[iv]:"",ref:d},h)}}),l=me(()=>Array.from(r.itemMap.value.values())),u=me(()=>r.itemMap.value.size);return{getItems:n,reactiveItems:l,itemMapSize:u,CollectionSlot:o,CollectionItem:a}}const vP="rovingFocusGroup.onEntryFocus",xP={bubbles:!1,cancelable:!0};function bP(t,e=!1){const i=oi();for(const s of t)if(s===i||(s.focus({preventScroll:e}),oi()!==i))return}const[U7,_P]=hs("RovingFocusGroup");var wP=be({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(t,{expose:e,emit:i}){const s=t,r=i,{loop:n,orientation:o,dir:a}=Hi(s),l=Hl(a),u=m0(s,"currentTabStopId",r,{defaultValue:s.defaultCurrentTabStopId,passive:s.currentTabStopId===void 0}),c=K(!1),h=K(!1),f=K(0),{getItems:d,CollectionSlot:p}=m1({isProvider:!0});function m(y){const b=!h.value;if(y.currentTarget&&y.target===y.currentTarget&&b&&!c.value){const v=new CustomEvent(vP,xP);if(y.currentTarget.dispatchEvent(v),r("entryFocus",v),!v.defaultPrevented){const x=d().map(w=>w.ref).filter(w=>w.dataset.disabled!==""),_=x.find(w=>w.getAttribute("data-active")===""),S=x.find(w=>w.getAttribute("data-highlighted")===""),T=x.find(w=>w.id===u.value),A=[_,S,T,...x].filter(Boolean);bP(A,s.preventScrollOnEntryFocus)}}h.value=!1}function g(){setTimeout(()=>{h.value=!1},1)}return e({getItems:d}),_P({loop:n,dir:l,orientation:o,currentTabStopId:u,onItemFocus:y=>{u.value=y},onItemShiftTab:()=>{c.value=!0},onFocusableItemAdd:()=>{f.value++},onFocusableItemRemove:()=>{f.value--}}),(y,b)=>(fe(),_e(M(p),null,{default:ae(()=>[oe(M(Si),{tabindex:c.value||f.value===0?-1:0,"data-orientation":M(o),as:y.as,"as-child":y.asChild,dir:M(l),style:{outline:"none"},onMousedown:b[0]||(b[0]=v=>h.value=!0),onMouseup:g,onFocus:m,onBlur:b[1]||(b[1]=v=>c.value=!1)},{default:ae(()=>[Re(y.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),SP=wP;const[g1,CP]=hs("PopperRoot");var TP=be({inheritAttrs:!1,__name:"PopperRoot",setup(t){const e=K();return CP({anchor:e,onAnchorChange:i=>e.value=i}),(i,s)=>Re(i.$slots,"default")}}),kP=TP,AP=be({__name:"PopperAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const e=t,{forwardRef:i,currentElement:s}=Ut(),r=g1();return Nb(()=>{r.onAnchorChange(e.reference??s.value)}),(n,o)=>(fe(),_e(M(Si),{ref:M(i),as:n.as,"as-child":n.asChild},{default:ae(()=>[Re(n.$slots,"default")]),_:3},8,["as","as-child"]))}}),IP=AP;function PP(t){return t!==null}function EP(t){return{name:"transformOrigin",options:t,fn(e){const{placement:i,rects:s,middlewareData:r}=e,o=r.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,c]=Zm(i),h={start:"0%",center:"50%",end:"100%"}[c],f=(r.arrow?.x??0)+a/2,d=(r.arrow?.y??0)+l/2;let p="",m="";return u==="bottom"?(p=o?h:`${f}px`,m=`${-l}px`):u==="top"?(p=o?h:`${f}px`,m=`${s.floating.height+l}px`):u==="right"?(p=`${-l}px`,m=o?h:`${d}px`):u==="left"&&(p=`${s.floating.width+l}px`,m=o?h:`${d}px`),{data:{x:p,y:m}}}}}function Zm(t){const[e,i="center"]=t.split("-");return[e,i]}const MP=["top","right","bottom","left"],Bs=Math.min,Xt=Math.max,al=Math.round,Yo=Math.floor,Di=t=>({x:t,y:t}),FP={left:"right",right:"left",bottom:"top",top:"bottom"},RP={start:"end",end:"start"};function Jm(t,e,i){return Xt(t,Bs(e,i))}function ns(t,e){return typeof t=="function"?t(e):t}function os(t){return t.split("-")[0]}function hn(t){return t.split("-")[1]}function x0(t){return t==="x"?"y":"x"}function b0(t){return t==="y"?"height":"width"}const zP=new Set(["top","bottom"]);function Bi(t){return zP.has(os(t))?"y":"x"}function _0(t){return x0(Bi(t))}function UP(t,e,i){i===void 0&&(i=!1);const s=hn(t),r=_0(t),n=b0(r);let o=r==="x"?s===(i?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[n]>e.floating[n]&&(o=ll(o)),[o,ll(o)]}function BP(t){const e=ll(t);return[Qm(t),e,Qm(e)]}function Qm(t){return t.replace(/start|end/g,e=>RP[e])}const sv=["left","right"],rv=["right","left"],OP=["top","bottom"],DP=["bottom","top"];function LP(t,e,i){switch(t){case"top":case"bottom":return i?e?rv:sv:e?sv:rv;case"left":case"right":return e?OP:DP;default:return[]}}function NP(t,e,i,s){const r=hn(t);let n=LP(os(t),i==="start",s);return r&&(n=n.map(o=>o+"-"+r),e&&(n=n.concat(n.map(Qm)))),n}function ll(t){return t.replace(/left|right|bottom|top/g,e=>FP[e])}function HP(t){return{top:0,right:0,bottom:0,left:0,...t}}function y1(t){return typeof t!="number"?HP(t):{top:t,right:t,bottom:t,left:t}}function cl(t){const{x:e,y:i,width:s,height:r}=t;return{width:s,height:r,top:i,left:e,right:e+s,bottom:i+r,x:e,y:i}}function nv(t,e,i){let{reference:s,floating:r}=t;const n=Bi(e),o=_0(e),a=b0(o),l=os(e),u=n==="y",c=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[a]/2-r[a]/2;let d;switch(l){case"top":d={x:c,y:s.y-r.height};break;case"bottom":d={x:c,y:s.y+s.height};break;case"right":d={x:s.x+s.width,y:h};break;case"left":d={x:s.x-r.width,y:h};break;default:d={x:s.x,y:s.y}}switch(hn(e)){case"start":d[o]-=f*(i&&u?-1:1);break;case"end":d[o]+=f*(i&&u?-1:1);break}return d}async function GP(t,e){var i;e===void 0&&(e={});const{x:s,y:r,platform:n,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:f=!1,padding:d=0}=ns(e,t),p=y1(d),g=a[f?h==="floating"?"reference":"floating":h],y=cl(await n.getClippingRect({element:(i=await(n.isElement==null?void 0:n.isElement(g)))==null||i?g:g.contextElement||await(n.getDocumentElement==null?void 0:n.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),b=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,v=await(n.getOffsetParent==null?void 0:n.getOffsetParent(a.floating)),x=await(n.isElement==null?void 0:n.isElement(v))?await(n.getScale==null?void 0:n.getScale(v))||{x:1,y:1}:{x:1,y:1},_=cl(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:v,strategy:l}):b);return{top:(y.top-_.top+p.top)/x.y,bottom:(_.bottom-y.bottom+p.bottom)/x.y,left:(y.left-_.left+p.left)/x.x,right:(_.right-y.right+p.right)/x.x}}const WP=async(t,e,i)=>{const{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:o}=i,a=n.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:h}=nv(u,s,l),f=s,d={},p=0;for(let g=0;g<a.length;g++){var m;const{name:y,fn:b}=a[g],{x:v,y:x,data:_,reset:S}=await b({x:c,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:d,rects:u,platform:{...o,detectOverflow:(m=o.detectOverflow)!=null?m:GP},elements:{reference:t,floating:e}});c=v??c,h=x??h,d={...d,[y]:{...d[y],..._}},S&&p<=50&&(p++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(u=S.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):S.rects),{x:c,y:h}=nv(u,f,l)),g=-1)}return{x:c,y:h,placement:f,strategy:r,middlewareData:d}},VP=t=>({name:"arrow",options:t,async fn(e){const{x:i,y:s,placement:r,rects:n,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=ns(t,e)||{};if(u==null)return{};const h=y1(c),f={x:i,y:s},d=_0(r),p=b0(d),m=await o.getDimensions(u),g=d==="y",y=g?"top":"left",b=g?"bottom":"right",v=g?"clientHeight":"clientWidth",x=n.reference[p]+n.reference[d]-f[d]-n.floating[p],_=f[d]-n.reference[d],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let T=S?S[v]:0;(!T||!await(o.isElement==null?void 0:o.isElement(S)))&&(T=a.floating[v]||n.floating[p]);const A=x/2-_/2,w=T/2-m[p]/2-1,k=Bs(h[y],w),F=Bs(h[b],w),O=k,V=T-m[p]-F,W=T/2-m[p]/2+A,ie=Jm(O,W,V),R=!l.arrow&&hn(r)!=null&&W!==ie&&n.reference[p]/2-(W<O?k:F)-m[p]/2<0,I=R?W<O?W-O:W-V:0;return{[d]:f[d]+I,data:{[d]:ie,centerOffset:W-ie-I,...R&&{alignmentOffset:I}},reset:R}}}),$P=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var i,s;const{placement:r,middlewareData:n,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=ns(t,e);if((i=n.arrow)!=null&&i.alignmentOffset)return{};const y=os(r),b=Bi(a),v=os(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=f||(v||!m?[ll(a)]:BP(a)),S=p!=="none";!f&&S&&_.push(...NP(a,m,p,x));const T=[a,..._],A=await l.detectOverflow(e,g),w=[];let k=((s=n.flip)==null?void 0:s.overflows)||[];if(c&&w.push(A[y]),h){const W=UP(r,o,x);w.push(A[W[0]],A[W[1]])}if(k=[...k,{placement:r,overflows:w}],!w.every(W=>W<=0)){var F,O;const W=(((F=n.flip)==null?void 0:F.index)||0)+1,ie=T[W];if(ie&&(!(h==="alignment"?b!==Bi(ie):!1)||k.every(E=>Bi(E.placement)===b?E.overflows[0]>0:!0)))return{data:{index:W,overflows:k},reset:{placement:ie}};let R=(O=k.filter(I=>I.overflows[0]<=0).sort((I,E)=>I.overflows[1]-E.overflows[1])[0])==null?void 0:O.placement;if(!R)switch(d){case"bestFit":{var V;const I=(V=k.filter(E=>{if(S){const U=Bi(E.placement);return U===b||U==="y"}return!0}).map(E=>[E.placement,E.overflows.filter(U=>U>0).reduce((U,Z)=>U+Z,0)]).sort((E,U)=>E[1]-U[1])[0])==null?void 0:V[0];I&&(R=I);break}case"initialPlacement":R=a;break}if(r!==R)return{reset:{placement:R}}}return{}}}};function ov(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function av(t){return MP.some(e=>t[e]>=0)}const qP=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:i,platform:s}=e,{strategy:r="referenceHidden",...n}=ns(t,e);switch(r){case"referenceHidden":{const o=await s.detectOverflow(e,{...n,elementContext:"reference"}),a=ov(o,i.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:av(a)}}}case"escaped":{const o=await s.detectOverflow(e,{...n,altBoundary:!0}),a=ov(o,i.floating);return{data:{escapedOffsets:a,escaped:av(a)}}}default:return{}}}}},v1=new Set(["left","top"]);async function YP(t,e){const{placement:i,platform:s,elements:r}=t,n=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=os(i),a=hn(i),l=Bi(i)==="y",u=v1.has(o)?-1:1,c=n&&l?-1:1,h=ns(e,t);let{mainAxis:f,crossAxis:d,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof p=="number"&&(d=a==="end"?p*-1:p),l?{x:d*c,y:f*u}:{x:f*u,y:d*c}}const XP=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var i,s;const{x:r,y:n,placement:o,middlewareData:a}=e,l=await YP(e,t);return o===((i=a.offset)==null?void 0:i.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:n+l.y,data:{...l,placement:o}}}}},jP=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:i,y:s,placement:r,platform:n}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:l={fn:y=>{let{x:b,y:v}=y;return{x:b,y:v}}},...u}=ns(t,e),c={x:i,y:s},h=await n.detectOverflow(e,u),f=Bi(os(r)),d=x0(f);let p=c[d],m=c[f];if(o){const y=d==="y"?"top":"left",b=d==="y"?"bottom":"right",v=p+h[y],x=p-h[b];p=Jm(v,p,x)}if(a){const y=f==="y"?"top":"left",b=f==="y"?"bottom":"right",v=m+h[y],x=m-h[b];m=Jm(v,m,x)}const g=l.fn({...e,[d]:p,[f]:m});return{...g,data:{x:g.x-i,y:g.y-s,enabled:{[d]:o,[f]:a}}}}}},KP=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:i,y:s,placement:r,rects:n,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=ns(t,e),c={x:i,y:s},h=Bi(r),f=x0(h);let d=c[f],p=c[h];const m=ns(a,e),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const v=f==="y"?"height":"width",x=n.reference[f]-n.floating[v]+g.mainAxis,_=n.reference[f]+n.reference[v]-g.mainAxis;d<x?d=x:d>_&&(d=_)}if(u){var y,b;const v=f==="y"?"width":"height",x=v1.has(os(r)),_=n.reference[h]-n.floating[v]+(x&&((y=o.offset)==null?void 0:y[h])||0)+(x?0:g.crossAxis),S=n.reference[h]+n.reference[v]+(x?0:((b=o.offset)==null?void 0:b[h])||0)-(x?g.crossAxis:0);p<_?p=_:p>S&&(p=S)}return{[f]:d,[h]:p}}}},ZP=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var i,s;const{placement:r,rects:n,platform:o,elements:a}=e,{apply:l=()=>{},...u}=ns(t,e),c=await o.detectOverflow(e,u),h=os(r),f=hn(r),d=Bi(r)==="y",{width:p,height:m}=n.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=f==="end"?"top":"bottom");const b=m-c.top-c.bottom,v=p-c.left-c.right,x=Bs(m-c[g],b),_=Bs(p-c[y],v),S=!e.middlewareData.shift;let T=x,A=_;if((i=e.middlewareData.shift)!=null&&i.enabled.x&&(A=v),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(T=b),S&&!f){const k=Xt(c.left,0),F=Xt(c.right,0),O=Xt(c.top,0),V=Xt(c.bottom,0);d?A=p-2*(k!==0||F!==0?k+F:Xt(c.left,c.right)):T=m-2*(O!==0||V!==0?O+V:Xt(c.top,c.bottom))}await l({...e,availableWidth:A,availableHeight:T});const w=await o.getDimensions(a.floating);return p!==w.width||m!==w.height?{reset:{rects:!0}}:{}}}};function Gl(){return typeof window<"u"}function wr(t){return w0(t)?(t.nodeName||"").toLowerCase():"#document"}function Kt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function $i(t){var e;return(e=(w0(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function w0(t){return Gl()?t instanceof Node||t instanceof Kt(t).Node:!1}function bi(t){return Gl()?t instanceof Element||t instanceof Kt(t).Element:!1}function Wi(t){return Gl()?t instanceof HTMLElement||t instanceof Kt(t).HTMLElement:!1}function lv(t){return!Gl()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Kt(t).ShadowRoot}const JP=new Set(["inline","contents"]);function Fo(t){const{overflow:e,overflowX:i,overflowY:s,display:r}=_i(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+i)&&!JP.has(r)}const QP=new Set(["table","td","th"]);function eE(t){return QP.has(wr(t))}const tE=[":popover-open",":modal"];function Wl(t){return tE.some(e=>{try{return t.matches(e)}catch{return!1}})}const iE=["transform","translate","scale","rotate","perspective"],sE=["transform","translate","scale","rotate","perspective","filter"],rE=["paint","layout","strict","content"];function S0(t){const e=C0(),i=bi(t)?_i(t):t;return iE.some(s=>i[s]?i[s]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!e&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!e&&(i.filter?i.filter!=="none":!1)||sE.some(s=>(i.willChange||"").includes(s))||rE.some(s=>(i.contain||"").includes(s))}function nE(t){let e=Os(t);for(;Wi(e)&&!tn(e);){if(S0(e))return e;if(Wl(e))return null;e=Os(e)}return null}function C0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const oE=new Set(["html","body","#document"]);function tn(t){return oE.has(wr(t))}function _i(t){return Kt(t).getComputedStyle(t)}function Vl(t){return bi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Os(t){if(wr(t)==="html")return t;const e=t.assignedSlot||t.parentNode||lv(t)&&t.host||$i(t);return lv(e)?e.host:e}function x1(t){const e=Os(t);return tn(e)?t.ownerDocument?t.ownerDocument.body:t.body:Wi(e)&&Fo(e)?e:x1(e)}function mo(t,e,i){var s;e===void 0&&(e=[]),i===void 0&&(i=!0);const r=x1(t),n=r===((s=t.ownerDocument)==null?void 0:s.body),o=Kt(r);if(n){const a=eg(o);return e.concat(o,o.visualViewport||[],Fo(r)?r:[],a&&i?mo(a):[])}return e.concat(r,mo(r,[],i))}function eg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function b1(t){const e=_i(t);let i=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Wi(t),n=r?t.offsetWidth:i,o=r?t.offsetHeight:s,a=al(i)!==n||al(s)!==o;return a&&(i=n,s=o),{width:i,height:s,$:a}}function T0(t){return bi(t)?t:t.contextElement}function jr(t){const e=T0(t);if(!Wi(e))return Di(1);const i=e.getBoundingClientRect(),{width:s,height:r,$:n}=b1(e);let o=(n?al(i.width):i.width)/s,a=(n?al(i.height):i.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const aE=Di(0);function _1(t){const e=Kt(t);return!C0()||!e.visualViewport?aE:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function lE(t,e,i){return e===void 0&&(e=!1),!i||e&&i!==Kt(t)?!1:e}function mr(t,e,i,s){e===void 0&&(e=!1),i===void 0&&(i=!1);const r=t.getBoundingClientRect(),n=T0(t);let o=Di(1);e&&(s?bi(s)&&(o=jr(s)):o=jr(t));const a=lE(n,i,s)?_1(n):Di(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,c=r.width/o.x,h=r.height/o.y;if(n){const f=Kt(n),d=s&&bi(s)?Kt(s):s;let p=f,m=eg(p);for(;m&&s&&d!==p;){const g=jr(m),y=m.getBoundingClientRect(),b=_i(m),v=y.left+(m.clientLeft+parseFloat(b.paddingLeft))*g.x,x=y.top+(m.clientTop+parseFloat(b.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,h*=g.y,l+=v,u+=x,p=Kt(m),m=eg(p)}}return cl({width:c,height:h,x:l,y:u})}function $l(t,e){const i=Vl(t).scrollLeft;return e?e.left+i:mr($i(t)).left+i}function w1(t,e){const i=t.getBoundingClientRect(),s=i.left+e.scrollLeft-$l(t,i),r=i.top+e.scrollTop;return{x:s,y:r}}function cE(t){let{elements:e,rect:i,offsetParent:s,strategy:r}=t;const n=r==="fixed",o=$i(s),a=e?Wl(e.floating):!1;if(s===o||a&&n)return i;let l={scrollLeft:0,scrollTop:0},u=Di(1);const c=Di(0),h=Wi(s);if((h||!h&&!n)&&((wr(s)!=="body"||Fo(o))&&(l=Vl(s)),Wi(s))){const d=mr(s);u=jr(s),c.x=d.x+s.clientLeft,c.y=d.y+s.clientTop}const f=o&&!h&&!n?w1(o,l):Di(0);return{width:i.width*u.x,height:i.height*u.y,x:i.x*u.x-l.scrollLeft*u.x+c.x+f.x,y:i.y*u.y-l.scrollTop*u.y+c.y+f.y}}function uE(t){return Array.from(t.getClientRects())}function hE(t){const e=$i(t),i=Vl(t),s=t.ownerDocument.body,r=Xt(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),n=Xt(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-i.scrollLeft+$l(t);const a=-i.scrollTop;return _i(s).direction==="rtl"&&(o+=Xt(e.clientWidth,s.clientWidth)-r),{width:r,height:n,x:o,y:a}}const cv=25;function dE(t,e){const i=Kt(t),s=$i(t),r=i.visualViewport;let n=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){n=r.width,o=r.height;const c=C0();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const u=$l(s);if(u<=0){const c=s.ownerDocument,h=c.body,f=getComputedStyle(h),d=c.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,p=Math.abs(s.clientWidth-h.clientWidth-d);p<=cv&&(n-=p)}else u<=cv&&(n+=u);return{width:n,height:o,x:a,y:l}}const fE=new Set(["absolute","fixed"]);function pE(t,e){const i=mr(t,!0,e==="fixed"),s=i.top+t.clientTop,r=i.left+t.clientLeft,n=Wi(t)?jr(t):Di(1),o=t.clientWidth*n.x,a=t.clientHeight*n.y,l=r*n.x,u=s*n.y;return{width:o,height:a,x:l,y:u}}function uv(t,e,i){let s;if(e==="viewport")s=dE(t,i);else if(e==="document")s=hE($i(t));else if(bi(e))s=pE(e,i);else{const r=_1(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return cl(s)}function S1(t,e){const i=Os(t);return i===e||!bi(i)||tn(i)?!1:_i(i).position==="fixed"||S1(i,e)}function mE(t,e){const i=e.get(t);if(i)return i;let s=mo(t,[],!1).filter(a=>bi(a)&&wr(a)!=="body"),r=null;const n=_i(t).position==="fixed";let o=n?Os(t):t;for(;bi(o)&&!tn(o);){const a=_i(o),l=S0(o);!l&&a.position==="fixed"&&(r=null),(n?!l&&!r:!l&&a.position==="static"&&!!r&&fE.has(r.position)||Fo(o)&&!l&&S1(t,o))?s=s.filter(c=>c!==o):r=a,o=Os(o)}return e.set(t,s),s}function gE(t){let{element:e,boundary:i,rootBoundary:s,strategy:r}=t;const o=[...i==="clippingAncestors"?Wl(e)?[]:mE(e,this._c):[].concat(i),s],a=o[0],l=o.reduce((u,c)=>{const h=uv(e,c,r);return u.top=Xt(h.top,u.top),u.right=Bs(h.right,u.right),u.bottom=Bs(h.bottom,u.bottom),u.left=Xt(h.left,u.left),u},uv(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function yE(t){const{width:e,height:i}=b1(t);return{width:e,height:i}}function vE(t,e,i){const s=Wi(e),r=$i(e),n=i==="fixed",o=mr(t,!0,n,e);let a={scrollLeft:0,scrollTop:0};const l=Di(0);function u(){l.x=$l(r)}if(s||!s&&!n)if((wr(e)!=="body"||Fo(r))&&(a=Vl(e)),s){const d=mr(e,!0,n,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else r&&u();n&&!s&&r&&u();const c=r&&!s&&!n?w1(r,a):Di(0),h=o.left+a.scrollLeft-l.x-c.x,f=o.top+a.scrollTop-l.y-c.y;return{x:h,y:f,width:o.width,height:o.height}}function Ic(t){return _i(t).position==="static"}function hv(t,e){if(!Wi(t)||_i(t).position==="fixed")return null;if(e)return e(t);let i=t.offsetParent;return $i(t)===i&&(i=i.ownerDocument.body),i}function C1(t,e){const i=Kt(t);if(Wl(t))return i;if(!Wi(t)){let r=Os(t);for(;r&&!tn(r);){if(bi(r)&&!Ic(r))return r;r=Os(r)}return i}let s=hv(t,e);for(;s&&eE(s)&&Ic(s);)s=hv(s,e);return s&&tn(s)&&Ic(s)&&!S0(s)?i:s||nE(t)||i}const xE=async function(t){const e=this.getOffsetParent||C1,i=this.getDimensions,s=await i(t.floating);return{reference:vE(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function bE(t){return _i(t).direction==="rtl"}const _E={convertOffsetParentRelativeRectToViewportRelativeRect:cE,getDocumentElement:$i,getClippingRect:gE,getOffsetParent:C1,getElementRects:xE,getClientRects:uE,getDimensions:yE,getScale:jr,isElement:bi,isRTL:bE};function T1(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function wE(t,e){let i=null,s;const r=$i(t);function n(){var a;clearTimeout(s),(a=i)==null||a.disconnect(),i=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),n();const u=t.getBoundingClientRect(),{left:c,top:h,width:f,height:d}=u;if(a||e(),!f||!d)return;const p=Yo(h),m=Yo(r.clientWidth-(c+f)),g=Yo(r.clientHeight-(h+d)),y=Yo(c),v={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:Xt(0,Bs(1,l))||1};let x=!0;function _(S){const T=S[0].intersectionRatio;if(T!==l){if(!x)return o();T?o(!1,T):s=setTimeout(()=>{o(!1,1e-7)},1e3)}T===1&&!T1(u,t.getBoundingClientRect())&&o(),x=!1}try{i=new IntersectionObserver(_,{...v,root:r.ownerDocument})}catch{i=new IntersectionObserver(_,v)}i.observe(t)}return o(!0),n}function SE(t,e,i,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:n=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=T0(t),c=r||n?[...u?mo(u):[],...mo(e)]:[];c.forEach(y=>{r&&y.addEventListener("scroll",i,{passive:!0}),n&&y.addEventListener("resize",i)});const h=u&&a?wE(u,i):null;let f=-1,d=null;o&&(d=new ResizeObserver(y=>{let[b]=y;b&&b.target===u&&d&&(d.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var v;(v=d)==null||v.observe(e)})),i()}),u&&!l&&d.observe(u),d.observe(e));let p,m=l?mr(t):null;l&&g();function g(){const y=mr(t);m&&!T1(m,y)&&i(),m=y,p=requestAnimationFrame(g)}return i(),()=>{var y;c.forEach(b=>{r&&b.removeEventListener("scroll",i),n&&b.removeEventListener("resize",i)}),h?.(),(y=d)==null||y.disconnect(),d=null,l&&cancelAnimationFrame(p)}}const CE=XP,TE=jP,dv=$P,kE=ZP,AE=qP,IE=VP,PE=KP,EE=(t,e,i)=>{const s=new Map,r={platform:_E,...i},n={...r.platform,_c:s};return WP(t,e,{...r,platform:n})};function ME(t){return t!=null&&typeof t=="object"&&"$el"in t}function tg(t){if(ME(t)){const e=t.$el;return w0(e)&&wr(e)==="#comment"?null:e}return t}function Mr(t){return typeof t=="function"?t():M(t)}function FE(t){return{name:"arrow",options:t,fn(e){const i=tg(Mr(t.element));return i==null?{}:IE({element:i,padding:t.padding}).fn(e)}}}function k1(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function fv(t,e){const i=k1(t);return Math.round(e*i)/i}function RE(t,e,i){i===void 0&&(i={});const s=i.whileElementsMounted,r=me(()=>{var T;return(T=Mr(i.open))!=null?T:!0}),n=me(()=>Mr(i.middleware)),o=me(()=>{var T;return(T=Mr(i.placement))!=null?T:"bottom"}),a=me(()=>{var T;return(T=Mr(i.strategy))!=null?T:"absolute"}),l=me(()=>{var T;return(T=Mr(i.transform))!=null?T:!0}),u=me(()=>tg(t.value)),c=me(()=>tg(e.value)),h=K(0),f=K(0),d=K(a.value),p=K(o.value),m=uo({}),g=K(!1),y=me(()=>{const T={position:d.value,left:"0",top:"0"};if(!c.value)return T;const A=fv(c.value,h.value),w=fv(c.value,f.value);return l.value?{...T,transform:"translate("+A+"px, "+w+"px)",...k1(c.value)>=1.5&&{willChange:"transform"}}:{position:d.value,left:A+"px",top:w+"px"}});let b;function v(){if(u.value==null||c.value==null)return;const T=r.value;EE(u.value,c.value,{middleware:n.value,placement:o.value,strategy:a.value}).then(A=>{h.value=A.x,f.value=A.y,d.value=A.strategy,p.value=A.placement,m.value=A.middlewareData,g.value=T!==!1})}function x(){typeof b=="function"&&(b(),b=void 0)}function _(){if(x(),s===void 0){v();return}if(u.value!=null&&c.value!=null){b=s(u.value,c.value,v);return}}function S(){r.value||(g.value=!1)}return lt([n,o,a,r],v,{flush:"sync"}),lt([u,c],_,{flush:"sync"}),lt(r,S,{flush:"sync"}),Il()&&mb(x),{x:Cr(h),y:Cr(f),strategy:Cr(d),placement:Cr(p),middlewareData:Cr(m),isPositioned:Cr(g),floatingStyles:y,update:v}}const A1={side:"bottom",sideOffset:0,sideFlip:!0,align:"center",alignOffset:0,alignFlip:!0,arrowPadding:0,hideShiftedArrow:!0,avoidCollisions:!0,collisionBoundary:()=>[],collisionPadding:0,sticky:"partial",hideWhenDetached:!1,positionStrategy:"fixed",updatePositionStrategy:"optimized",prioritizePosition:!1},[B7,zE]=hs("PopperContent");var UE=be({inheritAttrs:!1,__name:"PopperContent",props:Qb({side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...A1}),emits:["placed"],setup(t,{emit:e}){const i=t,s=e,r=g1(),{forwardRef:n,currentElement:o}=Ut(),a=K(),l=K(),{width:u,height:c}=HI(l),h=me(()=>i.side+(i.align!=="center"?`-${i.align}`:"")),f=me(()=>typeof i.collisionPadding=="number"?i.collisionPadding:{top:0,right:0,bottom:0,left:0,...i.collisionPadding}),d=me(()=>Array.isArray(i.collisionBoundary)?i.collisionBoundary:[i.collisionBoundary]),p=me(()=>({padding:f.value,boundary:d.value.filter(PP),altBoundary:d.value.length>0})),m=me(()=>({mainAxis:i.sideFlip,crossAxis:i.alignFlip})),g=sI(()=>[CE({mainAxis:i.sideOffset+c.value,alignmentAxis:i.alignOffset}),i.prioritizePosition&&i.avoidCollisions&&dv({...p.value,...m.value}),i.avoidCollisions&&TE({mainAxis:!0,crossAxis:!!i.prioritizePosition,limiter:i.sticky==="partial"?PE():void 0,...p.value}),!i.prioritizePosition&&i.avoidCollisions&&dv({...p.value,...m.value}),kE({...p.value,apply:({elements:O,rects:V,availableWidth:W,availableHeight:ie})=>{const{width:R,height:I}=V.reference,E=O.floating.style;E.setProperty("--reka-popper-available-width",`${W}px`),E.setProperty("--reka-popper-available-height",`${ie}px`),E.setProperty("--reka-popper-anchor-width",`${R}px`),E.setProperty("--reka-popper-anchor-height",`${I}px`)}}),l.value&&FE({element:l.value,padding:i.arrowPadding}),EP({arrowWidth:u.value,arrowHeight:c.value}),i.hideWhenDetached&&AE({strategy:"referenceHidden",...p.value})]),y=me(()=>i.reference??r.anchor.value),{floatingStyles:b,placement:v,isPositioned:x,middlewareData:_}=RE(y,a,{strategy:i.positionStrategy,placement:h,whileElementsMounted:(...O)=>SE(...O,{layoutShift:!i.disableUpdateOnLayoutShift,animationFrame:i.updatePositionStrategy==="always"}),middleware:g}),S=me(()=>Zm(v.value)[0]),T=me(()=>Zm(v.value)[1]);Nb(()=>{x.value&&s("placed")});const A=me(()=>{const O=_.value.arrow?.centerOffset!==0;return i.hideShiftedArrow&&O}),w=K("");Tt(()=>{o.value&&(w.value=window.getComputedStyle(o.value).zIndex)});const k=me(()=>_.value.arrow?.x??0),F=me(()=>_.value.arrow?.y??0);return zE({placedSide:S,onArrowChange:O=>l.value=O,arrowX:k,arrowY:F,shouldHideArrow:A}),(O,V)=>(fe(),dr("div",{ref_key:"floatingRef",ref:a,"data-reka-popper-content-wrapper":"",style:Gs({...M(b),transform:M(x)?M(b).transform:"translate(0, -200%)",minWidth:"max-content",zIndex:w.value,"--reka-popper-transform-origin":[M(_).transformOrigin?.x,M(_).transformOrigin?.y].join(" "),...M(_).hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}})},[oe(M(Si),vt({ref:M(n)},O.$attrs,{"as-child":i.asChild,as:O.as,"data-side":S.value,"data-align":T.value,style:{animation:M(x)?void 0:"none"}}),{default:ae(()=>[Re(O.$slots,"default")]),_:3},16,["as-child","as","data-side","data-align","style"])],4))}}),BE=UE;function OE(t){const e=y0({nonce:K()});return me(()=>t?.value||e.nonce?.value)}var DE=be({__name:"MenuAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const e=t;return(i,s)=>(fe(),_e(M(IP),Ni(cs(e)),{default:ae(()=>[Re(i.$slots,"default")]),_:3},16))}}),LE=DE;function NE(){const t=K(!1);return br(()=>{Ym("keydown",()=>{t.value=!0},{capture:!0,passive:!0}),Ym(["pointerdown","pointermove"],()=>{t.value=!1},{capture:!0,passive:!0})}),t}const HE=r1(NE),[ql,GE]=hs(["MenuRoot","MenuSub"],"MenuContext"),[k0,WE]=hs("MenuRoot");var VE=be({__name:"MenuRoot",props:{open:{type:Boolean,required:!1,default:!1},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:e}){const i=t,s=e,{modal:r,dir:n}=Hi(i),o=Hl(n),a=m0(i,"open",s),l=K(),u=HE();return GE({open:a,onOpenChange:c=>{a.value=c},content:l,onContentChange:c=>{l.value=c}}),WE({onClose:()=>{a.value=!1},isUsingKeyboardRef:u,dir:o,modal:r}),(c,h)=>(fe(),_e(M(kP),null,{default:ae(()=>[Re(c.$slots,"default")]),_:3}))}}),$E=VE;const[I1,qE]=hs("MenuContent");var YE=be({__name:"MenuContentImpl",props:Qb({loop:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},disableOutsideScroll:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...A1}),emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus","dismiss"],setup(t,{emit:e}){const i=t,s=e,r=ql(),n=k0(),{trapFocus:o,disableOutsidePointerEvents:a,loop:l}=Hi(i);UI(),zI(a.value);const u=K(""),c=K(0),h=K(0),f=K(null),d=K("right"),p=K(0),m=K(null),g=K(),{forwardRef:y,currentElement:b}=Ut(),{handleTypeaheadSearch:v}=WI();lt(b,w=>{r.onContentChange(w)}),_r(()=>{window.clearTimeout(c.value)});function x(w){return d.value===f.value?.side&&mP(w,f.value?.area)}async function _(w){s("openAutoFocus",w),!w.defaultPrevented&&(w.preventDefault(),b.value?.focus({preventScroll:!0}))}function S(w){if(w.defaultPrevented)return;const F=w.target.closest("[data-reka-menu-content]")===w.currentTarget,O=w.ctrlKey||w.altKey||w.metaKey,V=w.key.length===1,W=FI(w,oi(),b.value,{loop:l.value,arrowKeyOptions:"vertical",dir:n?.dir.value,focus:!0,attributeName:"[data-reka-collection-item]:not([data-disabled])"});if(W)return W?.focus();if(w.code==="Space")return;const ie=g.value?.getItems()??[];if(F&&(w.key==="Tab"&&w.preventDefault(),!O&&V&&v(w.key,ie)),w.target!==b.value||!hP.includes(w.key))return;w.preventDefault();const R=[...ie.map(I=>I.ref)];p1.includes(w.key)&&R.reverse(),fP(R)}function T(w){w?.currentTarget?.contains?.(w.target)||(window.clearTimeout(c.value),u.value="")}function A(w){if(!Km(w))return;const k=w.target,F=p.value!==w.clientX;if(w?.currentTarget?.contains(k)&&F){const O=w.clientX>p.value?"right":"left";d.value=O,p.value=w.clientX}}return qE({onItemEnter:w=>!!x(w),onItemLeave:w=>{x(w)||(b.value?.focus(),m.value=null)},onTriggerLeave:w=>!!x(w),searchRef:u,pointerGraceTimerRef:h,onPointerGraceIntentChange:w=>{f.value=w}}),(w,k)=>(fe(),_e(M(lP),{"as-child":"",trapped:M(o),onMountAutoFocus:_,onUnmountAutoFocus:k[7]||(k[7]=F=>s("closeAutoFocus",F))},{default:ae(()=>[oe(M(eP),{"as-child":"","disable-outside-pointer-events":M(a),onEscapeKeyDown:k[2]||(k[2]=F=>s("escapeKeyDown",F)),onPointerDownOutside:k[3]||(k[3]=F=>s("pointerDownOutside",F)),onFocusOutside:k[4]||(k[4]=F=>s("focusOutside",F)),onInteractOutside:k[5]||(k[5]=F=>s("interactOutside",F)),onDismiss:k[6]||(k[6]=F=>s("dismiss"))},{default:ae(()=>[oe(M(SP),{ref_key:"rovingFocusGroupRef",ref:g,"current-tab-stop-id":m.value,"onUpdate:currentTabStopId":k[0]||(k[0]=F=>m.value=F),"as-child":"",orientation:"vertical",dir:M(n).dir.value,loop:M(l),onEntryFocus:k[1]||(k[1]=F=>{s("entryFocus",F),M(n).isUsingKeyboardRef.value||F.preventDefault()})},{default:ae(()=>[oe(M(BE),{ref:M(y),role:"menu",as:w.as,"as-child":w.asChild,"aria-orientation":"vertical","data-reka-menu-content":"","data-state":M(dP)(M(r).open.value),dir:M(n).dir.value,side:w.side,"side-offset":w.sideOffset,align:w.align,"align-offset":w.alignOffset,"avoid-collisions":w.avoidCollisions,"collision-boundary":w.collisionBoundary,"collision-padding":w.collisionPadding,"arrow-padding":w.arrowPadding,"prioritize-position":w.prioritizePosition,"position-strategy":w.positionStrategy,"update-position-strategy":w.updatePositionStrategy,sticky:w.sticky,"hide-when-detached":w.hideWhenDetached,reference:w.reference,onKeydown:S,onBlur:T,onPointermove:A},{default:ae(()=>[Re(w.$slots,"default")]),_:3},8,["as","as-child","data-state","dir","side","side-offset","align","align-offset","avoid-collisions","collision-boundary","collision-padding","arrow-padding","prioritize-position","position-strategy","update-position-strategy","sticky","hide-when-detached","reference"])]),_:3},8,["current-tab-stop-id","dir","loop"])]),_:3},8,["disable-outside-pointer-events"])]),_:3},8,["trapped"]))}}),P1=YE,XE=be({inheritAttrs:!1,__name:"MenuItemImpl",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const e=t,i=I1(),{forwardRef:s}=Ut(),{CollectionItem:r}=m1(),n=K(!1);async function o(l){l.defaultPrevented||Km(l)&&(e.disabled?i.onItemLeave(l):i.onItemEnter(l)||l.currentTarget?.focus({preventScroll:!0}))}async function a(l){await Rt(),!l.defaultPrevented&&Km(l)&&i.onItemLeave(l)}return(l,u)=>(fe(),_e(M(r),{value:{textValue:l.textValue}},{default:ae(()=>[oe(M(Si),vt({ref:M(s),role:"menuitem",tabindex:"-1"},l.$attrs,{as:l.as,"as-child":l.asChild,"aria-disabled":l.disabled||void 0,"data-disabled":l.disabled?"":void 0,"data-highlighted":n.value?"":void 0,onPointermove:o,onPointerleave:a,onFocus:u[0]||(u[0]=async c=>{await Rt(),!(c.defaultPrevented||l.disabled)&&(n.value=!0)}),onBlur:u[1]||(u[1]=async c=>{await Rt(),!c.defaultPrevented&&(n.value=!1)})}),{default:ae(()=>[Re(l.$slots,"default")]),_:3},16,["as","as-child","aria-disabled","data-disabled","data-highlighted"])]),_:3},8,["value"]))}}),jE=XE,KE=be({__name:"MenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(t,{emit:e}){const i=t,s=e,{forwardRef:r,currentElement:n}=Ut(),o=k0(),a=I1(),l=K(!1);async function u(){const c=n.value;if(!i.disabled&&c){const h=new CustomEvent(cP,{bubbles:!0,cancelable:!0});s("select",h),await Rt(),h.defaultPrevented?l.value=!1:o.onClose()}}return(c,h)=>(fe(),_e(jE,vt(i,{ref:M(r),onClick:u,onPointerdown:h[0]||(h[0]=()=>{l.value=!0}),onPointerup:h[1]||(h[1]=async f=>{await Rt(),!f.defaultPrevented&&(l.value||f.currentTarget?.click())}),onKeydown:h[2]||(h[2]=async f=>{const d=M(a).searchRef.value!=="";c.disabled||d&&f.key===" "||M(jm).includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})}),{default:ae(()=>[Re(c.$slots,"default")]),_:3},16))}}),ZE=KE,JE=be({__name:"MenuRootContentModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const i=t,s=e,r=ds(i,s),n=ql(),{forwardRef:o,currentElement:a}=Ut();return NI(a),(l,u)=>(fe(),_e(P1,vt(M(r),{ref:M(o),"trap-focus":M(n).open.value,"disable-outside-pointer-events":M(n).open.value,"disable-outside-scroll":!0,onDismiss:u[0]||(u[0]=c=>M(n).onOpenChange(!1)),onFocusOutside:u[1]||(u[1]=w3(c=>s("focusOutside",c),["prevent"]))}),{default:ae(()=>[Re(l.$slots,"default")]),_:3},16,["trap-focus","disable-outside-pointer-events"]))}}),QE=JE,eM=be({__name:"MenuRootContentNonModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const r=ds(t,e),n=ql();return(o,a)=>(fe(),_e(P1,vt(M(r),{"trap-focus":!1,"disable-outside-pointer-events":!1,"disable-outside-scroll":!1,onDismiss:a[0]||(a[0]=l=>M(n).onOpenChange(!1))}),{default:ae(()=>[Re(o.$slots,"default")]),_:3},16))}}),tM=eM,iM=be({__name:"MenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const r=ds(t,e),n=ql(),o=k0();return(a,l)=>(fe(),_e(M(YI),{present:a.forceMount||M(n).open.value},{default:ae(()=>[M(o).modal.value?(fe(),_e(QE,Ni(vt({key:0},{...a.$attrs,...M(r)})),{default:ae(()=>[Re(a.$slots,"default")]),_:3},16)):(fe(),_e(tM,Ni(vt({key:1},{...a.$attrs,...M(r)})),{default:ae(()=>[Re(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),sM=iM,rM=be({__name:"MenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const e=t;return(i,s)=>(fe(),_e(M(yP),Ni(cs(e)),{default:ae(()=>[Re(i.$slots,"default")]),_:3},16))}}),nM=rM;const[E1,oM]=hs("DropdownMenuRoot");var aM=be({__name:"DropdownMenuRoot",props:{defaultOpen:{type:Boolean,required:!1},open:{type:Boolean,required:!1,default:void 0},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:e}){const i=t,s=e;Ut();const r=m0(i,"open",s,{defaultValue:i.defaultOpen,passive:i.open===void 0}),n=K(),{modal:o,dir:a}=Hi(i),l=Hl(a);return oM({open:r,onOpenChange:u=>{r.value=u},onOpenToggle:()=>{r.value=!r.value},triggerId:"",triggerElement:n,contentId:"",modal:o,dir:l}),(u,c)=>(fe(),_e(M($E),{open:M(r),"onUpdate:open":c[0]||(c[0]=h=>je(r)?r.value=h:null),dir:M(l),modal:M(o)},{default:ae(()=>[Re(u.$slots,"default",{open:M(r)})]),_:3},8,["open","dir","modal"]))}}),lM=aM,cM=be({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(t,{emit:e}){const r=ds(t,e);Ut();const n=E1(),o=K(!1);function a(l){l.defaultPrevented||(o.value||setTimeout(()=>{n.triggerElement.value?.focus()},0),o.value=!1,l.preventDefault())}return n.contentId||=Mo(void 0,"reka-dropdown-menu-content"),(l,u)=>(fe(),_e(M(sM),vt(M(r),{id:M(n).contentId,"aria-labelledby":M(n)?.triggerId,style:{"--reka-dropdown-menu-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-dropdown-menu-content-available-width":"var(--reka-popper-available-width)","--reka-dropdown-menu-content-available-height":"var(--reka-popper-available-height)","--reka-dropdown-menu-trigger-width":"var(--reka-popper-anchor-width)","--reka-dropdown-menu-trigger-height":"var(--reka-popper-anchor-height)"},onCloseAutoFocus:a,onInteractOutside:u[0]||(u[0]=c=>{if(c.defaultPrevented)return;const h=c.detail.originalEvent,f=h.button===0&&h.ctrlKey===!0,d=h.button===2||f;(!M(n).modal.value||d)&&(o.value=!0),M(n).triggerElement.value?.contains(c.target)&&c.preventDefault()})}),{default:ae(()=>[Re(l.$slots,"default")]),_:3},16,["id","aria-labelledby"]))}}),uM=cM,hM=be({__name:"DropdownMenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(t,{emit:e}){const i=t,r=u1(e);return Ut(),(n,o)=>(fe(),_e(M(ZE),Ni(cs({...i,...M(r)})),{default:ae(()=>[Re(n.$slots,"default")]),_:3},16))}}),dM=hM,fM=be({__name:"DropdownMenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const e=t;return(i,s)=>(fe(),_e(M(nM),Ni(cs(e)),{default:ae(()=>[Re(i.$slots,"default")]),_:3},16))}}),pM=fM,mM=be({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const e=t,i=E1(),{forwardRef:s,currentElement:r}=Ut();return br(()=>{i.triggerElement=r}),i.triggerId||=Mo(void 0,"reka-dropdown-menu-trigger"),(n,o)=>(fe(),_e(M(LE),{"as-child":""},{default:ae(()=>[oe(M(Si),{id:M(i).triggerId,ref:M(s),type:n.as==="button"?"button":void 0,"as-child":e.asChild,as:n.as,"aria-haspopup":"menu","aria-expanded":M(i).open.value,"aria-controls":M(i).open.value?M(i).contentId:void 0,"data-disabled":n.disabled?"":void 0,disabled:n.disabled,"data-state":M(i).open.value?"open":"closed",onClick:o[0]||(o[0]=async a=>{!n.disabled&&a.button===0&&a.ctrlKey===!1&&(M(i)?.onOpenToggle(),await Rt(),M(i).open.value&&a.preventDefault())}),onKeydown:o[1]||(o[1]=C3(a=>{n.disabled||(["Enter"," "].includes(a.key)&&M(i).onOpenToggle(),a.key==="ArrowDown"&&M(i).onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())},["enter","space","arrow-down"]))},{default:ae(()=>[Re(n.$slots,"default")]),_:3},8,["id","type","as-child","as","aria-expanded","aria-controls","data-disabled","disabled","data-state"])]),_:3}))}}),gM=mM;function Te(t,e="Assertion failed!"){if(!t)throw console.error(e),new Error(e)}function M1(t,e=document){if(!Eo)return null;if(e instanceof HTMLElement&&e?.dataset?.panelGroupId===t)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return i||null}function Yl(t,e=document){if(!Eo)return null;const i=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return i||null}function F1(t,e,i=document){return Eo?go(t,i).findIndex(n=>n.getAttribute("data-panel-resize-handle-id")===e)??null:null}function go(t,e=document){return Eo?Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`)):[]}function yM(t,e,i,s=document){const r=Yl(e,s),n=go(t,s),o=r?n.indexOf(r):-1,a=i[o]?.id??null,l=i[o+1]?.id??null;return[a,l]}function R1(t){return t.type==="keydown"}function z1(t){return t.type.startsWith("mouse")}function U1(t){return t.type.startsWith("touch")}function Xl(t){if(z1(t))return{x:t.clientX,y:t.clientY};if(U1(t)){const e=t.touches[0];if(e&&e.clientX&&e.clientY)return{x:e.clientX,y:e.clientY}}return{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY}}function B1(t,e){const i=t==="horizontal",{x:s,y:r}=Xl(e);return i?s:r}function vM(t,e,i,s,r){const n=i==="horizontal",o=Yl(e,r);Te(o);const a=o.getAttribute("data-panel-group-id");Te(a);const{initialCursorPosition:l}=s,u=B1(i,t),c=M1(a,r);Te(c);const h=c.getBoundingClientRect(),f=n?h.width:h.height;return(u-l)/f*100}function xM(t,e,i,s,r,n){if(R1(t)){const o=i==="horizontal";let a=0;t.shiftKey?a=100:a=r??10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return s==null?0:vM(t,e,i,s,n)}function bM({layout:t,panelsArray:e,pivotIndices:i}){let s=0,r=100,n=0,o=0;const a=i[0];Te(a!=null),e.forEach((h,f)=>{const{constraints:d}=h,{maxSize:p=100,minSize:m=0}=d;f===a?(s=m,r=p):(n+=m,o+=p)});const l=Math.min(r,100-n),u=Math.max(s,100-o),c=t[a];return{valueMax:l,valueMin:u,valueNow:c}}function _M({panelDataArray:t}){const e=Array.from({length:t.length}),i=t.map(n=>n.constraints);let s=0,r=100;for(let n=0;n<t.length;n++){const o=i[n];Te(o);const{defaultSize:a}=o;a!=null&&(s++,e[n]=a,r-=a)}for(let n=0;n<t.length;n++){const o=i[n];Te(o);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-s,u=r/l;s++,e[n]=u,r-=u}return e}function _n(t,e,i){e.forEach((s,r)=>{const n=t[r];Te(n);const{callbacks:o,constraints:a,id:l}=n,{collapsedSize:u=0,collapsible:c}=a,h=i[l];if(h==null||s!==h){i[l]=s;const{onCollapse:f,onExpand:d,onResize:p}=o;p&&p(s,h),c&&(f||d)&&(d&&(h==null||h===u)&&s!==u&&d(),f&&(h==null||h!==u)&&s===u&&f())}})}function wM(t,e=10){let i=null;return(...r)=>{i!==null&&clearTimeout(i),i=setTimeout(()=>{t(...r)},e)}}const A0=10;function yo(t,e,i=A0){t=Number.parseFloat(t.toFixed(i)),e=Number.parseFloat(e.toFixed(i));const s=t-e;return s===0?0:s>0?1:-1}function $t(t,e,i){return yo(t,e,i)===0}function Nr({panelConstraints:t,panelIndex:e,size:i}){const s=t[e];Te(s!=null);const{collapsedSize:r=0,collapsible:n,maxSize:o=100,minSize:a=0}=s;if(yo(i,a)<0)if(n){const l=(r+a)/2;yo(i,l)<0?i=r:i=a}else i=a;return i=Math.min(o,i),i=Number.parseFloat(i.toFixed(A0)),i}function Xo(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function Un({delta:t,layout:e,panelConstraints:i,pivotIndices:s,trigger:r}){if($t(t,0))return e;const n=[...e],[o,a]=s;Te(o!=null),Te(a!=null);let l=0;if(r==="keyboard"){{const c=t<0?a:o,h=i[c];if(Te(h),h.collapsible){const f=e[c];Te(f!=null);const d=i[c];Te(d);const{collapsedSize:p=0,minSize:m=0}=d;if($t(f,p)){const g=m-f;yo(g,Math.abs(t))>0&&(t=t<0?0-g:g)}}}{const c=t<0?o:a,h=i[c];Te(h);const{collapsible:f}=h;if(f){const d=e[c];Te(d!=null);const p=i[c];Te(p);const{collapsedSize:m=0,minSize:g=0}=p;if($t(d,g)){const y=d-m;yo(y,Math.abs(t))>0&&(t=t<0?0-y:y)}}}}{const c=t<0?1:-1;let h=t<0?a:o,f=0;for(;;){const p=e[h];Te(p!=null);const g=Nr({panelConstraints:i,panelIndex:h,size:100})-p;if(f+=g,h+=c,h<0||h>=i.length)break}const d=Math.min(Math.abs(t),Math.abs(f));t=t<0?0-d:d}{let h=t<0?o:a;for(;h>=0&&h<i.length;){const f=Math.abs(t)-Math.abs(l),d=e[h];Te(d!=null);const p=d-f,m=Nr({panelConstraints:i,panelIndex:h,size:p});if(!$t(d,m)&&(l+=d-m,n[h]=m,l.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?h--:h++}}if($t(l,0))return e;{const c=t<0?a:o,h=e[c];Te(h!=null);const f=h+l,d=Nr({panelConstraints:i,panelIndex:c,size:f});if(n[c]=d,!$t(d,f)){let p=f-d,g=t<0?a:o;for(;g>=0&&g<i.length;){const y=n[g];Te(y!=null);const b=y+p,v=Nr({panelConstraints:i,panelIndex:g,size:b});if($t(y,v)||(p-=v-y,n[g]=v),$t(p,0))break;t>0?g--:g++}}}const u=n.reduce((c,h)=>h+c,0);return $t(u,100)?n:e}function O1(t,e,i){const s=F1(t,e,i);return s!=null?[s,s+1]:[-1,-1]}function SM(t,e,i){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function CM(t,e){if(t===e)throw new Error("Cannot compare node with itself");const i={a:gv(t),b:gv(e)};let s;for(;i.a.at(-1)===i.b.at(-1);)t=i.a.pop(),e=i.b.pop(),s=t;Te(s);const r={a:mv(pv(i.a)),b:mv(pv(i.b))};if(r.a===r.b){const n=s.childNodes,o={a:i.a.at(-1),b:i.b.at(-1)};let a=n.length;for(;a--;){const l=n[a];if(l===o.a)return 1;if(l===o.b)return-1}}return Math.sign(r.a-r.b)}const TM=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function kM(t){const e=getComputedStyle(D1(t)).display;return e==="flex"||e==="inline-flex"}function AM(t){const e=getComputedStyle(t);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||kM(t))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||TM.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function pv(t){let e=t.length;for(;e--;){const i=t[e];if(Te(i),AM(i))return i}return null}function mv(t){return t&&Number(getComputedStyle(t).zIndex)||0}function gv(t){const e=[];for(;t;)e.push(t),t=D1(t);return e}function D1(t){return t.parentNode instanceof DocumentFragment&&t.parentNode?.host||t.parentNode}const L1=1,N1=2,H1=4,G1=8;function IM(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}const PM=IM()==="coarse",Ds=[];let jl=!1;const ks=new Map,Kl=new Map,vo=new Set;function EM(t,e,i,s,r,n){const{ownerDocument:o}=e,a={direction:i,element:e,hitAreaMargins:s,nonce:r,setResizeHandlerState:n},l=ks.get(o)??0;return ks.set(o,l+1),vo.add(a),ul(),function(){Kl.delete(t),vo.delete(a);const c=ks.get(o)??1;ks.set(o,c-1),ul(),V1(),c===1&&ks.delete(o)}}function jo(t){const{target:e}=t,{x:i,y:s}=Xl(t);jl=!0,I0({target:e,x:i,y:s}),ul(),Ds.length>0&&(P0("down",t),t.preventDefault())}function fs(t){const{x:e,y:i}=Xl(t);if(!jl){const{target:s}=t;I0({target:s,x:e,y:i})}P0("move",t),W1(),Ds.length>0&&t.preventDefault()}function ps(t){const{target:e}=t,{x:i,y:s}=Xl(t);Kl.clear(),jl=!1,Ds.length>0&&t.preventDefault(),P0("up",t),I0({target:e,x:i,y:s}),W1(),ul()}function I0({target:t,x:e,y:i}){Ds.splice(0);let s=null;t instanceof HTMLElement&&(s=t),vo.forEach(r=>{const{element:n,hitAreaMargins:o}=r,a=n.getBoundingClientRect(),{bottom:l,left:u,right:c,top:h}=a,f=PM?o.coarse:o.fine;if(e>=u-f&&e<=c+f&&i>=h-f&&i<=l+f){if(s!==null&&n!==s&&!n.contains(s)&&!s.contains(n)&&CM(s,n)>0){let p=s,m=!1;for(;p&&!p.contains(n);){if(SM(p.getBoundingClientRect(),a)){m=!0;break}p=p.parentElement}if(m)return}Ds.push(r)}})}function Pc(t,e){Kl.set(t,e)}function W1(){let t=!1,e=!1,i;Ds.forEach(r=>{const{direction:n,nonce:o}=r;n.value==="horizontal"?t=!0:e=!0,i=o.value});let s=0;Kl.forEach(r=>{s|=r}),t&&e?Ec("intersection",s,i):t?Ec("horizontal",s,i):e?Ec("vertical",s,i):V1()}function ul(){ks.forEach((t,e)=>{const{body:i}=e;i.removeEventListener("contextmenu",ps),i.removeEventListener("mousedown",jo),i.removeEventListener("mouseleave",fs),i.removeEventListener("mousemove",fs),i.removeEventListener("touchmove",fs),i.removeEventListener("touchstart",jo)}),window.removeEventListener("mouseup",ps),window.removeEventListener("touchcancel",ps),window.removeEventListener("touchend",ps),vo.size>0&&(jl?(Ds.length>0&&ks.forEach((t,e)=>{const{body:i}=e;t>0&&(i.addEventListener("contextmenu",ps),i.addEventListener("mouseleave",fs),i.addEventListener("mousemove",fs),i.addEventListener("touchmove",fs,{passive:!1}))}),window.addEventListener("mouseup",ps),window.addEventListener("touchcancel",ps),window.addEventListener("touchend",ps)):ks.forEach((t,e)=>{const{body:i}=e;t>0&&(i.addEventListener("mousedown",jo),i.addEventListener("mousemove",fs),i.addEventListener("touchmove",fs,{passive:!1}),i.addEventListener("touchstart",jo))}))}function P0(t,e){vo.forEach(i=>{const{setResizeHandlerState:s}=i,r=Ds.includes(i);s(t,r,e)})}let ig=null,As=null;function MM(t,e){if(e){const i=(e&L1)!==0,s=(e&N1)!==0,r=(e&H1)!==0,n=(e&G1)!==0;if(i)return r?"se-resize":n?"ne-resize":"e-resize";if(s)return r?"sw-resize":n?"nw-resize":"w-resize";if(r)return"s-resize";if(n)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function V1(){As!==null&&(document.head.removeChild(As),ig=null,As=null)}function Ec(t,e,i){const s=MM(t,e);ig!==s&&(ig=s,As===null&&(As=document.createElement("style"),i&&(As.nonce=i),document.head.appendChild(As)),As.innerHTML=`*{cursor: ${s}!important;}`)}function FM({defaultSize:t,dragState:e,layout:i,panelData:s,panelIndex:r,precision:n=3}){const o=i[r];let a;return o==null?a=t!==void 0?t.toPrecision(n):"1":s.length===1?a="1":a=o.toPrecision(n),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function RM({layout:t,panelConstraints:e}){const i=[...t],s=i.reduce((n,o)=>n+o,0);if(i.length!==e.length)throw new Error(`Invalid ${e.length} panel layout: ${i.map(n=>`${n}%`).join(", ")}`);if(!$t(s,100)){console.warn(`WARNING: Invalid layout total size: ${i.map(n=>`${n}%`).join(", ")}. Layout normalization will be applied.`);for(let n=0;n<e.length;n++){const o=i[n];Te(o!=null);const a=100/s*o;i[n]=a}}let r=0;for(let n=0;n<e.length;n++){const o=i[n];Te(o!=null);const a=Nr({panelConstraints:e,panelIndex:n,size:o});o!==a&&(r+=o-a,i[n]=a)}if(!$t(r,0))for(let n=0;n<e.length;n++){const o=i[n];Te(o!=null);const a=o+r,l=Nr({panelConstraints:e,panelIndex:n,size:a});if(o!==l&&(r-=l-o,i[n]=l,$t(r,0)))break}return i}function zM({eagerValuesRef:t,groupId:e,layout:i,panelDataArray:s,panelGroupElement:r,setLayout:n}){Tt(o=>{const a=r.value;if(!a)return;const l=go(e,a);for(let u=0;u<s.length-1;u++){const{valueMax:c,valueMin:h,valueNow:f}=bM({layout:i.value,panelsArray:s,pivotIndices:[u,u+1]}),d=l[u];if(d!=null){const p=s[u];Te(p),d.setAttribute("aria-controls",p.id),d.setAttribute("aria-valuemax",`${Math.round(c)}`),d.setAttribute("aria-valuemin",`${Math.round(h)}`),d.setAttribute("aria-valuenow",f!=null?`${Math.round(f)}`:"")}}o(()=>{l.forEach(u=>{u.removeAttribute("aria-controls"),u.removeAttribute("aria-valuemax"),u.removeAttribute("aria-valuemin"),u.removeAttribute("aria-valuenow")})})}),Tt(o=>{const a=r.value;if(!a)return;const l=t.value;Te(l);const{panelDataArray:u}=l,c=M1(e,a);Te(c!=null,`No group found for id "${e}"`);const h=go(e,a);Te(h);const f=h.map(d=>{const p=d.getAttribute("data-panel-resize-handle-id");Te(p);const[m,g]=yM(e,p,u,a);if(m==null||g==null)return()=>{};const y=b=>{if(!b.defaultPrevented)switch(b.key){case"Enter":{b.preventDefault();const v=u.findIndex(x=>x.id===m);if(v>=0){const x=u[v];Te(x);const _=i.value[v],{collapsedSize:S=0,collapsible:T,minSize:A=0}=x.constraints;if(_!=null&&T){const w=Un({delta:$t(_,S)?A-S:S-_,layout:i.value,panelConstraints:u.map(k=>k.constraints),pivotIndices:O1(e,p,a),trigger:"keyboard"});i.value!==w&&n(w)}}break}}};return d.addEventListener("keydown",y),()=>{d.removeEventListener("keydown",y)}});o(()=>{f.forEach(d=>d())})})}function yv(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,i)=>{localStorage.setItem(e,i)};else throw new TypeError("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function $1(t){return`reka:${t}`}function q1(t){return t.map(e=>{const{constraints:i,id:s,idIsFromProps:r,order:n}=e;return r?s:n?`${n}:${JSON.stringify(i)}`:JSON.stringify(i)}).sort((e,i)=>e.localeCompare(i)).join(",")}function Y1(t,e){try{const i=$1(t),s=e.getItem(i);if(s){const r=JSON.parse(s);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function UM(t,e,i){const s=Y1(t,i)??{},r=q1(e);return s[r]??null}function BM(t,e,i,s,r){const n=$1(t),o=q1(e),a=Y1(t,r)??{};a[o]={expandToSizes:Object.fromEntries(i.entries()),layout:s};try{r.setItem(n,JSON.stringify(a))}catch(l){console.error(l)}}const OM=100,Bn={getItem:t=>(yv(Bn),Bn.getItem(t)),setItem:(t,e)=>{yv(Bn),Bn.setItem(t,e)}},[X1,DM]=hs("PanelGroup");var LM=be({__name:"SplitterGroup",props:{id:{type:[String,null],required:!1},autoSaveId:{type:[String,null],required:!1,default:null},direction:{type:String,required:!0},keyboardResizeBy:{type:[Number,null],required:!1,default:10},storage:{type:Object,required:!1,default:()=>Bn},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["layout"],setup(t,{emit:e}){const i=t,s=e,r={},{direction:n}=Hi(i),o=Mo(i.id,"reka-splitter-group"),a=Hl(),{forwardRef:l,currentElement:u}=Ut(),c=K(null),h=K([]),f=K({}),d=K(new Map),p=K(0),m=me(()=>({autoSaveId:i.autoSaveId,direction:i.direction,dragState:c.value,id:o,keyboardResizeBy:i.keyboardResizeBy,storage:i.storage})),g=K({layout:h.value,panelDataArray:[],panelDataArrayChanged:!1}),y=I=>h.value=I;zM({eagerValuesRef:g,groupId:o,layout:h,panelDataArray:g.value.panelDataArray,setLayout:y,panelGroupElement:u}),Tt(()=>{const{panelDataArray:I}=g.value,{autoSaveId:E}=i;if(E){if(h.value.length===0||h.value.length!==I.length)return;let U=r[E];U||(U=wM(BM,OM),r[E]=U);const Z=[...I],se=new Map(d.value);U(E,Z,se,h.value,i.storage)}});function b(I,E){const{panelDataArray:U}=g.value,Z=ie(U,I);return FM({defaultSize:E,dragState:c.value,layout:h.value,panelData:U,panelIndex:Z})}function v(I){const{panelDataArray:E}=g.value;E.push(I),E.sort((U,Z)=>{const se=U.order,te=Z.order;return se==null&&te==null?0:se==null?-1:te==null?1:se-te}),g.value.panelDataArrayChanged=!0}lt(()=>g.value.panelDataArrayChanged,()=>{if(g.value.panelDataArrayChanged){g.value.panelDataArrayChanged=!1;const{autoSaveId:I,storage:E}=m.value,{layout:U,panelDataArray:Z}=g.value;let se=null;if(I){const q=UM(I,Z,E);q&&(d.value=new Map(Object.entries(q.expandToSizes)),se=q.layout)}se===null&&(se=_M({panelDataArray:Z}));const te=RM({layout:se,panelConstraints:Z.map(q=>q.constraints)});PI(U,te)||(y(te),g.value.layout=te,s("layout",te),_n(Z,te,f.value))}});function x(I){return function(U){U.preventDefault();const Z=u.value;if(!Z)return()=>null;const{direction:se,dragState:te,id:q,keyboardResizeBy:he}=m.value,{layout:J,panelDataArray:j}=g.value,{initialLayout:ce}=te??{},we=O1(q,I,Z);let ke=xM(U,I,se,te,he,Z);if(ke===0)return;const Ue=se==="horizontal";a.value==="rtl"&&Ue&&(ke=-ke);const Xe=j.map(P=>P.constraints),Ee=Un({delta:ke,layout:ce??J,panelConstraints:Xe,pivotIndices:we,trigger:R1(U)?"keyboard":"mouse-or-touch"}),C=!Xo(J,Ee);(z1(U)||U1(U))&&p.value!==ke&&(p.value=ke,C?Pc(I,0):Ue?Pc(I,ke<0?L1:N1):Pc(I,ke<0?H1:G1)),C&&(y(Ee),g.value.layout=Ee,s("layout",Ee),_n(j,Ee,f.value))}}function _(I,E){const{layout:U,panelDataArray:Z}=g.value,se=Z.map(ce=>ce.constraints),{panelSize:te,pivotIndices:q}=R(Z,I,U);Te(te!=null);const J=ie(Z,I)===Z.length-1?te-E:E-te,j=Un({delta:J,layout:U,panelConstraints:se,pivotIndices:q,trigger:"imperative-api"});Xo(U,j)||(y(j),g.value.layout=j,s("layout",j),_n(Z,j,f.value))}function S(I,E){const{layout:U,panelDataArray:Z}=g.value,se=ie(Z,I);Z[se]=I,g.value.panelDataArrayChanged=!0;const{collapsedSize:te=0,collapsible:q}=E,{collapsedSize:he=0,collapsible:J,maxSize:j=100,minSize:ce=0}=I.constraints,{panelSize:we}=R(Z,I,U);we!==null&&(q&&J&&we===te?te!==he&&_(I,he):we<ce?_(I,ce):we>j&&_(I,j))}function T(I,E){const{direction:U}=m.value,{layout:Z}=g.value;if(!u.value)return;const se=Yl(I,u.value);Te(se);const te=B1(U,E);c.value={dragHandleId:I,dragHandleRect:se.getBoundingClientRect(),initialCursorPosition:te,initialLayout:Z}}function A(){c.value=null}function w(I){const{panelDataArray:E}=g.value,U=ie(E,I);U>=0&&(E.splice(U,1),delete f.value[I.id],g.value.panelDataArrayChanged=!0)}function k(I){const{layout:E,panelDataArray:U}=g.value;if(I.constraints.collapsible){const Z=U.map(he=>he.constraints),{collapsedSize:se=0,panelSize:te,pivotIndices:q}=R(U,I,E);if(Te(te!=null,`Panel size not found for panel "${I.id}"`),te!==se){d.value.set(I.id,te);const J=ie(U,I)===U.length-1?te-se:se-te,j=Un({delta:J,layout:E,panelConstraints:Z,pivotIndices:q,trigger:"imperative-api"});Xo(E,j)||(y(j),g.value.layout=j,s("layout",j),_n(U,j,f.value))}}}function F(I){const{layout:E,panelDataArray:U}=g.value;if(I.constraints.collapsible){const Z=U.map(J=>J.constraints),{collapsedSize:se=0,panelSize:te,minSize:q=0,pivotIndices:he}=R(U,I,E);if(te===se){const J=d.value.get(I.id),j=J!=null&&J>=q?J:q,we=ie(U,I)===U.length-1?te-j:j-te,ke=Un({delta:we,layout:E,panelConstraints:Z,pivotIndices:he,trigger:"imperative-api"});Xo(E,ke)||(y(ke),g.value.layout=ke,s("layout",ke),_n(U,ke,f.value))}}}function O(I){const{layout:E,panelDataArray:U}=g.value,{panelSize:Z}=R(U,I,E);return Te(Z!=null,`Panel size not found for panel "${I.id}"`),Z}function V(I){const{layout:E,panelDataArray:U}=g.value,{collapsedSize:Z=0,collapsible:se,panelSize:te}=R(U,I,E);return se?te===void 0?I.constraints.defaultSize===I.constraints.collapsedSize:te===Z:!1}function W(I){const{layout:E,panelDataArray:U}=g.value,{collapsedSize:Z=0,collapsible:se,panelSize:te}=R(U,I,E);return Te(te!=null,`Panel size not found for panel "${I.id}"`),!se||te>Z}DM({direction:n,dragState:c.value,groupId:o,reevaluatePanelConstraints:S,registerPanel:v,registerResizeHandle:x,resizePanel:_,startDragging:T,stopDragging:A,unregisterPanel:w,panelGroupElement:u,collapsePanel:k,expandPanel:F,isPanelCollapsed:V,isPanelExpanded:W,getPanelSize:O,getPanelStyle:b});function ie(I,E){return I.findIndex(U=>U===E||U.id===E.id)}function R(I,E,U){const Z=ie(I,E),te=Z===I.length-1?[Z-1,Z]:[Z,Z+1],q=U[Z];return{...E.constraints,panelSize:q,pivotIndices:te}}return(I,E)=>(fe(),_e(M(Si),{ref:M(l),as:I.as,"as-child":I.asChild,style:Gs({display:"flex",flexDirection:M(n)==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"}),"data-panel-group":"","data-orientation":M(n),"data-panel-group-id":M(o)},{default:ae(()=>[Re(I.$slots,"default",{layout:h.value})]),_:3},8,["as","as-child","style","data-orientation","data-panel-group-id"]))}}),NM=LM,HM=be({__name:"SplitterPanel",props:{collapsedSize:{type:Number,required:!1},collapsible:{type:Boolean,required:!1},defaultSize:{type:Number,required:!1},id:{type:String,required:!1},maxSize:{type:Number,required:!1},minSize:{type:Number,required:!1},order:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["collapse","expand","resize"],setup(t,{expose:e,emit:i}){const s=t,r=i,n=X1();if(n===null)throw new Error("SplitterPanel components must be rendered within a SplitterGroup container");const{collapsePanel:o,expandPanel:a,getPanelSize:l,getPanelStyle:u,isPanelCollapsed:c,resizePanel:h,groupId:f,reevaluatePanelConstraints:d,registerPanel:p,unregisterPanel:m}=n,g=Mo(s.id,"reka-splitter-panel"),y=me(()=>({callbacks:{onCollapse:()=>r("collapse"),onExpand:()=>r("expand"),onResize:(...A)=>r("resize",...A)},constraints:{collapsedSize:s.collapsedSize&&Number.parseFloat(s.collapsedSize.toFixed(A0)),collapsible:s.collapsible,defaultSize:s.defaultSize,maxSize:s.maxSize,minSize:s.minSize},id:g,idIsFromProps:s.id!==void 0,order:s.order}));lt(()=>y.value.constraints,(A,w)=>{(w.collapsedSize!==A.collapsedSize||w.collapsible!==A.collapsible||w.maxSize!==A.maxSize||w.minSize!==A.minSize)&&d(y.value,w)},{deep:!0}),br(()=>{p(y.value)}),_r(()=>{m(y.value)});const b=me(()=>u(y.value,s.defaultSize)),v=me(()=>c(y.value)),x=me(()=>!v.value);function _(){o(y.value)}function S(){a(y.value)}function T(A){h(y.value,A)}return e({collapse:_,expand:S,getSize(){return l(y.value)},resize:T,isCollapsed:v,isExpanded:x}),(A,w)=>(fe(),_e(M(Si),{id:M(g),style:Gs(b.value),as:A.as,"as-child":A.asChild,"data-panel":"","data-panel-collapsible":A.collapsible||void 0,"data-panel-group-id":M(f),"data-panel-id":M(g),"data-panel-size":Number.parseFloat(`${b.value.flexGrow}`).toFixed(1),"data-state":A.collapsible?v.value?"collapsed":"expanded":void 0},{default:ae(()=>[Re(A.$slots,"default",{isCollapsed:v.value,isExpanded:x.value,expand:S,collapse:_,resize:T})]),_:3},8,["id","style","as","as-child","data-panel-collapsible","data-panel-group-id","data-panel-id","data-panel-size","data-state"]))}}),GM=HM;function WM({disabled:t,handleId:e,resizeHandler:i,panelGroupElement:s}){Tt(r=>{const n=s.value;if(t.value||i.value===null||n===null)return;const o=Yl(e,n);if(o==null)return;const a=l=>{if(!l.defaultPrevented)switch(l.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{l.preventDefault(),i.value?.(l);break}case"F6":{l.preventDefault();const u=o.getAttribute("data-panel-group-id");Te(u);const c=go(u,n),h=F1(u,e,n);Te(h!==null);const f=l.shiftKey?h>0?h-1:c.length-1:h+1<c.length?h+1:0;c[f].focus();break}}};o.addEventListener("keydown",a),r(()=>{o.removeEventListener("keydown",a)})})}var VM=be({__name:"SplitterResizeHandle",props:{id:{type:String,required:!1},hitAreaMargins:{type:Object,required:!1},tabindex:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},nonce:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["dragging"],setup(t,{emit:e}){const i=t,s=e,{forwardRef:r,currentElement:n}=Ut(),{disabled:o}=Hi(i),a=X1();if(a===null)throw new Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:l,groupId:u,registerResizeHandle:c,startDragging:h,stopDragging:f,panelGroupElement:d}=a,p=Mo(i.id,"reka-splitter-resize-handle"),m=K("inactive"),g=K(!1),y=K(null),{nonce:b}=Hi(i),v=OE(b);return lt(o,()=>{Eo&&(o.value?y.value=null:y.value=c(p))},{immediate:!0}),Tt(x=>{if(o.value||y.value===null)return;const _=n.value;if(!_)return;Te(_);const S=(T,A,w)=>{if(A)switch(T){case"down":{m.value="drag",h(p,w),s("dragging",!0);break}case"move":{m.value!=="drag"&&(m.value="hover"),y.value?.(w);break}case"up":{m.value="hover",f(),s("dragging",!1);break}}else m.value="inactive"};x(EM(p,_,l,{coarse:i.hitAreaMargins?.coarse??15,fine:i.hitAreaMargins?.fine??5},v,S))}),WM({disabled:o,resizeHandler:y,handleId:p,panelGroupElement:d}),(x,_)=>(fe(),_e(M(Si),{id:M(p),ref:M(r),style:{touchAction:"none",userSelect:"none"},as:x.as,"as-child":x.asChild,role:"separator","data-resize-handle":"",tabindex:x.tabindex,"data-state":m.value,"data-disabled":M(o)?"":void 0,"data-orientation":M(l),"data-panel-group-id":M(u),"data-resize-handle-active":m.value==="drag"?"pointer":g.value?"keyboard":void 0,"data-resize-handle-state":m.value,"data-panel-resize-handle-enabled":!M(o),"data-panel-resize-handle-id":M(p),onBlur:_[0]||(_[0]=S=>g.value=!1),onFocus:_[1]||(_[1]=S=>g.value=!1)},{default:ae(()=>[Re(x.$slots,"default")]),_:3},8,["id","as","as-child","tabindex","data-state","data-disabled","data-orientation","data-panel-group-id","data-resize-handle-active","data-resize-handle-state","data-panel-resize-handle-enabled","data-panel-resize-handle-id"]))}}),$M=VM;function j1(t){var e,i,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(i=j1(t[e]))&&(s&&(s+=" "),s+=i)}else for(i in t)t[i]&&(s&&(s+=" "),s+=i);return s}function K1(){for(var t,e,i=0,s="",r=arguments.length;i<r;i++)(t=arguments[i])&&(e=j1(t))&&(s&&(s+=" "),s+=e);return s}const qM=(t,e)=>{const i=new Array(t.length+e.length);for(let s=0;s<t.length;s++)i[s]=t[s];for(let s=0;s<e.length;s++)i[t.length+s]=e[s];return i},YM=(t,e)=>({classGroupId:t,validator:e}),Z1=(t=new Map,e=null,i)=>({nextPart:t,validators:e,classGroupId:i}),hl="-",vv=[],XM="arbitrary..",jM=t=>{const e=ZM(t),{conflictingClassGroups:i,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return KM(o);const a=o.split(hl),l=a[0]===""&&a.length>1?1:0;return J1(a,l,e)},getConflictingClassGroupIds:(o,a)=>{if(a){const l=s[o],u=i[o];return l?u?qM(u,l):l:u||vv}return i[o]||vv}}},J1=(t,e,i)=>{if(t.length-e===0)return i.classGroupId;const r=t[e],n=i.nextPart.get(r);if(n){const u=J1(t,e+1,n);if(u)return u}const o=i.validators;if(o===null)return;const a=e===0?t.join(hl):t.slice(e).join(hl),l=o.length;for(let u=0;u<l;u++){const c=o[u];if(c.validator(a))return c.classGroupId}},KM=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),i=e.indexOf(":"),s=e.slice(0,i);return s?XM+s:void 0})(),ZM=t=>{const{theme:e,classGroups:i}=t;return JM(i,e)},JM=(t,e)=>{const i=Z1();for(const s in t){const r=t[s];E0(r,i,s,e)}return i},E0=(t,e,i,s)=>{const r=t.length;for(let n=0;n<r;n++){const o=t[n];QM(o,e,i,s)}},QM=(t,e,i,s)=>{if(typeof t=="string"){eF(t,e,i);return}if(typeof t=="function"){tF(t,e,i,s);return}iF(t,e,i,s)},eF=(t,e,i)=>{const s=t===""?e:Q1(e,t);s.classGroupId=i},tF=(t,e,i,s)=>{if(sF(t)){E0(t(s),e,i,s);return}e.validators===null&&(e.validators=[]),e.validators.push(YM(i,t))},iF=(t,e,i,s)=>{const r=Object.entries(t),n=r.length;for(let o=0;o<n;o++){const[a,l]=r[o];E0(l,Q1(e,a),i,s)}},Q1=(t,e)=>{let i=t;const s=e.split(hl),r=s.length;for(let n=0;n<r;n++){const o=s[n];let a=i.nextPart.get(o);a||(a=Z1(),i.nextPart.set(o,a)),i=a}return i},sF=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,rF=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,i=Object.create(null),s=Object.create(null);const r=(n,o)=>{i[n]=o,e++,e>t&&(e=0,s=i,i=Object.create(null))};return{get(n){let o=i[n];if(o!==void 0)return o;if((o=s[n])!==void 0)return r(n,o),o},set(n,o){n in i?i[n]=o:r(n,o)}}},sg="!",xv=":",nF=[],bv=(t,e,i,s,r)=>({modifiers:t,hasImportantModifier:e,baseClassName:i,maybePostfixModifierPosition:s,isExternal:r}),oF=t=>{const{prefix:e,experimentalParseClassName:i}=t;let s=r=>{const n=[];let o=0,a=0,l=0,u;const c=r.length;for(let m=0;m<c;m++){const g=r[m];if(o===0&&a===0){if(g===xv){n.push(r.slice(l,m)),l=m+1;continue}if(g==="/"){u=m;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const h=n.length===0?r:r.slice(l);let f=h,d=!1;h.endsWith(sg)?(f=h.slice(0,-1),d=!0):h.startsWith(sg)&&(f=h.slice(1),d=!0);const p=u&&u>l?u-l:void 0;return bv(n,d,f,p)};if(e){const r=e+xv,n=s;s=o=>o.startsWith(r)?n(o.slice(r.length)):bv(nF,!1,o,void 0,!0)}if(i){const r=s;s=n=>i({className:n,parseClassName:r})}return s},aF=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((i,s)=>{e.set(i,1e6+s)}),i=>{const s=[];let r=[];for(let n=0;n<i.length;n++){const o=i[n],a=o[0]==="[",l=e.has(o);a||l?(r.length>0&&(r.sort(),s.push(...r),r=[]),s.push(o)):r.push(o)}return r.length>0&&(r.sort(),s.push(...r)),s}},lF=t=>({cache:rF(t.cacheSize),parseClassName:oF(t),sortModifiers:aF(t),...jM(t)}),cF=/\s+/,uF=(t,e)=>{const{parseClassName:i,getClassGroupId:s,getConflictingClassGroupIds:r,sortModifiers:n}=e,o=[],a=t.trim().split(cF);let l="";for(let u=a.length-1;u>=0;u-=1){const c=a[u],{isExternal:h,modifiers:f,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:m}=i(c);if(h){l=c+(l.length>0?" "+l:l);continue}let g=!!m,y=s(g?p.substring(0,m):p);if(!y){if(!g){l=c+(l.length>0?" "+l:l);continue}if(y=s(p),!y){l=c+(l.length>0?" "+l:l);continue}g=!1}const b=f.length===0?"":f.length===1?f[0]:n(f).join(":"),v=d?b+sg:b,x=v+y;if(o.indexOf(x)>-1)continue;o.push(x);const _=r(y,g);for(let S=0;S<_.length;++S){const T=_[S];o.push(v+T)}l=c+(l.length>0?" "+l:l)}return l},hF=(...t)=>{let e=0,i,s,r="";for(;e<t.length;)(i=t[e++])&&(s=ew(i))&&(r&&(r+=" "),r+=s);return r},ew=t=>{if(typeof t=="string")return t;let e,i="";for(let s=0;s<t.length;s++)t[s]&&(e=ew(t[s]))&&(i&&(i+=" "),i+=e);return i},dF=(t,...e)=>{let i,s,r,n;const o=l=>{const u=e.reduce((c,h)=>h(c),t());return i=lF(u),s=i.cache.get,r=i.cache.set,n=a,a(l)},a=l=>{const u=s(l);if(u)return u;const c=uF(l,i);return r(l,c),c};return n=o,(...l)=>n(hF(...l))},fF=[],ot=t=>{const e=i=>i[t]||fF;return e.isThemeGetter=!0,e},tw=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,iw=/^\((?:(\w[\w-]*):)?(.+)\)$/i,pF=/^\d+\/\d+$/,mF=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gF=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yF=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,vF=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,xF=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ar=t=>pF.test(t),Ce=t=>!!t&&!Number.isNaN(Number(t)),ms=t=>!!t&&Number.isInteger(Number(t)),Mc=t=>t.endsWith("%")&&Ce(t.slice(0,-1)),Yi=t=>mF.test(t),bF=()=>!0,_F=t=>gF.test(t)&&!yF.test(t),sw=()=>!1,wF=t=>vF.test(t),SF=t=>xF.test(t),CF=t=>!re(t)&&!ne(t),TF=t=>dn(t,ow,sw),re=t=>tw.test(t),js=t=>dn(t,aw,_F),Fc=t=>dn(t,EF,Ce),_v=t=>dn(t,rw,sw),kF=t=>dn(t,nw,SF),Ko=t=>dn(t,lw,wF),ne=t=>iw.test(t),wn=t=>fn(t,aw),AF=t=>fn(t,MF),wv=t=>fn(t,rw),IF=t=>fn(t,ow),PF=t=>fn(t,nw),Zo=t=>fn(t,lw,!0),dn=(t,e,i)=>{const s=tw.exec(t);return s?s[1]?e(s[1]):i(s[2]):!1},fn=(t,e,i=!1)=>{const s=iw.exec(t);return s?s[1]?e(s[1]):i:!1},rw=t=>t==="position"||t==="percentage",nw=t=>t==="image"||t==="url",ow=t=>t==="length"||t==="size"||t==="bg-size",aw=t=>t==="length",EF=t=>t==="number",MF=t=>t==="family-name",lw=t=>t==="shadow",FF=()=>{const t=ot("color"),e=ot("font"),i=ot("text"),s=ot("font-weight"),r=ot("tracking"),n=ot("leading"),o=ot("breakpoint"),a=ot("container"),l=ot("spacing"),u=ot("radius"),c=ot("shadow"),h=ot("inset-shadow"),f=ot("text-shadow"),d=ot("drop-shadow"),p=ot("blur"),m=ot("perspective"),g=ot("aspect"),y=ot("ease"),b=ot("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],x=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],_=()=>[...x(),ne,re],S=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],A=()=>[ne,re,l],w=()=>[Ar,"full","auto",...A()],k=()=>[ms,"none","subgrid",ne,re],F=()=>["auto",{span:["full",ms,ne,re]},ms,ne,re],O=()=>[ms,"auto",ne,re],V=()=>["auto","min","max","fr",ne,re],W=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ie=()=>["start","end","center","stretch","center-safe","end-safe"],R=()=>["auto",...A()],I=()=>[Ar,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...A()],E=()=>[t,ne,re],U=()=>[...x(),wv,_v,{position:[ne,re]}],Z=()=>["no-repeat",{repeat:["","x","y","space","round"]}],se=()=>["auto","cover","contain",IF,TF,{size:[ne,re]}],te=()=>[Mc,wn,js],q=()=>["","none","full",u,ne,re],he=()=>["",Ce,wn,js],J=()=>["solid","dashed","dotted","double"],j=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ce=()=>[Ce,Mc,wv,_v],we=()=>["","none",p,ne,re],ke=()=>["none",Ce,ne,re],Ue=()=>["none",Ce,ne,re],Xe=()=>[Ce,ne,re],Ee=()=>[Ar,"full",...A()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yi],breakpoint:[Yi],color:[bF],container:[Yi],"drop-shadow":[Yi],ease:["in","out","in-out"],font:[CF],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yi],shadow:[Yi],spacing:["px",Ce],text:[Yi],"text-shadow":[Yi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ar,re,ne,g]}],container:["container"],columns:[{columns:[Ce,re,ne,a]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:_()}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:w()}],"inset-x":[{"inset-x":w()}],"inset-y":[{"inset-y":w()}],start:[{start:w()}],end:[{end:w()}],top:[{top:w()}],right:[{right:w()}],bottom:[{bottom:w()}],left:[{left:w()}],visibility:["visible","invisible","collapse"],z:[{z:[ms,"auto",ne,re]}],basis:[{basis:[Ar,"full","auto",a,...A()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ce,Ar,"auto","initial","none",re]}],grow:[{grow:["",Ce,ne,re]}],shrink:[{shrink:["",Ce,ne,re]}],order:[{order:[ms,"first","last","none",ne,re]}],"grid-cols":[{"grid-cols":k()}],"col-start-end":[{col:F()}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":k()}],"row-start-end":[{row:F()}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:A()}],"gap-x":[{"gap-x":A()}],"gap-y":[{"gap-y":A()}],"justify-content":[{justify:[...W(),"normal"]}],"justify-items":[{"justify-items":[...ie(),"normal"]}],"justify-self":[{"justify-self":["auto",...ie()]}],"align-content":[{content:["normal",...W()]}],"align-items":[{items:[...ie(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ie(),{baseline:["","last"]}]}],"place-content":[{"place-content":W()}],"place-items":[{"place-items":[...ie(),"baseline"]}],"place-self":[{"place-self":["auto",...ie()]}],p:[{p:A()}],px:[{px:A()}],py:[{py:A()}],ps:[{ps:A()}],pe:[{pe:A()}],pt:[{pt:A()}],pr:[{pr:A()}],pb:[{pb:A()}],pl:[{pl:A()}],m:[{m:R()}],mx:[{mx:R()}],my:[{my:R()}],ms:[{ms:R()}],me:[{me:R()}],mt:[{mt:R()}],mr:[{mr:R()}],mb:[{mb:R()}],ml:[{ml:R()}],"space-x":[{"space-x":A()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":A()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[a,"screen",...I()]}],"min-w":[{"min-w":[a,"screen","none",...I()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",i,wn,js]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,ne,Fc]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Mc,re]}],"font-family":[{font:[AF,re,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,ne,re]}],"line-clamp":[{"line-clamp":[Ce,"none",ne,Fc]}],leading:[{leading:[n,...A()]}],"list-image":[{"list-image":["none",ne,re]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ne,re]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:E()}],"text-color":[{text:E()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...J(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ce,"from-font","auto",ne,js]}],"text-decoration-color":[{decoration:E()}],"underline-offset":[{"underline-offset":[Ce,"auto",ne,re]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ne,re]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ne,re]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:U()}],"bg-repeat":[{bg:Z()}],"bg-size":[{bg:se()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ms,ne,re],radial:["",ne,re],conic:[ms,ne,re]},PF,kF]}],"bg-color":[{bg:E()}],"gradient-from-pos":[{from:te()}],"gradient-via-pos":[{via:te()}],"gradient-to-pos":[{to:te()}],"gradient-from":[{from:E()}],"gradient-via":[{via:E()}],"gradient-to":[{to:E()}],rounded:[{rounded:q()}],"rounded-s":[{"rounded-s":q()}],"rounded-e":[{"rounded-e":q()}],"rounded-t":[{"rounded-t":q()}],"rounded-r":[{"rounded-r":q()}],"rounded-b":[{"rounded-b":q()}],"rounded-l":[{"rounded-l":q()}],"rounded-ss":[{"rounded-ss":q()}],"rounded-se":[{"rounded-se":q()}],"rounded-ee":[{"rounded-ee":q()}],"rounded-es":[{"rounded-es":q()}],"rounded-tl":[{"rounded-tl":q()}],"rounded-tr":[{"rounded-tr":q()}],"rounded-br":[{"rounded-br":q()}],"rounded-bl":[{"rounded-bl":q()}],"border-w":[{border:he()}],"border-w-x":[{"border-x":he()}],"border-w-y":[{"border-y":he()}],"border-w-s":[{"border-s":he()}],"border-w-e":[{"border-e":he()}],"border-w-t":[{"border-t":he()}],"border-w-r":[{"border-r":he()}],"border-w-b":[{"border-b":he()}],"border-w-l":[{"border-l":he()}],"divide-x":[{"divide-x":he()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":he()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...J(),"hidden","none"]}],"divide-style":[{divide:[...J(),"hidden","none"]}],"border-color":[{border:E()}],"border-color-x":[{"border-x":E()}],"border-color-y":[{"border-y":E()}],"border-color-s":[{"border-s":E()}],"border-color-e":[{"border-e":E()}],"border-color-t":[{"border-t":E()}],"border-color-r":[{"border-r":E()}],"border-color-b":[{"border-b":E()}],"border-color-l":[{"border-l":E()}],"divide-color":[{divide:E()}],"outline-style":[{outline:[...J(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ce,ne,re]}],"outline-w":[{outline:["",Ce,wn,js]}],"outline-color":[{outline:E()}],shadow:[{shadow:["","none",c,Zo,Ko]}],"shadow-color":[{shadow:E()}],"inset-shadow":[{"inset-shadow":["none",h,Zo,Ko]}],"inset-shadow-color":[{"inset-shadow":E()}],"ring-w":[{ring:he()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:E()}],"ring-offset-w":[{"ring-offset":[Ce,js]}],"ring-offset-color":[{"ring-offset":E()}],"inset-ring-w":[{"inset-ring":he()}],"inset-ring-color":[{"inset-ring":E()}],"text-shadow":[{"text-shadow":["none",f,Zo,Ko]}],"text-shadow-color":[{"text-shadow":E()}],opacity:[{opacity:[Ce,ne,re]}],"mix-blend":[{"mix-blend":[...j(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":j()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ce]}],"mask-image-linear-from-pos":[{"mask-linear-from":ce()}],"mask-image-linear-to-pos":[{"mask-linear-to":ce()}],"mask-image-linear-from-color":[{"mask-linear-from":E()}],"mask-image-linear-to-color":[{"mask-linear-to":E()}],"mask-image-t-from-pos":[{"mask-t-from":ce()}],"mask-image-t-to-pos":[{"mask-t-to":ce()}],"mask-image-t-from-color":[{"mask-t-from":E()}],"mask-image-t-to-color":[{"mask-t-to":E()}],"mask-image-r-from-pos":[{"mask-r-from":ce()}],"mask-image-r-to-pos":[{"mask-r-to":ce()}],"mask-image-r-from-color":[{"mask-r-from":E()}],"mask-image-r-to-color":[{"mask-r-to":E()}],"mask-image-b-from-pos":[{"mask-b-from":ce()}],"mask-image-b-to-pos":[{"mask-b-to":ce()}],"mask-image-b-from-color":[{"mask-b-from":E()}],"mask-image-b-to-color":[{"mask-b-to":E()}],"mask-image-l-from-pos":[{"mask-l-from":ce()}],"mask-image-l-to-pos":[{"mask-l-to":ce()}],"mask-image-l-from-color":[{"mask-l-from":E()}],"mask-image-l-to-color":[{"mask-l-to":E()}],"mask-image-x-from-pos":[{"mask-x-from":ce()}],"mask-image-x-to-pos":[{"mask-x-to":ce()}],"mask-image-x-from-color":[{"mask-x-from":E()}],"mask-image-x-to-color":[{"mask-x-to":E()}],"mask-image-y-from-pos":[{"mask-y-from":ce()}],"mask-image-y-to-pos":[{"mask-y-to":ce()}],"mask-image-y-from-color":[{"mask-y-from":E()}],"mask-image-y-to-color":[{"mask-y-to":E()}],"mask-image-radial":[{"mask-radial":[ne,re]}],"mask-image-radial-from-pos":[{"mask-radial-from":ce()}],"mask-image-radial-to-pos":[{"mask-radial-to":ce()}],"mask-image-radial-from-color":[{"mask-radial-from":E()}],"mask-image-radial-to-color":[{"mask-radial-to":E()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":x()}],"mask-image-conic-pos":[{"mask-conic":[Ce]}],"mask-image-conic-from-pos":[{"mask-conic-from":ce()}],"mask-image-conic-to-pos":[{"mask-conic-to":ce()}],"mask-image-conic-from-color":[{"mask-conic-from":E()}],"mask-image-conic-to-color":[{"mask-conic-to":E()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:U()}],"mask-repeat":[{mask:Z()}],"mask-size":[{mask:se()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ne,re]}],filter:[{filter:["","none",ne,re]}],blur:[{blur:we()}],brightness:[{brightness:[Ce,ne,re]}],contrast:[{contrast:[Ce,ne,re]}],"drop-shadow":[{"drop-shadow":["","none",d,Zo,Ko]}],"drop-shadow-color":[{"drop-shadow":E()}],grayscale:[{grayscale:["",Ce,ne,re]}],"hue-rotate":[{"hue-rotate":[Ce,ne,re]}],invert:[{invert:["",Ce,ne,re]}],saturate:[{saturate:[Ce,ne,re]}],sepia:[{sepia:["",Ce,ne,re]}],"backdrop-filter":[{"backdrop-filter":["","none",ne,re]}],"backdrop-blur":[{"backdrop-blur":we()}],"backdrop-brightness":[{"backdrop-brightness":[Ce,ne,re]}],"backdrop-contrast":[{"backdrop-contrast":[Ce,ne,re]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ce,ne,re]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ce,ne,re]}],"backdrop-invert":[{"backdrop-invert":["",Ce,ne,re]}],"backdrop-opacity":[{"backdrop-opacity":[Ce,ne,re]}],"backdrop-saturate":[{"backdrop-saturate":[Ce,ne,re]}],"backdrop-sepia":[{"backdrop-sepia":["",Ce,ne,re]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":A()}],"border-spacing-x":[{"border-spacing-x":A()}],"border-spacing-y":[{"border-spacing-y":A()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ne,re]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ce,"initial",ne,re]}],ease:[{ease:["linear","initial",y,ne,re]}],delay:[{delay:[Ce,ne,re]}],animate:[{animate:["none",b,ne,re]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,ne,re]}],"perspective-origin":[{"perspective-origin":_()}],rotate:[{rotate:ke()}],"rotate-x":[{"rotate-x":ke()}],"rotate-y":[{"rotate-y":ke()}],"rotate-z":[{"rotate-z":ke()}],scale:[{scale:Ue()}],"scale-x":[{"scale-x":Ue()}],"scale-y":[{"scale-y":Ue()}],"scale-z":[{"scale-z":Ue()}],"scale-3d":["scale-3d"],skew:[{skew:Xe()}],"skew-x":[{"skew-x":Xe()}],"skew-y":[{"skew-y":Xe()}],transform:[{transform:[ne,re,"","none","gpu","cpu"]}],"transform-origin":[{origin:_()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ee()}],"translate-x":[{"translate-x":Ee()}],"translate-y":[{"translate-y":Ee()}],"translate-z":[{"translate-z":Ee()}],"translate-none":["translate-none"],accent:[{accent:E()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:E()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ne,re]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ne,re]}],fill:[{fill:["none",...E()]}],"stroke-w":[{stroke:[Ce,wn,js,Fc]}],stroke:[{stroke:["none",...E()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},RF=dF(FF);function Ro(...t){return RF(K1(t))}const zF={key:0,class:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border"},Rc=be({__name:"ResizableHandle",props:{id:{},hitAreaMargins:{},tabindex:{},disabled:{type:Boolean},nonce:{},asChild:{type:Boolean},as:{},class:{},withHandle:{type:Boolean}},emits:["dragging"],setup(t,{emit:e}){const i=t,s=e,r=Nl(i,"class","withHandle"),n=ds(r,s);return(o,a)=>(fe(),_e(M($M),vt({"data-slot":"resizable-handle"},M(n),{class:M(Ro)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[orientation=vertical]:h-px data-[orientation=vertical]:w-full data-[orientation=vertical]:after:left-0 data-[orientation=vertical]:after:h-1 data-[orientation=vertical]:after:w-full data-[orientation=vertical]:after:-translate-y-1/2 data-[orientation=vertical]:after:translate-x-0 [&[data-orientation=vertical]>div]:rotate-90",i.class)}),{default:ae(()=>[i.withHandle?(fe(),dr("div",zF,[Re(o.$slots,"default",{},()=>[oe(M(TI),{class:"size-2.5"})])])):i0("",!0)]),_:3},16,["class"]))}}),Sn=be({__name:"ResizablePanel",props:{collapsedSize:{},collapsible:{type:Boolean},defaultSize:{},id:{},maxSize:{},minSize:{},order:{},asChild:{type:Boolean},as:{}},emits:["collapse","expand","resize"],setup(t,{emit:e}){const r=ds(t,e),{forwardRef:n}=Ut();return(o,a)=>(fe(),_e(M(GM),vt({ref:M(n),"data-slot":"resizable-panel"},M(r)),{default:ae(l=>[Re(o.$slots,"default",Ni(cs(l)))]),_:3},16))}}),Sv=be({__name:"ResizablePanelGroup",props:{id:{},autoSaveId:{},direction:{},keyboardResizeBy:{},storage:{},asChild:{type:Boolean},as:{},class:{}},emits:["layout"],setup(t,{emit:e}){const i=t,s=e,r=Nl(i,"class"),n=ds(r,s);return(o,a)=>(fe(),_e(M(NM),vt({"data-slot":"resizable-panel-group"},M(n),{class:M(Ro)("flex h-full w-full data-[orientation=vertical]:flex-col",i.class)}),{default:ae(l=>[Re(o.$slots,"default",Ni(cs(l)))]),_:3},16,["class"]))}}),UF=be({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(t,{emit:e}){const r=ds(t,e);return(n,o)=>(fe(),_e(M(lM),vt({"data-slot":"dropdown-menu"},M(r)),{default:ae(a=>[Re(n.$slots,"default",Ni(cs(a)))]),_:3},16))}}),BF=be({inheritAttrs:!1,__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},hideShiftedArrow:{type:Boolean},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(t,{emit:e}){const i=t,s=e,r=Nl(i,"class"),n=ds(r,s);return(o,a)=>(fe(),_e(M(pM),null,{default:ae(()=>[oe(M(uM),vt({"data-slot":"dropdown-menu-content"},{...o.$attrs,...M(n)},{class:M(Ro)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--reka-dropdown-menu-content-available-height) min-w-[8rem] origin-(--reka-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",i.class)}),{default:ae(()=>[Re(o.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),zc=be({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean},variant:{default:"default"}},setup(t){const e=t,i=Nl(e,"inset","variant","class"),s=v0(i);return(r,n)=>(fe(),_e(M(dM),vt({"data-slot":"dropdown-menu-item","data-inset":t.inset?"":void 0,"data-variant":t.variant},M(s),{class:M(Ro)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)}),{default:ae(()=>[Re(r.$slots,"default")]),_:3},16,["data-inset","data-variant","class"]))}}),OF=be({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(t){const i=v0(t);return(s,r)=>(fe(),_e(M(gM),vt({"data-slot":"dropdown-menu-trigger"},M(i)),{default:ae(()=>[Re(s.$slots,"default")]),_:3},16))}}),Cv=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Tv=K1,DF=(t,e)=>i=>{var s;if(e?.variants==null)return Tv(t,i?.class,i?.className);const{variants:r,defaultVariants:n}=e,o=Object.keys(r).map(u=>{const c=i?.[u],h=n?.[u];if(c===null)return null;const f=Cv(c)||Cv(h);return r[u][f]}),a=i&&Object.entries(i).reduce((u,c)=>{let[h,f]=c;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,c)=>{let{class:h,className:f,...d}=c;return Object.entries(d).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...n,...a}[m]):{...n,...a}[m]===g})?[...u,h,f]:u},[]);return Tv(t,o,l,i?.class,i?.className)},Ks=be({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(t){const e=t;return(i,s)=>(fe(),_e(M(Si),{"data-slot":"button",as:t.as,"as-child":t.asChild,class:Ao(M(Ro)(M(LF)({variant:t.variant,size:t.size}),e.class))},{default:ae(()=>[Re(i.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),LF=DF("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}}),kv={ai:t=>Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},[Oe("g",{fill:"none"},[Oe("path",{fill:"currentColor","fill-opacity":"0.16",d:"m9.96 9.137l.886-3.099c.332-1.16 1.976-1.16 2.308 0l.885 3.099a1.2 1.2 0 0 0 .824.824l3.099.885c1.16.332 1.16 1.976 0 2.308l-3.099.885a1.2 1.2 0 0 0-.824.824l-.885 3.099c-.332 1.16-1.976 1.16-2.308 0l-.885-3.099a1.2 1.2 0 0 0-.824-.824l-3.099-.885c-1.16-.332-1.16-1.976 0-2.308l3.099-.885a1.2 1.2 0 0 0 .824-.824"}),Oe("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":"10","stroke-width":"1.5",d:"m9.96 9.137l.886-3.099c.332-1.16 1.976-1.16 2.308 0l.885 3.099a1.2 1.2 0 0 0 .824.824l3.099.885c1.16.332 1.16 1.976 0 2.308l-3.099.885a1.2 1.2 0 0 0-.824.824l-.885 3.099c-.332 1.16-1.976 1.16-2.308 0l-.885-3.099a1.2 1.2 0 0 0-.824-.824l-3.099-.885c-1.16-.332-1.16-1.976 0-2.308l3.099-.885a1.2 1.2 0 0 0 .824-.824M4.43 4.283l.376-1.507c.05-.202.338-.202.388 0l.377 1.507a.2.2 0 0 0 .145.146l1.508.377c.202.05.202.337 0 .388l-1.508.377a.2.2 0 0 0-.145.145l-.377 1.508c-.05.202-.338.202-.388 0l-.377-1.508a.2.2 0 0 0-.145-.145l-1.508-.377c-.202-.05-.202-.338 0-.388l1.508-.377a.2.2 0 0 0 .145-.146M18.43 18.284l.376-1.508c.05-.202.337-.202.388 0l.377 1.508a.2.2 0 0 0 .145.145l1.508.377c.202.05.202.337 0 .388l-1.508.377a.2.2 0 0 0-.145.145l-.377 1.508c-.05.202-.337.202-.388 0l-.377-1.508a.2.2 0 0 0-.145-.145l-1.508-.377c-.202-.05-.202-.338 0-.388l1.508-.377a.2.2 0 0 0 .145-.145"})])]),undo:t=>Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},[Oe("path",{fill:"currentColor","fill-rule":"evenodd",d:"M7.53 3.47a.75.75 0 0 1 0 1.06L5.81 6.25h9.226c.904 0 1.633 0 2.222.053c.606.055 1.136.172 1.617.45a3.75 3.75 0 0 1 1.373 1.372c.277.481.394 1.011.449 1.617c.053.589.053 1.318.053 2.222v.072c0 .904 0 1.633-.053 2.222c-.055.606-.171 1.136-.45 1.617a3.75 3.75 0 0 1-1.372 1.373c-.481.277-1.011.394-1.617.449c-.589.053-1.318.053-2.222.053H8a.75.75 0 0 1 0-1.5h7c.948 0 1.61 0 2.122-.047c.503-.046.788-.13 1.003-.254a2.25 2.25 0 0 0 .824-.824c.124-.215.208-.5.254-1.003c.046-.512.047-1.174.047-2.122s0-1.61-.047-2.122c-.046-.503-.13-.788-.254-1.003a2.25 2.25 0 0 0-.824-.824c-.215-.124-.5-.208-1.003-.254c-.512-.046-1.174-.047-2.122-.047H5.81l1.72 1.72a.75.75 0 1 1-1.06 1.06l-3-3a.75.75 0 0 1 0-1.06l3-3a.75.75 0 0 1 1.06 0","clip-rule":"evenodd"})]),redo:t=>Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},[Oe("path",{fill:"currentColor","fill-rule":"evenodd",d:"M16.47 3.47a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1 0 1.06l-3 3a.75.75 0 1 1-1.06-1.06l1.72-1.72H9c-.948 0-1.61 0-2.122.047c-.503.046-.788.13-1.003.254a2.25 2.25 0 0 0-.824.824c-.124.215-.208.5-.254 1.003c-.046.512-.047 1.174-.047 2.122s0 1.61.047 2.122c.046.502.13.788.254 1.003c.198.342.482.626.824.824c.215.124.5.208 1.003.254c.512.046 1.174.047 2.122.047h7a.75.75 0 0 1 0 1.5H8.964c-.904 0-1.633 0-2.222-.053c-.606-.055-1.136-.172-1.617-.45a3.75 3.75 0 0 1-1.373-1.372c-.277-.481-.394-1.011-.449-1.617c-.053-.589-.053-1.318-.053-2.222v-.072c0-.904 0-1.633.053-2.222c.055-.606.172-1.136.45-1.617a3.75 3.75 0 0 1 1.372-1.373c.481-.277 1.011-.394 1.617-.449c.589-.053 1.318-.053 2.222-.053h9.225l-1.72-1.72a.75.75 0 0 1 0-1.06","clip-rule":"evenodd"})]),user:o1,video:a1,warning:n1,discord:t=>Oe("svg",{viewBox:"0 0 256 199",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid",...t},[Oe("path",{d:"M216.856 16.597A208.502 208.502 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046-19.692-2.961-39.203-2.961-58.533 0-1.832-4.4-4.55-9.933-6.846-14.046a207.809 207.809 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161.094 161.094 0 0 0 79.735 175.3a136.413 136.413 0 0 1-21.846-10.632 108.636 108.636 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a131.66 131.66 0 0 0 5.355 4.237 136.07 136.07 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848 21.142-6.58 42.646-16.637 64.815-33.213 5.316-56.288-9.08-105.09-38.056-148.36ZM85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2c12.867 0 23.236 11.804 23.015 26.2.02 14.375-10.148 26.18-23.015 26.18Zm85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2 0 14.375-10.148 26.18-23.015 26.18Z",fill:"currentColor"})])},Av={nextjs:t=>Oe("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"nextjs",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 15 15",...t},[Oe("path",{fill:"currentColor",d:"m4.5 4.5l.405-.293A.5.5 0 0 0 4 4.5zm3 9.5A6.5 6.5 0 0 1 1 7.5H0A7.5 7.5 0 0 0 7.5 15zM14 7.5A6.5 6.5 0 0 1 7.5 14v1A7.5 7.5 0 0 0 15 7.5zM7.5 1A6.5 6.5 0 0 1 14 7.5h1A7.5 7.5 0 0 0 7.5 0zm0-1A7.5 7.5 0 0 0 0 7.5h1A6.5 6.5 0 0 1 7.5 1zM5 12V4.5H4V12zm-.905-7.207l6.5 9l.81-.586l-6.5-9zM10 4v6h1V4z"})]),scenify:t=>Oe("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},[Oe("path",{d:"M16.357 13.6285L7.50539 8.78788C6.35744 8.16009 5.00018 9.06141 5.00018 10.4517V15.2922V20.1328C5.00018 21.5231 6.35744 22.4244 7.50539 21.7966L16.357 16.956C17.6189 16.2659 17.6189 14.3186 16.357 13.6285Z",fill:"currentColor"}),Oe("path",{d:"M7.86941 6.59173L12.7247 9.24668C13.3543 9.59092 14.0988 9.09661 14.0988 8.33415V5.6792V3.02425C14.0988 2.26179 13.3543 1.76726 12.7247 2.11149L7.86941 4.76668C7.17724 5.14499 7.17724 6.21318 7.86941 6.59173Z",fill:"currentColor"}),Oe("path",{d:"M15.1556 10.7035L17.547 12.0111C17.8573 12.1808 18.2238 11.9371 18.2238 11.5616V10.254V8.94636C18.2238 8.57084 17.857 8.32719 17.547 8.49686L15.1556 9.8045C14.8148 9.99097 14.8148 10.517 15.1556 10.7035Z",fill:"currentColor"}),Oe("path",{d:"M7.5052 11.3551L16.357 16.1957C16.5425 16.2972 16.6974 16.4281 16.8285 16.5758C17.5884 15.7182 17.4335 14.217 16.357 13.6285L7.5052 8.78788C6.35726 8.16009 5 9.06141 5 10.4517V13.0189C5.00023 11.6288 6.35726 10.7275 7.5052 11.3551Z",fill:"currentColor"}),Oe("path",{d:"M12.7247 2.11152L7.86937 4.76671C7.19775 5.13405 7.17977 6.14857 7.81144 6.55442C7.83083 6.54205 7.84882 6.52828 7.86937 6.51707L12.7247 3.86189C13.3542 3.51765 14.0987 4.01195 14.0987 4.77441V3.02405C14.0987 2.26159 13.3542 1.76728 12.7247 2.11152Z",fill:"currentColor"}),Oe("path",{d:"M17.547 8.49665L15.1556 9.80429C14.8148 9.99076 14.8148 10.5168 15.1556 10.7033L15.4717 10.8762L17.5468 9.74127C17.857 9.57161 18.2235 9.81526 18.2235 10.1908V8.94614C18.2238 8.57063 17.857 8.32721 17.547 8.49665Z",fill:"currentColor"})]),user:o1,video:a1,warning:n1,discord:t=>Oe("svg",{viewBox:"0 0 256 199",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid",...t},[Oe("path",{d:"M216.856 16.597A208.502 208.502 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046-19.692-2.961-39.203-2.961-58.533 0-1.832-4.4-4.55-9.933-6.846-14.046a207.809 207.809 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161.094 161.094 0 0 0 79.735 175.3a136.413 136.413 0 0 1-21.846-10.632 108.636 108.636 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a131.66 131.66 0 0 0 5.355 4.237 136.07 136.07 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848 21.142-6.58 42.646-16.637 64.815-33.213 5.316-56.288-9.08-105.09-38.056-148.36ZM85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2c12.867 0 23.236 11.804 23.015 26.2.02 14.375-10.148 26.18-23.015 26.18Zm85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2 0 14.375-10.148 26.18-23.015 26.18Z",fill:"currentColor"})])},NF={class:"relative flex h-[52px] w-full shrink-0 items-center justify-between px-4 bg-card z-10 border-b"},HF={class:"flex items-center gap-2"},GF={class:"pointer-events-auto flex h-9 w-9 bg-primary/20 items-center justify-center rounded-md"},WF={class:"pointer-events-auto flex h-10 items-center px-1.5"},VF={class:"flex items-center gap-2"},$F={class:"flex items-center mr-2"},qF={href:"https://discord.gg/SCfMrQx8kr",target:"_blank"},YF=be({__name:"Header",setup(t){const e=K(!1),i=K(!1),s=()=>{window.confirm("Are you sure you want to start a new project? Unsaved changes will be lost.")&&console.log("New project started")},r=()=>{console.log("Export JSON")},n=()=>{console.log("Import JSON")};return(o,a)=>(fe(),dr("header",NF,[nt("div",HF,[nt("div",GF,[oe(M(Av).scenify,{class:"w-6 h-6"})]),oe(M(UF),null,{default:ae(()=>[oe(M(OF),{"as-child":""},{default:ae(()=>[oe(M(Ks),{variant:"ghost"},{default:ae(()=>[...a[0]||(a[0]=[el("File",-1)])]),_:1})]),_:1}),oe(M(BF),{align:"start",class:"w-48"},{default:ae(()=>[oe(M(zc),{onClick:r},{default:ae(()=>[oe(M(SI),{class:"mr-2 h-4 w-4"}),a[1]||(a[1]=nt("span",null,"Export (to JSON)",-1))]),_:1}),oe(M(zc),{onClick:n},{default:ae(()=>[oe(M(II),{class:"mr-2 h-4 w-4"}),a[2]||(a[2]=nt("span",null,"Import from JSON",-1))]),_:1}),oe(M(zc),{onClick:s},{default:ae(()=>[oe(M(CI),{class:"mr-2 h-4 w-4"}),a[3]||(a[3]=nt("span",null,"Clear or New project",-1))]),_:1})]),_:1})]),_:1}),nt("div",WF,[oe(M(Ks),{variant:"ghost",size:"icon",disabled:!e.value},{default:ae(()=>[oe(M(kv).undo,{class:"size-5"})]),_:1},8,["disabled"]),oe(M(Ks),{variant:"ghost",size:"icon",disabled:!i.value,class:"text-muted-foreground"},{default:ae(()=>[oe(M(kv).redo,{class:"size-5"})]),_:1},8,["disabled"])])]),a[7]||(a[7]=nt("div",{class:"absolute text-sm font-medium left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"}," Untitled video ",-1)),nt("div",VF,[nt("div",$F,[oe(M(Ks),{variant:"ghost",size:"icon",class:"h-8 w-8 text-muted-foreground hover:text-foreground"},{default:ae(()=>[oe(M(kI),{class:"size-5"})]),_:1})]),nt("a",qF,[oe(M(Ks),{class:"h-7 rounded-lg",variant:"outline"},{default:ae(()=>[oe(M(Av).discord,{class:"w-6 h-6 mr-2"}),a[4]||(a[4]=nt("span",{class:"hidden md:block"},"Join Us",-1))]),_:1})]),oe(M(Ks),{class:"flex h-7 gap-1 border border-border",variant:"outline",size:"sm"},{default:ae(()=>[oe(M(AI),{class:"w-4 h-4 mr-1"}),a[5]||(a[5]=nt("span",{class:"hidden md:block"},"Share",-1))]),_:1}),oe(M(Ks),{size:"sm",class:"gap-2 rounded-full"},{default:ae(()=>[...a[6]||(a[6]=[el(" Download ",-1)])]),_:1})])]))}}),XF=Object.assign(YF,{__name:"EditorHeader"});var cw=t=>{throw TypeError(t)},M0=(t,e,i)=>e.has(t)||cw("Cannot "+i),jF=(t,e,i)=>(M0(t,e,"read from private field"),i?i.call(t):e.get(t)),uw=(t,e,i)=>e.has(t)?cw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),KF=(t,e,i,s)=>(M0(t,e,"write to private field"),e.set(t,i),i),Iv=(t,e,i)=>(M0(t,e,"access private method"),i),ZF=Object.defineProperty,hw=(t,e)=>{for(var i in e)ZF(t,i,{get:e[i],enumerable:!0})},Uc=Math.pow(2,32),at=Math.pow(2,32)-1,JF=1,QF=2,eR=4,ka=1,Aa=2,Ia=8,Pa=16,Ea=32,Pv=131072,Jn=1,Ma=4,Qn=256,eo=512,to=1024,io=2048,dw=-1,vs=0,Nt=1,Ui=class fw extends ArrayBuffer{constructor(e){super(e),this.fileStart=0,this.usedBytes=0}static fromArrayBuffer(e,i){const s=new fw(e.byteLength);return new Uint8Array(s).set(new Uint8Array(e)),s.fileStart=i,s}},pw=(t=>(t[t.BIG_ENDIAN=1]="BIG_ENDIAN",t[t.LITTLE_ENDIAN=2]="LITTLE_ENDIAN",t))(pw||{}),Jo,Bc,Me,ct=(Me=class{constructor(t,e,i){uw(this,Jo),this._byteLength=0,this.failurePosition=0,this._dynamicSize=1,this._byteOffset=e||0,t instanceof ArrayBuffer?this.buffer=Ui.fromArrayBuffer(t,0):t instanceof DataView?(this.dataView=t,e&&(this._byteOffset+=e)):this.buffer=new Ui(t||0),this.position=0,this.endianness=i||1}getPosition(){return this.position}_realloc(t){if(!this._dynamicSize)return;const e=this._byteOffset+this.position+t;let i=this._buffer.byteLength;if(e<=i){e>this._byteLength&&(this._byteLength=e);return}for(i<1&&(i=1);e>i;)i*=2;const s=new Ui(i),r=new Uint8Array(this._buffer);new Uint8Array(s,0,r.length).set(r),this.buffer=s,this._byteLength=e}_trimAlloc(){if(this._byteLength===this._buffer.byteLength)return;const t=new Ui(this._byteLength),e=new Uint8Array(t),i=new Uint8Array(this._buffer,0,e.length);e.set(i),this.buffer=t}get byteLength(){return this._byteLength-this._byteOffset}get buffer(){return this._trimAlloc(),this._buffer}set buffer(t){this._buffer=t,this._dataView=new DataView(t,this._byteOffset),this._byteLength=t.byteLength}get byteOffset(){return this._byteOffset}set byteOffset(t){this._byteOffset=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}get dataView(){return this._dataView}set dataView(t){this._byteOffset=t.byteOffset,this._buffer=Ui.fromArrayBuffer(t.buffer,0),this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+t.byteLength}seek(t){const e=Math.max(0,Math.min(this.byteLength,t));this.position=isNaN(e)||!isFinite(e)?0:e}isEof(){return this.position>=this._byteLength}mapUint8Array(t){this._realloc(t*1);const e=new Uint8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,e}readInt32Array(t,e){t=t===void 0?this.byteLength-this.position/4:t;const i=new Int32Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readInt16Array(t,e){t=t===void 0?this.byteLength-this.position/2:t;const i=new Int16Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readInt8Array(t){t=t===void 0?this.byteLength-this.position:t;const e=new Int8Array(t);return Me.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e}readUint32Array(t,e){t=t===void 0?this.byteLength-this.position/4:t;const i=new Uint32Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readUint16Array(t,e){t=t===void 0?this.byteLength-this.position/2:t;const i=new Uint16Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readUint8Array(t){t=t===void 0?this.byteLength-this.position:t;const e=new Uint8Array(t);return Me.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e}readFloat64Array(t,e){t=t===void 0?this.byteLength-this.position/8:t;const i=new Float64Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readFloat32Array(t,e){t=t===void 0?this.byteLength-this.position/4:t;const i=new Float32Array(t);return Me.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),Me.arrayToNative(i,e??this.endianness),this.position+=i.byteLength,i}readInt32(t){const e=this._dataView.getInt32(this.position,(t??this.endianness)===2);return this.position+=4,e}readInt16(t){const e=this._dataView.getInt16(this.position,(t??this.endianness)===2);return this.position+=2,e}readInt8(){const t=this._dataView.getInt8(this.position);return this.position+=1,t}readUint32(t){const e=this._dataView.getUint32(this.position,(t??this.endianness)===2);return this.position+=4,e}readUint16(t){const e=this._dataView.getUint16(this.position,(t??this.endianness)===2);return this.position+=2,e}readUint8(){const t=this._dataView.getUint8(this.position);return this.position+=1,t}readFloat32(t){const e=this._dataView.getFloat32(this.position,(t??this.endianness)===2);return this.position+=4,e}readFloat64(t){const e=this._dataView.getFloat64(this.position,(t??this.endianness)===2);return this.position+=8,e}static memcpy(t,e,i,s,r){const n=new Uint8Array(t,e,r),o=new Uint8Array(i,s,r);n.set(o)}static arrayToNative(t,e){return e===Me.ENDIANNESS?t:this.flipArrayEndianness(t)}static nativeToEndian(t,e){return e&&Me.ENDIANNESS===2?t:this.flipArrayEndianness(t)}static flipArrayEndianness(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);for(let i=0;i<t.byteLength;i+=t.BYTES_PER_ELEMENT)for(let s=i+t.BYTES_PER_ELEMENT-1,r=i;s>r;s--,r++){const n=e[r];e[r]=e[s],e[s]=n}return t}readString(t,e){return e===void 0||e==="ASCII"?Ev(this.mapUint8Array(t===void 0?this.byteLength-this.position:t)):new TextDecoder(e).decode(this.mapUint8Array(t))}readCString(t){let e=0;const i=this.byteLength-this.position,s=new Uint8Array(this._buffer,this._byteOffset+this.position),r=t!==void 0?Math.min(t,i):i;for(;e<r&&s[e]!==0;e++);const n=Ev(this.mapUint8Array(e));return t!==void 0?this.position+=r-e:e!==i&&(this.position+=1),n}readInt64(){return this.readInt32()*Uc+this.readUint32()}readUint64(){return this.readUint32()*Uc+this.readUint32()}readUint24(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()}save(t){const e=new Blob([this.buffer]);if(typeof window<"u"&&typeof document<"u")if(window.URL&&URL.createObjectURL){const i=window.URL.createObjectURL(e),s=document.createElement("a");document.body.appendChild(s),s.setAttribute("href",i),s.setAttribute("download",t),s.setAttribute("target","_self"),s.click(),window.URL.revokeObjectURL(i),document.body.removeChild(s)}else throw new Error("DataStream.save: Can't create object URL.");return e}get dynamicSize(){return this._dynamicSize}set dynamicSize(t){t||this._trimAlloc(),this._dynamicSize=t}shift(t){const e=new Ui(this._byteLength-t),i=new Uint8Array(e),s=new Uint8Array(this._buffer,t,i.length);i.set(s),this.buffer=e,this.position-=t}writeInt32Array(t,e){if(this._realloc(t.length*4),t instanceof Int32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt32Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeInt32(t[i],e)}writeInt16Array(t,e){if(this._realloc(t.length*2),t instanceof Int16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt16Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeInt16(t[i],e)}writeInt8Array(t){if(this._realloc(t.length*1),t instanceof Int8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt8Array(t.length);else for(let e=0;e<t.length;e++)this.writeInt8(t[e])}writeUint32Array(t,e){if(this._realloc(t.length*4),t instanceof Uint32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint32Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeUint32(t[i],e)}writeUint16Array(t,e){if(this._realloc(t.length*2),t instanceof Uint16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint16Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeUint16(t[i],e)}writeUint8Array(t){if(this._realloc(t.length*1),t instanceof Uint8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint8Array(t.length);else for(let e=0;e<t.length;e++)this.writeUint8(t[e])}writeFloat64Array(t,e){if(this._realloc(t.length*8),t instanceof Float64Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat64Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeFloat64(t[i],e)}writeFloat32Array(t,e){if(this._realloc(t.length*4),t instanceof Float32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)Me.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat32Array(t.length,e);else for(let i=0;i<t.length;i++)this.writeFloat32(t[i],e)}writeInt64(t,e){this._realloc(8),this._dataView.setBigInt64(this.position,BigInt(t),(e??this.endianness)===2),this.position+=8}writeInt32(t,e){this._realloc(4),this._dataView.setInt32(this.position,t,(e??this.endianness)===2),this.position+=4}writeInt16(t,e){this._realloc(2),this._dataView.setInt16(this.position,t,(e??this.endianness)===2),this.position+=2}writeInt8(t){this._realloc(1),this._dataView.setInt8(this.position,t),this.position+=1}writeUint32(t,e){this._realloc(4),this._dataView.setUint32(this.position,t,(e??this.endianness)===2),this.position+=4}writeUint16(t,e){this._realloc(2),this._dataView.setUint16(this.position,t,(e??this.endianness)===2),this.position+=2}writeUint8(t){this._realloc(1),this._dataView.setUint8(this.position,t),this.position+=1}writeFloat32(t,e){this._realloc(4),this._dataView.setFloat32(this.position,t,(e??this.endianness)===2),this.position+=4}writeFloat64(t,e){this._realloc(8),this._dataView.setFloat64(this.position,t,(e??this.endianness)===2),this.position+=8}writeUCS2String(t,e,i){i===void 0&&(i=t.length);let s;for(s=0;s<t.length&&s<i;s++)this.writeUint16(t.charCodeAt(s),e);for(;s<i;s++)this.writeUint16(0)}writeString(t,e,i){let s=0;if(e===void 0||e==="ASCII")if(i!==void 0){const r=Math.min(t.length,i);for(s=0;s<r;s++)this.writeUint8(t.charCodeAt(s));for(;s<i;s++)this.writeUint8(0)}else for(s=0;s<t.length;s++)this.writeUint8(t.charCodeAt(s));else this.writeUint8Array(new TextEncoder(e).encode(t.substring(0,i)))}writeCString(t,e){let i=0;if(e!==void 0){const s=Math.min(t.length,e);for(i=0;i<s;i++)this.writeUint8(t.charCodeAt(i));for(;i<e;i++)this.writeUint8(0)}else{for(i=0;i<t.length;i++)this.writeUint8(t.charCodeAt(i));this.writeUint8(0)}}writeStruct(t,e){for(let i=0;i<t.length;i++){const[s,r]=t[i],n=e[s];this.writeType(r,n,e)}}writeType(t,e,i){if(typeof t=="function")return t(this,e);if(typeof t=="object"&&!(t instanceof Array))return t.set(this,e,i);let s,r="ASCII";const n=this.position;let o=t;if(typeof t=="string"&&/:/.test(t)){const a=t.split(":");o=a[0],s=parseInt(a[1])}if(typeof o=="string"&&/,/.test(o)){const a=o.split(",");o=a[0],r=a[1]}switch(o){case"uint8":this.writeUint8(e);break;case"int8":this.writeInt8(e);break;case"uint16":this.writeUint16(e,this.endianness);break;case"int16":this.writeInt16(e,this.endianness);break;case"uint32":this.writeUint32(e,this.endianness);break;case"int32":this.writeInt32(e,this.endianness);break;case"float32":this.writeFloat32(e,this.endianness);break;case"float64":this.writeFloat64(e,this.endianness);break;case"uint16be":this.writeUint16(e,1);break;case"int16be":this.writeInt16(e,1);break;case"uint32be":this.writeUint32(e,1);break;case"int32be":this.writeInt32(e,1);break;case"float32be":this.writeFloat32(e,1);break;case"float64be":this.writeFloat64(e,1);break;case"uint16le":this.writeUint16(e,2);break;case"int16le":this.writeInt16(e,2);break;case"uint32le":this.writeUint32(e,2);break;case"int32le":this.writeInt32(e,2);break;case"float32le":this.writeFloat32(e,2);break;case"float64le":this.writeFloat64(e,2);break;case"cstring":this.writeCString(e,s);break;case"string":this.writeString(e,r,s);break;case"u16string":this.writeUCS2String(e,this.endianness,s);break;case"u16stringle":this.writeUCS2String(e,2,s);break;case"u16stringbe":this.writeUCS2String(e,1,s);break;default:if(Iv(this,Jo,Bc).call(this,o)){const[,a]=o;for(let l=0;l<e.length;l++)this.writeType(a,e[l]);break}else{this.writeStruct(o,e);break}}s&&(this.position=n,this._realloc(s),this.position=n+s)}writeUint64(t){const e=Math.floor(t/Uc);this.writeUint32(e),this.writeUint32(t&4294967295)}writeUint24(t){this.writeUint8((t&16711680)>>16),this.writeUint8((t&65280)>>8),this.writeUint8(t&255)}adjustUint32(t,e){const i=this.position;this.seek(t),this.writeUint32(e),this.seek(i)}readStruct(t){const e={},i=this.position;for(let s=0;s<t.length;s+=1){const r=t[s][1],n=this.readType(r,e);if(!n){this.failurePosition===0&&(this.failurePosition=this.position),this.position=i;return}e[t[s][0]]=n}return e}readUCS2String(t,e){return String.fromCharCode.apply(void 0,this.readUint16Array(t,e))}readType(t,e){if(typeof t=="function")return t(this,e);if(typeof t=="object"&&!(t instanceof Array))return t.get(this,e);if(t instanceof Array&&t.length!==3)return this.readStruct(t);let i,s,r="ASCII";const n=this.position;let o=t;if(typeof o=="string"&&/:/.test(o)){const a=o.split(":");o=a[0],s=parseInt(a[1])}if(typeof o=="string"&&/,/.test(o)){const a=o.split(",");o=a[0],r=a[1]}switch(o){case"uint8":i=this.readUint8();break;case"int8":i=this.readInt8();break;case"uint16":i=this.readUint16(this.endianness);break;case"int16":i=this.readInt16(this.endianness);break;case"uint32":i=this.readUint32(this.endianness);break;case"int32":i=this.readInt32(this.endianness);break;case"float32":i=this.readFloat32(this.endianness);break;case"float64":i=this.readFloat64(this.endianness);break;case"uint16be":i=this.readUint16(1);break;case"int16be":i=this.readInt16(1);break;case"uint32be":i=this.readUint32(1);break;case"int32be":i=this.readInt32(1);break;case"float32be":i=this.readFloat32(1);break;case"float64be":i=this.readFloat64(1);break;case"uint16le":i=this.readUint16(2);break;case"int16le":i=this.readInt16(2);break;case"uint32le":i=this.readUint32(2);break;case"int32le":i=this.readInt32(2);break;case"float32le":i=this.readFloat32(2);break;case"float64le":i=this.readFloat64(2);break;case"cstring":i=this.readCString(s);break;case"string":i=this.readString(s,r);break;case"u16string":i=this.readUCS2String(s,this.endianness);break;case"u16stringle":i=this.readUCS2String(s,2);break;case"u16stringbe":i=this.readUCS2String(s,1);break;default:if(Iv(this,Jo,Bc).call(this,o)){const[,a,l]=o,u=typeof l=="function"?l(e,this,o):typeof l=="string"&&e[l]!==void 0?parseInt(e[l]):typeof l=="number"?l:l==="*"?void 0:parseInt(l);if(typeof a=="string"){const c=a.replace(/(le|be)$/,"");let h;switch(/le$/.test(a)?h=2:/be$/.test(a)&&(h=1),c){case"uint8":i=this.readUint8Array(u);break;case"uint16":i=this.readUint16Array(u,h);break;case"uint32":i=this.readUint32Array(u,h);break;case"int8":i=this.readInt8Array(u);break;case"int16":i=this.readInt16Array(u,h);break;case"int32":i=this.readInt32Array(u,h);break;case"float32":i=this.readFloat32Array(u,h);break;case"float64":i=this.readFloat64Array(u,h);break;case"cstring":case"utf16string":case"string":if(u){i=new Array(u);for(let f=0;f<u;f++)i[f]=this.readType(a,e)}else for(i=[];!this.isEof();){const f=this.readType(a,e);if(!f)break;i.push(f)}break}}else if(u){i=new Array(u);for(let c=0;c<u;c++){const h=this.readType(a,e);if(!h)return;i[c]=h}}else for(i=[];;){const c=this.position;try{const h=this.readType(a,e);if(!h){this.position=c;break}i.push(h)}catch{this.position=c;break}}break}}return s&&(this.position=n+s),i}mapInt32Array(t,e){this._realloc(t*4);const i=new Int32Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*4,i}mapInt16Array(t,e){this._realloc(t*2);const i=new Int16Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*2,i}mapInt8Array(t,e){this._realloc(t*1);const i=new Int8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,i}mapUint32Array(t,e){this._realloc(t*4);const i=new Uint32Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*4,i}mapUint16Array(t,e){this._realloc(t*2);const i=new Uint16Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*2,i}mapFloat64Array(t,e){this._realloc(t*8);const i=new Float64Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*8,i}mapFloat32Array(t,e){this._realloc(t*4);const i=new Float32Array(this._buffer,this.byteOffset+this.position,t);return Me.arrayToNative(i,e??this.endianness),this.position+=t*4,i}},Jo=new WeakSet,Bc=function(t){return Array.isArray(t)&&t.length===3&&t[0]==="[]"},Me.ENDIANNESS=new Int8Array(new Int16Array([1]).buffer)[0]>0?2:1,Me);function Ev(t){const e=[];for(let i=0;i<t.length;i++)e[i]=t[i];return String.fromCharCode.apply(void 0,e)}var Qo=new Date,rg=4,Mv=3,Fv=2,Rv=1,gs=rg,B={setLogLevel(t){t===this.debug?gs=Rv:t===this.info?gs=Fv:t===this.warn?gs=Mv:(this.error,gs=rg)},debug(t,e){console.debug===void 0&&(console.debug=console.log),Rv>=gs&&console.debug("["+B.getDurationString(new Date().getTime()-Qo.getTime(),1e3)+"]","["+t+"]",e)},log(t,e){this.debug(t.msg)},info(t,e){Fv>=gs&&console.info("["+B.getDurationString(new Date().getTime()-Qo.getTime(),1e3)+"]","["+t+"]",e)},warn(t,e){Mv>=gs&&console.warn("["+B.getDurationString(new Date().getTime()-Qo.getTime(),1e3)+"]","["+t+"]",e)},error(t,e,i){i?.onError?i.onError(t,e):rg>=gs&&console.error("["+B.getDurationString(new Date().getTime()-Qo.getTime(),1e3)+"]","["+t+"]",e)},getDurationString(t,e){let i;function s(l,u){const c=(""+l).split(".");for(;c[0].length<u;)c[0]="0"+c[0];return c.join(".")}t<0?(i=!0,t=-t):i=!1;let r=t/(e||1);const n=Math.floor(r/3600);r-=n*3600;const o=Math.floor(r/60);r-=o*60;let a=r*1e3;return r=Math.floor(r),a-=r*1e3,a=Math.floor(a),(i?"-":"")+n+":"+s(o,2)+":"+s(r,2)+"."+s(a,3)},printRanges(t){const e=t.length;if(e>0){let i="";for(let s=0;s<e;s++)s>0&&(i+=","),i+="["+B.getDurationString(t.start(s))+","+B.getDurationString(t.end(s))+"]";return i}else return"(empty)"}};function tR(t,e){B.debug("ArrayBuffer","Trying to create a new buffer of size: "+(t.byteLength+e.byteLength));const i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer}var Kr=class extends ct{constructor(t){super(new ArrayBuffer,0),this.buffers=[],this.bufferIndex=-1,t&&(this.insertBuffer(t),this.bufferIndex=0)}initialized(){if(this.bufferIndex>-1)return!0;if(this.buffers.length>0){const t=this.buffers[0];return t.fileStart===0?(this.buffer=t,this.bufferIndex=0,B.debug("MultiBufferStream","Stream ready for parsing"),!0):(B.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)}else return B.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1}reduceBuffer(t,e,i){const s=new Uint8Array(i);return s.set(new Uint8Array(t,e,i)),s.buffer.fileStart=t.fileStart+e,s.buffer.usedBytes=0,s.buffer}insertBuffer(t){let e=!0,i=0;for(;i<this.buffers.length;i++){const s=this.buffers[i];if(t.fileStart<=s.fileStart){if(t.fileStart===s.fileStart)if(t.byteLength>s.byteLength){this.buffers.splice(i,1),i--;continue}else B.warn("MultiBufferStream","Buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+") already appended, ignoring");else t.fileStart+t.byteLength<=s.fileStart||(t=this.reduceBuffer(t,0,s.fileStart-t.fileStart)),B.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.splice(i,0,t),i===0&&(this.buffer=t);e=!1;break}else if(t.fileStart<s.fileStart+s.byteLength){const r=s.fileStart+s.byteLength-t.fileStart,n=t.byteLength-r;if(n>0)t=this.reduceBuffer(t,r,n);else{e=!1;break}}}e&&(B.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.push(t),i===0&&(this.buffer=t))}logBufferLevel(t){const e=[];let i="",s,r=0,n=0;for(let a=0;a<this.buffers.length;a++){const l=this.buffers[a];a===0?(s={start:l.fileStart,end:l.fileStart+l.byteLength},e.push(s),i+="["+s.start+"-"):s.end===l.fileStart?s.end=l.fileStart+l.byteLength:(s={start:l.fileStart,end:l.fileStart+l.byteLength},i+=e[e.length-1].end-1+"], ["+s.start+"-",e.push(s)),r+=l.usedBytes,n+=l.byteLength}e.length>0&&(i+=s.end-1+"]");const o=t?B.info:B.debug;this.buffers.length===0?o("MultiBufferStream","No more buffer in memory"):o("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+r+"/"+n+" bytes), continuous ranges: "+i)}cleanBuffers(){for(let t=0;t<this.buffers.length;t++){const e=this.buffers[t];e.usedBytes===e.byteLength&&(B.debug("MultiBufferStream","Removing buffer #"+t),this.buffers.splice(t,1),t--)}}mergeNextBuffer(){if(this.bufferIndex+1<this.buffers.length){const t=this.buffers[this.bufferIndex+1];if(t.fileStart===this.buffer.fileStart+this.buffer.byteLength){const e=this.buffer.byteLength,i=this.buffer.usedBytes,s=this.buffer.fileStart;return this.buffers[this.bufferIndex]=tR(this.buffer,t),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=i,this.buffer.fileStart=s,B.debug("ISOFile","Concatenating buffer for box parsing (length: "+e+"->"+this.buffer.byteLength+")"),!0}else return!1}else return!1}findPosition(t,e,i){let s=-1,r=t===!0?0:this.bufferIndex;for(;r<this.buffers.length;){const o=this.buffers[r];if(o&&o.fileStart<=e)s=r,i&&(o.fileStart+o.byteLength<=e?o.usedBytes=o.byteLength:o.usedBytes=e-o.fileStart,this.logBufferLevel());else break;r++}if(s===-1)return-1;const n=this.buffers[s];return n.fileStart+n.byteLength>=e?(B.debug("MultiBufferStream","Found position in existing buffer #"+s),s):-1}findEndContiguousBuf(t){const e=t!==void 0?t:this.bufferIndex;let i=this.buffers[e];if(this.buffers.length>e+1)for(let s=e+1;s<this.buffers.length;s++){const r=this.buffers[s];if(r.fileStart===i.fileStart+i.byteLength)i=r;else break}return i.fileStart+i.byteLength}getEndFilePositionAfter(t){const e=this.findPosition(!0,t,!1);return e!==-1?this.findEndContiguousBuf(e):t}addUsedBytes(t){this.buffer.usedBytes+=t,this.logBufferLevel()}setAllUsedBytes(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()}seek(t,e,i){const s=this.findPosition(e,t,i);return s!==-1?(this.buffer=this.buffers[s],this.bufferIndex=s,this.position=t-this.buffer.fileStart,B.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(B.debug("MultiBufferStream","Position "+t+" not found in buffered data"),!1)}getPosition(){return this.bufferIndex===-1||this.buffers[this.bufferIndex]===void 0?0:this.buffers[this.bufferIndex].fileStart+this.position}getLength(){return this.byteLength}getEndPosition(){return this.bufferIndex===-1||this.buffers[this.bufferIndex]===void 0?0:this.buffers[this.bufferIndex].fileStart+this.byteLength}getAbsoluteEndPosition(){if(this.buffers.length===0)return 0;const t=this.buffers[this.buffers.length-1];return t.fileStart+t.byteLength}},ea,Oc,Q=(Oc=class{constructor(t=0){uw(this,ea),this.size=t}get type(){return this.constructor.fourcc??jF(this,ea)}set type(t){KF(this,ea,t)}addBox(t){return this.boxes||(this.boxes=[]),this.boxes.push(t),this[t.type+"s"]?this[t.type+"s"].push(t):this[t.type]=t,t}set(t,e){return this[t]=e,this}addEntry(t,e){const i=e||"entries";return this[i]||(this[i]=[]),this[i].push(t),this}writeHeader(t,e){if(this.size+=8,(this.size>at||this.original_size===1)&&(this.size+=8),this.type==="uuid"&&(this.size+=16),B.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+t.getPosition()+(e||"")),this.original_size===0?t.writeUint32(0):this.size>at||this.original_size===1?t.writeUint32(1):(this.sizePosition=t.getPosition(),t.writeUint32(this.size)),t.writeString(this.type,void 0,4),this.type==="uuid"){const i=new Uint8Array(16);for(let s=0;s<16;s++)i[s]=parseInt(this.uuid.substring(s*2,s*2+2),16);t.writeUint8Array(i)}(this.size>at||this.original_size===1)&&(this.sizePosition=t.getPosition(),t.writeUint64(this.size))}write(t){if(this.type==="mdat"){const e=this;if(e.stream){this.size=e.stream.getAbsoluteEndPosition(),this.writeHeader(t);for(const i of e.stream.buffers){const s=new Uint8Array(i);t.writeUint8Array(s)}}else e.data&&(this.size=e.data.length,this.writeHeader(t),t.writeUint8Array(e.data))}else this.size=this.data?this.data.length:0,this.writeHeader(t),this.data&&t.writeUint8Array(this.data)}printHeader(t){this.size+=8,this.size>at&&(this.size+=8),this.type==="uuid"&&(this.size+=16),t.log(t.indent+"size:"+this.size),t.log(t.indent+"type:"+this.type)}print(t){this.printHeader(t)}parse(t){this.type!=="mdat"?this.data=t.readUint8Array(this.size-this.hdr_size):this.size===0?t.seek(t.getEndPosition()):t.seek(this.start+this.size)}parseDataAndRewind(t){this.data=t.readUint8Array(this.size-this.hdr_size),t.seek(this.start+this.hdr_size)}parseLanguage(t){this.language=t.readUint16();const e=[];e[0]=this.language>>10&31,e[1]=this.language>>5&31,e[2]=this.language&31,this.languageString=String.fromCharCode(e[0]+96,e[1]+96,e[2]+96)}computeSize(t){const e=t||new Kr;this.write(e)}isEndOfBox(t){const e=t.getPosition(),i=this.start+this.size;return e===i}},ea=new WeakMap,Oc.registryId=Symbol.for("BoxIdentifier"),Oc),N=class extends Q{constructor(){super(...arguments),this.flags=0,this.version=0}writeHeader(e){this.size+=4,super.writeHeader(e," v="+this.version+" f="+this.flags),e.writeUint8(this.version),e.writeUint24(this.flags)}printHeader(e){this.size+=4,super.printHeader(e),e.log(e.indent+"version:"+this.version),e.log(e.indent+"flags:"+this.flags)}parseDataAndRewind(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,e.seek(this.start+this.hdr_size)}parseFullHeader(e){this.version=e.readUint8(),this.flags=e.readUint24(),this.hdr_size+=4}parse(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)}},Dc,rt=(Dc=class{constructor(t){this.grouping_type=t}write(t){t.writeUint8Array(this.data)}parse(t){B.warn("BoxParser",`Unknown sample group type: '${this.grouping_type}'`),this.data=t.readUint8Array(this.description_length)}},Dc.registryId=Symbol.for("SampleGroupEntryIdentifier"),Dc),mw=class extends N{parse(t){this.parseFullHeader(t),this.track_group_id=t.readUint32()}},gw=class extends Q{constructor(t,e,i,s,r){super(e),this.box_name=i,this.hdr_size=s,this.start=r,this.type=t}parse(t){this.from_item_ID=t.readUint16();const e=t.readUint16();this.references=[];for(let i=0;i<e;i++)this.references[i]={to_item_ID:t.readUint16()}}},yw=class extends Q{constructor(t,e,i,s,r){super(e),this.box_name=i,this.hdr_size=s,this.start=r,this.type=t}parse(t){this.from_item_ID=t.readUint32();const e=t.readUint16();this.references=[];for(let i=0;i<e;i++)this.references[i]={to_item_ID:t.readUint32()}}},vw=class extends Q{constructor(t,e,i,s){super(e),this.hdr_size=i,this.start=s,this.type=t}parse(t){this.track_ids=t.readUint32Array((this.size-this.hdr_size)/4)}write(t){this.size=this.track_ids.length*4,this.writeHeader(t),t.writeUint32Array(this.track_ids)}},dl=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],xw=["compatible_brands","matrix","opcolor","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"];function bw(t,e){if(t&&!e)return!1;let i;for(i in t)if(!dl.find(s=>s===i)){if(t[i]instanceof Q||e[i]instanceof Q||typeof t[i]>"u"||typeof e[i]>"u"||typeof t[i]=="function"||typeof e[i]=="function"||"subBoxNames"in t&&t.subBoxNames.indexOf(i.slice(0,4))>-1||"subBoxNames"in e&&e.subBoxNames.indexOf(i.slice(0,4))>-1||i==="data"||i==="start"||i==="size"||i==="creation_time"||i==="modification_time"||xw.find(s=>s===i))continue;if(t[i]!==e[i])return!1}return!0}function F0(t,e){if(!bw(t,e))return!1;for(let i=0;i<dl.length;i++){const s=dl[i];if(t[s]&&e[s]&&!F0(t[s],e[s]))return!1}return!0}function R0(t){let e=t;for(;e;){if("registryId"in e)return e.registryId;e=Object.getPrototypeOf(e)}}var iR=t=>{const e=Symbol.for("SampleGroupEntryIdentifier");return R0(t)===e},sR=t=>{const e=Symbol.for("SampleEntryIdentifier");return R0(t)===e},rR=t=>{const e=Symbol.for("BoxIdentifier");return R0(t)===e},Dt={uuid:{},sampleEntry:{},sampleGroupEntry:{},box:{}};function nR(t){const e={uuid:{},sampleEntry:{},sampleGroupEntry:{},box:{}};for(const[i,s]of Object.entries(t)){if(iR(s)){const r="grouping_type"in s?s.grouping_type:void 0;if(!r)throw new Error(`SampleGroupEntry class ${i} does not have a valid static grouping_type. Please ensure it is defined correctly.`);if(r in e.sampleGroupEntry)throw new Error(`SampleGroupEntry class ${i} has a grouping_type that is already registered. Please ensure it is unique.`);e.sampleGroupEntry[r]=s;continue}if(sR(s)){const r="fourcc"in s?s.fourcc:void 0;if(!r)throw new Error(`SampleEntry class ${i} does not have a valid static fourcc. Please ensure it is defined correctly.`);if(r in e.sampleEntry)throw new Error(`SampleEntry class ${i} has a fourcc that is already registered. Please ensure it is unique.`);e.sampleEntry[r]=s;continue}if(rR(s)){const r="fourcc"in s?s.fourcc:void 0,n="uuid"in s?s.uuid:void 0;if(r==="uuid"){if(!n)throw new Error(`Box class ${i} has a fourcc of 'uuid' but does not have a valid uuid. Please ensure it is defined correctly.`);if(n in e.uuid)throw new Error(`Box class ${i} has a uuid that is already registered. Please ensure it is unique.`);e.uuid[n]=s;continue}e.box[r]=s;continue}throw new Error(`Box class ${i} does not have a valid static fourcc, uuid, or grouping_type. Please ensure it is defined correctly.`)}return Dt.uuid={...e.uuid},Dt.sampleEntry={...e.sampleEntry},Dt.sampleGroupEntry={...e.sampleGroupEntry},Dt.box={...e.box},Dt}var fl={};function oR(t){return Object.entries(t).forEach(([e,i])=>fl[e]=i),fl}function aR(t){return gr(t)}function gr(t){let e="";for(let i=0;i<16;i++){const s=t.readUint8().toString(16);e+=s.length===1?"0"+s:s}return e}function Ci(t,e,i){let s,r;const n=t.getPosition();let o=0,a;if(t.getEndPosition()-n<8)return B.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:vs};if(i&&i<8)return B.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:vs};let l=t.readUint32();const u=t.readString(4);if(u.length!==4||!/^[\x20-\x7E]{4}$/.test(u))return B.error("BoxParser",`Invalid box type: '${u}'`),{code:dw,start:n,type:u};let c=u;if(B.debug("BoxParser","Found box of type '"+u+"' and size "+l+" at position "+n),o=8,u==="uuid"){if(t.getEndPosition()-t.getPosition()<16||i-o<16)return t.seek(n),B.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:vs};a=aR(t),o+=16,c=a}if(l===1){if(t.getEndPosition()-t.getPosition()<8||i&&i-o<8)return t.seek(n),B.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+u+'" box'),{code:vs};r=l,l=t.readUint64(),o+=8}else if(l===0){if(i)l=i;else if(u!=="mdat")return B.error("BoxParser","Unlimited box size not supported for type: '"+u+"'"),s=new Q(l),s.type=u,{code:Nt,box:s,size:s.size}}if(l!==0&&l<o)return B.error("BoxParser","Box of type "+u+" has an invalid size "+l+" (too small to be a box)"),{code:vs,type:u,size:l,hdr_size:o,start:n};if(l!==0&&i&&l>i)return B.error("BoxParser","Box of type '"+u+"' has a size "+l+" greater than its container size "+i),{code:vs,type:u,size:l,hdr_size:o,start:n};if(l!==0&&n+l>t.getEndPosition())return t.seek(n),B.info("BoxParser","Not enough data in stream to parse the entire '"+u+"' box"),{code:vs,type:u,size:l,hdr_size:o,start:n,original_size:r};if(e)return{code:Nt,type:u,size:l,hdr_size:o,start:n};u in Dt.box?s=new Dt.box[u](l):u!=="uuid"?(B.warn("BoxParser",`Unknown box type: '${u}'`),s=new Q(l),s.type=u,s.has_unparsed_data=!0):a in Dt.uuid?s=new Dt.uuid[a](l):(B.warn("BoxParser",`Unknown UUID box type: '${a}'`),s=new Q(l),s.type=u,s.uuid=a,s.has_unparsed_data=!0),s.original_size=r,s.hdr_size=o,s.start=n,s.write===Q.prototype.write&&s.type!=="mdat"&&(B.info("BoxParser","'"+c+"' box writing not yet implemented, keeping unparsed data in memory for later write"),s.parseDataAndRewind(t)),s.parse(t);const h=t.getPosition()-(s.start+s.size);return h<0?(B.warn("BoxParser","Parsing of box '"+c+"' did not read the entire indicated box data size (missing "+-h+" bytes), seeking forward"),t.seek(s.start+s.size)):h>0&&s.size!==0&&(B.error("BoxParser","Parsing of box '"+c+"' read "+h+" more bytes than the indicated box data size, seeking backwards"),t.seek(s.start+s.size)),{code:Nt,box:s,size:s.size}}var ze=class extends Q{write(e){if(this.size=0,this.writeHeader(e),this.boxes)for(let i=0;i<this.boxes.length;i++)this.boxes[i]&&(this.boxes[i].write(e),this.size+=this.boxes[i].size);B.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)}print(e){this.printHeader(e);for(let i=0;i<this.boxes.length;i++)if(this.boxes[i]){const s=e.indent;e.indent+=" ",this.boxes[i].print(e),e.indent=s}}parse(e){let i;for(;e.getPosition()<this.start+this.size;)if(i=Ci(e,!1,this.size-(e.getPosition()-this.start)),i.code===Nt){const s=i.box;if(this.boxes||(this.boxes=[]),this.boxes.push(s),this.subBoxNames&&this.subBoxNames.indexOf(s.type)!==-1){const r=this.subBoxNames[this.subBoxNames.indexOf(s.type)]+"s";this[r]||(this[r]=[]),this[r].push(s)}else{const r=s.type!=="uuid"?s.type:s.uuid;this[r]?B.warn("ContainerBox",`Box of type ${r} already exists in container box ${this.type}.`):this[r]=s}}else return}},Lc,Vi=(Lc=class extends ze{constructor(t,e,i){super(t),this.hdr_size=e,this.start=i}isVideo(){return!1}isAudio(){return!1}isSubtitle(){return!1}isMetadata(){return!1}isHint(){return!1}getCodec(){return this.type.replace(".","")}getWidth(){return""}getHeight(){return""}getChannelCount(){return""}getSampleRate(){return""}getSampleSize(){return""}parseHeader(t){t.readUint8Array(6),this.data_reference_index=t.readUint16(),this.hdr_size+=8}parse(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)}parseDataAndRewind(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,t.seek(this.start+this.hdr_size)}parseFooter(t){super.parse(t)}writeHeader(t){this.size=8,super.writeHeader(t),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint16(this.data_reference_index)}writeFooter(t){if(this.boxes)for(let e=0;e<this.boxes.length;e++)this.boxes[e].write(t),this.size+=this.boxes[e].size;B.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)}write(t){this.writeHeader(t),t.writeUint8Array(this.data),this.size+=this.data.length,B.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)}},Lc.registryId=Symbol.for("SampleEntryIdentifier"),Lc),ng=class extends Vi{},yr=class extends Vi{isMetadata(){return!0}},Ls=class extends Vi{isSubtitle(){return!0}},_w=class extends Vi{},Ze=class extends Vi{parse(e){this.parseHeader(e),e.readUint16(),e.readUint16(),e.readUint32Array(3),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16();const i=Math.min(31,e.readUint8());this.compressorname=e.readString(i),i<31&&e.readString(31-i),this.depth=e.readUint16(),e.readUint16(),this.parseFooter(e)}isVideo(){return!0}getWidth(){return this.width}getHeight(){return this.height}write(e){this.writeHeader(e),this.size+=70,e.writeUint16(0),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.width),e.writeUint16(this.height),e.writeUint32(this.horizresolution),e.writeUint32(this.vertresolution),e.writeUint32(0),e.writeUint16(this.frame_count),e.writeUint8(Math.min(31,this.compressorname.length)),e.writeString(this.compressorname,void 0,31),e.writeUint16(this.depth),e.writeInt16(-1),this.writeFooter(e)}},zt=class extends Vi{parse(e){this.parseHeader(e),this.version=e.readUint16(),e.readUint16(),e.readUint32(),this.channel_count=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.samplerate=e.readUint32()/65536,e.isofile?.ftyp?.major_brand.includes("qt")&&(this.version===1?this.extensions=e.readUint8Array(16):this.version===2&&(this.extensions=e.readUint8Array(36))),this.parseFooter(e)}isAudio(){return!0}getChannelCount(){return this.channel_count}getSampleRate(){return this.samplerate}getSampleSize(){return this.samplesize}write(e){this.writeHeader(e),this.size+=20,e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.channel_count),e.writeUint16(this.samplesize),e.writeUint16(0),e.writeUint16(0),e.writeUint32(this.samplerate<<16),this.writeFooter(e)}},Zl=class extends Vi{parse(t){this.parseHeader(t),this.parseFooter(t)}write(t){this.writeHeader(t),this.writeFooter(t)}},zv=class extends Array{toString(){let t="<table class='inner-table'>";t+="<thead><tr><th>length</th><th>nalu_data</th></tr></thead>",t+="<tbody>";for(let e=0;e<this.length;e++){const i=this[e];t+="<tr>",t+="<td>"+i.length+"</td>",t+="<td>",t+=i.data.reduce(function(s,r){return s+r.toString(16).padStart(2,"0")},"0x"),t+="</td></tr>"}return t+="</tbody></table>",t}},Nc,ww=(Nc=class extends Q{constructor(){super(...arguments),this.box_name="AVCConfigurationBox"}parse(t){this.configurationVersion=t.readUint8(),this.AVCProfileIndication=t.readUint8(),this.profile_compatibility=t.readUint8(),this.AVCLevelIndication=t.readUint8(),this.lengthSizeMinusOne=t.readUint8()&3,this.nb_SPS_nalus=t.readUint8()&31;let e=this.size-this.hdr_size-6;this.SPS=new zv;for(let i=0;i<this.nb_SPS_nalus;i++){const s=t.readUint16();this.SPS.push({length:s,data:t.readUint8Array(s)}),e-=2+s}this.nb_PPS_nalus=t.readUint8(),e--,this.PPS=new zv;for(let i=0;i<this.nb_PPS_nalus;i++){const s=t.readUint16();this.PPS.push({length:s,data:t.readUint8Array(s)}),e-=2+s}e>0&&(this.ext=t.readUint8Array(e))}write(t){this.size=7;for(let e=0;e<this.SPS.length;e++)this.size+=2+this.SPS[e].length;for(let e=0;e<this.PPS.length;e++)this.size+=2+this.PPS[e].length;this.ext&&(this.size+=this.ext.length),this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8(this.AVCProfileIndication),t.writeUint8(this.profile_compatibility),t.writeUint8(this.AVCLevelIndication),t.writeUint8(this.lengthSizeMinusOne+252),t.writeUint8(this.SPS.length+224);for(let e=0;e<this.SPS.length;e++)t.writeUint16(this.SPS[e].length),t.writeUint8Array(this.SPS[e].data);t.writeUint8(this.PPS.length);for(let e=0;e<this.PPS.length;e++)t.writeUint16(this.PPS[e].length),t.writeUint8Array(this.PPS[e].data);this.ext&&t.writeUint8Array(this.ext)}},Nc.fourcc="avcC",Nc),Hc,Fa=(Hc=class extends Q{constructor(){super(...arguments),this.box_name="MediaDataBox"}},Hc.fourcc="mdat",Hc),Gc,lR=(Gc=class extends Q{constructor(){super(...arguments),this.box_name="ItemDataBox"}},Gc.fourcc="idat",Gc),Wc,cR=(Wc=class extends Q{constructor(){super(...arguments),this.box_name="FreeSpaceBox"}},Wc.fourcc="free",Wc),Vc,uR=(Vc=class extends Q{constructor(){super(...arguments),this.box_name="FreeSpaceBox"}},Vc.fourcc="skip",Vc),$c,Sw=($c=class extends N{constructor(){super(...arguments),this.box_name="HintMediaHeaderBox"}},$c.fourcc="hmhd",$c),qc,Ra=(qc=class extends N{constructor(){super(...arguments),this.box_name="NullMediaHeaderBox"}},qc.fourcc="nmhd",qc),Yc,hR=(Yc=class extends N{constructor(){super(...arguments),this.box_name="ObjectDescriptorBox"}},Yc.fourcc="iods",Yc),Xc,dR=(Xc=class extends N{constructor(){super(...arguments),this.box_name="XMLBox"}},Xc.fourcc="xml ",Xc),jc,fR=(jc=class extends N{constructor(){super(...arguments),this.box_name="BinaryXMLBox"}},jc.fourcc="bxml",jc),Kc,pR=(Kc=class extends N{constructor(){super(...arguments),this.box_name="ItemProtectionBox",this.sinfs=[]}get protections(){return this.sinfs}},Kc.fourcc="ipro",Kc),Zc,og=(Zc=class extends ze{constructor(){super(...arguments),this.box_name="MovieBox",this.traks=[],this.psshs=[],this.subBoxNames=["trak","pssh"]}},Zc.fourcc="moov",Zc),Jc,Cw=(Jc=class extends ze{constructor(){super(...arguments),this.box_name="TrackBox",this.samples=[]}},Jc.fourcc="trak",Jc),Qc,mR=(Qc=class extends ze{constructor(){super(...arguments),this.box_name="EditBox"}},Qc.fourcc="edts",Qc),eu,Tw=(eu=class extends ze{constructor(){super(...arguments),this.box_name="MediaBox"}},eu.fourcc="mdia",eu),tu,kw=(tu=class extends ze{constructor(){super(...arguments),this.box_name="MediaInformationBox"}},tu.fourcc="minf",tu),iu,Aw=(iu=class extends ze{constructor(){super(...arguments),this.box_name="DataInformationBox"}},iu.fourcc="dinf",iu),su,Iw=(su=class extends ze{constructor(){super(...arguments),this.box_name="SampleTableBox",this.sgpds=[],this.sbgps=[],this.subBoxNames=["sgpd","sbgp"]}},su.fourcc="stbl",su),ru,ag=(ru=class extends ze{constructor(){super(...arguments),this.box_name="MovieExtendsBox",this.trexs=[],this.subBoxNames=["trex"]}},ru.fourcc="mvex",ru),nu,Pw=(nu=class extends ze{constructor(){super(...arguments),this.box_name="MovieFragmentBox",this.trafs=[],this.subBoxNames=["traf"]}},nu.fourcc="moof",nu),ou,Ew=(ou=class extends ze{constructor(){super(...arguments),this.box_name="TrackFragmentBox",this.truns=[],this.sgpds=[],this.sbgps=[],this.subBoxNames=["trun","sgpd","sbgp"]}},ou.fourcc="traf",ou),au,gR=(au=class extends ze{constructor(){super(...arguments),this.box_name="VTTCueBox"}},au.fourcc="vttc",au),lu,yR=(lu=class extends ze{constructor(){super(...arguments),this.box_name="MovieFragmentRandomAccessBox",this.tfras=[],this.subBoxNames=["tfra"]}},lu.fourcc="mfra",lu),cu,vR=(cu=class extends ze{constructor(){super(...arguments),this.box_name="AdditionalMetadataContainerBox"}},cu.fourcc="meco",cu),uu,xR=(uu=class extends ze{constructor(){super(...arguments),this.box_name="trackhintinformation",this.subBoxNames=["sdp ","rtp "]}},uu.fourcc="hnti",uu),hu,bR=(hu=class extends ze{constructor(){super(...arguments),this.box_name="hintstatisticsbox",this.maxrs=[],this.subBoxNames=["maxr"]}},hu.fourcc="hinf",hu),du,_R=(du=class extends ze{constructor(){super(...arguments),this.box_name="SubTrackBox"}},du.fourcc="strk",du),fu,wR=(fu=class extends ze{constructor(){super(...arguments),this.box_name="SubTrackDefinitionBox"}},fu.fourcc="strd",fu),pu,SR=(pu=class extends ze{constructor(){super(...arguments),this.box_name="ProtectionSchemeInfoBox"}},pu.fourcc="sinf",pu),mu,CR=(mu=class extends ze{constructor(){super(...arguments),this.box_name="RestrictedSchemeInfoBox"}},mu.fourcc="rinf",mu),gu,TR=(gu=class extends ze{constructor(){super(...arguments),this.box_name="SchemeInformationBox"}},gu.fourcc="schi",gu),yu,kR=(yu=class extends ze{constructor(){super(...arguments),this.box_name="TrackGroupBox"}},yu.fourcc="trgr",yu),vu,AR=(vu=class extends ze{constructor(){super(...arguments),this.box_name="UserDataBox",this.kinds=[],this.strks=[],this.subBoxNames=["kind","strk"]}},vu.fourcc="udta",vu),xu,IR=(xu=class extends ze{constructor(){super(...arguments),this.box_name="ItemPropertiesBox",this.ipmas=[],this.subBoxNames=["ipma"]}},xu.fourcc="iprp",xu),bu,PR=(bu=class extends ze{constructor(){super(...arguments),this.box_name="ItemPropertyContainerBox",this.hvcCs=[],this.ispes=[],this.claps=[],this.irots=[],this.subBoxNames=["hvcC","ispe","clap","irot"]}},bu.fourcc="ipco",bu),_u,ER=(_u=class extends ze{constructor(){super(...arguments),this.box_name="GroupsListBox"}},_u.fourcc="grpl",_u),wu,MR=(wu=class extends ze{constructor(){super(...arguments),this.box_name="J2KHeaderInfoBox"}},wu.fourcc="j2kH",wu),Su,FR=(Su=class extends ze{constructor(){super(...arguments),this.box_name="ExtendedTypeBox",this.tycos=[],this.subBoxNames=["tyco"]}},Su.fourcc="etyp",Su),Cu,RR=(Cu=class extends ze{constructor(){super(...arguments),this.box_name="ProjectedOmniVideoBox",this.subBoxNames=["prfr"]}},Cu.fourcc="povd",Cu),Tu,Mw=(Tu=class extends N{constructor(){super(...arguments),this.box_name="DataReferenceBox"}parse(t){this.parseFullHeader(t),this.entries=[];const e=t.readUint32();for(let i=0;i<e;i++){const s=Ci(t,!1,this.size-(t.getPosition()-this.start));if(s.code===Nt){const r=s.box;this.entries.push(r)}else return}}write(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.entries.length);for(let e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;B.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)}},Tu.fourcc="dref",Tu),ku,Fw=(ku=class extends N{constructor(){super(...arguments),this.box_name="ExtendedLanguageBox"}parse(t){this.parseFullHeader(t),this.extended_language=t.readString(this.size-this.hdr_size)}write(t){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(t),t.writeString(this.extended_language)}},ku.fourcc="elng",ku),Au,Rw=(Au=class extends Q{constructor(){super(...arguments),this.box_name="FileTypeBox"}parse(t){let e=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),e-=8,this.compatible_brands=[];let i=0;for(;e>=4;)this.compatible_brands[i]=t.readString(4),e-=4,i++}write(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,void 0,4),t.writeUint32(this.minor_version);for(let e=0;e<this.compatible_brands.length;e++)t.writeString(this.compatible_brands[e],void 0,4)}},Au.fourcc="ftyp",Au),Iu,zw=(Iu=class extends N{constructor(){super(...arguments),this.box_name="HandlerBox"}parse(t){if(this.parseFullHeader(t),this.version===0&&(t.readUint32(),this.handler=t.readString(4),t.readUint32Array(3),!this.isEndOfBox(t))){const e=this.start+this.size-t.getPosition();this.name=t.readCString();const i=this.start+this.size-1;t.seek(i),t.readUint8()!==0&&e>1&&(B.info("BoxParser","Warning: hdlr name is not null-terminated, possibly length-prefixed string. Trimming first byte."),this.name=this.name.slice(1))}}write(t){this.size=20+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(t),t.writeUint32(0),t.writeString(this.handler,void 0,4),t.writeUint32Array([0,0,0]),t.writeCString(this.name)}},Iu.fourcc="hdlr",Iu),Pu,Uw=(Pu=class extends Q{constructor(){super(...arguments),this.box_name="HEVCConfigurationBox"}parse(t){this.configurationVersion=t.readUint8();let e=t.readUint8();this.general_profile_space=e>>6,this.general_tier_flag=(e&32)>>5,this.general_profile_idc=e&31,this.general_profile_compatibility=t.readUint32(),this.general_constraint_indicator=t.readUint8Array(6),this.general_level_idc=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3,this.chroma_format_idc=t.readUint8()&3,this.bit_depth_luma_minus8=t.readUint8()&7,this.bit_depth_chroma_minus8=t.readUint8()&7,this.avgFrameRate=t.readUint16(),e=t.readUint8(),this.constantFrameRate=e>>6,this.numTemporalLayers=(e&13)>>3,this.temporalIdNested=(e&4)>>2,this.lengthSizeMinusOne=e&3,this.nalu_arrays=[];const i=t.readUint8();for(let s=0;s<i;s++){const r=[];this.nalu_arrays.push(r),e=t.readUint8(),r.completeness=(e&128)>>7,r.nalu_type=e&63;const n=t.readUint16();for(let o=0;o<n;o++){const a=t.readUint16();r.push({data:t.readUint8Array(a)})}}}write(t){this.size=23;for(let e=0;e<this.nalu_arrays.length;e++){this.size+=3;for(let i=0;i<this.nalu_arrays[e].length;i++)this.size+=2+this.nalu_arrays[e][i].data.length}this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8((this.general_profile_space<<6)+(this.general_tier_flag<<5)+this.general_profile_idc),t.writeUint32(this.general_profile_compatibility),t.writeUint8Array(this.general_constraint_indicator),t.writeUint8(this.general_level_idc),t.writeUint16(this.min_spatial_segmentation_idc+(15<<24)),t.writeUint8(this.parallelismType+252),t.writeUint8(this.chroma_format_idc+252),t.writeUint8(this.bit_depth_luma_minus8+248),t.writeUint8(this.bit_depth_chroma_minus8+248),t.writeUint16(this.avgFrameRate),t.writeUint8((this.constantFrameRate<<6)+(this.numTemporalLayers<<3)+(this.temporalIdNested<<2)+this.lengthSizeMinusOne),t.writeUint8(this.nalu_arrays.length);for(let e=0;e<this.nalu_arrays.length;e++){t.writeUint8((this.nalu_arrays[e].completeness<<7)+this.nalu_arrays[e].nalu_type),t.writeUint16(this.nalu_arrays[e].length);for(let i=0;i<this.nalu_arrays[e].length;i++)t.writeUint16(this.nalu_arrays[e][i].data.length),t.writeUint8Array(this.nalu_arrays[e][i].data)}}},Pu.fourcc="hvcC",Pu),Eu,Bw=(Eu=class extends N{constructor(){super(...arguments),this.box_name="MediaHeaderBox"}parse(t){this.parseFullHeader(t),this.version===1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.parseLanguage(t),t.readUint16()}write(t){const e=this.modification_time>at||this.creation_time>at||this.duration>at||this.version===1;this.version=e?1:0,this.size=20,this.size+=e?12:0,this.flags=0,this.writeHeader(t),e?(t.writeUint64(this.creation_time),t.writeUint64(this.modification_time),t.writeUint32(this.timescale),t.writeUint64(this.duration)):(t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration)),t.writeUint16(this.language),t.writeUint16(0)}},Eu.fourcc="mdhd",Eu),Mu,Ow=(Mu=class extends N{constructor(){super(...arguments),this.box_name="MovieExtendsHeaderBox"}parse(t){this.parseFullHeader(t),this.flags&1&&(B.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version===1?this.fragment_duration=t.readUint64():this.fragment_duration=t.readUint32()}write(t){const e=this.fragment_duration>at||this.version===1;this.version=e?1:0,this.size=4,this.size+=e?4:0,this.flags=0,this.writeHeader(t),e?t.writeUint64(this.fragment_duration):t.writeUint32(this.fragment_duration)}},Mu.fourcc="mehd",Mu),Fu,zR=(Fu=class extends N{constructor(){super(...arguments),this.box_name="ItemInfoEntry"}parse(t){if(this.parseFullHeader(t),(this.version===0||this.version===1)&&(this.item_ID=t.readUint16(),this.item_protection_index=t.readUint16(),this.item_name=t.readCString(),this.content_type=t.readCString(),this.isEndOfBox(t)||(this.content_encoding=t.readCString())),this.version===1){this.extension_type=t.readString(4),B.warn("BoxParser","Cannot parse extension type"),t.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=t.readUint16():this.version===3&&(this.item_ID=t.readUint32()),this.item_protection_index=t.readUint16(),this.item_type=t.readString(4),this.item_name=t.readCString(),this.item_type==="mime"?(this.content_type=t.readCString(),this.content_encoding=t.readCString()):this.item_type==="uri "&&(this.item_uri_type=t.readCString()))}},Fu.fourcc="infe",Fu),Ru,UR=(Ru=class extends N{constructor(){super(...arguments),this.box_name="ItemInfoBox"}parse(t){this.parseFullHeader(t),this.version===0?this.entry_count=t.readUint16():this.entry_count=t.readUint32(),this.item_infos=[];for(let e=0;e<this.entry_count;e++){const i=Ci(t,!1,this.size-(t.getPosition()-this.start));if(i.code===Nt){const s=i.box;s.type==="infe"?this.item_infos[e]=s:B.error("BoxParser","Expected 'infe' box, got "+i.box.type,t.isofile)}else return}}},Ru.fourcc="iinf",Ru),zu,BR=(zu=class extends N{constructor(){super(...arguments),this.box_name="ItemLocationBox"}parse(t){this.parseFullHeader(t);let e;e=t.readUint8(),this.offset_size=e>>4&15,this.length_size=e&15,e=t.readUint8(),this.base_offset_size=e>>4&15,this.version===1||this.version===2?this.index_size=e&15:this.index_size=0,this.items=[];let i=0;if(this.version<2)i=t.readUint16();else if(this.version===2)i=t.readUint32();else throw new Error("version of iloc box not supported");for(let s=0;s<i;s++){let r=0,n=0,o=0;if(this.version<2)r=t.readUint16();else if(this.version===2)r=t.readUint32();else throw new Error("version of iloc box not supported");this.version===1||this.version===2?n=t.readUint16()&15:n=0;const a=t.readUint16();switch(this.base_offset_size){case 0:o=0;break;case 4:o=t.readUint32();break;case 8:o=t.readUint64();break;default:throw new Error("Error reading base offset size")}const l=[],u=t.readUint16();for(let c=0;c<u;c++){let h=0,f=0,d=0;if(this.version===1||this.version===2)switch(this.index_size){case 0:h=0;break;case 4:h=t.readUint32();break;case 8:h=t.readUint64();break;default:throw new Error("Error reading extent index")}switch(this.offset_size){case 0:f=0;break;case 4:f=t.readUint32();break;case 8:f=t.readUint64();break;default:throw new Error("Error reading extent index")}switch(this.length_size){case 0:d=0;break;case 4:d=t.readUint32();break;case 8:d=t.readUint64();break;default:throw new Error("Error reading extent index")}l.push({extent_index:h,extent_length:d,extent_offset:f})}this.items.push({base_offset:o,construction_method:n,item_ID:r,data_reference_index:a,extents:l})}}},zu.fourcc="iloc",zu),OR={auxl:"Auxiliary image item",base:"Pre-derived image item base",cdsc:"Item describes referenced item",dimg:"Derived image item",dpnd:"Item coding dependency",eroi:"Region",evir:"EVC slice",exbl:"Scalable image item","fdl ":"File delivery",font:"Font item",iloc:"Item data location",mask:"Region mask",mint:"Data integrity",pred:"Predictively coded item",prem:"Pre-multiplied item",tbas:"HEVC tile track base item",text:"Text item",thmb:"Thumbnail image item"},Cn,DR=(Cn=class extends N{constructor(){super(...arguments),this.box_name="ItemReferenceBox",this.references=[]}parse(t){for(this.parseFullHeader(t),this.references=[];t.getPosition()<this.start+this.size;){const e=Ci(t,!0,this.size-(t.getPosition()-this.start));if(e.code===Nt){let i="Unknown item reference";Cn.allowed_types.includes(e.type)?i=OR[e.type]:B.warn("BoxParser",`Unknown item reference type: '${e.type}'`);const s=this.version===0?new gw(e.type,e.size,i,e.hdr_size,e.start):new yw(e.type,e.size,i,e.hdr_size,e.start);s.write===Q.prototype.write&&s.type!=="mdat"&&(B.warn("BoxParser",s.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),s.parseDataAndRewind(t)),s.parse(t),this.references.push(s)}else return}}},Cn.fourcc="iref",Cn.allowed_types=["auxl","base","cdsc","dimg","dpnd","eroi","evir","exbl","fdl ","font","iloc","mask","mint","pred","prem","tbas","text","thmb"],Cn),Uu,LR=(Uu=class extends N{constructor(){super(...arguments),this.box_name="PrimaryItemBox"}parse(t){this.parseFullHeader(t),this.version===0?this.item_id=t.readUint16():this.item_id=t.readUint32()}},Uu.fourcc="pitm",Uu),Bu,NR=(Bu=class extends N{constructor(){super(...arguments),this.box_name="MetaBox",this.isQT=!1}parse(t){const e=t.getPosition();if(this.size>8){switch(t.readUint32(),t.readString(4)){case"hdlr":case"mhdr":case"keys":case"ilst":case"ctry":case"lang":this.isQT=!0;break}t.seek(e)}this.isQT||this.parseFullHeader(t),ze.prototype.parse.call(this,t)}},Bu.fourcc="meta",Bu),Ou,Dw=(Ou=class extends N{constructor(){super(...arguments),this.box_name="MovieFragmentHeaderBox"}parse(t){this.parseFullHeader(t),this.sequence_number=t.readUint32()}write(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.sequence_number)}},Ou.fourcc="mfhd",Ou),Du,Lw=(Du=class extends N{constructor(){super(...arguments),this.box_name="MovieHeaderBox"}parse(t){this.parseFullHeader(t),this.version===1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.rate=t.readUint32(),this.volume=t.readUint16()>>8,t.readUint16(),t.readUint32Array(2),this.matrix=t.readInt32Array(9),t.readUint32Array(6),this.next_track_id=t.readUint32()}write(t){const e=this.modification_time>at||this.creation_time>at||this.duration>at||this.version===1;this.version=e?1:0,this.size=96,this.size+=e?12:0,this.flags=0,this.writeHeader(t),e?(t.writeUint64(this.creation_time),t.writeUint64(this.modification_time),t.writeUint32(this.timescale),t.writeUint64(this.duration)):(t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration)),t.writeUint32(this.rate),t.writeUint16(this.volume<<8),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeInt32Array(this.matrix),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(this.next_track_id)}print(t){super.printHeader(t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"timescale: "+this.timescale),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"rate: "+this.rate),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"next_track_id: "+this.next_track_id)}},Du.fourcc="mvhd",Du),Lu,HR=(Lu=class extends yr{parse(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}},Lu.fourcc="mett",Lu),Nu,GR=(Nu=class extends yr{parse(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.parseFooter(t)}},Nu.fourcc="metx",Nu),Hu,WR=(Hu=class extends Q{constructor(){super(...arguments),this.box_name="AV1CodecConfigurationBox"}parse(t){let e=t.readUint8();if((e>>7&1)!==1){B.error("BoxParser","av1C marker problem",t.isofile);return}if(this.version=e&127,this.version!==1){B.error("BoxParser","av1C version "+this.version+" not supported",t.isofile);return}if(e=t.readUint8(),this.seq_profile=e>>5&7,this.seq_level_idx_0=e&31,e=t.readUint8(),this.seq_tier_0=e>>7&1,this.high_bitdepth=e>>6&1,this.twelve_bit=e>>5&1,this.monochrome=e>>4&1,this.chroma_subsampling_x=e>>3&1,this.chroma_subsampling_y=e>>2&1,this.chroma_sample_position=e&3,e=t.readUint8(),this.reserved_1=e>>5&7,this.reserved_1!==0){B.error("BoxParser","av1C reserved_1 parsing problem",t.isofile);return}if(this.initial_presentation_delay_present=e>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=e&15;else if(this.reserved_2=e&15,this.reserved_2!==0){B.error("BoxParser","av1C reserved_2 parsing problem",t.isofile);return}const i=this.size-this.hdr_size-4;this.configOBUs=t.readUint8Array(i)}},Hu.fourcc="av1C",Hu),Gu,VR=(Gu=class extends N{constructor(){super(...arguments),this.box_name="ElementaryStreamDescriptorBox"}parse(t){this.parseFullHeader(t);const e=t.readUint8Array(this.size-this.hdr_size);if("MPEG4DescriptorParser"in fl){const i=new fl.MPEG4DescriptorParser;this.esd=i.parseOneDescriptor(new ct(e.buffer,0))}}},Gu.fourcc="esds",Gu),Wu,$R=(Wu=class extends N{constructor(){super(...arguments),this.box_name="VPCodecConfigurationRecord"}parse(t){if(this.parseFullHeader(t),this.version===1){this.profile=t.readUint8(),this.level=t.readUint8();const e=t.readUint8();this.bitDepth=e>>4,this.chromaSubsampling=e>>1&7,this.videoFullRangeFlag=e&1,this.colourPrimaries=t.readUint8(),this.transferCharacteristics=t.readUint8(),this.matrixCoefficients=t.readUint8(),this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize)}else{this.profile=t.readUint8(),this.level=t.readUint8();let e=t.readUint8();this.bitDepth=e>>4&15,this.colorSpace=e&15,e=t.readUint8(),this.chromaSubsampling=e>>4&15,this.transferFunction=e>>1&7,this.videoFullRangeFlag=e&1,this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize)}}},Wu.fourcc="vpcC",Wu),Vu,qR=(Vu=class extends N{constructor(){super(...arguments),this.box_name="VvcConfigurationBox"}parse(t){this.parseFullHeader(t);const e={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(n){this.held_bits=n.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(n){this.held_bits=n.readUint16(),this.num_held_bits=16},extract_bits:function(n){const o=this.held_bits>>this.num_held_bits-n&(1<<n)-1;return this.num_held_bits-=n,o}};if(e.stream_read_1_bytes(t),e.extract_bits(5),this.lengthSizeMinusOne=e.extract_bits(2),this.ptl_present_flag=e.extract_bits(1),this.ptl_present_flag){e.stream_read_2_bytes(t),this.ols_idx=e.extract_bits(9),this.num_sublayers=e.extract_bits(3),this.constant_frame_rate=e.extract_bits(2),this.chroma_format_idc=e.extract_bits(2),e.stream_read_1_bytes(t),this.bit_depth_minus8=e.extract_bits(3),e.extract_bits(5);{if(e.stream_read_2_bytes(t),e.extract_bits(2),this.num_bytes_constraint_info=e.extract_bits(6),this.general_profile_idc=e.extract_bits(7),this.general_tier_flag=e.extract_bits(1),this.general_level_idc=t.readUint8(),e.stream_read_1_bytes(t),this.ptl_frame_only_constraint_flag=e.extract_bits(1),this.ptl_multilayer_enabled_flag=e.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(let n=0;n<this.num_bytes_constraint_info-1;n++){const o=e.extract_bits(6);e.stream_read_1_bytes(t);const a=e.extract_bits(2);this.general_constraint_info[n]=o<<2|a}this.general_constraint_info[this.num_bytes_constraint_info-1]=e.extract_bits(6)}else e.extract_bits(6);if(this.num_sublayers>1){e.stream_read_1_bytes(t),this.ptl_sublayer_present_mask=0;for(let n=this.num_sublayers-2;n>=0;--n){const o=e.extract_bits(1);this.ptl_sublayer_present_mask|=o<<n}for(let n=this.num_sublayers;n<=8&&this.num_sublayers>1;++n)e.extract_bits(1);this.sublayer_level_idc=[];for(let n=this.num_sublayers-2;n>=0;--n)this.ptl_sublayer_present_mask&1<<n&&(this.sublayer_level_idc[n]=t.readUint8())}if(this.ptl_num_sub_profiles=t.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(let n=0;n<this.ptl_num_sub_profiles;n++)this.general_sub_profile_idc.push(t.readUint32())}this.max_picture_width=t.readUint16(),this.max_picture_height=t.readUint16(),this.avg_frame_rate=t.readUint16()}const i=12,s=13;this.nalu_arrays=[];const r=t.readUint8();for(let n=0;n<r;n++){const o=[];this.nalu_arrays.push(o),e.stream_read_1_bytes(t),o.completeness=e.extract_bits(1),e.extract_bits(2),o.nalu_type=e.extract_bits(5);let a=1;o.nalu_type!==s&&o.nalu_type!==i&&(a=t.readUint16());for(let l=0;l<a;l++){const u=t.readUint16();o.push({data:t.readUint8Array(u),length:u})}}}},Vu.fourcc="vvcC",Vu),$u,YR=($u=class extends Q{constructor(){super(...arguments),this.box_name="ColourInformationBox"}parse(t){if(this.colour_type=t.readString(4),this.colour_type==="nclx"){this.colour_primaries=t.readUint16(),this.transfer_characteristics=t.readUint16(),this.matrix_coefficients=t.readUint16();const e=t.readUint8();this.full_range_flag=e>>7}else this.colour_type==="rICC"?this.ICC_profile=t.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=t.readUint8Array(this.size-4))}},$u.fourcc="colr",$u);function Zr(t,e){let i=Number(t).toString(16);for(e=typeof e>"u"?2:e;i.length<e;)i="0"+i;return i}var Jl=class extends Ze{getCodec(){const t=super.getCodec();return this.avcC?`${t}.${Zr(this.avcC.AVCProfileIndication)}${Zr(this.avcC.profile_compatibility)}${Zr(this.avcC.AVCLevelIndication)}`:t}},qu,XR=(qu=class extends Jl{constructor(){super(...arguments),this.box_name="AVCSampleEntry"}},qu.fourcc="avc1",qu),Yu,jR=(Yu=class extends Jl{constructor(){super(...arguments),this.box_name="AVC2SampleEntry"}},Yu.fourcc="avc2",Yu),Xu,KR=(Xu=class extends Jl{constructor(){super(...arguments),this.box_name="AVCSampleEntry"}},Xu.fourcc="avc3",Xu),ju,ZR=(ju=class extends Jl{constructor(){super(...arguments),this.box_name="AVC2SampleEntry"}},ju.fourcc="avc4",ju),Ku,JR=(Ku=class extends Ze{constructor(){super(...arguments),this.box_name="AV1SampleEntry"}getCodec(){const t=super.getCodec(),e=this.av1C.seq_level_idx_0,i=e<10?"0"+e:e;let s;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?s=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(s=this.av1C.high_bitdepth===1?"10":"08"),t+"."+this.av1C.seq_profile+"."+i+(this.av1C.seq_tier_0?"H":"M")+"."+s}},Ku.fourcc="av01",Ku),Zu,QR=(Zu=class extends Ze{},Zu.fourcc="dav1",Zu),Ql=class extends Ze{getCodec(){let t=super.getCodec();if(this.hvcC){switch(t+=".",this.hvcC.general_profile_space){case 0:t+="";break;case 1:t+="A";break;case 2:t+="B";break;case 3:t+="C";break}t+=this.hvcC.general_profile_idc,t+=".";let e=this.hvcC.general_profile_compatibility,i=0;for(let n=0;n<32&&(i|=e&1,n!==31);n++)i<<=1,e>>=1;t+=Zr(i,0),t+=".",this.hvcC.general_tier_flag===0?t+="L":t+="H",t+=this.hvcC.general_level_idc;let s=!1,r="";for(let n=5;n>=0;n--)(this.hvcC.general_constraint_indicator[n]||s)&&(r="."+Zr(this.hvcC.general_constraint_indicator[n],0)+r,s=!0);t+=r}return t}},Ju,e4=(Ju=class extends Ql{constructor(){super(...arguments),this.box_name="HEVCSampleEntry"}},Ju.fourcc="hvc1",Ju),Qu,t4=(Qu=class extends Ql{},Qu.fourcc="hvc2",Qu),eh,i4=(eh=class extends Ql{constructor(){super(...arguments),this.box_name="HEVCSampleEntry",this.colrs=[],this.subBoxNames=["colr"]}},eh.fourcc="hev1",eh),th,s4=(th=class extends Ql{},th.fourcc="hev2",th),ih,r4=(ih=class extends Ze{constructor(){super(...arguments),this.box_name="HEVCTileSampleSampleEntry"}},ih.fourcc="hvt1",ih),sh,n4=(sh=class extends Ze{constructor(){super(...arguments),this.box_name="LHEVCSampleEntry"}},sh.fourcc="lhe1",sh),rh,o4=(rh=class extends Ze{constructor(){super(...arguments),this.box_name="LHEVCSampleEntry"}},rh.fourcc="lhv1",rh),nh,a4=(nh=class extends Ze{},nh.fourcc="dvh1",nh),oh,l4=(oh=class extends Ze{},oh.fourcc="dvhe",oh),Nw=class extends Ze{getCodec(){let t=super.getCodec();if(this.vvcC){t+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?t+=".H":t+=".L",t+=this.vvcC.general_level_idc;let e="";if(this.vvcC.general_constraint_info){const i=[];let s=0;s|=this.vvcC.ptl_frame_only_constraint_flag<<7,s|=this.vvcC.ptl_multilayer_enabled_flag<<6;let r;for(let n=0;n<this.vvcC.general_constraint_info.length;++n)s|=this.vvcC.general_constraint_info[n]>>2&63,i.push(s),s&&(r=n),s=this.vvcC.general_constraint_info[n]>>2&3;if(r===void 0)e=".CA";else{e=".C";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";let o=0,a=0;for(let l=0;l<=r;++l)for(o=o<<8|i[l],a+=8;a>=5;){const u=o>>a-5&31;e+=n[u],a-=5,o&=(1<<a)-1}a&&(o<<=5-a,e+=n[o&31])}}t+=e}return t}},ah,c4=(ah=class extends Nw{constructor(){super(...arguments),this.box_name="VvcSampleEntry"}},ah.fourcc="vvc1",ah),lh,u4=(lh=class extends Nw{constructor(){super(...arguments),this.box_name="VvcSampleEntry"}},lh.fourcc="vvi1",lh),ch,h4=(ch=class extends Ze{constructor(){super(...arguments),this.box_name="VvcSampleEntry"}},ch.fourcc="vvs1",ch),uh,d4=(uh=class extends Ze{constructor(){super(...arguments),this.box_name="VvcNonVCLSampleEntry"}},uh.fourcc="vvcN",uh),Hw=class extends Ze{getCodec(){const t=super.getCodec();let e=this.vpcC.level;e===0&&(e="00");let i=this.vpcC.bitDepth;return i===8&&(i="08"),`${t}.0${this.vpcC.profile}.${e}.${i}`}},hh,f4=(hh=class extends Hw{},hh.fourcc="vp08",hh),dh,p4=(dh=class extends Hw{},dh.fourcc="vp09",dh),fh,m4=(fh=class extends Ze{},fh.fourcc="avs3",fh),ph,g4=(ph=class extends Ze{constructor(){super(...arguments),this.box_name="J2KSampleEntry"}},ph.fourcc="j2ki",ph),mh,y4=(mh=class extends Ze{},mh.fourcc="mjp2",mh),gh,v4=(gh=class extends Ze{},gh.fourcc="mjpg",gh),yh,x4=(yh=class extends Ze{constructor(){super(...arguments),this.box_name="UncompressedVideoSampleEntry"}},yh.fourcc="uncv",yh),vh,b4=(vh=class extends Ze{constructor(){super(...arguments),this.box_name="MP4VisualSampleEntry"}},vh.fourcc="mp4v",vh),xh,_4=(xh=class extends zt{constructor(){super(...arguments),this.box_name="MP4AudioSampleEntry"}getCodec(){const t=super.getCodec();if(this.esds&&this.esds.esd){const e=this.esds.esd.getOTI(),i=this.esds.esd.getAudioConfig();return t+"."+Zr(e)+(i?"."+i:"")}else return t}},xh.fourcc="mp4a",xh),bh,w4=(bh=class extends zt{},bh.fourcc="m4ae",bh),_h,S4=(_h=class extends zt{},_h.fourcc="ac-3",_h),wh,C4=(wh=class extends zt{},wh.fourcc="ac-4",wh),Sh,T4=(Sh=class extends zt{},Sh.fourcc="ec-3",Sh),Ch,k4=(Ch=class extends zt{},Ch.fourcc="Opus",Ch),Th,A4=(Th=class extends zt{},Th.fourcc="mha1",Th),kh,I4=(kh=class extends zt{},kh.fourcc="mha2",kh),Ah,P4=(Ah=class extends zt{},Ah.fourcc="mhm1",Ah),Ih,E4=(Ih=class extends zt{},Ih.fourcc="mhm2",Ih),Ph,M4=(Ph=class extends zt{},Ph.fourcc="fLaC",Ph),Eh,F4=(Eh=class extends Ze{},Eh.fourcc="encv",Eh),Mh,R4=(Mh=class extends zt{},Mh.fourcc="enca",Mh),Fh,z4=(Fh=class extends Ls{constructor(){super(...arguments),this.subBoxNames=["sinf"],this.sinfs=[]}},Fh.fourcc="encu",Fh),Rh,U4=(Rh=class extends Zl{constructor(){super(...arguments),this.subBoxNames=["sinf"],this.sinfs=[]}},Rh.fourcc="encs",Rh),zh,B4=(zh=class extends Zl{},zh.fourcc="mp4s",zh),Uh,O4=(Uh=class extends _w{constructor(){super(...arguments),this.subBoxNames=["sinf"],this.sinfs=[]}},Uh.fourcc="enct",Uh),Bh,D4=(Bh=class extends yr{constructor(){super(...arguments),this.subBoxNames=["sinf"],this.sinfs=[]}},Bh.fourcc="encm",Bh),Oh,L4=(Oh=class extends Ze{constructor(){super(...arguments),this.box_name="RestrictedVideoSampleEntry"}},Oh.fourcc="resv",Oh),Dh,N4=(Dh=class extends Ls{parse(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}},Dh.fourcc="sbtt",Dh),Lh,Gw=(Lh=class extends Ls{parse(t){this.parseHeader(t),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.auxiliary_mime_types=t.readCString(),this.parseFooter(t)}write(t){this.writeHeader(t),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,t.writeCString(this.namespace),t.writeCString(this.schema_location),t.writeCString(this.auxiliary_mime_types),this.writeFooter(t)}},Lh.fourcc="stpp",Lh),Nh,H4=(Nh=class extends Ls{parse(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}getCodec(){const t=super.getCodec();return this.mime_format?t+"."+this.mime_format:t}},Nh.fourcc="stxt",Nh),Hh,G4=(Hh=class extends Ls{parse(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)}},Hh.fourcc="tx3g",Hh),Gh,W4=(Gh=class extends yr{parse(t){this.parseHeader(t),this.parseFooter(t)}},Gh.fourcc="wvtt",Gh),Wh,V4=(Wh=class extends N{constructor(){super(...arguments),this.box_name="SampleToGroupBox"}parse(t){this.parseFullHeader(t),this.grouping_type=t.readString(4),this.version===1?this.grouping_type_parameter=t.readUint32():this.grouping_type_parameter=0,this.entries=[];const e=t.readUint32();for(let i=0;i<e;i++)this.entries.push({sample_count:t.readInt32(),group_description_index:t.readInt32()})}write(t){this.grouping_type_parameter?this.version=1:this.version=0,this.flags=0,this.size=8+8*this.entries.length+(this.version===1?4:0),this.writeHeader(t),t.writeString(this.grouping_type,void 0,4),this.version===1&&t.writeUint32(this.grouping_type_parameter),t.writeUint32(this.entries.length);for(let e=0;e<this.entries.length;e++){const i=this.entries[e];t.writeInt32(i.sample_count),t.writeInt32(i.group_description_index)}}},Wh.fourcc="sbgp",Wh),Vh,$4=(Vh=class extends N{constructor(){super(...arguments),this.box_name="SampleDependencyTypeBox"}parse(t){this.parseFullHeader(t);const e=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(let i=0;i<e;i++){const s=t.readUint8();this.is_leading[i]=s>>6,this.sample_depends_on[i]=s>>4&3,this.sample_is_depended_on[i]=s>>2&3,this.sample_has_redundancy[i]=s&3}}},Vh.fourcc="sdtp",Vh),$h,q4=($h=class extends N{constructor(){super(...arguments),this.box_name="SampleGroupDescriptionBox"}parse(t){this.parseFullHeader(t),this.grouping_type=t.readString(4),B.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=t.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=t.readUint32()),this.entries=[];const e=t.readUint32();for(let i=0;i<e;i++){let s;this.grouping_type in Dt.sampleGroupEntry?s=new Dt.sampleGroupEntry[this.grouping_type](this.grouping_type):s=new rt(this.grouping_type),this.entries.push(s),this.version===1?this.default_length===0?s.description_length=t.readUint32():s.description_length=this.default_length:s.description_length=this.default_length,s.write===rt.prototype.write&&(B.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),s.data=t.readUint8Array(s.description_length),t.seek(t.getPosition()-s.description_length)),s.parse(t)}}write(t){this.flags=0,this.size=12;for(let e=0;e<this.entries.length;e++){const i=this.entries[e];this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=i.data.length)}this.writeHeader(t),t.writeString(this.grouping_type,void 0,4),this.version===1&&t.writeUint32(this.default_length),this.version>=2&&t.writeUint32(this.default_sample_description_index),t.writeUint32(this.entries.length);for(let e=0;e<this.entries.length;e++){const i=this.entries[e];this.version===1&&this.default_length===0&&t.writeUint32(i.description_length),i.write(t)}}},$h.fourcc="sgpd",$h),qh,Y4=(qh=class extends N{constructor(){super(...arguments),this.box_name="CompressedSegmentIndexBox"}parse(t){this.parseFullHeader(t),this.reference_ID=t.readUint32(),this.timescale=t.readUint32(),this.version===0?(this.earliest_presentation_time=t.readUint32(),this.first_offset=t.readUint32()):(this.earliest_presentation_time=t.readUint64(),this.first_offset=t.readUint64()),t.readUint16(),this.references=[];const e=t.readUint16();for(let i=0;i<e;i++){const s=t.readUint32(),r=t.readUint32(),n=t.readUint32();this.references.push({reference_type:s>>31&1,referenced_size:s&2147483647,subsegment_duration:r,starts_with_SAP:n>>31&1,SAP_type:n>>28&7,SAP_delta_time:n&268435455})}}write(t){const e=this.earliest_presentation_time>at||this.first_offset>at||this.version===1;this.version=e?1:0,this.size=12+12*this.references.length,this.size+=e?16:8,this.flags=0,this.writeHeader(t),t.writeUint32(this.reference_ID),t.writeUint32(this.timescale),e?(t.writeUint64(this.earliest_presentation_time),t.writeUint64(this.first_offset)):(t.writeUint32(this.earliest_presentation_time),t.writeUint32(this.first_offset)),t.writeUint16(0),t.writeUint16(this.references.length);for(let i=0;i<this.references.length;i++){const s=this.references[i];t.writeUint32(s.reference_type<<31|s.referenced_size),t.writeUint32(s.subsegment_duration),t.writeUint32(s.starts_with_SAP<<31|s.SAP_type<<28|s.SAP_delta_time)}}},qh.fourcc="sidx",qh),Yh,Ww=(Yh=class extends N{constructor(){super(...arguments),this.box_name="SoundMediaHeaderBox"}parse(t){this.parseFullHeader(t),this.balance=t.readUint16(),t.readUint16()}write(t){this.version=0,this.size=4,this.writeHeader(t),t.writeUint16(this.balance),t.writeUint16(0)}},Yh.fourcc="smhd",Yh),Xh,Vw=(Xh=class extends N{constructor(){super(...arguments),this.box_name="ChunkOffsetBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.chunk_offsets=[],this.version===0)for(let i=0;i<e;i++)this.chunk_offsets.push(t.readUint32())}write(t){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),t.writeUint32Array(this.chunk_offsets)}unpack(t){for(let e=0;e<this.chunk_offsets.length;e++)t[e].offset=this.chunk_offsets[e]}},Xh.fourcc="stco",Xh),jh,$w=(jh=class extends N{constructor(){super(...arguments),this.box_name="SubtitleMediaHeaderBox"}},jh.fourcc="sthd",jh),Kh,qw=(Kh=class extends N{constructor(){super(...arguments),this.box_name="SampleToChunkBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(let i=0;i<e;i++)this.first_chunk.push(t.readUint32()),this.samples_per_chunk.push(t.readUint32()),this.sample_description_index.push(t.readUint32())}write(t){this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(t),t.writeUint32(this.first_chunk.length);for(let e=0;e<this.first_chunk.length;e++)t.writeUint32(this.first_chunk[e]),t.writeUint32(this.samples_per_chunk[e]),t.writeUint32(this.sample_description_index[e])}unpack(t){let e=0,i=0;for(let s=0;s<this.first_chunk.length;s++)for(let r=0;r<(s+1<this.first_chunk.length?this.first_chunk[s+1]:1/0);r++){i++;for(let n=0;n<this.samples_per_chunk[s];n++){if(t[e])t[e].description_index=this.sample_description_index[s],t[e].chunk_index=i;else return;e++}}}},Kh.fourcc="stsc",Kh),Zh,Yw=(Zh=class extends N{constructor(){super(...arguments),this.box_name="SampleDescriptionBox"}parse(t){this.parseFullHeader(t),this.entries=[];const e=t.readUint32();for(let i=1;i<=e;i++){const s=Ci(t,!0,this.size-(t.getPosition()-this.start));if(s.code===Nt){let r;s.type in Dt.sampleEntry?(r=new Dt.sampleEntry[s.type](s.size),r.hdr_size=s.hdr_size,r.start=s.start):(B.warn("BoxParser",`Unknown sample entry type: '${s.type}'`),r=new Vi(s.size,s.hdr_size,s.start),r.type=s.type),r.write===Vi.prototype.write&&(B.info("BoxParser","SampleEntry "+r.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),r.parseDataAndRewind(t)),r.parse(t),this.entries.push(r)}else return}}write(t){this.version=0,this.flags=0,this.size=0,this.writeHeader(t),t.writeUint32(this.entries.length),this.size+=4;for(let e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;B.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)}},Zh.fourcc="stsd",Zh),Jh,Xw=(Jh=class extends N{constructor(){super(...arguments),this.box_name="SampleSizeBox"}parse(t){if(this.parseFullHeader(t),this.sample_sizes=[],this.version===0){this.sample_size=t.readUint32(),this.sample_count=t.readUint32();for(let e=0;e<this.sample_count;e++)this.sample_size===0?this.sample_sizes.push(t.readUint32()):this.sample_sizes[e]=this.sample_size}}write(t){let e=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0){let i=0;for(;i+1<this.sample_sizes.length;)if(this.sample_sizes[i+1]!==this.sample_sizes[0]){e=!1;break}else i++}else e=!1;this.size=8,e||(this.size+=4*this.sample_sizes.length),this.writeHeader(t),e?t.writeUint32(this.sample_sizes[0]):t.writeUint32(0),t.writeUint32(this.sample_sizes.length),e||t.writeUint32Array(this.sample_sizes)}unpack(t){for(let e=0;e<this.sample_sizes.length;e++)t[e].size=this.sample_sizes[e]}},Jh.fourcc="stsz",Jh),Qh,jw=(Qh=class extends N{constructor(){super(...arguments),this.box_name="TimeToSampleBox",this.sample_counts=[],this.sample_deltas=[]}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.sample_counts.length=0,this.sample_deltas.length=0,this.version===0)for(let i=0;i<e;i++){this.sample_counts.push(t.readUint32());let s=t.readInt32();s<0&&(B.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),s=1),this.sample_deltas.push(s)}}write(t){this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length);for(let e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),t.writeUint32(this.sample_deltas[e])}unpack(t){let e=0;for(let i=0;i<this.sample_counts.length;i++)for(let s=0;s<this.sample_counts[i];s++)e===0?t[e].dts=0:t[e].dts=t[e-1].dts+this.sample_deltas[i],e++}},Qh.fourcc="stts",Qh),ed,Kw=(ed=class extends N{constructor(){super(...arguments),this.box_name="TrackFragmentBaseMediaDecodeTimeBox"}parse(t){this.parseFullHeader(t),this.version===1?this.baseMediaDecodeTime=t.readUint64():this.baseMediaDecodeTime=t.readUint32()}write(t){const e=this.baseMediaDecodeTime>at||this.version===1;this.version=e?1:0,this.size=4,this.size+=e?4:0,this.flags=0,this.writeHeader(t),e?t.writeUint64(this.baseMediaDecodeTime):t.writeUint32(this.baseMediaDecodeTime)}},ed.fourcc="tfdt",ed),td,Zw=(td=class extends N{constructor(){super(...arguments),this.box_name="TrackFragmentHeaderBox"}parse(t){this.parseFullHeader(t);let e=0;this.track_id=t.readUint32(),this.size-this.hdr_size>e&&this.flags&ka?(this.base_data_offset=t.readUint64(),e+=8):this.base_data_offset=0,this.size-this.hdr_size>e&&this.flags&Aa?(this.default_sample_description_index=t.readUint32(),e+=4):this.default_sample_description_index=0,this.size-this.hdr_size>e&&this.flags&Ia?(this.default_sample_duration=t.readUint32(),e+=4):this.default_sample_duration=0,this.size-this.hdr_size>e&&this.flags&Pa?(this.default_sample_size=t.readUint32(),e+=4):this.default_sample_size=0,this.size-this.hdr_size>e&&this.flags&Ea?(this.default_sample_flags=t.readUint32(),e+=4):this.default_sample_flags=0}write(t){this.version=0,this.size=4,this.flags&ka&&(this.size+=8),this.flags&Aa&&(this.size+=4),this.flags&Ia&&(this.size+=4),this.flags&Pa&&(this.size+=4),this.flags&Ea&&(this.size+=4),this.writeHeader(t),t.writeUint32(this.track_id),this.flags&ka&&t.writeUint64(this.base_data_offset),this.flags&Aa&&t.writeUint32(this.default_sample_description_index),this.flags&Ia&&t.writeUint32(this.default_sample_duration),this.flags&Pa&&t.writeUint32(this.default_sample_size),this.flags&Ea&&t.writeUint32(this.default_sample_flags)}},td.fourcc="tfhd",td),id,Jw=(id=class extends N{constructor(){super(...arguments),this.box_name="TrackHeaderBox",this.layer=0,this.alternate_group=0}parse(t){this.parseFullHeader(t),this.version===1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint32()),t.readUint32Array(2),this.layer=t.readInt16(),this.alternate_group=t.readInt16(),this.volume=t.readInt16()>>8,t.readUint16(),this.matrix=t.readInt32Array(9),this.width=t.readUint32(),this.height=t.readUint32()}write(t){const e=this.modification_time>at||this.creation_time>at||this.duration>at||this.version===1;this.version=e?1:0,this.size=80,this.size+=e?12:0,this.flags=this.flags??3,this.writeHeader(t),e?(t.writeUint64(this.creation_time),t.writeUint64(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint64(this.duration)):(t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint32(this.duration)),t.writeUint32Array([0,0]),t.writeInt16(this.layer),t.writeInt16(this.alternate_group),t.writeInt16(this.volume<<8),t.writeInt16(0),t.writeInt32Array(this.matrix),t.writeUint32(this.width),t.writeUint32(this.height)}print(t){super.printHeader(t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"track_id: "+this.track_id),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"layer: "+this.layer),t.log(t.indent+"alternate_group: "+this.alternate_group),t.log(t.indent+"width: "+this.width),t.log(t.indent+"height: "+this.height)}},id.fourcc="tkhd",id),sd,lg=(sd=class extends N{constructor(){super(...arguments),this.box_name="TrackExtendsBox"}parse(t){this.parseFullHeader(t),this.track_id=t.readUint32(),this.default_sample_description_index=t.readUint32(),this.default_sample_duration=t.readUint32(),this.default_sample_size=t.readUint32(),this.default_sample_flags=t.readUint32()}write(t){this.version=0,this.flags=0,this.size=20,this.writeHeader(t),t.writeUint32(this.track_id),t.writeUint32(this.default_sample_description_index),t.writeUint32(this.default_sample_duration),t.writeUint32(this.default_sample_size),t.writeUint32(this.default_sample_flags)}},sd.fourcc="trex",sd),rd,Qw=(rd=class extends N{constructor(){super(...arguments),this.box_name="TrackRunBox",this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[]}parse(t){this.parseFullHeader(t);let e=0;if(this.sample_count=t.readUint32(),e+=4,this.size-this.hdr_size>e&&this.flags&Jn?(this.data_offset=t.readInt32(),e+=4):this.data_offset=0,this.size-this.hdr_size>e&&this.flags&Ma?(this.first_sample_flags=t.readUint32(),e+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>e)for(let i=0;i<this.sample_count;i++)this.flags&Qn&&(this.sample_duration[i]=t.readUint32()),this.flags&eo&&(this.sample_size[i]=t.readUint32()),this.flags&to&&(this.sample_flags[i]=t.readUint32()),this.flags&io&&(this.version===0?this.sample_composition_time_offset[i]=t.readUint32():this.sample_composition_time_offset[i]=t.readInt32())}write(t){this.size=4,this.flags&Jn&&(this.size+=4),this.flags&Ma&&(this.size+=4),this.flags&Qn&&(this.size+=4*this.sample_duration.length),this.flags&eo&&(this.size+=4*this.sample_size.length),this.flags&to&&(this.size+=4*this.sample_flags.length),this.flags&io&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(t),t.writeUint32(this.sample_count),this.flags&Jn&&(this.data_offset_position=t.getPosition(),t.writeInt32(this.data_offset)),this.flags&Ma&&t.writeUint32(this.first_sample_flags);for(let e=0;e<this.sample_count;e++)this.flags&Qn&&t.writeUint32(this.sample_duration[e]),this.flags&eo&&t.writeUint32(this.sample_size[e]),this.flags&to&&t.writeUint32(this.sample_flags[e]),this.flags&io&&(this.version===0?t.writeUint32(this.sample_composition_time_offset[e]):t.writeInt32(this.sample_composition_time_offset[e]))}},rd.fourcc="trun",rd),nd,e2=(nd=class extends N{constructor(){super(...arguments),this.box_name="DataEntryUrlBox"}parse(t){this.parseFullHeader(t),this.flags!==1&&(this.location=t.readCString())}write(t){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(t),this.location&&t.writeCString(this.location)}},nd.fourcc="url ",nd),od,t2=(od=class extends N{constructor(){super(...arguments),this.box_name="VideoMediaHeaderBox"}parse(t){this.parseFullHeader(t),this.graphicsmode=t.readUint16(),this.opcolor=t.readUint16Array(3)}write(t){this.version=0,this.size=8,this.writeHeader(t),t.writeUint16(this.graphicsmode),t.writeUint16Array(this.opcolor)}},od.fourcc="vmhd",od),za=class{constructor(t,e,i){this.grouping_type=t,this.grouping_type_parameter=e,this.sbgp=i,this.last_sample_in_run=-1,this.entry_index=-1}},i2=class xs{constructor(e,i=!0){this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.moovStartSent=!1,this.readySent=!1,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.sidxSent=!1,this.items=[],this.entity_groups=[],this.itemsDataSize=0,this.lastMoofIndex=0,this.samplesDataSize=0,this.lastBoxStartPosition=0,this.nextParsePosition=0,this.discardMdatData=!0,this.discardMdatData=i,e?(this.stream=e,this.parse()):this.stream=new Kr,this.stream.isofile=this}setSegmentOptions(e,i,s){const{sizePerSegment:r=Number.MAX_SAFE_INTEGER,rapAlignement:n=!0}=s;let o=s.nbSamples??s.nbSamplesPerFragment??1e3;const a=s.nbSamplesPerFragment??o;if(o<=0||a<=0||r<=0){B.error("ISOFile",`Invalid segment options: nbSamples=${o}, nbSamplesPerFragment=${a}, sizePerSegment=${r}`);return}if(o<a&&(B.warn("ISOFile",`nbSamples (${o}) is less than nbSamplesPerFragment (${a}), setting nbSamples to nbSamplesPerFragment`),o=a),this.fragmentedTracks.some(u=>u.nb_samples!==o)){B.error("ISOFile",`Cannot set segment options for track ${e}: nbSamples (${o}) does not match existing tracks`);return}const l=this.getTrackById(e);if(l){const u={id:e,user:i,trak:l,segmentStream:void 0,nb_samples:o,nb_samples_per_fragment:a,size_per_segment:r,rapAlignement:n,state:{lastFragmentSampleNumber:0,lastSegmentSampleNumber:0,accumulatedSize:0}};this.fragmentedTracks.push(u),l.nextSample=0}this.discardMdatData&&B.warn("ISOFile","Segmentation options set but discardMdatData is true, samples will not be segmented")}unsetSegmentOptions(e){let i=-1;for(let s=0;s<this.fragmentedTracks.length;s++)this.fragmentedTracks[s].id===e&&(i=s);i>-1&&this.fragmentedTracks.splice(i,1)}setExtractionOptions(e,i,{nbSamples:s=1e3}={}){const r=this.getTrackById(e);r&&(this.extractedTracks.push({id:e,user:i,trak:r,nb_samples:s,samples:[]}),r.nextSample=0),this.discardMdatData&&B.warn("ISOFile","Extraction options set but discardMdatData is true, samples will not be extracted")}unsetExtractionOptions(e){let i=-1;for(let s=0;s<this.extractedTracks.length;s++)this.extractedTracks[s].id===e&&(i=s);i>-1&&this.extractedTracks.splice(i,1)}parse(){if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else{this.saveParsePosition&&this.saveParsePosition();const e=Ci(this.stream,!1);if(e.code===vs)if(this.processIncompleteBox){if(this.processIncompleteBox(e))continue;return}else return;else if(e.code===Nt){const i=e.box;if(this.boxes.push(i),i.type==="uuid")this[i.uuid]!==void 0&&B.warn("ISOFile","Duplicate Box of uuid: "+i.uuid+", overriding previous occurrence"),this[i.uuid]=i;else switch(i.type){case"mdat":this.mdats.push(i),this.transferMdatData(i);break;case"moof":this.moofs.push(i);break;case"free":case"skip":break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[i.type]!==void 0?Array.isArray(this[i.type+"s"])?(B.info("ISOFile",`Found multiple boxes of type ${i.type} in ISOFile, adding to array`),this[i.type+"s"].push(i)):(B.warn("ISOFile",`Found multiple boxes of type ${i.type} but no array exists. Creating array dynamically.`),this[i.type+"s"]=[this[i.type],i]):(this[i.type]=i,Array.isArray(this[i.type+"s"])&&this[i.type+"s"].push(i));break}this.updateUsedBytes&&this.updateUsedBytes(i,e)}else if(e.code===dw){B.error("ISOFile",`Invalid data found while parsing box of type '${e.type}' at position ${e.start}. Aborting parsing.`,this);break}}}checkBuffer(e){if(!e)throw new Error("Buffer must be defined and non empty");return e.byteLength===0?(B.warn("ISOFile","Ignoring empty buffer (fileStart: "+e.fileStart+")"),this.stream.logBufferLevel(),!1):(B.info("ISOFile","Processing buffer (fileStart: "+e.fileStart+")"),e.usedBytes=0,this.stream.insertBuffer(e),this.stream.logBufferLevel(),this.stream.initialized()?!0:(B.warn("ISOFile","Not ready to start parsing"),!1))}appendBuffer(e,i){let s;if(this.checkBuffer(e))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(i),this.nextSeekPosition?(s=this.nextSeekPosition,this.nextSeekPosition=void 0):s=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(s=this.stream.getEndFilePositionAfter(s))):this.nextParsePosition?s=this.nextParsePosition:s=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(B.info("ISOFile","Done processing buffer (fileStart: "+e.fileStart+") - next buffer to fetch should have a fileStart position of "+s),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),B.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),s}getFragmentDuration(){const e=this.getBox("mvex");if(!e)return;if(e.mehd)return{num:e.mehd.fragment_duration,den:this.moov.mvhd.timescale};const i=this.getBoxes("trak",!1);let s={num:0,den:1};for(const r of i){const n=r.samples_duration,o=r.mdia.mdhd.timescale;n&&o&&n/o>s.num/s.den&&(s={num:n,den:o})}return s}getInfo(){if(!this.moov)return{hasMoov:!1,mime:""};const e=new Date("1904-01-01T00:00:00Z").getTime(),i=this.getBox("mvex")!==void 0,s={hasMoov:!0,duration:this.moov.mvhd.duration,timescale:this.moov.mvhd.timescale,isFragmented:i,fragment_duration:this.getFragmentDuration(),isProgressive:this.isProgressive,hasIOD:this.moov.iods!==void 0,brands:[this.ftyp.major_brand].concat(this.ftyp.compatible_brands),created:new Date(e+this.moov.mvhd.creation_time*1e3),modified:new Date(e+this.moov.mvhd.modification_time*1e3),tracks:[],audioTracks:[],videoTracks:[],subtitleTracks:[],metadataTracks:[],hintTracks:[],otherTracks:[],mime:""};for(let r=0;r<this.moov.traks.length;r++){const n=this.moov.traks[r],o=n.mdia.minf.stbl.stsd.entries[0],a=n.samples_size,l=n.mdia.mdhd.timescale,u=n.samples_duration,c=a*8*l/u,h={samples_duration:u,bitrate:c,size:a,timescale:l,alternate_group:n.tkhd.alternate_group,codec:o.getCodec(),created:new Date(e+n.tkhd.creation_time*1e3),cts_shift:n.mdia.minf.stbl.cslg,duration:n.mdia.mdhd.duration,id:n.tkhd.track_id,kind:n.udta&&n.udta.kinds.length?n.udta.kinds[0]:{schemeURI:"",value:""},language:n.mdia.elng?n.mdia.elng.extended_language:n.mdia.mdhd.languageString,layer:n.tkhd.layer,matrix:n.tkhd.matrix,modified:new Date(e+n.tkhd.modification_time*1e3),movie_duration:n.tkhd.duration,movie_timescale:s.timescale,name:n.mdia.hdlr.name,nb_samples:n.samples.length,references:[],track_height:n.tkhd.height/65536,track_width:n.tkhd.width/65536,volume:n.tkhd.volume};if(s.tracks.push(h),n.tref)for(let f=0;f<n.tref.references.length;f++)h.references.push({type:n.tref.references[f].type,track_ids:n.tref.references[f].track_ids});n.edts!==void 0&&n.edts.elst!==void 0&&(h.edits=n.edts.elst.entries),o instanceof zt?(h.type="audio",s.audioTracks.push(h),h.audio={sample_rate:o.getSampleRate(),channel_count:o.getChannelCount(),sample_size:o.getSampleSize()}):o instanceof Ze?(h.type="video",s.videoTracks.push(h),h.video={width:o.getWidth(),height:o.getHeight()}):o instanceof Ls?(h.type="subtitles",s.subtitleTracks.push(h)):o instanceof ng?(h.type="metadata",s.hintTracks.push(h)):o instanceof yr?(h.type="metadata",s.metadataTracks.push(h)):(h.type="metadata",s.otherTracks.push(h))}s.videoTracks&&s.videoTracks.length>0?s.mime+='video/mp4; codecs="':s.audioTracks&&s.audioTracks.length>0?s.mime+='audio/mp4; codecs="':s.mime+='application/mp4; codecs="';for(let r=0;r<s.tracks.length;r++)r!==0&&(s.mime+=","),s.mime+=s.tracks[r].codec;return s.mime+='"; profiles="',s.mime+=this.ftyp.compatible_brands.join(),s.mime+='"',s}setNextSeekPositionFromSample(e){e&&(this.nextSeekPosition?this.nextSeekPosition=Math.min(e.offset+e.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=e.offset+e.alreadyRead)}processSamples(e){if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==void 0){const i=new Set;for(;i.size<this.fragmentedTracks.length&&this.fragmentedTracks.some(s=>s.trak.nextSample<s.trak.samples.length)&&this.sampleProcessingStarted;)for(const s of this.fragmentedTracks){const r=s.trak;if(!i.has(s.id)){const n=r.nextSample<r.samples.length?this.getSample(r,r.nextSample):void 0;if(!n){this.setNextSeekPositionFromSample(r.samples[r.nextSample]),i.add(s.id);continue}s.state.accumulatedSize+=n.size;const o=r.nextSample+1,a=o-s.state.lastFragmentSampleNumber>s.nb_samples_per_fragment,l=o-s.state.lastSegmentSampleNumber>s.nb_samples;let u=a||o%s.nb_samples_per_fragment===0,c=l||o%s.nb_samples===0,h=s.state.accumulatedSize>=s.size_per_segment;const f=!s.rapAlignement||n.is_sync,d=e||r.nextSample+1>=r.samples.length;if(d&&!f&&B.warn("ISOFile","Flushing track #"+s.id+" at sample #"+r.nextSample+" which is not a RAP, this may lead to playback issues"),u=u&&f,c=c&&f,h=h&&f,u||h||d){a?B.warn("ISOFile","Fragment on track #"+s.id+" is overdue, creating it with samples ["+s.state.lastFragmentSampleNumber+", "+r.nextSample+"]"):B.debug("ISOFile","Creating media fragment on track #"+s.id+" for samples ["+s.state.lastFragmentSampleNumber+", "+r.nextSample+"]");const p=this.createFragment(s.id,s.state.lastFragmentSampleNumber,r.nextSample,s.segmentStream);if(p)s.segmentStream=p,s.state.lastFragmentSampleNumber=r.nextSample+1;else{i.add(s.id);continue}}(c||h||d)&&(l?B.warn("ISOFile","Segment on track #"+s.id+" is overdue, sending it with samples ["+Math.max(0,r.nextSample-s.nb_samples)+", "+(r.nextSample-1)+"]"):B.info("ISOFile","Sending fragmented data on track #"+s.id+" for samples ["+Math.max(0,r.nextSample-s.nb_samples)+", "+(r.nextSample-1)+"]"),B.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(s.id,s.user,s.segmentStream.buffer,r.nextSample+1,e||r.nextSample+1>=r.samples.length),s.segmentStream=void 0,s.state.accumulatedSize=0,s.state.lastSegmentSampleNumber=r.nextSample+1),r.nextSample++}}}if(this.onSamples!==void 0)for(let i=0;i<this.extractedTracks.length;i++){const s=this.extractedTracks[i],r=s.trak;for(;r.nextSample<r.samples.length&&this.sampleProcessingStarted;){B.debug("ISOFile","Exporting on track #"+s.id+" sample #"+r.nextSample);const n=this.getSample(r,r.nextSample);if(n)r.nextSample++,s.samples.push(n);else{this.setNextSeekPositionFromSample(r.samples[r.nextSample]);break}if((r.nextSample%s.nb_samples===0||r.nextSample>=r.samples.length)&&(B.debug("ISOFile","Sending samples on track #"+s.id+" for sample "+r.nextSample),this.onSamples&&this.onSamples(s.id,s.user,s.samples),s.samples=[],s!==this.extractedTracks[i]))break}}}}getBox(e){const i=this.getBoxes(e,!0);return i.length?i[0]:void 0}getBoxes(e,i){const s=[],r=n=>{n instanceof Q&&n.type&&n.type===e&&s.push(n);const o=[];n.boxes&&o.push(...n.boxes),n.entries&&o.push(...n.entries),n.item_infos&&o.push(...n.item_infos),n.references&&o.push(...n.references);for(const a of o){if(s.length&&i)return;r(a)}};return r(this),s}getTrackSamplesInfo(e){const i=this.getTrackById(e);if(i)return i.samples}getTrackSample(e,i){const s=this.getTrackById(e);return this.getSample(s,i)}releaseUsedSamples(e,i){let s=0;const r=this.getTrackById(e);r.lastValidSample||(r.lastValidSample=0);for(let n=r.lastValidSample;n<i;n++)s+=this.releaseSample(r,n);B.info("ISOFile","Track #"+e+" released samples up to "+i+" (released size: "+s+", remaining: "+this.samplesDataSize+")"),r.lastValidSample=i}start(){this.sampleProcessingStarted=!0,this.processSamples(!1)}stop(){this.sampleProcessingStarted=!1}flush(){B.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)}seekTrack(e,i,s){let r=0,n=0,o;if(s.samples.length===0)return B.info("ISOFile","No sample in track, cannot seek! Using time "+B.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(let l=0;l<s.samples.length;l++){const u=s.samples[l];if(l===0)n=0,o=u.timescale;else if(u.cts>e*u.timescale){n=l-1;break}i&&u.is_sync&&(r=l)}for(i&&(n=r),e=s.samples[n].cts,s.nextSample=n;s.samples[n].alreadyRead===s.samples[n].size&&s.samples[n+1];)n++;const a=s.samples[n].offset+s.samples[n].alreadyRead;return B.info("ISOFile","Seeking to "+(i?"RAP":"")+" sample #"+s.nextSample+" on track "+s.tkhd.track_id+", time "+B.getDurationString(e,o)+" and offset: "+a),{offset:a,time:e/o}}getTrackDuration(e){if(!e.samples)return 1/0;const i=e.samples[e.samples.length-1];return(i.cts+i.duration)/i.timescale}seek(e,i){const s=this.moov;let r={offset:1/0,time:1/0};if(this.moov){for(let n=0;n<s.traks.length;n++){const o=s.traks[n];if(e>this.getTrackDuration(o))continue;const a=this.seekTrack(e,i,o);a.offset<r.offset&&(r.offset=a.offset),a.time<r.time&&(r.time=a.time)}return B.info("ISOFile","Seeking at time "+B.getDurationString(r.time,1)+" needs a buffer with a fileStart position of "+r.offset),r.offset===1/0?r={offset:this.nextParsePosition,time:0}:r.offset=this.stream.getEndFilePositionAfter(r.offset),B.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+r.offset),r}else throw new Error("Cannot seek: moov not received!")}equal(e){let i=0;for(;i<this.boxes.length&&i<e.boxes.length;){const s=this.boxes[i],r=e.boxes[i];if(!F0(s,r))return!1;i++}return!0}write(e){for(let i=0;i<this.boxes.length;i++)this.boxes[i].write(e)}createFragment(e,i,s,r){const n=[];for(let c=i;c<=s;c++){const h=this.getTrackById(e),f=this.getSample(h,c);if(!f){this.setNextSeekPositionFromSample(h.samples[c]);return}n.push(f)}const o=r||new ct,a=this.createMoof(n);a.write(o),a.trafs[0].truns[0].data_offset=a.size+8,B.debug("MP4Box","Adjusting data_offset with new value "+a.trafs[0].truns[0].data_offset),o.adjustUint32(a.trafs[0].truns[0].data_offset_position,a.trafs[0].truns[0].data_offset);const l=new Fa;l.stream=new Kr;let u=0;for(const c of n)if(c.data){const h=Ui.fromArrayBuffer(c.data.buffer,u);l.stream.insertBuffer(h),u+=c.data.byteLength}return l.write(o),o}static writeInitializationSegment(e,i,s){B.debug("ISOFile","Generating initialization segment");const r=new ct;e.write(r);const n=i.addBox(new ag);if(s){const o=n.addBox(new Ow);o.fragment_duration=s}for(let o=0;o<i.traks.length;o++){const a=n.addBox(new lg);a.track_id=i.traks[o].tkhd.track_id,a.default_sample_description_index=1,a.default_sample_duration=i.traks[o].samples[0]?.duration??0,a.default_sample_size=0,a.default_sample_flags=65536}return i.write(r),r.buffer}save(e){const i=new ct;return i.isofile=this,this.write(i),i.save(e)}getBuffer(){const e=new ct;return e.isofile=this,this.write(e),e}initializeSegmentation(){this.onSegment||B.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.resetTables());const e=new og;e.addBox(this.moov.mvhd);for(let i=0;i<this.fragmentedTracks.length;i++){const s=this.getTrackById(this.fragmentedTracks[i].id);if(!s){B.warn("ISOFile",`Track with id ${this.fragmentedTracks[i].id} not found, skipping fragmentation initialization`);continue}e.addBox(s)}return{tracks:e.traks.map((i,s)=>({id:i.tkhd.track_id,user:this.fragmentedTracks[s].user})),buffer:xs.writeInitializationSegment(this.ftyp,e,this.moov?.mvex?.mehd.fragment_duration)}}resetTables(){this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0;for(let e=0;e<this.moov.traks.length;e++){const i=this.moov.traks[e];i.tkhd.duration=0,i.mdia.mdhd.duration=0;const s=i.mdia.minf.stbl.stco||i.mdia.minf.stbl.co64;s.chunk_offsets=[];const r=i.mdia.minf.stbl.stsc;r.first_chunk=[],r.samples_per_chunk=[],r.sample_description_index=[];const n=i.mdia.minf.stbl.stsz||i.mdia.minf.stbl.stz2;n.sample_sizes=[];const o=i.mdia.minf.stbl.stts;o.sample_counts=[],o.sample_deltas=[];const a=i.mdia.minf.stbl.ctts;a&&(a.sample_counts=[],a.sample_offsets=[]);const l=i.mdia.minf.stbl.stss,u=i.mdia.minf.stbl.boxes.indexOf(l);u!==-1&&(i.mdia.minf.stbl.boxes[u]=void 0)}}static initSampleGroups(e,i,s,r,n){i&&(i.sample_groups_info=[]),e.sample_groups_info||(e.sample_groups_info=[]);for(let o=0;o<s.length;o++){const a=s[o].grouping_type+"/"+s[o].grouping_type_parameter,l=new za(s[o].grouping_type,s[o].grouping_type_parameter,s[o]);i&&(i.sample_groups_info[a]=l),e.sample_groups_info[a]||(e.sample_groups_info[a]=l);for(let u=0;u<r.length;u++)r[u].grouping_type===s[o].grouping_type&&(l.description=r[u],l.description.used=!0);if(n)for(let u=0;u<n.length;u++)n[u].grouping_type===s[o].grouping_type&&(l.fragment_description=n[u],l.fragment_description.used=!0,l.is_fragment=!0)}if(i){if(n){for(let o=0;o<n.length;o++)if(!n[o].used&&n[o].version>=2){const a=n[o].grouping_type+"/0",l=new za(n[o].grouping_type,0);l.is_fragment=!0,i.sample_groups_info[a]||(i.sample_groups_info[a]=l)}}}else for(let o=0;o<r.length;o++)if(!r[o].used&&r[o].version>=2){const a=r[o].grouping_type+"/0",l=new za(r[o].grouping_type,0);e.sample_groups_info[a]||(e.sample_groups_info[a]=l)}}static setSampleGroupProperties(e,i,s,r){i.sample_groups=[];for(const n in r)if(i.sample_groups[n]={grouping_type:r[n].grouping_type,grouping_type_parameter:r[n].grouping_type_parameter},s>=r[n].last_sample_in_run&&(r[n].last_sample_in_run<0&&(r[n].last_sample_in_run=0),r[n].entry_index++,r[n].entry_index<=r[n].sbgp.entries.length-1&&(r[n].last_sample_in_run+=r[n].sbgp.entries[r[n].entry_index].sample_count)),r[n].entry_index<=r[n].sbgp.entries.length-1?i.sample_groups[n].group_description_index=r[n].sbgp.entries[r[n].entry_index].group_description_index:i.sample_groups[n].group_description_index=-1,i.sample_groups[n].group_description_index!==0){let o;if(r[n].fragment_description?o=r[n].fragment_description:o=r[n].description,i.sample_groups[n].group_description_index>0){let a;i.sample_groups[n].group_description_index>65535?a=(i.sample_groups[n].group_description_index>>16)-1:a=i.sample_groups[n].group_description_index-1,o&&a>=0&&(i.sample_groups[n].description=o.entries[a])}else o&&o.version>=2&&o.default_group_description_index>0&&(i.sample_groups[n].description=o.entries[o.default_group_description_index-1])}}static process_sdtp(e,i,s){i&&(e?(i.is_leading=e.is_leading[s],i.depends_on=e.sample_depends_on[s],i.is_depended_on=e.sample_is_depended_on[s],i.has_redundancy=e.sample_has_redundancy[s]):(i.is_leading=0,i.depends_on=0,i.is_depended_on=0,i.has_redundancy=0))}buildSampleLists(){for(let e=0;e<this.moov.traks.length;e++)this.buildTrakSampleLists(this.moov.traks[e])}buildTrakSampleLists(e){let i,s,r,n,o,a;e.samples=[],e.samples_duration=0,e.samples_size=0;const l=e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64,u=e.mdia.minf.stbl.stsc,c=e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2,h=e.mdia.minf.stbl.stts,f=e.mdia.minf.stbl.ctts,d=e.mdia.minf.stbl.stss,p=e.mdia.minf.stbl.stsd,m=e.mdia.minf.stbl.subs,g=e.mdia.minf.stbl.stdp,y=e.mdia.minf.stbl.sbgps,b=e.mdia.minf.stbl.sgpds;let v=-1,x=-1,_=-1,S=-1,T=0,A=0,w=0;if(xs.initSampleGroups(e,void 0,y,b),!(typeof c>"u")){for(i=0;i<c.sample_sizes.length;i++){const k={number:i,track_id:e.tkhd.track_id,timescale:e.mdia.mdhd.timescale,alreadyRead:0,size:c.sample_sizes[i]};e.samples[i]=k,e.samples_size+=k.size,i===0?(r=1,s=0,k.chunk_index=r,k.chunk_run_index=s,a=u.samples_per_chunk[s],o=0,s+1<u.first_chunk.length?n=u.first_chunk[s+1]-1:n=1/0):i<a?(k.chunk_index=r,k.chunk_run_index=s):(r++,k.chunk_index=r,o=0,r<=n||(s++,s+1<u.first_chunk.length?n=u.first_chunk[s+1]-1:n=1/0),k.chunk_run_index=s,a+=u.samples_per_chunk[s]),k.description_index=u.sample_description_index[k.chunk_run_index]-1,k.description=p.entries[k.description_index],k.offset=l.chunk_offsets[k.chunk_index-1]+o,o+=k.size,i>v&&(x++,v<0&&(v=0),v+=h.sample_counts[x]),i>0?(e.samples[i-1].duration=h.sample_deltas[x],e.samples_duration+=e.samples[i-1].duration,k.dts=e.samples[i-1].dts+e.samples[i-1].duration):k.dts=0,f?(i>=_&&(S++,_<0&&(_=0),_+=f.sample_counts[S]),k.cts=e.samples[i].dts+f.sample_offsets[S]):k.cts=k.dts,d?(i===d.sample_numbers[T]-1?(k.is_sync=!0,T++):(k.is_sync=!1,k.degradation_priority=0),m&&m.entries[A].sample_delta+w===i+1&&(k.subsamples=m.entries[A].subsamples,w+=m.entries[A].sample_delta,A++)):k.is_sync=!0,xs.process_sdtp(e.mdia.minf.stbl.sdtp,k,k.number),g?k.degradation_priority=g.priority[i]:k.degradation_priority=0,m&&m.entries[A].sample_delta+w===i&&(k.subsamples=m.entries[A].subsamples,w+=m.entries[A].sample_delta),(y.length>0||b.length>0)&&xs.setSampleGroupProperties(e,k,i,e.sample_groups_info)}i>0&&(e.samples[i-1].duration=Math.max(e.mdia.mdhd.duration-e.samples[i-1].dts,0),e.samples_duration+=e.samples[i-1].duration)}}updateSampleLists(){let e,i,s,r,n;if(this.moov!==void 0)for(;this.lastMoofIndex<this.moofs.length;){const o=this.moofs[this.lastMoofIndex];if(this.lastMoofIndex++,o.type==="moof"){const a=o;for(let l=0;l<a.trafs.length;l++){const u=a.trafs[l],c=this.getTrackById(u.tfhd.track_id),h=this.getTrexById(u.tfhd.track_id);u.tfhd.flags&Aa?e=u.tfhd.default_sample_description_index:e=h?h.default_sample_description_index:1,u.tfhd.flags&Ia?i=u.tfhd.default_sample_duration:i=h?h.default_sample_duration:0,u.tfhd.flags&Pa?s=u.tfhd.default_sample_size:s=h?h.default_sample_size:0,u.tfhd.flags&Ea?r=u.tfhd.default_sample_flags:r=h?h.default_sample_flags:0,u.sample_number=0,u.sbgps.length>0&&xs.initSampleGroups(c,u,u.sbgps,c.mdia.minf.stbl.sgpds,u.sgpds);for(let f=0;f<u.truns.length;f++){const d=u.truns[f];for(let p=0;p<d.sample_count;p++){const m=e-1;let g=r;d.flags&to?g=d.sample_flags[p]:p===0&&d.flags&Ma&&(g=d.first_sample_flags);let y=s;d.flags&eo&&(y=d.sample_size[p]),c.samples_size+=y;let b=i;d.flags&Qn&&(b=d.sample_duration[p]),c.samples_duration+=b;let v;c.first_traf_merged||p>0?v=c.samples[c.samples.length-1].dts+c.samples[c.samples.length-1].duration:(u.tfdt?v=u.tfdt.baseMediaDecodeTime:v=0,c.first_traf_merged=!0);let x=v;d.flags&io&&(x=v+d.sample_composition_time_offset[p]);const _=!!(u.tfhd.flags&ka),S=!!(u.tfhd.flags&Pv),T=!!(d.flags&Jn);let A=0;_?A=u.tfhd.base_data_offset:S||f===0?A=a.start:A=n;let w;f===0&&p===0?T?w=A+d.data_offset:w=A:w=n,n=w+y;const k=u.sample_number;u.sample_number++;const F={cts:x,description_index:m,description:c.mdia.minf.stbl.stsd.entries[m],dts:v,duration:b,moof_number:this.lastMoofIndex,number_in_traf:k,number:c.samples.length,offset:w,size:y,timescale:c.mdia.mdhd.timescale,track_id:c.tkhd.track_id,is_sync:!(g>>16&1),is_leading:g>>26&3,depends_on:g>>24&3,is_depended_on:g>>22&3,has_redundancy:g>>20&3,degradation_priority:g&65535};u.first_sample_index=c.samples.length,c.samples.push(F),(u.sbgps.length>0||u.sgpds.length>0||c.mdia.minf.stbl.sbgps.length>0||c.mdia.minf.stbl.sgpds.length>0)&&xs.setSampleGroupProperties(c,F,F.number_in_traf,u.sample_groups_info)}}if(u.subs){c.has_fragment_subsamples=!0;let f=u.first_sample_index;for(let d=0;d<u.subs.entries.length;d++){f+=u.subs.entries[d].sample_delta;const p=c.samples[f-1];p.subsamples=u.subs.entries[d].subsamples}}}}}}getSample(e,i){const s=e.samples[i];if(this.moov){if(!s.data)s.data=new Uint8Array(s.size),s.alreadyRead=0,this.samplesDataSize+=s.size,B.debug("ISOFile","Allocating sample #"+i+" on track #"+e.tkhd.track_id+" of size "+s.size+" (total: "+this.samplesDataSize+")");else if(s.alreadyRead===s.size)return s;for(;;){let r=this.stream,n=r.findPosition(!0,s.offset+s.alreadyRead,!1),o,a;if(n>-1)o=r.buffers[n],a=o.fileStart;else for(const l of this.mdats){if(!l.stream){B.debug("ISOFile","mdat stream not yet fully read for #"+this.mdats.indexOf(l)+" mdat");continue}if(n=l.stream.findPosition(!0,s.offset+s.alreadyRead-l.start-l.hdr_size,!1),n>-1){r=l.stream,o=l.stream.buffers[n],a=l.start+l.hdr_size+o.fileStart;break}}if(o){const l=o.byteLength-(s.offset+s.alreadyRead-a);if(s.size-s.alreadyRead<=l)return B.debug("ISOFile","Getting sample #"+i+" data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-a)+" read size: "+(s.size-s.alreadyRead)+" full size: "+s.size+")"),ct.memcpy(s.data.buffer,s.alreadyRead,o,s.offset+s.alreadyRead-a,s.size-s.alreadyRead),o.usedBytes+=s.size-s.alreadyRead,r.logBufferLevel(),s.alreadyRead=s.size,s;if(l===0)return;B.debug("ISOFile","Getting sample #"+i+" partial data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-a)+" read size: "+l+" full size: "+s.size+")"),ct.memcpy(s.data.buffer,s.alreadyRead,o,s.offset+s.alreadyRead-a,l),s.alreadyRead+=l,o.usedBytes+=l,r.logBufferLevel()}else return}}}releaseSample(e,i){const s=e.samples[i];return s.data?(this.samplesDataSize-=s.size,s.data=void 0,s.alreadyRead=0,s.size):0}getAllocatedSampleDataSize(){return this.samplesDataSize}getCodecs(){let e="";for(let i=0;i<this.moov.traks.length;i++){const s=this.moov.traks[i];i>0&&(e+=","),e+=s.mdia.minf.stbl.stsd.entries[0].getCodec()}return e}getTrexById(e){if(!(!this.moov||!this.moov.mvex))for(let i=0;i<this.moov.mvex.trexs.length;i++){const s=this.moov.mvex.trexs[i];if(s.track_id===e)return s}}getTrackById(e){if(this.moov)for(let i=0;i<this.moov.traks.length;i++){const s=this.moov.traks[i];if(s.tkhd.track_id===e)return s}}flattenItemInfo(){const e=this.items,i=this.entity_groups,s=this.meta;if(!(!s||!s.hdlr||!s.iinf)){for(let r=0;r<s.iinf.item_infos.length;r++){const n=s.iinf.item_infos[r].item_ID;e[n]={id:n,name:s.iinf.item_infos[r].item_name,ref_to:[],content_type:s.iinf.item_infos[r].content_type,content_encoding:s.iinf.item_infos[r].content_encoding,item_uri_type:s.iinf.item_infos[r].item_uri_type,type:s.iinf.item_infos[r].item_type?s.iinf.item_infos[r].item_type:"mime",protection:s.iinf.item_infos[r].item_protection_index>0?s.ipro.protections[s.iinf.item_infos[r].item_protection_index-1]:void 0}}if(s.grpl)for(let r=0;r<s.grpl.boxes.length;r++){const n=s.grpl.boxes[r];i[n.group_id]={id:n.group_id,entity_ids:n.entity_ids,type:n.type}}if(s.iloc)for(let r=0;r<s.iloc.items.length;r++){const n=s.iloc.items[r],o=e[n.item_ID];n.data_reference_index!==0&&(B.warn("Item storage with reference to other files: not supported"),o.source=s.dinf.boxes[n.data_reference_index-1]),o.extents=[],o.size=0;for(let a=0;a<n.extents.length;a++)o.extents[a]={offset:n.extents[a].extent_offset+n.base_offset,length:n.extents[a].extent_length,alreadyRead:0},n.construction_method===1&&(o.extents[a].offset+=s.idat.start+s.idat.hdr_size),o.size+=o.extents[a].length}if(s.pitm&&(e[s.pitm.item_id].primary=!0),s.iref)for(let r=0;r<s.iref.references.length;r++){const n=s.iref.references[r];for(let o=0;o<n.references.length;o++)e[n.from_item_ID].ref_to.push({type:n.type,id:n.references[o]})}if(s.iprp)for(let r=0;r<s.iprp.ipmas.length;r++){const n=s.iprp.ipmas[r];for(let o=0;o<n.associations.length;o++){const a=n.associations[o],l=e[a.id]??i[a.id];if(l){l.properties===void 0&&(l.properties={boxes:[]});for(let u=0;u<a.props.length;u++){const c=a.props[u];if(c.property_index>0&&c.property_index-1<s.iprp.ipco.boxes.length){const h=s.iprp.ipco.boxes[c.property_index-1];l.properties[h.type]=h,l.properties.boxes.push(h)}}}}}}}getItem(e){if(!this.meta)return;const i=this.items[e];if(!i.data&&i.size)i.data=new Uint8Array(i.size),i.alreadyRead=0,this.itemsDataSize+=i.size,B.debug("ISOFile","Allocating item #"+e+" of size "+i.size+" (total: "+this.itemsDataSize+")");else if(i.alreadyRead===i.size)return i;for(let s=0;s<i.extents.length;s++){const r=i.extents[s];if(r.alreadyRead!==r.length){const n=this.stream.findPosition(!0,r.offset+r.alreadyRead,!1);if(n>-1){const o=this.stream.buffers[n],a=o.byteLength-(r.offset+r.alreadyRead-o.fileStart);if(r.length-r.alreadyRead<=a)B.debug("ISOFile","Getting item #"+e+" extent #"+s+" data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-o.fileStart)+" read size: "+(r.length-r.alreadyRead)+" full extent size: "+r.length+" full item size: "+i.size+")"),ct.memcpy(i.data.buffer,i.alreadyRead,o,r.offset+r.alreadyRead-o.fileStart,r.length-r.alreadyRead),(!this.parsingMdat||this.discardMdatData)&&(o.usedBytes+=r.length-r.alreadyRead),this.stream.logBufferLevel(),i.alreadyRead+=r.length-r.alreadyRead,r.alreadyRead=r.length;else{B.debug("ISOFile","Getting item #"+e+" extent #"+s+" partial data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-o.fileStart)+" read size: "+a+" full extent size: "+r.length+" full item size: "+i.size+")"),ct.memcpy(i.data.buffer,i.alreadyRead,o,r.offset+r.alreadyRead-o.fileStart,a),r.alreadyRead+=a,i.alreadyRead+=a,(!this.parsingMdat||this.discardMdatData)&&(o.usedBytes+=a),this.stream.logBufferLevel();return}}else return}}if(i.alreadyRead===i.size)return i}releaseItem(e){const i=this.items[e];if(i.data){this.itemsDataSize-=i.size,i.data=void 0,i.alreadyRead=0;for(let s=0;s<i.extents.length;s++){const r=i.extents[s];r.alreadyRead=0}return i.size}else return 0}processItems(e){for(const i in this.items){const s=this.items[i];this.getItem(s.id),e&&!s.sent&&(e(s),s.sent=!0,s.data=void 0)}}hasItem(e){for(const i in this.items){const s=this.items[i];if(s.name===e)return s.id}return-1}getMetaHandler(){if(this.meta)return this.meta.hdlr.handler}getPrimaryItem(){if(this.meta&&this.meta.pitm)return this.getItem(this.meta.pitm.item_id)}itemToFragmentedTrackFile({itemId:e}={}){let i;if(e?i=this.getItem(e):i=this.getPrimaryItem(),!i)return;const s=new xs;s.discardMdatData=!1;const r={type:i.type,description_boxes:i.properties.boxes};i.properties.ispe&&(r.width=i.properties.ispe.image_width,r.height=i.properties.ispe.image_height);const n=s.addTrack(r);if(n)return s.addSample(n,i.data),s}processIncompleteBox(e){if(e.type==="mdat"){const i=new Fa(e.size);return this.parsingMdat=i,this.boxes.push(i),this.mdats.push(i),i.start=e.start,i.hdr_size=e.hdr_size,i.original_size=e.original_size,this.stream.addUsedBytes(i.hdr_size),this.lastBoxStartPosition=i.start+i.size,this.stream.seek(i.start+i.size,!1,this.discardMdatData)?(this.transferMdatData(),this.parsingMdat=void 0,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=i.start+i.size,!1)}else return e.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),this.stream.mergeNextBuffer&&this.stream.mergeNextBuffer()?(this.nextParsePosition=this.stream.getEndPosition(),!0):(e.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+e.size:this.nextParsePosition=this.stream.getEndPosition(),!1)}hasIncompleteMdat(){return this.parsingMdat!==void 0}transferMdatData(e){const i=e??this.parsingMdat;if(this.discardMdatData){B.debug("ISOFile","Discarding 'mdat' data, not transferring it to the mdat box stream");return}if(!i){B.warn("ISOFile","Cannot transfer 'mdat' data, no mdat box is being parsed");return}const s=this.stream.findPosition(!0,i.start+i.hdr_size,!1),r=this.stream.findPosition(!0,i.start+i.size,!1);if(s===-1||r===-1){B.warn("ISOFile","Cannot transfer 'mdat' data, start or end buffer not found");return}i.stream=new Kr;for(let n=s;n<=r;n++){const o=this.stream.buffers[n],a=n===s?i.start+i.hdr_size-o.fileStart:0,l=n===r?i.start+i.size-o.fileStart:o.byteLength;if(l>a){B.debug("ISOFile","Transferring 'mdat' data from buffer #"+n+" ("+a+" to "+l+")");const u=l-a,c=new Ui(u),h=i.stream.getAbsoluteEndPosition();ct.memcpy(c,0,o,a,u),c.fileStart=h,i.stream.insertBuffer(c),o.usedBytes+=u}}}processIncompleteMdat(){const e=this.parsingMdat;return this.stream.seek(e.start+e.size,!1,this.discardMdatData)?(B.debug("ISOFile","Found 'mdat' end in buffered data"),this.transferMdatData(),this.parsingMdat=void 0,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)}restoreParsePosition(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)}saveParsePosition(){this.lastBoxStartPosition=this.stream.getPosition()}updateUsedBytes(e,i){this.stream.addUsedBytes&&(e.type==="mdat"?(this.stream.addUsedBytes(e.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(e.size-e.hdr_size)):this.stream.addUsedBytes(e.size))}addBox(e){return Q.prototype.addBox.call(this,e)}init(e={}){const i=this.addBox(new Rw);i.major_brand=e.brands&&e.brands[0]||"iso4",i.minor_version=0,i.compatible_brands=e.brands||["iso4"];const s=this.addBox(new og);s.addBox(new ag);const r=s.addBox(new Lw);return r.timescale=e.timescale||600,r.rate=e.rate||65536,r.creation_time=0,r.modification_time=0,r.duration=e.duration||0,r.volume=e.width?0:256,r.matrix=[65536,0,0,0,65536,0,0,0,1073741824],r.next_track_id=1,this}addTrack(e={}){this.moov||this.init(e);const i=e||{};i.width=i.width||320,i.height=i.height||320,i.id=i.id||this.moov.mvhd.next_track_id,i.type=i.type||"avc1";const s=this.moov.addBox(new Cw);this.moov.mvhd.next_track_id=i.id+1;const r=s.addBox(new Jw);r.flags=JF|QF|eR,r.creation_time=0,r.modification_time=0,r.track_id=i.id,r.duration=i.duration||0,r.layer=i.layer||0,r.alternate_group=0,r.volume=1,r.matrix=[65536,0,0,0,65536,0,0,0,1073741824],r.width=i.width<<16,r.height=i.height<<16;const n=s.addBox(new Tw),o=n.addBox(new Bw);o.creation_time=0,o.modification_time=0,o.timescale=i.timescale||1,o.duration=i.media_duration||0,o.language=i.language||"und";const a=n.addBox(new zw);a.handler=i.hdlr||"vide",a.name=i.name||"Track created with MP4Box.js";const l=n.addBox(new Fw);l.extended_language=i.language||"fr-FR";const u=n.addBox(new kw),c=Dt.sampleEntry[i.type];if(!c)return;const h=new c;if(h.data_reference_index=1,h instanceof Ze){const x=h,_=u.addBox(new t2);_.graphicsmode=0,_.opcolor=[0,0,0],x.width=i.width,x.height=i.height,x.horizresolution=72<<16,x.vertresolution=72<<16,x.frame_count=1,x.compressorname=i.type+" Compressor",x.depth=24,i.avcDecoderConfigRecord?x.addBox(new ww(i.avcDecoderConfigRecord.byteLength)).parse(new ct(i.avcDecoderConfigRecord)):i.hevcDecoderConfigRecord&&x.addBox(new Uw(i.hevcDecoderConfigRecord.byteLength)).parse(new ct(i.hevcDecoderConfigRecord))}else if(h instanceof zt){const x=h,_=u.addBox(new Ww);_.balance=i.balance||0,x.channel_count=i.channel_count||2,x.samplesize=i.samplesize||16,x.samplerate=i.samplerate||65536}else h instanceof ng?u.addBox(new Sw):h instanceof Ls?(u.addBox(new $w),h instanceof Gw&&(h.namespace=i.namespace||"nonamespace",h.schema_location=i.schema_location||"",h.auxiliary_mime_types=i.auxiliary_mime_types||"")):h instanceof yr?u.addBox(new Ra):h instanceof Zl?u.addBox(new Ra):u.addBox(new Ra);i.description&&h.addBox.call(h,i.description),i.description_boxes&&i.description_boxes.forEach(function(x){h.addBox.call(h,x)});const f=u.addBox(new Aw).addBox(new Mw),d=new e2;d.flags=1,f.addEntry(d);const p=u.addBox(new Iw);p.addBox(new Yw).addEntry(h);const m=p.addBox(new jw);m.sample_counts=[],m.sample_deltas=[];const g=p.addBox(new qw);g.first_chunk=[],g.samples_per_chunk=[],g.sample_description_index=[];const y=p.addBox(new Vw);y.chunk_offsets=[];const b=p.addBox(new Xw);b.sample_sizes=[];const v=this.moov.mvex.addBox(new lg);return v.track_id=i.id,v.default_sample_description_index=i.default_sample_description_index||1,v.default_sample_duration=i.default_sample_duration||0,v.default_sample_size=i.default_sample_size||0,v.default_sample_flags=i.default_sample_flags||0,this.buildTrakSampleLists(s),i.id}addSample(e,i,{sample_description_index:s,duration:r=1,cts:n=0,dts:o=0,is_sync:a=!1,is_leading:l=0,depends_on:u=0,is_depended_on:c=0,has_redundancy:h=0,degradation_priority:f=0,subsamples:d,offset:p=0}={}){const m=this.getTrackById(e);if(m===void 0)return;const g=s?s-1:0,y={number:m.samples.length,track_id:m.tkhd.track_id,timescale:m.mdia.mdhd.timescale,description_index:g,description:m.mdia.minf.stbl.stsd.entries[g],data:i,size:i.byteLength,alreadyRead:i.byteLength,duration:r,cts:n,dts:o,is_sync:a,is_leading:l,depends_on:u,is_depended_on:c,has_redundancy:h,degradation_priority:f,offset:p,subsamples:d};m.samples.push(y),m.samples_size+=y.size,m.samples_duration+=y.duration,m.first_dts===void 0&&(m.first_dts=o),this.processSamples();const b=this.addBox(this.createMoof([y]));b.computeSize(),b.trafs[0].truns[0].data_offset=b.size+8;const v=this.addBox(new Fa);return v.data=new Uint8Array(i),y}createMoof(e){if(e.length===0)return;if(e.some(c=>c.track_id!==e[0].track_id))throw new Error("Cannot create moof for samples from different tracks: "+e.map(c=>c.track_id).join(", "));const i=e[0].track_id,s=this.getTrackById(i);if(!s)throw new Error("Cannot create moof for non-existing track: "+i);const r=new Pw,n=r.addBox(new Dw);n.sequence_number=++this.nextMoofNumber;const o=r.addBox(new Ew),a=o.addBox(new Zw);a.track_id=i,a.flags=Pv;const l=o.addBox(new Kw);l.baseMediaDecodeTime=e[0].dts-(s.first_dts||0);const u=o.addBox(new Qw);u.flags=Jn|Qn|eo|to|io,u.data_offset=0,u.first_sample_flags=0,u.sample_count=e.length;for(const c of e){let h=0;c.is_sync?h=1<<25:h=65536,u.sample_duration.push(c.duration),u.sample_size.push(c.size),u.sample_flags.push(h),u.sample_composition_time_offset.push(c.cts-c.dts)}return r}print(e){e.indent="";for(let i=0;i<this.boxes.length;i++)this.boxes[i]&&this.boxes[i].print(e)}};function X4(t=!1,e){return new i2(e,!t)}var s2={};hw(s2,{Descriptor:()=>$s,ES_Descriptor:()=>U0,MPEG4DescriptorParser:()=>a2});var r2=3,pl=4,z0=5,n2=6,$s=class o2{constructor(e,i){this.tag=e,this.size=i,this.descs=[]}parse(e){this.data=e.readUint8Array(this.size)}findDescriptor(e){for(let i=0;i<this.descs.length;i++)if(this.descs[i].tag===e)return this.descs[i]}parseOneDescriptor(e){let i=0;const s=e.readUint8();let r=e.readUint8();for(;r&128;)i=(i<<7)+(r&127),r=e.readUint8();i=(i<<7)+(r&127),B.debug("Descriptor","Found "+(Ua[s]||"Descriptor "+s)+", size "+i+" at position "+e.getPosition());const n=Ua[s]?new J4[Ua[s]](i):new o2(i);return n.parse(e),n}parseRemainingDescriptors(e){const i=e.getPosition();for(;e.getPosition()<i+this.size;){const s=this.parseOneDescriptor?.(e);this.descs.push(s)}}},U0=class extends $s{constructor(t){super(r2,t)}parse(t){if(this.ES_ID=t.readUint16(),this.flags=t.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=t.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){const e=t.readUint8();this.URL=t.readString(e),this.size-=e+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=t.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(t)}getOTI(){const t=this.findDescriptor(pl);return t?t.oti:0}getAudioConfig(){const t=this.findDescriptor(pl);if(!t)return;const e=t.findDescriptor(z0);if(e&&e.data){let i=(e.data[0]&248)>>3;return i===31&&e.data.length>=2&&(i=32+((e.data[0]&7)<<3)+((e.data[1]&224)>>5)),i}}},j4=class extends $s{constructor(t){super(pl,t)}parse(t){this.oti=t.readUint8(),this.streamType=t.readUint8(),this.upStream=(this.streamType>>1&1)!==0,this.streamType=this.streamType>>>2,this.bufferSize=t.readUint24(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32(),this.size-=13,this.parseRemainingDescriptors(t)}},K4=class extends $s{constructor(t){super(z0,t)}},Z4=class extends $s{constructor(t){super(n2,t)}},J4={Descriptor:$s,ES_Descriptor:U0,DecoderConfigDescriptor:j4,DecoderSpecificInfo:K4,SLConfigDescriptor:Z4},Ua={[r2]:"ES_Descriptor",[pl]:"DecoderConfigDescriptor",[z0]:"DecoderSpecificInfo",[n2]:"SLConfigDescriptor"},a2=class{constructor(){this.parseOneDescriptor=$s.prototype.parseOneDescriptor}getDescriptorName(t){return Ua[t]}},Q4=class{parseSample(t){const e=[],i=new Kr(Ui.fromArrayBuffer(t.buffer,0));for(;!i.isEof();){const s=Ci(i,!1);s.code===Nt&&s.box?.type==="vttc"&&e.push(s.box)}return e}getText(t,e,i){function s(a,l){const u=a.toString();return u.length>=l?u:new Array(l-u.length+1).join("0")+u}function r(a){const l=Math.floor(a/3600),u=Math.floor((a-l*3600)/60),c=Math.floor(a-l*3600-u*60),h=Math.floor((a-l*3600-u*60-c)*1e3);return""+s(l,2)+":"+s(u,2)+":"+s(c,2)+"."+s(h,3)}const n=this.parseSample(i);let o="";for(let a=0;a<n.length;a++){const l=n[a];o+=r(t)+" --> "+r(e)+`\r
`,o+=l.payl.text}return o}},e5=class{parseSample(t){const e={resources:[],documentString:"",document:void 0},i=new ct(t.data.buffer);if(!t.subsamples||t.subsamples.length===0)e.documentString=i.readString(t.data.length);else if(e.documentString=i.readString(t.subsamples[0].size),t.subsamples.length>1)for(let s=1;s<t.subsamples.length;s++)e.resources[s]=i.readUint8Array(t.subsamples[s].size);return typeof DOMParser<"u"&&(e.document=new DOMParser().parseFromString(e.documentString,"application/xml")),e}},t5=class{parseSample(t){return new ct(t.data.buffer).readString(t.data.length)}parseConfig(t){const e=new ct(t.buffer);return e.readUint32(),e.readCString()}},i5=class{parseSample(t){const e=new ct(t.data.buffer),i=e.readUint16();if(i!==0)return e.readString(i)}},l2={};hw(l2,{CoLLBox:()=>m5,ItemContentIDPropertyBox:()=>VU,OpusSampleEntry:()=>k4,SmDmBox:()=>Hz,a1lxBox:()=>s5,a1opBox:()=>r5,ac_3SampleEntry:()=>S4,ac_4SampleEntry:()=>C4,aebrBox:()=>R5,afbrBox:()=>z5,albcBox:()=>U5,alstSampleGroupEntry:()=>xU,altrBox:()=>B5,auxCBox:()=>n5,av01SampleEntry:()=>JR,av1CBox:()=>WR,avc1SampleEntry:()=>XR,avc2SampleEntry:()=>jR,avc3SampleEntry:()=>KR,avc4SampleEntry:()=>ZR,avcCBox:()=>ww,avllSampleGroupEntry:()=>bU,avs3SampleEntry:()=>m4,avssSampleGroupEntry:()=>_U,brstBox:()=>O5,btrtBox:()=>o5,bxmlBox:()=>fR,ccstBox:()=>a5,cdefBox:()=>l5,clapBox:()=>c5,clefBox:()=>Tz,clliBox:()=>u5,cmexBox:()=>h5,cminBox:()=>d5,cmpdBox:()=>f5,co64Box:()=>p5,colrBox:()=>YR,coviBox:()=>v5,cprtBox:()=>x5,cschBox:()=>b5,cslgBox:()=>_5,cttsBox:()=>w5,dOpsBox:()=>P5,dac3Box:()=>S5,dataBox:()=>On,dav1SampleEntry:()=>QR,dec3Box:()=>C5,dfLaBox:()=>T5,dimmBox:()=>k5,dinfBox:()=>Aw,dmax:()=>A5,dmedBox:()=>I5,dobrBox:()=>D5,drefBox:()=>Mw,drepBox:()=>E5,dtrtSampleGroupEntry:()=>wU,dvh1SampleEntry:()=>a4,dvheSampleEntry:()=>l4,ec_3SampleEntry:()=>T4,edtsBox:()=>mR,elngBox:()=>Fw,elstBox:()=>M5,emsgBox:()=>F5,encaSampleEntry:()=>R4,encmSampleEntry:()=>D4,encsSampleEntry:()=>U4,enctSampleEntry:()=>O4,encuSampleEntry:()=>z4,encvSampleEntry:()=>F4,enofBox:()=>Az,eqivBox:()=>L5,esdsBox:()=>VR,etypBox:()=>FR,fLaCSampleEntry:()=>M4,favcBox:()=>N5,fielBox:()=>K5,fobrBox:()=>H5,freeBox:()=>cR,frmaBox:()=>Z5,ftypBox:()=>Rw,grplBox:()=>ER,hdlrBox:()=>zw,hev1SampleEntry:()=>i4,hev2SampleEntry:()=>s4,hinfBox:()=>bR,hmhdBox:()=>Sw,hntiBox:()=>xR,hvc1SampleEntry:()=>e4,hvc2SampleEntry:()=>t4,hvcCBox:()=>Uw,hvt1SampleEntry:()=>r4,iaugBox:()=>G5,idatBox:()=>lR,iinfBox:()=>UR,ilocBox:()=>BR,ilstBox:()=>Iz,imirBox:()=>J5,infeBox:()=>zR,iodsBox:()=>hR,ipcoBox:()=>PR,ipmaBox:()=>Q5,iproBox:()=>pR,iprpBox:()=>IR,irefBox:()=>DR,irotBox:()=>ez,ispeBox:()=>tz,itaiBox:()=>iz,j2kHBox:()=>MR,j2kiSampleEntry:()=>g4,keysBox:()=>Pz,kindBox:()=>sz,levaBox:()=>rz,lhe1SampleEntry:()=>n4,lhv1SampleEntry:()=>o4,lhvCBox:()=>nz,lselBox:()=>oz,m4aeSampleEntry:()=>w4,maxrBox:()=>az,mdatBox:()=>Fa,mdcvBox:()=>lz,mdhdBox:()=>Bw,mdiaBox:()=>Tw,mecoBox:()=>vR,mehdBox:()=>Ow,metaBox:()=>NR,mettSampleEntry:()=>HR,metxSampleEntry:()=>GR,mfhdBox:()=>Dw,mfraBox:()=>yR,mfroBox:()=>cz,mha1SampleEntry:()=>A4,mha2SampleEntry:()=>I4,mhm1SampleEntry:()=>P4,mhm2SampleEntry:()=>E4,minfBox:()=>kw,mjp2SampleEntry:()=>y4,mjpgSampleEntry:()=>v4,moofBox:()=>Pw,moovBox:()=>og,mp4aSampleEntry:()=>_4,mp4sSampleEntry:()=>B4,mp4vSampleEntry:()=>b4,mskCBox:()=>uz,msrcTrackGroupTypeBox:()=>aU,mvexBox:()=>ag,mvhdBox:()=>Lw,mvifSampleGroupEntry:()=>SU,nmhdBox:()=>Ra,npckBox:()=>hz,numpBox:()=>dz,padbBox:()=>pz,panoBox:()=>W5,paspBox:()=>mz,paylBox:()=>gz,paytBox:()=>yz,pdinBox:()=>vz,piffLsmBox:()=>DU,piffPsshBox:()=>LU,piffSencBox:()=>NU,piffTencBox:()=>HU,piffTfrfBox:()=>GU,piffTfxdBox:()=>WU,pitmBox:()=>LR,pixiBox:()=>xz,pmaxBox:()=>bz,povdBox:()=>RR,prdiBox:()=>_z,prfrBox:()=>wz,prftBox:()=>Sz,prgrBox:()=>X5,profBox:()=>Ez,prolSampleGroupEntry:()=>CU,psshBox:()=>Cz,pymdBox:()=>j5,rapSampleGroupEntry:()=>TU,rashSampleGroupEntry:()=>kU,resvSampleEntry:()=>L4,rinfBox:()=>CR,rollSampleGroupEntry:()=>AU,rtp_Box:()=>Rz,saioBox:()=>zz,saizBox:()=>Uz,sbgpBox:()=>V4,sbpmBox:()=>Oz,sbttSampleEntry:()=>N4,schiBox:()=>TR,schmBox:()=>Dz,scifSampleGroupEntry:()=>IU,scnmSampleGroupEntry:()=>PU,sdp_Box:()=>Lz,sdtpBox:()=>$4,seigSampleGroupEntry:()=>EU,sencBox:()=>Nz,sgpdBox:()=>q4,sidxBox:()=>Y4,sinfBox:()=>SR,skipBox:()=>uR,slidBox:()=>V5,smhdBox:()=>Ww,sratBox:()=>Gz,ssixBox:()=>Wz,stblBox:()=>Iw,stcoBox:()=>Vw,stdpBox:()=>Vz,sterBox:()=>$5,sthdBox:()=>$w,stppSampleEntry:()=>Gw,strdBox:()=>wR,striBox:()=>$z,strkBox:()=>_R,stsaSampleGroupEntry:()=>MU,stscBox:()=>qw,stsdBox:()=>Yw,stsgBox:()=>qz,stshBox:()=>Yz,stssBox:()=>Xz,stszBox:()=>Xw,sttsBox:()=>jw,stviBox:()=>jz,stxtSampleEntry:()=>H4,stypBox:()=>Kz,stz2Box:()=>Zz,subsBox:()=>Jz,syncSampleGroupEntry:()=>FU,taicBox:()=>Qz,taptBox:()=>Mz,teleSampleGroupEntry:()=>RU,tencBox:()=>eU,tfdtBox:()=>Kw,tfhdBox:()=>Zw,tfraBox:()=>tU,tkhdBox:()=>Jw,tmaxBox:()=>iU,tminBox:()=>sU,totlBox:()=>rU,tpayBox:()=>nU,tpylBox:()=>oU,trafBox:()=>Ew,trakBox:()=>Cw,trefBox:()=>lU,trepBox:()=>cU,trexBox:()=>lg,trgrBox:()=>kR,trpyBox:()=>uU,trunBox:()=>Qw,tsasSampleGroupEntry:()=>zU,tsclSampleGroupEntry:()=>UU,tselBox:()=>hU,tsynBox:()=>q5,tx3gSampleEntry:()=>G4,txtcBox:()=>dU,tycoBox:()=>fU,udesBox:()=>pU,udtaBox:()=>AR,uncCBox:()=>mU,uncvSampleEntry:()=>x4,urlBox:()=>e2,urnBox:()=>gU,viprSampleGroupEntry:()=>BU,vmhdBox:()=>t2,vp08SampleEntry:()=>f4,vp09SampleEntry:()=>p4,vpcCBox:()=>$R,vttCBox:()=>yU,vttcBox:()=>gR,vvc1SampleEntry:()=>c4,vvcCBox:()=>qR,vvcNSampleEntry:()=>d4,vvi1SampleEntry:()=>u4,vvnCBox:()=>vU,vvs1SampleEntry:()=>h4,waveBox:()=>Fz,wbbrBox:()=>Y5,wvttSampleEntry:()=>W4,xmlBox:()=>dR});var ad,s5=(ad=class extends Q{constructor(){super(...arguments),this.box_name="AV1LayeredImageIndexingProperty"}parse(t){const e=((t.readUint8()&1&1)+1)*16;this.layer_size=[];for(let i=0;i<3;i++)e===16?this.layer_size[i]=t.readUint16():this.layer_size[i]=t.readUint32()}},ad.fourcc="a1lx",ad),ld,r5=(ld=class extends Q{constructor(){super(...arguments),this.box_name="OperatingPointSelectorProperty"}parse(t){this.op_index=t.readUint8()}},ld.fourcc="a1op",ld),cd,n5=(cd=class extends N{constructor(){super(...arguments),this.box_name="AuxiliaryTypeProperty"}parse(t){this.parseFullHeader(t),this.aux_type=t.readCString();const e=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=t.readUint8Array(e)}},cd.fourcc="auxC",cd),ud,o5=(ud=class extends Q{constructor(){super(...arguments),this.box_name="BitRateBox"}parse(t){this.bufferSizeDB=t.readUint32(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32()}},ud.fourcc="btrt",ud),hd,a5=(hd=class extends N{constructor(){super(...arguments),this.box_name="CodingConstraintsBox"}parse(t){this.parseFullHeader(t);const e=t.readUint8();this.all_ref_pics_intra=(e&128)===128,this.intra_pred_used=(e&64)===64,this.max_ref_per_pic=(e&63)>>2,t.readUint24()}},hd.fourcc="ccst",hd),dd,l5=(dd=class extends Q{constructor(){super(...arguments),this.box_name="ComponentDefinitionBox"}parse(t){this.channel_count=t.readUint16(),this.channel_indexes=[],this.channel_types=[],this.channel_associations=[];for(let e=0;e<this.channel_count;e++)this.channel_indexes.push(t.readUint16()),this.channel_types.push(t.readUint16()),this.channel_associations.push(t.readUint16())}},dd.fourcc="cdef",dd),fd,c5=(fd=class extends Q{constructor(){super(...arguments),this.box_name="CleanApertureBox"}parse(t){this.cleanApertureWidthN=t.readUint32(),this.cleanApertureWidthD=t.readUint32(),this.cleanApertureHeightN=t.readUint32(),this.cleanApertureHeightD=t.readUint32(),this.horizOffN=t.readUint32(),this.horizOffD=t.readUint32(),this.vertOffN=t.readUint32(),this.vertOffD=t.readUint32()}},fd.fourcc="clap",fd),pd,u5=(pd=class extends Q{constructor(){super(...arguments),this.box_name="ContentLightLevelBox"}parse(t){this.max_content_light_level=t.readUint16(),this.max_pic_average_light_level=t.readUint16()}},pd.fourcc="clli",pd),md,h5=(md=class extends Q{constructor(){super(...arguments),this.box_name="CameraExtrinsicMatrixProperty"}parse(t){this.flags&1&&(this.pos_x=t.readInt32()),this.flags&2&&(this.pos_y=t.readInt32()),this.flags&4&&(this.pos_z=t.readInt32()),this.flags&8&&(this.version===0?this.flags&16?(this.quat_x=t.readInt32(),this.quat_y=t.readInt32(),this.quat_z=t.readInt32()):(this.quat_x=t.readInt16(),this.quat_y=t.readInt16(),this.quat_z=t.readInt16()):this.version),this.flags&32&&(this.id=t.readUint32())}},md.fourcc="cmex",md),gd,d5=(gd=class extends Q{constructor(){super(...arguments),this.box_name="CameraIntrinsicMatrixProperty"}parse(t){this.focal_length_x=t.readInt32(),this.principal_point_x=t.readInt32(),this.principal_point_y=t.readInt32(),this.flags&1&&(this.focal_length_y=t.readInt32(),this.skew_factor=t.readInt32())}},gd.fourcc="cmin",gd),yd,f5=(yd=class extends Q{constructor(){super(...arguments),this.box_name="ComponentDefinitionBox"}parse(t){this.component_count=t.readUint32(),this.component_types=[],this.component_type_urls=[];for(let e=0;e<this.component_count;e++){const i=t.readUint16();this.component_types.push(i),i>=32768&&this.component_type_urls.push(t.readCString())}}},yd.fourcc="cmpd",yd),vd,p5=(vd=class extends N{constructor(){super(...arguments),this.box_name="ChunkLargeOffsetBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.chunk_offsets=[],this.version===0)for(let i=0;i<e;i++)this.chunk_offsets.push(t.readUint64())}write(t){this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length);for(let e=0;e<this.chunk_offsets.length;e++)t.writeUint64(this.chunk_offsets[e])}},vd.fourcc="co64",vd),xd,m5=(xd=class extends N{constructor(){super(...arguments),this.box_name="ContentLightLevelBox"}parse(t){this.parseFullHeader(t),this.maxCLL=t.readUint16(),this.maxFALL=t.readUint16()}},xd.fourcc="CoLL",xd),g5=class{toString(){let t="centre_azimuth: ";return t+=this.centre_azimuth,t+=" (",t+=this.centre_azimuth*2**-16,t+="), centre_elevation: ",t+=this.centre_elevation,t+=" (",t+=this.centre_elevation*2**-16,t+="), centre_tilt: ",t+=this.centre_tilt,t+=" (",t+=this.centre_tilt*2**-16,t+=")",this.range_included_flag&&(t+=", azimuth_range: ",t+=this.azimuth_range,t+=" (",t+=this.azimuth_range*2**-16,t+="), elevation_range: ",t+=this.elevation_range,t+=" (",t+=this.elevation_range*2**-16,t+=")"),this.interpolate_included_flag&&(t+=", interpolate: ",t+=this.interpolate),t}},y5=class{toString(){let t="";return this.view_idc&&(t+="view_idc: ",t+=this.view_idc,t+=", "),t+="sphere_region: {",t+=this.sphere_region,t+="}",t}},bd,v5=(bd=class extends N{constructor(){super(...arguments),this.box_name="CoverageInformationBox"}parse(t){this.parseFullHeader(t),this.coverage_shape_type=t.readUint8();const e=t.readUint8(),i=t.readInt8(),s=i&128;s&&(this.default_view_idc=(i&96)>>5),this.coverage_regions=new Array;for(let r=0;r<e;r++){const n=new y5;s&&(n.view_idc=t.readUint8()>>6),n.sphere_region=this.parseSphereRegion(t,!0,!0),this.coverage_regions.push(n)}}parseSphereRegion(t,e,i){const s=new g5;return s.centre_azimuth=t.readInt32(),s.centre_elevation=t.readInt32(),s.centre_tilt=t.readInt32(),s.range_included_flag=e,e&&(s.azimuth_range=t.readUint32(),s.elevation_range=t.readUint32()),s.interpolate_included_flag=i,i&&(s.interpolate=(t.readUint8()&128)===128),s}},bd.fourcc="covi",bd),_d,x5=(_d=class extends N{constructor(){super(...arguments),this.box_name="CopyrightBox"}parse(t){this.parseFullHeader(t),this.parseLanguage(t),this.notice=t.readCString()}},_d.fourcc="cprt",_d),wd,b5=(wd=class extends N{constructor(){super(...arguments),this.box_name="CompatibleSchemeTypeBox"}parse(t){this.parseFullHeader(t),this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),this.flags&1&&(this.scheme_uri=t.readCString())}},wd.fourcc="csch",wd),Tn=2147483647,Sd,_5=(Sd=class extends N{constructor(){super(...arguments),this.box_name="CompositionToDecodeBox"}parse(t){this.parseFullHeader(t),this.version===0?(this.compositionToDTSShift=t.readInt32(),this.leastDecodeToDisplayDelta=t.readInt32(),this.greatestDecodeToDisplayDelta=t.readInt32(),this.compositionStartTime=t.readInt32(),this.compositionEndTime=t.readInt32()):this.version===1&&(this.compositionToDTSShift=t.readInt64(),this.leastDecodeToDisplayDelta=t.readInt64(),this.greatestDecodeToDisplayDelta=t.readInt64(),this.compositionStartTime=t.readInt64(),this.compositionEndTime=t.readInt64())}write(t){this.version=0,(this.compositionToDTSShift>Tn||this.leastDecodeToDisplayDelta>Tn||this.greatestDecodeToDisplayDelta>Tn||this.compositionStartTime>Tn||this.compositionEndTime>Tn)&&(this.version=1),this.flags=0,this.version===0?(this.size=20,this.writeHeader(t),t.writeInt32(this.compositionToDTSShift),t.writeInt32(this.leastDecodeToDisplayDelta),t.writeInt32(this.greatestDecodeToDisplayDelta),t.writeInt32(this.compositionStartTime),t.writeInt32(this.compositionEndTime)):this.version===1&&(this.size=40,this.writeHeader(t),t.writeInt64(this.compositionToDTSShift),t.writeInt64(this.leastDecodeToDisplayDelta),t.writeInt64(this.greatestDecodeToDisplayDelta),t.writeInt64(this.compositionStartTime),t.writeInt64(this.compositionEndTime))}},Sd.fourcc="cslg",Sd),Cd,w5=(Cd=class extends N{constructor(){super(...arguments),this.box_name="CompositionOffsetBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.sample_counts=[],this.sample_offsets=[],this.version===0)for(let i=0;i<e;i++){this.sample_counts.push(t.readUint32());const s=t.readInt32();s<0&&B.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(s)}else if(this.version===1)for(let i=0;i<e;i++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32())}write(t){this.version=this.sample_offsets.some(e=>e<0)?1:0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length);for(let e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),this.version===1?t.writeInt32(this.sample_offsets[e]):t.writeUint32(this.sample_offsets[e])}unpack(t){let e=0;for(let i=0;i<this.sample_counts.length;i++)for(let s=0;s<this.sample_counts[i];s++)t[e].pts=t[e].dts+this.sample_offsets[i],e++}},Cd.fourcc="ctts",Cd),Td,S5=(Td=class extends Q{constructor(){super(...arguments),this.box_name="AC3SpecificBox"}parse(t){const e=t.readUint8(),i=t.readUint8(),s=t.readUint8();this.fscod=e>>6,this.bsid=e>>1&31,this.bsmod=(e&1)<<2|i>>6&3,this.acmod=i>>3&7,this.lfeon=i>>2&1,this.bit_rate_code=i&3|s>>5&7}},Td.fourcc="dac3",Td),kd,C5=(kd=class extends Q{constructor(){super(...arguments),this.box_name="EC3SpecificBox"}parse(t){const e=t.readUint16();this.data_rate=e>>3,this.num_ind_sub=e&7,this.ind_subs=[];for(let i=0;i<this.num_ind_sub+1;i++){const s=t.readUint8(),r=t.readUint8(),n=t.readUint8(),o={fscod:s>>6,bsid:s>>1&31,bsmod:(s&1)<<4|r>>4&15,acmod:r>>1&7,lfeon:r&1,num_dep_sub:n>>1&15};this.ind_subs.push(o),o.num_dep_sub>0&&(o.chan_loc=(n&1)<<8|t.readUint8())}}},kd.fourcc="dec3",kd),Ad,T5=(Ad=class extends N{constructor(){super(...arguments),this.box_name="FLACSpecificBox"}parse(t){this.parseFullHeader(t);const e=127,i=128,s=[],r=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];let n;do{n=t.readUint8();const o=Math.min(n&e,r.length-1);o?t.readUint8Array(t.readUint24()):(t.readUint8Array(13),this.samplerate=t.readUint32()>>12,t.readUint8Array(20)),s.push(r[o])}while(n&i);this.numMetadataBlocks=s.length+" ("+s.join(", ")+")"}},Ad.fourcc="dfLa",Ad),Id,k5=(Id=class extends Q{constructor(){super(...arguments),this.box_name="hintimmediateBytesSent"}parse(t){this.bytessent=t.readUint64()}},Id.fourcc="dimm",Id),Pd,A5=(Pd=class extends Q{constructor(){super(...arguments),this.box_name="hintlongestpacket"}parse(t){this.time=t.readUint32()}},Pd.fourcc="dmax",Pd),Ed,I5=(Ed=class extends Q{constructor(){super(...arguments),this.box_name="hintmediaBytesSent"}parse(t){this.bytessent=t.readUint64()}},Ed.fourcc="dmed",Ed),Md,P5=(Md=class extends Q{constructor(){super(...arguments),this.box_name="OpusSpecificBox"}parse(t){if(this.Version=t.readUint8(),this.OutputChannelCount=t.readUint8(),this.PreSkip=t.readUint16(),this.InputSampleRate=t.readUint32(),this.OutputGain=t.readInt16(),this.ChannelMappingFamily=t.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=t.readUint8(),this.CoupledCount=t.readUint8(),this.ChannelMapping=[];for(let e=0;e<this.OutputChannelCount;e++)this.ChannelMapping[e]=t.readUint8()}}write(t){if(this.size=11,this.ChannelMappingFamily!==0&&(this.size+=2+this.OutputChannelCount),this.writeHeader(t),t.writeUint8(this.Version),t.writeUint8(this.OutputChannelCount),t.writeUint16(this.PreSkip),t.writeUint32(this.InputSampleRate),t.writeInt16(this.OutputGain),t.writeUint8(this.ChannelMappingFamily),this.ChannelMappingFamily!==0){t.writeUint8(this.StreamCount),t.writeUint8(this.CoupledCount);for(let e=0;e<this.OutputChannelCount;e++)t.writeUint8(this.ChannelMapping[e])}}},Md.fourcc="dOps",Md),Fd,E5=(Fd=class extends Q{constructor(){super(...arguments),this.box_name="hintrepeatedBytesSent"}parse(t){this.bytessent=t.readUint64()}},Fd.fourcc="drep",Fd),Rd,M5=(Rd=class extends N{constructor(){super(...arguments),this.box_name="EditListBox"}parse(t){this.parseFullHeader(t),this.entries=[];const e=t.readUint32();for(let i=0;i<e;i++){const s={segment_duration:this.version===1?t.readUint64():t.readUint32(),media_time:this.version===1?t.readInt64():t.readInt32(),media_rate_integer:t.readInt16(),media_rate_fraction:t.readInt16()};this.entries.push(s)}}write(t){const e=this.entries.some(i=>i.segment_duration>at||i.media_time>at)||this.version===1;this.version=e?1:0,this.size=4+12*this.entries.length,this.size+=e?8*this.entries.length:0,this.writeHeader(t),t.writeUint32(this.entries.length);for(let i=0;i<this.entries.length;i++){const s=this.entries[i];e?(t.writeUint64(s.segment_duration),t.writeInt64(s.media_time)):(t.writeUint32(s.segment_duration),t.writeInt32(s.media_time)),t.writeInt16(s.media_rate_integer),t.writeInt16(s.media_rate_fraction)}}},Rd.fourcc="elst",Rd),zd,F5=(zd=class extends N{constructor(){super(...arguments),this.box_name="EventMessageBox"}parse(t){this.parseFullHeader(t),this.version===1?(this.timescale=t.readUint32(),this.presentation_time=t.readUint64(),this.event_duration=t.readUint32(),this.id=t.readUint32(),this.scheme_id_uri=t.readCString(),this.value=t.readCString()):(this.scheme_id_uri=t.readCString(),this.value=t.readCString(),this.timescale=t.readUint32(),this.presentation_time_delta=t.readUint32(),this.event_duration=t.readUint32(),this.id=t.readUint32());let e=this.size-this.hdr_size-(16+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version===1&&(e-=4),this.message_data=t.readUint8Array(e)}write(t){this.version=0,this.flags=0,this.size=16+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(t),t.writeCString(this.scheme_id_uri),t.writeCString(this.value),t.writeUint32(this.timescale),t.writeUint32(this.presentation_time_delta),t.writeUint32(this.event_duration),t.writeUint32(this.id),t.writeUint8Array(this.message_data)}},zd.fourcc="emsg",zd),bt=class extends N{parse(e){this.parseFullHeader(e),this.group_id=e.readUint32(),this.num_entities_in_group=e.readUint32(),this.entity_ids=[];for(let i=0;i<this.num_entities_in_group;i++){const s=e.readUint32();this.entity_ids.push(s)}}},Ud,R5=(Ud=class extends bt{constructor(){super(...arguments),this.box_name="Auto exposure bracketing"}},Ud.fourcc="aebr",Ud),Bd,z5=(Bd=class extends bt{constructor(){super(...arguments),this.box_name="Flash exposure information"}},Bd.fourcc="afbr",Bd),Od,U5=(Od=class extends bt{constructor(){super(...arguments),this.box_name="Album collection"}},Od.fourcc="albc",Od),Dd,B5=(Dd=class extends bt{constructor(){super(...arguments),this.box_name="Alternative entity"}},Dd.fourcc="altr",Dd),Ld,O5=(Ld=class extends bt{constructor(){super(...arguments),this.box_name="Burst image"}},Ld.fourcc="brst",Ld),Nd,D5=(Nd=class extends bt{constructor(){super(...arguments),this.box_name="Depth of field bracketing"}},Nd.fourcc="dobr",Nd),Hd,L5=(Hd=class extends bt{constructor(){super(...arguments),this.box_name="Equivalent entity"}},Hd.fourcc="eqiv",Hd),Gd,N5=(Gd=class extends bt{constructor(){super(...arguments),this.box_name="Favorites collection"}},Gd.fourcc="favc",Gd),Wd,H5=(Wd=class extends bt{constructor(){super(...arguments),this.box_name="Focus bracketing"}},Wd.fourcc="fobr",Wd),Vd,G5=(Vd=class extends bt{constructor(){super(...arguments),this.box_name="Image item with an audio track"}},Vd.fourcc="iaug",Vd),$d,W5=($d=class extends bt{constructor(){super(...arguments),this.box_name="Panorama"}},$d.fourcc="pano",$d),qd,V5=(qd=class extends bt{constructor(){super(...arguments),this.box_name="Slideshow"}},qd.fourcc="slid",qd),Yd,$5=(Yd=class extends bt{constructor(){super(...arguments),this.box_name="Stereo"}},Yd.fourcc="ster",Yd),Xd,q5=(Xd=class extends bt{constructor(){super(...arguments),this.box_name="Time-synchronized capture"}},Xd.fourcc="tsyn",Xd),jd,Y5=(jd=class extends bt{constructor(){super(...arguments),this.box_name="White balance bracketing"}},jd.fourcc="wbbr",jd),Kd,X5=(Kd=class extends bt{constructor(){super(...arguments),this.box_name="Progressive rendering"}},Kd.fourcc="prgr",Kd),Zd,j5=(Zd=class extends bt{constructor(){super(...arguments),this.box_name="Image pyramid"}parse(t){this.parseFullHeader(t),this.group_id=t.readUint32(),this.num_entities_in_group=t.readUint32(),this.entity_ids=[];for(let e=0;e<this.num_entities_in_group;e++){const i=t.readUint32();this.entity_ids.push(i)}this.tile_size_x=t.readUint16(),this.tile_size_y=t.readUint16(),this.layer_binning=[],this.tiles_in_layer_column_minus1=[],this.tiles_in_layer_row_minus1=[];for(let e=0;e<this.num_entities_in_group;e++)this.layer_binning[e]=t.readUint16(),this.tiles_in_layer_row_minus1[e]=t.readUint16(),this.tiles_in_layer_column_minus1[e]=t.readUint16()}},Zd.fourcc="pymd",Zd),Jd,K5=(Jd=class extends Q{constructor(){super(...arguments),this.box_name="FieldHandlingBox"}parse(t){this.fieldCount=t.readUint8(),this.fieldOrdering=t.readUint8()}},Jd.fourcc="fiel",Jd),Qd,Z5=(Qd=class extends Q{constructor(){super(...arguments),this.box_name="OriginalFormatBox"}parse(t){this.data_format=t.readString(4)}},Qd.fourcc="frma",Qd),ef,J5=(ef=class extends Q{constructor(){super(...arguments),this.box_name="ImageMirror"}parse(t){const e=t.readUint8();this.reserved=e>>7,this.axis=e&1}},ef.fourcc="imir",ef),tf,Q5=(tf=class extends N{constructor(){super(...arguments),this.box_name="ItemPropertyAssociationBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();this.associations=[];for(let i=0;i<e;i++){const s=this.version<1?t.readUint16():t.readUint32(),r=[],n=t.readUint8();for(let o=0;o<n;o++){const a=t.readUint8();r.push({essential:(a&128)>>7===1,property_index:this.flags&1?(a&127)<<8|t.readUint8():a&127})}this.associations.push({id:s,props:r})}}},tf.fourcc="ipma",tf),sf,ez=(sf=class extends Q{constructor(){super(...arguments),this.box_name="ImageRotation"}parse(t){this.angle=t.readUint8()&3}},sf.fourcc="irot",sf),rf,tz=(rf=class extends N{constructor(){super(...arguments),this.box_name="ImageSpatialExtentsProperty"}parse(t){this.parseFullHeader(t),this.image_width=t.readUint32(),this.image_height=t.readUint32()}},rf.fourcc="ispe",rf),nf,iz=(nf=class extends N{constructor(){super(...arguments),this.box_name="TAITimestampBox"}parse(t){this.TAI_timestamp=t.readUint64();const e=t.readUint8();this.sychronization_state=e>>7&1,this.timestamp_generation_failure=e>>6&1,this.timestamp_is_modified=e>>5&1}},nf.fourcc="itai",nf),of,sz=(of=class extends N{constructor(){super(...arguments),this.box_name="KindBox"}parse(t){this.parseFullHeader(t),this.schemeURI=t.readCString(),this.isEndOfBox(t)||(this.value=t.readCString())}write(t){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value?this.value.length+1:0),this.writeHeader(t),t.writeCString(this.schemeURI),this.value&&t.writeCString(this.value)}},of.fourcc="kind",of),af,rz=(af=class extends N{constructor(){super(...arguments),this.box_name="LevelAssignmentBox"}parse(t){this.parseFullHeader(t);const e=t.readUint8();this.levels=[];for(let i=0;i<e;i++){const s={};this.levels[i]=s,s.track_ID=t.readUint32();const r=t.readUint8();switch(s.padding_flag=r>>7,s.assignment_type=r&127,s.assignment_type){case 0:s.grouping_type=t.readString(4);break;case 1:s.grouping_type=t.readString(4),s.grouping_type_parameter=t.readUint32();break;case 2:break;case 3:break;case 4:s.sub_track_id=t.readUint32();break;default:B.warn("BoxParser",`Unknown level assignment type: ${s.assignment_type}`)}}}},af.fourcc="leva",af),lf,nz=(lf=class extends Q{constructor(){super(...arguments),this.box_name="LHEVCConfigurationBox"}parse(t){this.configurationVersion=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3;let e=t.readUint8();this.numTemporalLayers=(e&13)>>3,this.temporalIdNested=(e&4)>>2,this.lengthSizeMinusOne=e&3,this.nalu_arrays=[];const i=t.readUint8();for(let s=0;s<i;s++){const r=[];this.nalu_arrays.push(r),e=t.readUint8(),r.completeness=(e&128)>>7,r.nalu_type=e&63;const n=t.readUint16();for(let o=0;o<n;o++){const a=t.readUint16();r.push({data:t.readUint8Array(a)})}}}},lf.fourcc="lhvC",lf),cf,oz=(cf=class extends Q{constructor(){super(...arguments),this.box_name="LayerSelectorProperty"}parse(t){this.layer_id=t.readUint16()}},cf.fourcc="lsel",cf),uf,az=(uf=class extends Q{constructor(){super(...arguments),this.box_name="hintmaxrate"}parse(t){this.period=t.readUint32(),this.bytes=t.readUint32()}},uf.fourcc="maxr",uf),ta=class{constructor(t,e){this.x=t,this.y=e}toString(){return"("+this.x+","+this.y+")"}},hf,lz=(hf=class extends Q{constructor(){super(...arguments),this.box_name="MasteringDisplayColourVolumeBox"}parse(t){this.display_primaries=[],this.display_primaries[0]=new ta(t.readUint16(),t.readUint16()),this.display_primaries[1]=new ta(t.readUint16(),t.readUint16()),this.display_primaries[2]=new ta(t.readUint16(),t.readUint16()),this.white_point=new ta(t.readUint16(),t.readUint16()),this.max_display_mastering_luminance=t.readUint32(),this.min_display_mastering_luminance=t.readUint32()}},hf.fourcc="mdcv",hf),df,cz=(df=class extends N{constructor(){super(...arguments),this.box_name="MovieFragmentRandomAccessOffsetBox"}parse(t){this.parseFullHeader(t),this._size=t.readUint32()}},df.fourcc="mfro",df),ff,uz=(ff=class extends N{constructor(){super(...arguments),this.box_name="MaskConfigurationProperty"}parse(t){this.parseFullHeader(t),this.bits_per_pixel=t.readUint8()}},ff.fourcc="mskC",ff),pf,hz=(pf=class extends Q{constructor(){super(...arguments),this.box_name="hintPacketsSent"}parse(t){this.packetssent=t.readUint32()}},pf.fourcc="npck",pf),mf,dz=(mf=class extends Q{constructor(){super(...arguments),this.box_name="hintPacketsSent"}parse(t){this.packetssent=t.readUint64()}},mf.fourcc="nump",mf),fz=class{constructor(t,e){this.pad1=t,this.pad2=e}},gf,pz=(gf=class extends N{constructor(){super(...arguments),this.box_name="PaddingBitsBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();this.padbits=[];for(let i=0;i<Math.floor((e+1)/2);i++){const s=t.readUint8(),r=(s&112)>>4,n=s&7;this.padbits.push(new fz(r,n))}}},gf.fourcc="padb",gf),yf,mz=(yf=class extends Q{constructor(){super(...arguments),this.box_name="PixelAspectRatioBox"}parse(t){this.hSpacing=t.readUint32(),this.vSpacing=t.readUint32()}},yf.fourcc="pasp",yf),vf,gz=(vf=class extends Q{constructor(){super(...arguments),this.box_name="CuePayloadBox"}parse(t){this.text=t.readString(this.size-this.hdr_size)}},vf.fourcc="payl",vf),xf,yz=(xf=class extends Q{constructor(){super(...arguments),this.box_name="hintpayloadID"}parse(t){this.payloadID=t.readUint32();const e=t.readUint8();this.rtpmap_string=t.readString(e)}},xf.fourcc="payt",xf),bf,vz=(bf=class extends N{constructor(){super(...arguments),this.box_name="ProgressiveDownloadInfoBox",this.rate=[],this.initial_delay=[]}parse(t){this.parseFullHeader(t);const e=(this.size-this.hdr_size)/8;for(let i=0;i<e;i++)this.rate[i]=t.readUint32(),this.initial_delay[i]=t.readUint32()}},bf.fourcc="pdin",bf),_f,xz=(_f=class extends N{constructor(){super(...arguments),this.box_name="PixelInformationProperty"}parse(t){this.parseFullHeader(t),this.num_channels=t.readUint8(),this.bits_per_channels=[];for(let e=0;e<this.num_channels;e++)this.bits_per_channels[e]=t.readUint8()}},_f.fourcc="pixi",_f),wf,bz=(wf=class extends Q{constructor(){super(...arguments),this.box_name="hintlargestpacket"}parse(t){this.bytes=t.readUint32()}},wf.fourcc="pmax",wf),Sf,_z=(Sf=class extends N{constructor(){super(...arguments),this.box_name="ProgressiveDerivedImageItemInformationProperty"}parse(t){if(this.parseFullHeader(t),this.step_count=t.readUint16(),this.item_count=[],this.flags&2)for(let e=0;e<this.step_count;e++)this.item_count[e]=t.readUint16()}},Sf.fourcc="prdi",Sf),Cf,wz=(Cf=class extends N{constructor(){super(...arguments),this.box_name="ProjectionFormatBox"}parse(t){this.parseFullHeader(t),this.projection_type=t.readUint8()&31}},Cf.fourcc="prfr",Cf),Tf,Sz=(Tf=class extends N{constructor(){super(...arguments),this.box_name="ProducerReferenceTimeBox"}parse(t){this.parseFullHeader(t),this.ref_track_id=t.readUint32(),this.ntp_timestamp=t.readUint64(),this.version===0?this.media_time=t.readUint32():this.media_time=t.readUint64()}},Tf.fourcc="prft",Tf),kf,Cz=(kf=class extends N{constructor(){super(...arguments),this.box_name="ProtectionSystemSpecificHeaderBox"}parse(t){if(this.parseFullHeader(t),this.system_id=gr(t),this.kid=[],this.version>0){const i=t.readUint32();for(let s=0;s<i;s++)this.kid[s]=gr(t)}const e=t.readUint32();e>0&&(this.protection_data=t.readUint8Array(e))}},kf.fourcc="pssh",kf),Af,Tz=(Af=class extends N{constructor(){super(...arguments),this.box_name="TrackCleanApertureDimensionsBox"}parse(t){this.parseFullHeader(t),this.width=t.readUint32(),this.height=t.readUint32()}},Af.fourcc="clef",Af);function kz(t,e){if(t===On.Types.UTF8)return new TextDecoder("utf-8").decode(e);const i=new DataView(e.buffer);if(t===On.Types.BE_UNSIGNED_INT){if(e.length===1)return i.getUint8(0);if(e.length===2)return i.getUint16(0,!1);if(e.length===4)return i.getUint32(0,!1);if(e.length===8)return i.getBigUint64(0,!1);throw new Error("Unsupported ITIF_TYPE_BE_UNSIGNED_INT length "+e.length)}else if(t===On.Types.BE_SIGNED_INT){if(e.length===1)return i.getInt8(0);if(e.length===2)return i.getInt16(0,!1);if(e.length===4)return i.getInt32(0,!1);if(e.length===8)return i.getBigInt64(0,!1);throw new Error("Unsupported ITIF_TYPE_BE_SIGNED_INT length "+e.length)}else if(t===On.Types.BE_FLOAT32)return i.getFloat32(0,!1);B.warn("DataBox","Unsupported or unimplemented itif data type: "+t)}var ia,On=(ia=class extends Q{constructor(){super(...arguments),this.box_name="DataBox"}parse(t){this.valueType=t.readUint32(),this.country=t.readUint16(),this.country>255&&(t.seek(t.getPosition()-2),this.countryString=t.readString(2)),this.language=t.readUint16(),this.language>255&&(t.seek(t.getPosition()-2),this.parseLanguage(t)),this.raw=t.readUint8Array(this.size-this.hdr_size-8),this.value=kz(this.valueType,this.raw)}},ia.fourcc="data",ia.Types={RESERVED:0,UTF8:1,UTF16:2,SJIS:3,UTF8_SORT:4,UTF16_SORT:5,JPEG:13,PNG:14,BE_SIGNED_INT:21,BE_UNSIGNED_INT:22,BE_FLOAT32:23,BE_FLOAT64:24,BMP:27,QT_ATOM:28,BE_SIGNED_INT8:65,BE_SIGNED_INT16:66,BE_SIGNED_INT32:67,BE_FLOAT32_POINT:70,BE_FLOAT32_DIMENSIONS:71,BE_FLOAT32_RECT:72,BE_SIGNED_INT64:74,BE_UNSIGNED_INT8:75,BE_UNSIGNED_INT16:76,BE_UNSIGNED_INT32:77,BE_UNSIGNED_INT64:78,BE_FLOAT64_AFFINE_TRANSFORM:79},ia),If,Az=(If=class extends N{constructor(){super(...arguments),this.box_name="TrackEncodedPixelsDimensionsBox"}parse(t){this.parseFullHeader(t),this.width=t.readUint32(),this.height=t.readUint32()}},If.fourcc="enof",If),Pf,Iz=(Pf=class extends Q{constructor(){super(...arguments),this.box_name="IlstBox"}parse(t){this.list={};let e=this.size-this.hdr_size;for(;e>0;){const i=t.readUint32(),s=t.readUint32(),r=Ci(t,!1,i-8);r.code===Nt&&(this.list[s]=r.box),e-=i}}},Pf.fourcc="ilst",Pf),Ef,Pz=(Ef=class extends N{constructor(){super(...arguments),this.box_name="KeysBox"}parse(t){this.parseFullHeader(t),this.count=t.readUint32(),this.keys={};for(let e=0;e<this.count;e++){const i=t.readUint32();this.keys[e+1]=t.readString(i-4)}}},Ef.fourcc="keys",Ef),Mf,Ez=(Mf=class extends N{constructor(){super(...arguments),this.box_name="TrackProductionApertureDimensionsBox"}parse(t){this.parseFullHeader(t),this.width=t.readUint32(),this.height=t.readUint32()}},Mf.fourcc="prof",Mf),Ff,Mz=(Ff=class extends ze{constructor(){super(...arguments),this.box_name="TrackApertureModeDimensionsBox",this.clefs=[],this.profs=[],this.enofs=[],this.subBoxNames=["clef","prof","enof"]}},Ff.fourcc="tapt",Ff),Rf,Fz=(Rf=class extends ze{constructor(){super(...arguments),this.box_name="siDecompressionParamBox"}},Rf.fourcc="wave",Rf),zf,Rz=(zf=class extends Q{constructor(){super(...arguments),this.box_name="rtpmoviehintinformation"}parse(t){this.descriptionformat=t.readString(4),this.sdptext=t.readString(this.size-this.hdr_size-4)}},zf.fourcc="rtp ",zf),Uf,zz=(Uf=class extends N{constructor(){super(...arguments),this.box_name="SampleAuxiliaryInformationOffsetsBox"}parse(t){this.parseFullHeader(t),this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32());const e=t.readUint32();this.offset=[];for(let i=0;i<e;i++)this.version===0?this.offset[i]=t.readUint32():this.offset[i]=t.readUint64()}},Uf.fourcc="saio",Uf),Bf,Uz=(Bf=class extends N{constructor(){super(...arguments),this.box_name="SampleAuxiliaryInformationSizesBox"}parse(t){if(this.parseFullHeader(t),this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32()),this.default_sample_info_size=t.readUint8(),this.sample_count=t.readUint32(),this.sample_info_size=[],this.default_sample_info_size===0)for(let e=0;e<this.sample_count;e++)this.sample_info_size[e]=t.readUint8()}},Bf.fourcc="saiz",Bf),Bz=class{constructor(t,e){this.bad_pixel_row=t,this.bad_pixel_column=e}toString(){return"[row: "+this.bad_pixel_row+", column: "+this.bad_pixel_column+"]"}},Of,Oz=(Of=class extends N{constructor(){super(...arguments),this.box_name="SensorBadPixelsMapBox"}parse(t){this.parseFullHeader(t),this.component_count=t.readUint16(),this.component_index=[];for(let i=0;i<this.component_count;i++)this.component_index.push(t.readUint16());const e=t.readUint8();this.correction_applied=(e&128)===128,this.num_bad_rows=t.readUint32(),this.num_bad_cols=t.readUint32(),this.num_bad_pixels=t.readUint32(),this.bad_rows=[],this.bad_columns=[],this.bad_pixels=[];for(let i=0;i<this.num_bad_rows;i++)this.bad_rows.push(t.readUint32());for(let i=0;i<this.num_bad_cols;i++)this.bad_columns.push(t.readUint32());for(let i=0;i<this.num_bad_pixels;i++){const s=t.readUint32(),r=t.readUint32();this.bad_pixels.push(new Bz(s,r))}}},Of.fourcc="sbpm",Of),Df,Dz=(Df=class extends N{constructor(){super(...arguments),this.box_name="SchemeTypeBox"}parse(t){this.parseFullHeader(t),this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),this.flags&1&&(this.scheme_uri=t.readString(this.size-this.hdr_size-8))}},Df.fourcc="schm",Df),Lf,Lz=(Lf=class extends Q{constructor(){super(...arguments),this.box_name="rtptracksdphintinformation"}parse(t){this.sdptext=t.readString(this.size-this.hdr_size)}},Lf.fourcc="sdp ",Lf),Nf,Nz=(Nf=class extends N{constructor(){super(...arguments),this.box_name="SampleEncryptionBox"}},Nf.fourcc="senc",Nf),Hf,Hz=(Hf=class extends N{constructor(){super(...arguments),this.box_name="SMPTE2086MasteringDisplayMetadataBox"}parse(t){this.parseFullHeader(t),this.primaryRChromaticity_x=t.readUint16(),this.primaryRChromaticity_y=t.readUint16(),this.primaryGChromaticity_x=t.readUint16(),this.primaryGChromaticity_y=t.readUint16(),this.primaryBChromaticity_x=t.readUint16(),this.primaryBChromaticity_y=t.readUint16(),this.whitePointChromaticity_x=t.readUint16(),this.whitePointChromaticity_y=t.readUint16(),this.luminanceMax=t.readUint32(),this.luminanceMin=t.readUint32()}},Hf.fourcc="SmDm",Hf),Gf,Gz=(Gf=class extends N{constructor(){super(...arguments),this.box_name="SamplingRateBox"}parse(t){this.parseFullHeader(t),this.sampling_rate=t.readUint32()}},Gf.fourcc="srat",Gf),Wf,Wz=(Wf=class extends N{constructor(){super(...arguments),this.box_name="CompressedSubsegmentIndexBox"}parse(t){this.parseFullHeader(t),this.subsegments=[];const e=t.readUint32();for(let i=0;i<e;i++){const s={};this.subsegments.push(s),s.ranges=[];const r=t.readUint32();for(let n=0;n<r;n++){const o={};s.ranges.push(o),o.level=t.readUint8(),o.range_size=t.readUint24()}}}},Wf.fourcc="ssix",Wf),Vf,Vz=(Vf=class extends N{constructor(){super(...arguments),this.box_name="DegradationPriorityBox"}parse(t){this.parseFullHeader(t);const e=(this.size-this.hdr_size)/2;this.priority=[];for(let i=0;i<e;i++)this.priority[i]=t.readUint16()}},Vf.fourcc="stpd",Vf),$f,$z=($f=class extends N{constructor(){super(...arguments),this.box_name="SubTrackInformationBox"}parse(t){this.parseFullHeader(t),this.switch_group=t.readUint16(),this.alternate_group=t.readUint16(),this.sub_track_id=t.readUint32();const e=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(let i=0;i<e;i++)this.attribute_list[i]=t.readUint32()}},$f.fourcc="stri",$f),qf,qz=(qf=class extends N{constructor(){super(...arguments),this.box_name="SubTrackSampleGroupBox"}parse(t){this.parseFullHeader(t),this.grouping_type=t.readUint32();const e=t.readUint16();this.group_description_index=[];for(let i=0;i<e;i++)this.group_description_index[i]=t.readUint32()}},qf.fourcc="stsg",qf),Yf,Yz=(Yf=class extends N{constructor(){super(...arguments),this.box_name="ShadowSyncSampleBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(let i=0;i<e;i++)this.shadowed_sample_numbers.push(t.readUint32()),this.sync_sample_numbers.push(t.readUint32())}write(t){this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(t),t.writeUint32(this.shadowed_sample_numbers.length);for(let e=0;e<this.shadowed_sample_numbers.length;e++)t.writeUint32(this.shadowed_sample_numbers[e]),t.writeUint32(this.sync_sample_numbers[e])}},Yf.fourcc="stsh",Yf),Xf,Xz=(Xf=class extends N{constructor(){super(...arguments),this.box_name="SyncSampleBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();if(this.version===0){this.sample_numbers=[];for(let i=0;i<e;i++)this.sample_numbers.push(t.readUint32())}}write(t){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(t),t.writeUint32(this.sample_numbers.length),t.writeUint32Array(this.sample_numbers)}},Xf.fourcc="stss",Xf),jf,jz=(jf=class extends N{constructor(){super(...arguments),this.box_name="StereoVideoBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();this.single_view_allowed=e&3,this.stereo_scheme=t.readUint32();const i=t.readUint32();for(this.stereo_indication_type=t.readString(i),this.boxes=[];t.getPosition()<this.start+this.size;){const s=Ci(t,!1,this.size-(t.getPosition()-this.start));if(s.code===Nt){const r=s.box;this.boxes.push(r),this[r.type]=r}else return}}},jf.fourcc="stvi",jf),Kf,Kz=(Kf=class extends Q{constructor(){super(...arguments),this.box_name="SegmentTypeBox"}parse(t){let e=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),e-=8,this.compatible_brands=[];let i=0;for(;e>=4;)this.compatible_brands[i]=t.readString(4),e-=4,i++}write(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,void 0,4),t.writeUint32(this.minor_version);for(let e=0;e<this.compatible_brands.length;e++)t.writeString(this.compatible_brands[e],void 0,4)}},Kf.fourcc="styp",Kf),Zf,Zz=(Zf=class extends N{constructor(){super(...arguments),this.box_name="CompactSampleSizeBox"}parse(t){if(this.parseFullHeader(t),this.sample_sizes=[],this.version===0){this.reserved=t.readUint24(),this.field_size=t.readUint8();const e=t.readUint32();if(this.field_size===4)for(let i=0;i<e;i+=2){const s=t.readUint8();this.sample_sizes[i]=s>>4&15,this.sample_sizes[i+1]=s&15}else if(this.field_size===8)for(let i=0;i<e;i++)this.sample_sizes[i]=t.readUint8();else if(this.field_size===16)for(let i=0;i<e;i++)this.sample_sizes[i]=t.readUint16();else B.error("BoxParser","Error in length field in stz2 box",t.isofile)}}},Zf.fourcc="stz2",Zf),Jf,Jz=(Jf=class extends N{constructor(){super(...arguments),this.box_name="SubSampleInformationBox"}parse(t){this.parseFullHeader(t);const e=t.readUint32();this.entries=[];let i;for(let s=0;s<e;s++){const r={};if(this.entries[s]=r,r.sample_delta=t.readUint32(),r.subsamples=[],i=t.readUint16(),i>0)for(let n=0;n<i;n++){const o={};r.subsamples.push(o),this.version===1?o.size=t.readUint32():o.size=t.readUint16(),o.priority=t.readUint8(),o.discardable=t.readUint8(),o.codec_specific_parameters=t.readUint32()}}}},Jf.fourcc="subs",Jf),Qf,Qz=(Qf=class extends N{constructor(){super(...arguments),this.box_name="TAIClockInfoBox"}parse(t){this.time_uncertainty=t.readUint64(),this.clock_resolution=t.readUint32(),this.clock_drift_rate=t.readInt32();const e=t.readUint8();this.clock_type=(e&192)>>6}},Qf.fourcc="taic",Qf),ep,eU=(ep=class extends N{constructor(){super(...arguments),this.box_name="TrackEncryptionBox"}parse(t){if(this.parseFullHeader(t),t.readUint8(),this.version===0)t.readUint8();else{const e=t.readUint8();this.default_crypt_byte_block=e>>4&15,this.default_skip_byte_block=e&15}this.default_isProtected=t.readUint8(),this.default_Per_Sample_IV_Size=t.readUint8(),this.default_KID=gr(t),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=t.readUint8(),this.default_constant_IV=t.readUint8Array(this.default_constant_IV_size))}},ep.fourcc="tenc",ep),tp,tU=(tp=class extends N{constructor(){super(...arguments),this.box_name="TrackFragmentRandomAccessBox"}parse(t){this.parseFullHeader(t),this.track_ID=t.readUint32(),t.readUint24();const e=t.readUint8();this.length_size_of_traf_num=e>>4&3,this.length_size_of_trun_num=e>>2&3,this.length_size_of_sample_num=e&3,this.entries=[];const i=t.readUint32();for(let s=0;s<i;s++)this.version===1?(this.time=t.readUint64(),this.moof_offset=t.readUint64()):(this.time=t.readUint32(),this.moof_offset=t.readUint32()),this.traf_number=t["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=t["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=t["readUint"+8*(this.length_size_of_sample_num+1)]()}},tp.fourcc="tfra",tp),ip,iU=(ip=class extends Q{constructor(){super(...arguments),this.box_name="hintmaxrelativetime"}parse(t){this.time=t.readUint32()}},ip.fourcc="tmax",ip),sp,sU=(sp=class extends Q{constructor(){super(...arguments),this.box_name="hintminrelativetime"}parse(t){this.time=t.readUint32()}},sp.fourcc="tmin",sp),rp,rU=(rp=class extends Q{constructor(){super(...arguments),this.box_name="hintBytesSent"}parse(t){this.bytessent=t.readUint32()}},rp.fourcc="totl",rp),np,nU=(np=class extends Q{constructor(){super(...arguments),this.box_name="hintBytesSent"}parse(t){this.bytessent=t.readUint32()}},np.fourcc="tpay",np),op,oU=(op=class extends Q{constructor(){super(...arguments),this.box_name="hintBytesSent"}parse(t){this.bytessent=t.readUint64()}},op.fourcc="tpyl",op),ap,aU=(ap=class extends mw{},ap.fourcc="msrc",ap),kn,lU=(kn=class extends Q{constructor(){super(...arguments),this.box_name="TrackReferenceBox",this.references=[]}parse(t){for(;t.getPosition()<this.start+this.size;){const e=Ci(t,!0,this.size-(t.getPosition()-this.start));if(e.code===Nt){kn.allowed_types.includes(e.type)||B.warn("BoxParser",`Unknown track reference type: '${e.type}'`);const i=new vw(e.type,e.size,e.hdr_size,e.start);i.write===Q.prototype.write&&i.type!=="mdat"&&(B.info("BoxParser","TrackReference "+i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),this.references.push(i)}else return}}},kn.fourcc="tref",kn.allowed_types=["hint","cdsc","font","hind","vdep","vplx","subt","thmb","auxl","cdtg","shsc","aest"],kn),lp,cU=(lp=class extends N{constructor(){super(...arguments),this.box_name="TrackExtensionPropertiesBox"}parse(t){for(this.parseFullHeader(t),this.track_ID=t.readUint32(),this.boxes=[];t.getPosition()<this.start+this.size;){const e=Ci(t,!1,this.size-(t.getPosition()-this.start));if(e.code===Nt){const i=e.box;this.boxes.push(i)}else return}}},lp.fourcc="trep",lp),cp,uU=(cp=class extends Q{constructor(){super(...arguments),this.box_name="hintBytesSent"}parse(t){this.bytessent=t.readUint64()}},cp.fourcc="trpy",cp),up,hU=(up=class extends N{constructor(){super(...arguments),this.box_name="TrackSelectionBox"}parse(t){this.parseFullHeader(t),this.switch_group=t.readUint32();const e=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(let i=0;i<e;i++)this.attribute_list[i]=t.readUint32()}},up.fourcc="tsel",up),hp,dU=(hp=class extends N{constructor(){super(...arguments),this.box_name="TextConfigBox"}parse(t){this.parseFullHeader(t),this.config=t.readCString()}},hp.fourcc="txtc",hp),dp,fU=(dp=class extends Q{constructor(){super(...arguments),this.box_name="TypeCombinationBox"}parse(t){const e=(this.size-this.hdr_size)/4;this.compatible_brands=[];for(let i=0;i<e;i++)this.compatible_brands[i]=t.readString(4)}},dp.fourcc="tyco",dp),fp,pU=(fp=class extends N{constructor(){super(...arguments),this.box_name="UserDescriptionProperty"}parse(t){this.parseFullHeader(t),this.lang=t.readCString(),this.name=t.readCString(),this.description=t.readCString(),this.tags=t.readCString()}},fp.fourcc="udes",fp),pp,mU=(pp=class extends N{constructor(){super(...arguments),this.box_name="UncompressedFrameConfigBox"}parse(t){if(this.parseFullHeader(t),this.profile=t.readString(4),this.version!==1&&this.version===0){this.component_count=t.readUint32(),this.component_index=[],this.component_bit_depth_minus_one=[],this.component_format=[],this.component_align_size=[];for(let i=0;i<this.component_count;i++)this.component_index.push(t.readUint16()),this.component_bit_depth_minus_one.push(t.readUint8()),this.component_format.push(t.readUint8()),this.component_align_size.push(t.readUint8());this.sampling_type=t.readUint8(),this.interleave_type=t.readUint8(),this.block_size=t.readUint8();const e=t.readUint8();this.component_little_endian=e>>7&1,this.block_pad_lsb=e>>6&1,this.block_little_endian=e>>5&1,this.block_reversed=e>>4&1,this.pad_unknown=e>>3&1,this.pixel_size=t.readUint32(),this.row_align_size=t.readUint32(),this.tile_align_size=t.readUint32(),this.num_tile_cols_minus_one=t.readUint32(),this.num_tile_rows_minus_one=t.readUint32()}}},pp.fourcc="uncC",pp),mp,gU=(mp=class extends N{constructor(){super(...arguments),this.box_name="DataEntryUrnBox"}parse(t){this.parseFullHeader(t),this.name=t.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=t.readCString())}write(t){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(t),t.writeCString(this.name),this.location&&t.writeCString(this.location)}},mp.fourcc="urn ",mp),gp,yU=(gp=class extends Q{constructor(){super(...arguments),this.box_name="WebVTTConfigurationBox"}parse(t){this.text=t.readString(this.size-this.hdr_size)}},gp.fourcc="vttC",gp),yp,vU=(yp=class extends N{constructor(){super(...arguments),this.box_name="VvcNALUConfigBox"}parse(t){this.parseFullHeader(t);const e=t.readUint8();this.lengthSizeMinusOne=e&3}},yp.fourcc="vvnC",yp),vp,xU=(vp=class extends rt{parse(t){const e=t.readUint16();this.first_output_sample=t.readUint16(),this.sample_offset=[];for(let s=0;s<e;s++)this.sample_offset[s]=t.readUint32();const i=this.description_length-4-4*e;this.num_output_samples=[],this.num_total_samples=[];for(let s=0;s<i/4;s++)this.num_output_samples[s]=t.readUint16(),this.num_total_samples[s]=t.readUint16()}},vp.grouping_type="alst",vp),xp,bU=(xp=class extends rt{parse(t){this.layerNumber=t.readUint8(),this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()}},xp.grouping_type="avll",xp),bp,_U=(bp=class extends rt{parse(t){this.subSequenceIdentifier=t.readUint16(),this.layerNumber=t.readUint8();const e=t.readUint8();this.durationFlag=e>>7,this.avgRateFlag=e>>6&1,this.durationFlag&&(this.duration=t.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()),this.dependency=[];const i=t.readUint8();for(let s=0;s<i;s++)this.dependency.push({subSeqDirectionFlag:t.readUint8(),layerNumber:t.readUint8(),subSequenceIdentifier:t.readUint16()})}},bp.grouping_type="avss",bp),_p,wU=(_p=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},_p.grouping_type="dtrt",_p),wp,SU=(wp=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},wp.grouping_type="mvif",wp),Sp,CU=(Sp=class extends rt{parse(t){this.roll_distance=t.readInt16()}},Sp.grouping_type="prol",Sp),Cp,TU=(Cp=class extends rt{parse(t){const e=t.readUint8();this.num_leading_samples_known=e>>7,this.num_leading_samples=e&127}},Cp.grouping_type="rap ",Cp),Tp,kU=(Tp=class extends rt{parse(t){if(this.operation_point_count=t.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)B.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=t.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=t.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(let e=0;e<this.operation_point_count;e++)this.available_bitrate[e]=t.readUint32(),this.target_rate_share[e]=t.readUint16()}this.maximum_bitrate=t.readUint32(),this.minimum_bitrate=t.readUint32(),this.discard_priority=t.readUint8()}}},Tp.grouping_type="rash",Tp),kp,AU=(kp=class extends rt{parse(t){this.roll_distance=t.readInt16()}},kp.grouping_type="roll",kp),Ap,IU=(Ap=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},Ap.grouping_type="scif",Ap),Ip,PU=(Ip=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},Ip.grouping_type="scnm",Ip),Pp,EU=(Pp=class extends rt{parse(t){this.reserved=t.readUint8();const e=t.readUint8();this.crypt_byte_block=e>>4,this.skip_byte_block=e&15,this.isProtected=t.readUint8(),this.Per_Sample_IV_Size=t.readUint8(),this.KID=gr(t),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=t.readUint8(),this.constant_IV=t.readUint8Array(this.constant_IV_size))}},Pp.grouping_type="seig",Pp),Ep,MU=(Ep=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},Ep.grouping_type="stsa",Ep),Mp,FU=(Mp=class extends rt{parse(t){const e=t.readUint8();this.NAL_unit_type=e&63}},Mp.grouping_type="sync",Mp),Fp,RU=(Fp=class extends rt{parse(t){const e=t.readUint8();this.level_independently_decodable=e>>7}},Fp.grouping_type="tele",Fp),Rp,zU=(Rp=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},Rp.grouping_type="tsas",Rp),zp,UU=(zp=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},zp.grouping_type="tscl",zp),Up,BU=(Up=class extends rt{parse(t){B.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}},Up.grouping_type="vipr",Up),Bp,OU=(Bp=class extends Q{},Bp.fourcc="uuid",Bp),Op,pn=(Op=class extends N{},Op.fourcc="uuid",Op),Dp,DU=(Dp=class extends pn{constructor(){super(...arguments),this.box_name="LiveServerManifestBox"}parse(t){this.parseFullHeader(t),this.LiveServerManifest=t.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},Dp.uuid="a5d40b30e81411ddba2f0800200c9a66",Dp),Lp,LU=(Lp=class extends pn{constructor(){super(...arguments),this.box_name="PiffProtectionSystemSpecificHeaderBox"}parse(t){this.parseFullHeader(t),this.system_id=gr(t);const e=t.readUint32();e>0&&(this.data=t.readUint8Array(e))}},Lp.uuid="d08a4f1810f34a82b6c832d8aba183d3",Lp),Np,NU=(Np=class extends pn{constructor(){super(...arguments),this.box_name="PiffSampleEncryptionBox"}},Np.uuid="a2394f525a9b4f14a2446c427c648df4",Np),Hp,HU=(Hp=class extends pn{constructor(){super(...arguments),this.box_name="PiffTrackEncryptionBox"}parse(t){this.parseFullHeader(t),this.default_AlgorithmID=t.readUint24(),this.default_IV_size=t.readUint8(),this.default_KID=gr(t)}},Hp.uuid="8974dbce7be74c5184f97148f9882554",Hp),Gp,GU=(Gp=class extends pn{constructor(){super(...arguments),this.box_name="TfrfBox"}parse(t){this.parseFullHeader(t),this.fragment_count=t.readUint8(),this.entries=[];for(let e=0;e<this.fragment_count;e++){let i=0,s=0;this.version===1?(i=t.readUint64(),s=t.readUint64()):(i=t.readUint32(),s=t.readUint32()),this.entries.push({absolute_time:i,absolute_duration:s})}}},Gp.uuid="d4807ef2ca3946958e5426cb9e46a79f",Gp),Wp,WU=(Wp=class extends pn{constructor(){super(...arguments),this.box_name="TfxdBox"}parse(t){this.parseFullHeader(t),this.version===1?(this.absolute_time=t.readUint64(),this.duration=t.readUint64()):(this.absolute_time=t.readUint32(),this.duration=t.readUint32())}},Wp.uuid="6d1d9b0542d544e680e2141daff757b2",Wp),Vp,VU=(Vp=class extends OU{constructor(){super(...arguments),this.box_name="ItemContentIDProperty"}parse(t){this.content_id=t.readCString()}},Vp.uuid="261ef3741d975bbaacbd9d2c8ea73522",Vp),c2=nR(l2);oR(s2);const u2=Object.freeze(Object.defineProperty({__proto__:null,AudioSampleEntry:zt,Box:Q,BoxParser:c2,DIFF_BOXES_PROP_NAMES:dl,DIFF_PRIMITIVE_ARRAY_PROP_NAMES:xw,DataStream:ct,Descriptor:$s,ES_Descriptor:U0,Endianness:pw,FullBox:N,HintSampleEntry:ng,ISOFile:i2,Log:B,MP4BoxBuffer:Ui,MPEG4DescriptorParser:a2,MetadataSampleEntry:yr,MultiBufferStream:Kr,SampleEntry:Vi,SampleGroupEntry:rt,SampleGroupInfo:za,SingleItemTypeReferenceBox:gw,SingleItemTypeReferenceBoxLarge:yw,SubtitleSampleEntry:Ls,SystemSampleEntry:Zl,TX3GParser:i5,TextSampleEntry:_w,Textin4Parser:t5,TrackGroupTypeBox:mw,TrackReferenceTypeBox:vw,VTTin4Parser:Q4,VisualSampleEntry:Ze,XMLSubtitlein4Parser:e5,boxEqual:F0,boxEqualFields:bw,createFile:X4},Symbol.toStringTag,{value:"Module"}));c2?.box?.esds;const $U={0:"debug",1:"info",2:"warn",3:"error"};function qU(t){if(t instanceof Error)return String(t);if(typeof t=="object"&&t!==null)try{return JSON.stringify(t,(e,i)=>i instanceof Error?String(i):i)}catch{return String(t)}return String(t)}function YU(){const t=new Date,e=s=>s.toString().padStart(2,"0"),i=t.getMilliseconds().toString().padStart(3,"0");return`${e(t.getHours())}:${e(t.getMinutes())}:${e(t.getSeconds())}.${i}`}class XU{threshold=1;history=[];debug=(...e)=>this.log(0,console.debug,e);info=(...e)=>this.log(1,console.info,e);warn=(...e)=>this.log(2,console.warn,e);error=(...e)=>this.log(3,console.error,e);log(e,i,s){e>=this.threshold&&(i(...s),this.history.push({level:$U[e],time:YU(),args:s}))}setThreshold(e){this.threshold=e}getThreshold(){return this.threshold}createTagged(e){return{debug:(...i)=>this.debug(e,...i),info:(...i)=>this.info(e,...i),warn:(...i)=>this.warn(e,...i),error:(...i)=>this.error(e,...i)}}dump(){return this.history.map(({level:e,time:i,args:s})=>`[${e.toUpperCase()}][${i}] ${s.map(qU).join(" ")}`).join(`
`)}}const Ii=new XU,Is={debug:Ii.debug,info:Ii.info,warn:Ii.warn,error:Ii.error,setLogLevel:t=>{const e=t;e===Is.debug?Ii.setThreshold(0):e===Is.info?Ii.setThreshold(1):e===Is.warn?Ii.setThreshold(2):e===Is.error&&Ii.setThreshold(3)},create:t=>Ii.createTagged(t),dump:async()=>Ii.dump()};(async function(){if(!(typeof navigator>"u"||typeof document>"u")&&(Is.info(`User Agent: ${navigator.userAgent}`),document.addEventListener("visibilitychange",()=>{Is.info(`visibilitychange: ${document.visibilityState}`)}),"PressureObserver"in globalThis))try{let t="";new globalThis.PressureObserver(e=>{const i=JSON.stringify(e.map(s=>s.state));i!==t&&(Is.info(`cpu state change: ${i}`),t=i)}).observe("cpu")}catch(t){Is.debug("Failed to initialize PressureObserver",t)}})();const jU=()=>{let t,e=16.6;self.onmessage=i=>{i.data.event==="start"&&(self.clearInterval(t),t=self.setInterval(()=>{self.postMessage({})},e)),i.data.event==="stop"&&self.clearInterval(t)}},KU=()=>{const t=new Blob([`(${jU.toString()})()`]),e=URL.createObjectURL(t);return new Worker(e)},ZU=new Map;let Uv=1,Bv=null;globalThis.Worker!=null&&(Bv=KU(),Bv.onmessage=()=>{Uv+=1;for(const[t,e]of ZU)if(Uv%t===0)for(const i of e)i()});var h2=t=>{throw TypeError(t)},d2=(t,e,i)=>e.has(t)||h2("Cannot "+i),Fe=(t,e,i)=>(d2(t,e,"read from private field"),i?i.call(t):e.get(t)),ii=(t,e,i)=>e.has(t)?h2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),At=(t,e,i,s)=>(d2(t,e,"write to private field"),e.set(t,i),i);const f2="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHUobil7aWYobj09PSIvIilyZXR1cm57cGFyZW50Om51bGwsbmFtZToiIn07Y29uc3QgZT1uLnNwbGl0KCIvIikuZmlsdGVyKGk9PmkubGVuZ3RoPjApO2lmKGUubGVuZ3RoPT09MCl0aHJvdyBFcnJvcigiSW52YWxpZCBwYXRoIik7Y29uc3QgYT1lW2UubGVuZ3RoLTFdLHI9Ii8iK2Uuc2xpY2UoMCwtMSkuam9pbigiLyIpO3JldHVybntuYW1lOmEscGFyZW50OnJ9fWFzeW5jIGZ1bmN0aW9uIHcobixlKXtjb25zdHtwYXJlbnQ6YSxuYW1lOnJ9PXUobik7aWYoYT09bnVsbClyZXR1cm4gYXdhaXQgbmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Y29uc3QgaT1hLnNwbGl0KCIvIikuZmlsdGVyKHQ9PnQubGVuZ3RoPjApO3RyeXtsZXQgdD1hd2FpdCBuYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgcyBvZiBpKXQ9YXdhaXQgdC5nZXREaXJlY3RvcnlIYW5kbGUocyx7Y3JlYXRlOmUuY3JlYXRlfSk7aWYoZS5pc0ZpbGUpcmV0dXJuIGF3YWl0IHQuZ2V0RmlsZUhhbmRsZShyLHtjcmVhdGU6ZS5jcmVhdGV9KX1jYXRjaCh0KXtpZih0Lm5hbWU9PT0iTm90Rm91bmRFcnJvciIpcmV0dXJuIG51bGw7dGhyb3cgdH19Y29uc3QgZj17fTtzZWxmLm9ubWVzc2FnZT1hc3luYyBuPT57dmFyIGk7Y29uc3R7ZXZ0VHlwZTplLGFyZ3M6YX09bi5kYXRhO2xldCByPWZbYS5maWxlSWRdO3RyeXtsZXQgdDtjb25zdCBzPVtdO2lmKGU9PT0icmVnaXN0ZXIiKXtjb25zdCBsPWF3YWl0IHcoYS5maWxlUGF0aCx7Y3JlYXRlOiEwLGlzRmlsZTohMH0pO2lmKGw9PW51bGwpdGhyb3cgRXJyb3IoYG5vdCBmb3VuZCBmaWxlOiAke2EuZmlsZUlkfWApO3I9YXdhaXQgbC5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKHttb2RlOmEubW9kZX0pLGZbYS5maWxlSWRdPXJ9ZWxzZSBpZihlPT09ImNsb3NlIilhd2FpdCByLmNsb3NlKCksZGVsZXRlIGZbYS5maWxlSWRdO2Vsc2UgaWYoZT09PSJ0cnVuY2F0ZSIpYXdhaXQgci50cnVuY2F0ZShhLm5ld1NpemUpO2Vsc2UgaWYoZT09PSJ3cml0ZSIpe2NvbnN0e2RhdGE6bCxvcHRzOm99PW4uZGF0YS5hcmdzO3Q9YXdhaXQgci53cml0ZShsLG8pfWVsc2UgaWYoZT09PSJyZWFkIil7Y29uc3R7b2Zmc2V0Omwsc2l6ZTpvfT1uLmRhdGEuYXJncyxnPW5ldyBVaW50OEFycmF5KG8pLGQ9YXdhaXQgci5yZWFkKGcse2F0Omx9KSxjPWcuYnVmZmVyO3Q9ZD09PW8/YzooKGk9Yy50cmFuc2Zlcik9PW51bGw/dm9pZCAwOmkuY2FsbChjLGQpKT8/Yy5zbGljZSgwLGQpLHMucHVzaCh0KX1lbHNlIGU9PT0iZ2V0U2l6ZSI/dD1hd2FpdCByLmdldFNpemUoKTplPT09ImZsdXNoIiYmYXdhaXQgci5mbHVzaCgpO3NlbGYucG9zdE1lc3NhZ2Uoe2V2dFR5cGU6ImNhbGxiYWNrIixjYklkOm4uZGF0YS5jYklkLHJldHVyblZhbDp0fSxzKX1jYXRjaCh0KXtjb25zdCBzPXQ7c2VsZi5wb3N0TWVzc2FnZSh7ZXZ0VHlwZToidGhyb3dFcnJvciIsY2JJZDpuLmRhdGEuY2JJZCxlcnJNc2c6cy5uYW1lKyI6ICIrcy5tZXNzYWdlK2AKYCtKU09OLnN0cmluZ2lmeShuLmRhdGEpfSl9fX0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW9wZnMtd29ya2VyLUY0UldscWNfLmpzLm1hcAo=",JU=t=>Uint8Array.from(atob(t),e=>e.charCodeAt(0)),Ov=typeof self<"u"&&self.Blob&&new Blob([JU(f2)],{type:"text/javascript;charset=utf-8"});function QU(t){let e;try{if(e=Ov&&(self.URL||self.webkitURL).createObjectURL(Ov),!e)throw"";const i=new Worker(e,{name:t?.name});return i.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),i}catch{return new Worker("data:text/javascript;base64,"+f2,{name:t?.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}async function eB(t,e,i){const s=tB();return await s("register",{fileId:t,filePath:e,mode:i}),{read:async(r,n)=>await s("read",{fileId:t,offset:r,size:n}),write:async(r,n)=>await s("write",{fileId:t,data:r,opts:n},[ArrayBuffer.isView(r)?r.buffer:r]),close:async()=>await s("close",{fileId:t}),truncate:async r=>await s("truncate",{fileId:t,newSize:r}),getSize:async()=>await s("getSize",{fileId:t}),flush:async()=>await s("flush",{fileId:t})}}const sa=[];let $p=0;function tB(){if(sa.length<3){const e=t();return sa.push(e),e}else{const e=sa[$p];return $p=($p+1)%sa.length,e}function t(){const e=new QU;let i=0,s={};return e.onmessage=({data:r})=>{var n,o;r.evtType==="callback"?(n=s[r.cbId])==null||n.resolve(r.returnVal):r.evtType==="throwError"&&((o=s[r.cbId])==null||o.reject(Error(r.errMsg))),delete s[r.cbId]},async function(r,n,o=[]){i+=1;const a=new Promise((l,u)=>{s[i]={resolve:l,reject:u}});return e.postMessage({cbId:i,evtType:r,args:n},o),a}}}function ec(t){if(t==="/")return{parent:null,name:""};const e=t.split("/").filter(r=>r.length>0);if(e.length===0)throw Error("Invalid path");const i=e[e.length-1],s="/"+e.slice(0,-1).join("/");return{name:i,parent:s}}async function Ps(t,e){const{parent:i,name:s}=ec(t);if(i==null)return await navigator.storage.getDirectory();const r=i.split("/").filter(n=>n.length>0);try{let n=await navigator.storage.getDirectory();for(const o of r)n=await n.getDirectoryHandle(o,{create:e.create});return e.isFile?await n.getFileHandle(s,{create:e.create}):await n.getDirectoryHandle(s,{create:e.create})}catch(n){if(n.name==="NotFoundError")return null;throw n}}async function cg(t){const{parent:e,name:i}=ec(t);if(e==null){const r=await navigator.storage.getDirectory();for await(const n of r.keys())await r.removeEntry(n,{recursive:!0});return}const s=await Ps(e,{create:!1,isFile:!1});if(s!=null)try{await s.removeEntry(i,{recursive:!0})}catch(r){if(r.name==="NotFoundError")return;throw r}}function ug(t,e){return`${t}/${e}`.replace("//","/")}function Hr(t){return new m2(t)}var Ei,Ba,Dn;const iB=class p2{constructor(e){ii(this,Ei),ii(this,Ba),ii(this,Dn),At(this,Ei,e);const{parent:i,name:s}=ec(e);At(this,Ba,s),At(this,Dn,i)}get kind(){return"dir"}get name(){return Fe(this,Ba)}get path(){return Fe(this,Ei)}get parent(){return Fe(this,Dn)==null?null:Hr(Fe(this,Dn))}async create(){return await Ps(Fe(this,Ei),{create:!0,isFile:!1}),Hr(Fe(this,Ei))}async exists(){return await Ps(Fe(this,Ei),{create:!1,isFile:!1})instanceof FileSystemDirectoryHandle}async remove(e={}){for(const i of await this.children())try{await i.remove(e)}catch(s){console.warn(s)}try{await cg(Fe(this,Ei))}catch(i){console.warn(i)}}async children(){const e=await Ps(Fe(this,Ei),{create:!1,isFile:!1});if(e==null)return[];const i=[];for await(const s of e.values())i.push((s.kind==="file"?vr:Hr)(ug(Fe(this,Ei),s.name)));return i}async copyTo(e){if(!await this.exists())throw Error(`dir ${this.path} not exists`);if(e instanceof p2){const i=await e.exists()?Hr(ug(e.path,this.name)):e;return await i.create(),await Promise.all((await this.children()).map(s=>s.copyTo(i))),i}else if(e instanceof FileSystemDirectoryHandle)return await Promise.all((await this.children()).map(async i=>{i.kind==="file"?await i.copyTo(await e.getFileHandle(i.name,{create:!0})):await i.copyTo(await e.getDirectoryHandle(i.name,{create:!0}))})),null;throw Error("Illegal target type")}async moveTo(e){const i=await this.copyTo(e);return await this.remove(),i}};Ei=new WeakMap,Ba=new WeakMap,Dn=new WeakMap;let m2=iB;const hg=new Map;function vr(t,e="rw"){if(e==="rw"){const i=hg.get(t)??new ml(t,e);return hg.set(t,i),i}return new ml(t,e)}async function tc(t,e,i={overwrite:!0}){if(e instanceof ml){await tc(t,await e.stream(),i);return}const s=await(t instanceof ml?t:vr(t,"rw")).createWriter();try{if(i.overwrite&&await s.truncate(0),e instanceof ReadableStream){const r=e.getReader();for(;;){const{done:n,value:o}=await r.read();if(n)break;await s.write(o)}}else await s.write(e)}catch(r){throw r}finally{await s.close()}}let sB=0;const rB=()=>++sB;var ei,Ln,Oa,Nn,Da,Ki,La,Na,Fr;const nB=class g2{constructor(e,i){ii(this,ei),ii(this,Ln),ii(this,Oa),ii(this,Nn),ii(this,Da),ii(this,Ki,0),ii(this,La,async()=>{}),ii(this,Na,(()=>{let n=null;return()=>(At(this,Ki,Fe(this,Ki)+1),n!=null||(n=new Promise(async(o,a)=>{try{const l=await eB(Fe(this,Da),Fe(this,ei),Fe(this,Nn));At(this,La,async()=>{n!=null&&(n=null,At(this,Ki,0),await l.close().catch(console.error))}),o([l,async()=>{At(this,Ki,Fe(this,Ki)-1),!(Fe(this,Ki)>0)&&(n=null,await l.close())}])}catch(l){a(l)}})),n)})()),ii(this,Fr,!1),At(this,Da,rB()),At(this,ei,e),At(this,Nn,{r:"read-only",rw:"readwrite","rw-unsafe":"readwrite-unsafe"}[i]);const{parent:s,name:r}=ec(e);if(s==null)throw Error("Invalid path");At(this,Oa,r),At(this,Ln,s)}get kind(){return"file"}get path(){return Fe(this,ei)}get name(){return Fe(this,Oa)}get parent(){return Fe(this,Ln)==null?null:Hr(Fe(this,Ln))}async createWriter(){if(Fe(this,Nn)==="read-only")throw Error("file is read-only");if(Fe(this,Fr))throw Error("Other writer have not been closed");At(this,Fr,!0);try{const e=new TextEncoder,[i,s]=await Fe(this,Na).call(this);let r=await i.getSize(),n=!1;return{write:async(o,a={})=>{if(n)throw Error("Writer is closed");const l=typeof o=="string"?e.encode(o):o,u=a.at??r,c=l.byteLength;return r=u+c,await i.write(l,{at:u})},truncate:async o=>{if(n)throw Error("Writer is closed");await i.truncate(o),r>o&&(r=o)},flush:async()=>{if(n)throw Error("Writer is closed");await i.flush()},close:async()=>{if(n)throw Error("Writer is closed");n=!0,At(this,Fr,!1),await s()}}}catch(e){throw At(this,Fr,!1),e}}async createReader(){const[e,i]=await Fe(this,Na).call(this);let s=!1,r=0;return{read:async(n,o={})=>{if(s)throw Error("Reader is closed");const a=o.at??r,l=await e.read(a,n);return r=a+l.byteLength,l},getSize:async()=>{if(s)throw Error("Reader is closed");return await e.getSize()},close:async()=>{s||(s=!0,await i())}}}async text(){return new TextDecoder().decode(await this.arrayBuffer())}async arrayBuffer(){const e=await Ps(Fe(this,ei),{create:!1,isFile:!0});return e==null?new ArrayBuffer(0):(await e.getFile()).arrayBuffer()}async stream(){const e=await this.getOriginFile();return e==null?new ReadableStream({pull:i=>{i.close()}}):e.stream()}async getOriginFile(){var e;return(e=await Ps(Fe(this,ei),{create:!1,isFile:!0}))==null?void 0:e.getFile()}async getSize(){const e=await Ps(Fe(this,ei),{create:!1,isFile:!0});return e==null?0:(await e.getFile()).size}async exists(){return await Ps(Fe(this,ei),{create:!1,isFile:!0})instanceof FileSystemFileHandle}async remove(e={}){if(e.force===!0){await Fe(this,La).call(this),await cg(Fe(this,ei)),hg.delete(Fe(this,ei));return}if(Fe(this,Ki)>0)throw Error("exists unclosed reader/writer");await cg(Fe(this,ei))}async copyTo(e){if(e instanceof g2)return e.path===this.path?this:(await tc(e,this),e);if(e instanceof m2){if(!await this.exists())throw Error(`file ${this.path} not exists`);return await this.copyTo(vr(ug(e.path,this.name)))}else if(e instanceof FileSystemFileHandle)return await(await this.stream()).pipeTo(await e.createWritable()),null;throw Error("Illegal target type")}async moveTo(e){const i=await this.copyTo(e);return await this.remove(),i}};ei=new WeakMap,Ln=new WeakMap,Oa=new WeakMap,Nn=new WeakMap,Da=new WeakMap,Ki=new WeakMap,La=new WeakMap,Na=new WeakMap,Fr=new WeakMap;let ml=nB;const B0="/.opfs-tools-temp-dir";async function y2(t){try{if(t.kind==="file"){if(!await t.exists())return!0;const e=await t.createWriter();await e.truncate(0),await e.close(),await t.remove()}else await t.remove();return!0}catch(e){return console.warn(e),!1}}function oB(){setInterval(async()=>{for(const t of await Hr(B0).children()){const e=/^\d+-(\d+)$/.exec(t.name);(e==null||Date.now()-Number(e[1])>2592e5)&&await y2(t)}},60*1e3)}const dg=[];let Dv=!1;async function aB(){if(globalThis.localStorage==null)return;const t="OPFS_TOOLS_EXPIRES_TMP_FILES";Dv||(Dv=!0,globalThis.addEventListener("unload",()=>{dg.length!==0&&localStorage.setItem(t,`${localStorage.getItem(t)??""},${dg.join(",")}`)}));let e=localStorage.getItem(t)??"";for(const i of e.split(","))i.length!==0&&await y2(vr(`${B0}/${i}`))&&(e=e.replace(i,""));localStorage.setItem(t,e.replace(/,{2,}/g,","))}(async function(){var t;globalThis.__opfs_tools_tmpfile_init__!==!0&&(globalThis.__opfs_tools_tmpfile_init__=!0,!(globalThis.FileSystemDirectoryHandle==null||globalThis.FileSystemFileHandle==null||((t=globalThis.navigator)==null?void 0:t.storage.getDirectory)==null)&&(oB(),await aB()))})();function lB(){const t=`${Math.random().toString().slice(2)}-${Date.now()}`;return dg.push(t),vr(`${B0}/${t}`)}const cB={0:"debug",1:"info",2:"warn",3:"error"};function uB(t){if(t instanceof Error)return String(t);if(typeof t=="object"&&t!==null)try{return JSON.stringify(t,(e,i)=>i instanceof Error?String(i):i)}catch{return String(t)}return String(t)}function hB(){const t=new Date,e=s=>s.toString().padStart(2,"0"),i=t.getMilliseconds().toString().padStart(3,"0");return`${e(t.getHours())}:${e(t.getMinutes())}:${e(t.getSeconds())}.${i}`}class dB{threshold=1;history=[];debug=(...e)=>this.log(0,console.debug,e);info=(...e)=>this.log(1,console.info,e);warn=(...e)=>this.log(2,console.warn,e);error=(...e)=>this.log(3,console.error,e);log(e,i,s){e>=this.threshold&&(i(...s),this.history.push({level:cB[e],time:hB(),args:s}))}setThreshold(e){this.threshold=e}getThreshold(){return this.threshold}createTagged(e){return{debug:(...i)=>this.debug(e,...i),info:(...i)=>this.info(e,...i),warn:(...i)=>this.warn(e,...i),error:(...i)=>this.error(e,...i)}}dump(){return this.history.map(({level:e,time:i,args:s})=>`[${e.toUpperCase()}][${i}] ${s.map(uB).join(" ")}`).join(`
`)}}const Pi=new dB,De={debug:Pi.debug,info:Pi.info,warn:Pi.warn,error:Pi.error,setLogLevel:t=>{const e=t;e===De.debug?Pi.setThreshold(0):e===De.info?Pi.setThreshold(1):e===De.warn?Pi.setThreshold(2):e===De.error&&Pi.setThreshold(3)},create:t=>Pi.createTagged(t),dump:async()=>Pi.dump()};class fB{constructor(e,i,s){this.length_=e,this.scaleFactor_=(e-1)/i,this.interpolate=this.cubic,s.method==="point"?this.interpolate=this.point:s.method==="linear"?this.interpolate=this.linear:s.method==="sinc"&&(this.interpolate=this.sinc),this.tangentFactor_=1-Math.max(0,Math.min(1,s.tension||0)),this.sincFilterSize_=s.sincFilterSize||1,this.kernel_=mB(s.sincWindow||pB)}point(e,i){return this.getClippedInput_(Math.round(this.scaleFactor_*e),i)}linear(e,i){e=this.scaleFactor_*e;let s=Math.floor(e);return e-=s,(1-e)*this.getClippedInput_(s,i)+e*this.getClippedInput_(s+1,i)}cubic(e,i){e=this.scaleFactor_*e;let s=Math.floor(e),r=[this.getTangent_(s,i),this.getTangent_(s+1,i)],n=[this.getClippedInput_(s,i),this.getClippedInput_(s+1,i)];e-=s;let o=e*e,a=e*o;return(2*a-3*o+1)*n[0]+(a-2*o+e)*r[0]+(-2*a+3*o)*n[1]+(a-o)*r[1]}sinc(e,i){e=this.scaleFactor_*e;let s=Math.floor(e),r=s-this.sincFilterSize_+1,n=s+this.sincFilterSize_,o=0;for(let a=r;a<=n;a++)o+=this.kernel_(e-a)*this.getClippedInput_(a,i);return o}getTangent_(e,i){return this.tangentFactor_*(this.getClippedInput_(e+1,i)-this.getClippedInput_(e-1,i))/2}getClippedInput_(e,i){return 0<=e&&e<this.length_?i[e]:0}}function pB(t){return Math.exp(-t/2*t/2)}function mB(t){return function(e){return gB(e)*t(e)}}function gB(t){return t===0?1:Math.sin(Math.PI*t)/(Math.PI*t)}class yB{constructor(e,i,s){let r=2*Math.PI*s/i,n=0;this.filters=[];for(let o=0;o<=e;o++)o-e/2===0?this.filters[o]=r:(this.filters[o]=Math.sin(r*(o-e/2))/(o-e/2),this.filters[o]*=.54-.46*Math.cos(2*Math.PI*o/e)),n=n+this.filters[o];for(let o=0;o<=e;o++)this.filters[o]/=n;this.z=this.initZ_()}filter(e){this.z.buf[this.z.pointer]=e;let i=0;for(let s=0,r=this.z.buf.length;s<r;s++)i+=this.filters[s]*this.z.buf[(this.z.pointer+s)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,i}reset(){this.z=this.initZ_()}initZ_(){let e=[];for(let i=0;i<this.filters.length-1;i++)e.push(0);return{buf:e,pointer:0}}}class vB{constructor(e,i,s){let r=[];for(let n=0;n<e;n++)r.push(this.getCoeffs_({Fs:i,Fc:s,Q:.5/Math.sin(Math.PI/(e*2)*(n+.5))}));this.stages=[];for(let n=0;n<r.length;n++)this.stages[n]={b0:r[n].b[0],b1:r[n].b[1],b2:r[n].b[2],a1:r[n].a[0],a2:r[n].a[1],k:r[n].k,z:[0,0]}}filter(e){let i=e;for(let s=0,r=this.stages.length;s<r;s++)i=this.runStage_(s,i);return i}getCoeffs_(e){let i={};i.z=[0,0],i.a=[],i.b=[];let s=this.preCalc_(e,i);return i.k=1,i.b.push((1-s.cw)/(2*s.a0)),i.b.push(2*i.b[0]),i.b.push(i.b[0]),i}preCalc_(e,i){let s={},r=2*Math.PI*e.Fc/e.Fs;return s.alpha=Math.sin(r)/(2*e.Q),s.cw=Math.cos(r),s.a0=1+s.alpha,i.a0=s.a0,i.a.push(-2*s.cw/s.a0),i.k=1,i.a.push((1-s.alpha)/s.a0),s}runStage_(e,i){let s=i*this.stages[e].k-this.stages[e].a1*this.stages[e].z[0]-this.stages[e].a2*this.stages[e].z[1],r=this.stages[e].b0*s+this.stages[e].b1*this.stages[e].z[0]+this.stages[e].b2*this.stages[e].z[1];return this.stages[e].z[1]=this.stages[e].z[0],this.stages[e].z[0]=s,r}reset(){for(let e=0;e<this.stages.length;e++)this.stages[e].z=[0,0]}}const xB={point:!1,linear:!1,cubic:!0,sinc:!0},Lv={IIR:16,FIR:71},bB={IIR:vB,FIR:yB};function _B(t,e,i,s={}){let r=(i-e)/e+1,n=new Float64Array(t.length*r);s.method=s.method||"cubic";let o=new fB(t.length,n.length,{method:s.method,tension:s.tension||0,sincFilterSize:s.sincFilterSize||6,sincWindow:s.sincWindow||void 0});if(s.LPF===void 0&&(s.LPF=xB[s.method]),s.LPF){s.LPFType=s.LPFType||"IIR";const a=bB[s.LPFType];if(i>e){let l=new a(s.LPFOrder||Lv[s.LPFType],i,e/2);wB(t,n,o,l)}else{let l=new a(s.LPFOrder||Lv[s.LPFType],e,i/2);SB(t,n,o,l)}}else v2(t,n,o);return n}function v2(t,e,i){for(let s=0,r=e.length;s<r;s++)e[s]=i.interpolate(s,t)}function wB(t,e,i,s){for(let r=0,n=e.length;r<n;r++)e[r]=s.filter(i.interpolate(r,t));s.reset();for(let r=e.length-1;r>=0;r--)e[r]=s.filter(e[r])}function SB(t,e,i,s){for(let r=0,n=t.length;r<n;r++)t[r]=s.filter(t[r]);s.reset();for(let r=t.length-1;r>=0;r--)t[r]=s.filter(t[r]);v2(t,e,i)}function CB(t){const e=new Float32Array(t.map(s=>s.length).reduce((s,r)=>s+r));let i=0;for(const s of t)e.set(s,i),i+=s.length;return e}function TB(t){const e=[];for(let i=0;i<t.length;i+=1)for(let s=0;s<t[i].length;s+=1)e[s]==null&&(e[s]=[]),e[s].push(t[i][s]);return e.map(CB)}function kB(t){if(t.format==="f32-planar"){const e=[];for(let i=0;i<t.numberOfChannels;i+=1){const s=t.allocationSize({planeIndex:i}),r=new ArrayBuffer(s);t.copyTo(r,{planeIndex:i}),e.push(new Float32Array(r))}return e}else if(t.format==="f32"){const e=new ArrayBuffer(t.allocationSize({planeIndex:0}));return t.copyTo(e,{planeIndex:0}),IB(new Float32Array(e),t.numberOfChannels)}else if(t.format==="s16"){const e=new ArrayBuffer(t.allocationSize({planeIndex:0}));return t.copyTo(e,{planeIndex:0}),AB(new Int16Array(e),t.numberOfChannels)}throw Error("Unsupported audio data format")}function AB(t,e){const i=t.length/e,s=Array.from({length:e},()=>new Float32Array(i));for(let r=0;r<i;r++)for(let n=0;n<e;n++){const o=t[r*e+n];s[n][r]=o/32768}return s}function IB(t,e){const i=t.length/e,s=Array.from({length:e},()=>new Float32Array(i));for(let r=0;r<i;r++)for(let n=0;n<e;n++)s[n][r]=t[r*e+n];return s}function x2(t){return Array(t.numberOfChannels).fill(0).map((e,i)=>t.getChannelData(i))}async function PB(t,e,i){const s=t.length,r=Array(i.chanCount).fill(0).map(()=>new Float32Array(0));if(s===0)return r;const n=Math.max(...t.map(u=>u.length));if(n===0)return r;if(globalThis.OfflineAudioContext==null)return t.map(u=>new Float32Array(_B(u,e,i.rate,{method:"sinc",LPF:!1})));const o=new globalThis.OfflineAudioContext(i.chanCount,n*i.rate/e,i.rate),a=o.createBufferSource(),l=o.createBuffer(s,n,e);return t.forEach((u,c)=>l.copyToChannel(new Float32Array(u),c)),a.buffer=l,a.connect(o.destination),a.start(),x2(await o.startRendering())}function Nv(t,e,i){const s=i-e,r=new Float32Array(s);let n=0;for(;n<s;)r[n]=t[(e+n)%t.length],n+=1;return r}function Hv(t,e){const i=Math.floor(t.length/e),s=new Float32Array(i);for(let r=0;r<i;r++){const n=r*e,o=Math.floor(n),a=n-o;o+1<t.length?s[r]=t[o]*(1-a)+t[o+1]*a:s[r]=t[o]}return s}const EB=()=>{let t,e=16.6;self.onmessage=i=>{i.data.event==="start"&&(self.clearInterval(t),t=self.setInterval(()=>{self.postMessage({})},e)),i.data.event==="stop"&&self.clearInterval(t)}},MB=()=>{const t=new Blob([`(${EB.toString()})()`]),e=URL.createObjectURL(t);return new Worker(e)},Rr=new Map;let fg=1,gl=null;globalThis.Worker!=null&&(gl=MB(),gl.onmessage=()=>{fg+=1;for(const[t,e]of Rr)if(fg%t===0)for(const i of e)i()});const FB=(t,e)=>{const i=Math.round(e/16.6),s=Rr.get(i)??new Set;return s.add(t),Rr.set(i,s),Rr.size===1&&s.size===1&&gl?.postMessage({event:"start"}),()=>{s.delete(t),s.size===0&&Rr.delete(i),Rr.size===0&&(fg=0,gl?.postMessage({event:"stop"}))}};function b2(t){return new Promise(e=>{const i=FB(()=>{i(),e()},t)})}async function RB(t,e){const i={type:e,data:t},s=new ImageDecoder(i);await Promise.all([s.completed,s.tracks.ready]);const r=s.tracks.selectedTrack?.frameCount??1,n=[];for(let o=0;o<r;o+=1)n.push((await s.decode({frameIndex:o})).image);return n}let _2=class{all=new Map;on(e,i){const s=this.all.get(e);return s?s.push(i):this.all.set(e,[i]),()=>this.off(e,i)}once(e,i){const s=this.on(e,r=>{s(),i(r)});return s}off(e,i){const s=this.all.get(e);s&&(i?s.splice(s.indexOf(i)>>>0,1):this.all.set(e,[]))}emit(e,i){let s=this.all.get(e);s&&s.slice().forEach(r=>{r(i)}),s=this.all.get("*"),s&&s.slice().forEach(r=>{r(e,i)})}};class zB extends _2{id="";name="";display={from:0,to:0};duration=0;playbackRate=1;trim={from:0,to:0};constructor(){super()}_left=0;get left(){return this._left}set left(e){const i=this._left!==e;this._left=e,i&&this.emit("propsChange",{left:e})}_top=0;get top(){return this._top}set top(e){const i=this._top!==e;this._top=e,i&&this.emit("propsChange",{top:e})}_width=0;get width(){return this._width}set width(e){const i=this._width!==e;this._width=e,i&&this.emit("propsChange",{width:e})}_height=0;get height(){return this._height}set height(e){const i=this._height!==e;this._height=e,i&&this.emit("propsChange",{height:e})}_angle=0;get angle(){return this._angle}set angle(e){const i=this._angle!==e;this._angle=e,i&&this.emit("propsChange",{angle:e})}get center(){return{x:this.left+this.width/2,y:this.top+this.height/2}}_zIndex=0;get zIndex(){return this._zIndex}set zIndex(e){const i=this._zIndex!==e;this._zIndex=e,i&&this.emit("propsChange",{zIndex:e})}_opacity=1;get opacity(){return this._opacity}set opacity(e){const i=this._opacity!==e;this._opacity=e,i&&this.emit("propsChange",{opacity:e})}_volume=1;get volume(){return this._volume}set volume(e){const i=this._volume!==e;this._volume=e,i&&this.emit("propsChange",{volume:e})}flip=null;effects=[];_style={};get style(){return this._style}set style(e){this._style=e}animatKeyFrame=null;animatOpts=null;ready=Promise.resolve();_render(e){const{center:i}=this;e.setTransform(this.flip==="horizontal"?-1:1,0,0,this.flip==="vertical"?-1:1,i.x,i.y);const s=this.angle*Math.PI/180;e.rotate((this.flip==null?1:-1)*s),e.globalAlpha=this.opacity}setAnimation(e,i){this.animatKeyFrame=Object.entries(e).map(([s,r])=>{const n={from:0,to:100}[s]??Number(s.slice(0,-1));if(isNaN(n)||n>100||n<0)throw Error("keyFrame must between 0~100");return[n/100,r]}),this.animatOpts=Object.assign({},this.animatOpts,{duration:i.duration,delay:i.delay??0,iterCount:i.iterCount??1/0})}animate(e){if(this.animatKeyFrame==null||this.animatOpts==null||e<this.animatOpts.delay)return;const i=UB(e,this.animatKeyFrame,this.animatOpts);for(const s in i)switch(s){case"opacity":this.opacity=i[s];break;case"x":this.left=i[s];break;case"y":this.top=i[s];break;case"w":this.width=i[s];break;case"h":this.height=i[s];break;case"angle":this.angle=i[s];break}}copyStateTo(e){e.animatKeyFrame=this.animatKeyFrame,e.animatOpts=this.animatOpts,e.zIndex=this.zIndex,e.opacity=this.opacity,e.volume=this.volume,e.flip=this.flip,e.left=this.left,e.top=this.top,e.width=this.width,e.height=this.height,e.angle=this.angle,e.display={...this.display},e.duration=this.duration,e.playbackRate=this.playbackRate,e.trim={...this.trim},e.style=JSON.parse(JSON.stringify(this.style||{})),"src"in this&&"src"in e&&(e.src=this.src)}update(e){Object.assign(this,e),this.emit("propsChange",e)}destroy(){this.all.clear()}}function UB(t,e,i){const s=t-i.delay,r=s%i.duration,n=s/i.duration>=i.iterCount||s===i.duration?1:r/i.duration,o=e.findIndex(d=>d[0]>=n);if(o===-1)return{};const a=e[o-1],l=e[o],u=l[1];if(a==null)return u;const c=a[1],h={},f=(n-a[0])/(l[0]-a[0]);for(const d in u){if(!Object.hasOwn(u,d)||typeof d!="string")continue;const p=d;c[p]!=null&&(h[p]=(u[p]-c[p])*f+c[p])}return h}class qs extends zB{lastVf=null;destroyed=!1;src="";transition;constructor(){super()}async getFrame(e){const i=e*this.playbackRate,{video:s,audio:r,state:n}=await this.tick(i);let o=r??[];r!=null&&this.playbackRate!==1&&(o=r.map(l=>Hv(l,this.playbackRate)));let a=null;return s!=null?(this.lastVf?.close(),s instanceof VideoFrame?(a=await createImageBitmap(s),s.close()):a=s,this.lastVf=a):this.lastVf!=null&&(a=this.lastVf),{video:a,audio:o,done:n==="done"}}async offscreenRender(e,i){const s=i*this.playbackRate;this.animate(s),super._render(e);const{width:r,height:n}=this,{video:o,audio:a,state:l}=await this.tick(s);let u=a??[];if(a!=null&&this.playbackRate!==1&&(u=a.map(h=>Hv(h,this.playbackRate))),l==="done")return{audio:u,done:!0};const c=o??this.lastVf;if(c!=null){const h=this.style.borderRadius||0,f=this.style.dropShadow;if(e.save(),f&&(f.blur>0||f.distance>0)){const p=f.distance??0,m=f.angle??0;e.shadowColor=f.color||"#000000",e.shadowBlur=f.blur||0,e.shadowOffsetX=Math.cos(m)*p,e.shadowOffsetY=Math.sin(m)*p}if(h>0){const p=Math.min(h,r/2,n/2);e.beginPath(),e.roundRect(-r/2,-n/2,r,n,p),e.clip()}e.drawImage(c,-r/2,-n/2,r,n),e.restore();const d=this.style.stroke;if(d&&d.width>0){if(e.save(),e.strokeStyle=d.color,e.lineWidth=d.width,h>0){const p=Math.min(h,r/2,n/2);e.beginPath(),e.roundRect(-r/2,-n/2,r,n,p),e.stroke()}else e.strokeRect(-r/2,-n/2,r,n);e.restore()}}return o!=null&&(this.lastVf?.close(),o instanceof ImageBitmap&&(this.lastVf=o)),{audio:u,done:!1}}set(e,i=30){if(e.display&&(e.display.from!==void 0&&(this.display.from=e.display.from<1e6?e.display.from/i*1e6:e.display.from),e.display.to!==void 0&&(this.display.to=e.display.to<1e6?e.display.to/i*1e6:e.display.to)),e.x!==void 0&&(this.left=e.x),e.y!==void 0&&(this.top=e.y),e.width!==void 0&&(this.width=e.width),e.height!==void 0&&(this.height=e.height),e.duration!==void 0){const s=e.duration<1e6?e.duration/i*1e6:e.duration;this.duration=s,this.display.from!==void 0&&(this.display.to=this.display.from+s)}return this}toJSON(e=!1){const i=this.animatKeyFrame&&this.animatOpts?{keyFrames:this.animatKeyFrame.reduce((s,[r,n])=>{const o=r===0?"from":r===1?"to":`${Math.round(r*100)}%`;return s[o]=n,s},{}),opts:this.animatOpts}:void 0;return{type:this.constructor.name,id:this.id,name:this.name,src:this.src,display:{from:this.display.from,to:this.display.to},playbackRate:this.playbackRate,duration:this.duration,left:this.left,top:this.top,width:this.width,height:this.height,angle:this.angle,zIndex:this.zIndex,opacity:this.opacity,flip:this.flip,style:this.style,trim:{from:this.trim.from,to:this.trim.to},...i&&{animation:i},...e&&{main:!0}}}getVisibleHandles(){return["tl","tr","bl","br","ml","mr","mt","mb","rot"]}async scaleToFit(e,i){await this.ready;const{width:s,height:r}=this.meta;if(s===0||r===0)return;const n=Math.min(e/s,i/r);this.width=s*n,this.height=r*n}async scaleToFill(e,i){await this.ready;const{width:s,height:r}=this.meta;if(s===0||r===0)return;const n=Math.max(e/s,i/r);this.width=s*n,this.height=r*n}centerInScene(e,i){this.left=(e-this.width)/2,this.top=(i-this.height)/2}destroy(){this.destroyed||(this.destroyed=!0,De.info("BaseClip destroy"),super.destroy(),this.lastVf?.close(),this.lastVf=null)}}const si={get codec(){return"mp4a.40.2"},get sampleRate(){return 48e3},get channelCount(){return 2}};class Ir{static async getCacheKey(e){const s=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-1",s);return Array.from(new Uint8Array(r)).map(o=>o.toString(16).padStart(2,"0")).join("")}static getPath(e){return`assets/${e}`}static async get(e){const i=await this.getCacheKey(e),s=this.getPath(i),r=vr(s);return await r.exists()?r:null}static async put(e,i){const s=await this.getCacheKey(e),r=this.getPath(s),n=vr(r);return await tc(n,i),n}}class sn{resources=new Map;loadingPromises=new Map;async preload(e){const s=[...new Set(e)].filter(r=>r&&!r.startsWith("data:")&&!r.startsWith("blob:")).map(r=>this.loadResource(r));await Promise.allSettled(s)}static async getReadableStream(e){const i=await Ir.get(e);if(i){const a=await i.getOriginFile();if(a)return a.stream()}const s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch: ${s.status} ${s.statusText}`);const r=s.body;if(!r)throw new Error("Response body is null");if(e.startsWith("data:")||e.startsWith("blob:"))return r;const[n,o]=r.tee();return Ir.put(e,o).catch(a=>{console.error(`ResourceManager: Failed to cache ${e}`,a)}),n}static async getImageBitmap(e){const i=await Ir.get(e);if(i){const l=await i.getOriginFile();if(l)return await createImageBitmap(l)}if(e.startsWith("data:")||e.startsWith("blob:")){const u=await(await fetch(e)).blob();return await createImageBitmap(u)}const s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch: ${s.status} ${s.statusText}`);const r=s.body;if(!r)throw new Error("Response body is null");const[n,o]=r.tee(),a=(async()=>{const u=await new Response(n).blob();return await createImageBitmap(u)})();return Ir.put(e,o).catch(l=>{console.error(`ResourceManager: Failed to cache ${e}`,l)}),await a}async loadResource(e){const i=this.loadingPromises.get(e);if(i)return i;if(this.resources.has(e)){const r=this.resources.get(e);if(r.status==="completed")return r}const s=(async()=>{const r={url:e,status:"loading"};this.resources.set(e,r);try{const n=await Ir.get(e);if(n)return r.status="completed",r.localFile=n,r;const o=await fetch(e);if(!o.ok)throw new Error(`Fetch failed: ${o.status}`);const a=o.body;if(!a)throw new Error("No body");const l=await Ir.put(e,a);return r.status="completed",r.localFile=l,r}catch(n){return r.status="failed",r.error=n instanceof Error?n:new Error(String(n)),r}finally{this.loadingPromises.delete(e)}})();return this.loadingPromises.set(e,s),s}async resolve(e){if(!e||e.startsWith("data:")||e.startsWith("blob:"))return e;const i=await this.loadResource(e);return i.status==="completed"&&i.localFile?i.localFile:e}getStatus(e){return this.resources.get(e)}clear(){this.resources.clear(),this.loadingPromises.clear()}}class gi extends qs{type="Audio";static ctx=null;ready;_meta={duration:0,width:0,height:0};get meta(){return{...this._meta,sampleRate:si.sampleRate,chanCount:2}}chan0Buf=new Float32Array;chan1Buf=new Float32Array;getPCMData(){return[this.chan0Buf,this.chan1Buf]}opts;loop=!1;static async fromUrl(e,i={}){const s=await sn.getReadableStream(e),r=new gi(s,i,e);return await r.ready,r}static async fromObject(e){if(e.type!=="Audio")throw new Error(`Expected Audio, got ${e.type}`);if(!e.src||e.src.trim()==="")throw new Error("Audio requires a valid source URL");const i={};e.loop!==void 0&&(i.loop=e.loop),e.volume!==void 0&&(i.volume=e.volume);const s=await gi.fromUrl(e.src,i);return s.left=e.left,s.top=e.top,s.width=e.width,s.height=e.height,s.angle=e.angle,s.display.from=e.display.from,s.display.to=e.display.to,s.duration=e.duration,s.playbackRate=e.playbackRate,s.zIndex=e.zIndex,s.opacity=e.opacity,s.flip=e.flip,e.animation&&s.setAnimation(e.animation.keyFrames,e.animation.opts),s}constructor(e,i={},s){super(),this.src=s!==void 0?s:"",this.opts={loop:!1,volume:1,...i},this.loop=this.opts.loop??!1,this.volume=this.opts.volume??1,this.ready=this.init(e).then(r=>{const n={width:0,height:0,duration:i.loop?1/0:this._meta.duration};return this.width=this.width===0?n.width:this.width,this.height=this.height===0?n.height:this.height,this.duration=this.duration===0?n.duration:this.duration,this.display.to=this.display.from+this.duration,n})}async init(e){gi.ctx==null&&(gi.ctx=new AudioContext({sampleRate:si.sampleRate}));const i=performance.now(),s=e instanceof ReadableStream?await OB(e,gi.ctx):e;De.info("Audio clip decoded complete:",performance.now()-i),this._meta.duration=s[0].length/si.sampleRate*1e6,this.chan0Buf=s[0],this.chan1Buf=s[1]??this.chan0Buf,De.info("Audio clip convert to AudioData, time:",performance.now()-i)}tickInterceptor=async(e,i)=>i;timestamp=0;frameOffset=0;async tick(e){if(!this.opts.loop&&e>=this._meta.duration)return await this.tickInterceptor(e,{audio:[],state:"done"});const i=e-this.timestamp;if(e<this.timestamp||i>3e6)return this.timestamp=e,this.frameOffset=Math.ceil(this.timestamp/1e6*si.sampleRate),await this.tickInterceptor(e,{audio:[new Float32Array(0),new Float32Array(0)],state:"success"});this.timestamp=e;const s=Math.ceil(i/1e6*si.sampleRate),r=this.frameOffset+s,n=this.opts.loop?[Nv(this.chan0Buf,this.frameOffset,r),Nv(this.chan1Buf,this.frameOffset,r)]:[this.chan0Buf.slice(this.frameOffset,r),this.chan1Buf.slice(this.frameOffset,r)];if(this.volume!==1)for(const o of n)for(let a=0;a<o.length;a++)o[a]*=this.volume;return this.frameOffset=r,await this.tickInterceptor(e,{audio:n,state:"success"})}async split(e){await this.ready;const i=Math.ceil(e/1e6*si.sampleRate),s=new gi(this.getPCMData().map(n=>n.slice(0,i)),this.opts,this.src),r=new gi(this.getPCMData().map(n=>n.slice(i)),this.opts,this.src);return[s,r]}async clone(){await this.ready;const e=new gi(this.getPCMData(),this.opts,this.src);return await e.ready,this.copyStateTo(e),e}destroy(){this.chan0Buf=new Float32Array(0),this.chan1Buf=new Float32Array(0),De.info("---- audioclip destroy ----"),super.destroy()}toJSON(e=!1){return{...super.toJSON(e),type:"Audio",loop:this.loop,id:this.id,volume:this.volume}}static concatAudio=BB;async createPlaybackElement(){if(await this.ready,!this.src||this.src.trim()==="")throw new Error("Audio requires a source URL for playback");const e=this.src.startsWith("blob:")?this.src:void 0,i=document.createElement("audio");return i.crossOrigin="anonymous",i.autoplay=!1,i.preload="auto",i.loop=this.opts.loop||!1,i.src=this.src,await new Promise((s,r)=>{const n=()=>{i.removeEventListener("loadeddata",n),i.removeEventListener("error",o),i.pause(),i.currentTime=0,s()},o=()=>{i.removeEventListener("loadeddata",n),i.removeEventListener("error",o),r(new Error("Failed to load audio"))};i.addEventListener("loadeddata",n,{once:!0}),i.addEventListener("error",o,{once:!0}),i.load()}),{element:i,objectUrl:e}}async play(e,i){const s=e;if(Math.abs(s.currentTime-i)>.1&&(s.currentTime=i),s.paused)try{await s.play()}catch{try{await s.play()}catch(n){console.warn("Failed to play audio:",n)}}}pause(e){e.pause()}async seek(e,i){const s=e;return s.pause(),s.currentTime=i,new Promise(r=>{if(Math.abs(s.currentTime-i)<.01){r();return}const n=()=>{s.removeEventListener("seeked",n),r()};s.addEventListener("seeked",n,{once:!0}),setTimeout(()=>{s.removeEventListener("seeked",n),r()},500)})}syncPlayback(e,i,s){const r=e,n=this.meta.duration/1e6,o=s>=0&&s<n;r.volume=this.volume,i&&o?r.paused&&this.play(r,s).catch(console.warn):(r.paused||r.pause(),o&&Math.abs(r.currentTime-s)>.1&&(r.currentTime=s))}cleanupPlayback(e,i){const s=e;s.pause(),s.removeAttribute("src"),s.load(),i&&i.startsWith("blob:")&&URL.revokeObjectURL(i)}}async function BB(t,e){const i=[];for(const s of t)await s.ready,i.push(s.getPCMData());return new gi(TB(i),e)}async function OB(t,e){const i=await new Response(t).arrayBuffer();return x2(await e.decodeAudioData(i))}const DB="modulepreload",LB=function(t,e){return new URL(t,e).href},Gv={},rn=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){let u=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");r=u(i.map(c=>{if(c=LB(c,s),c in Gv)return;Gv[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(s)for(let p=o.length-1;p>=0;p--){const m=o[p];if(m.href===c&&(!h||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":DB,h||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),h)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};var Ge=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(Ge||{});const pg=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},ra=(t,e)=>pg(t).priority??e,di={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(pg).forEach(e=>{e.type.forEach(i=>this._removeHandlers[i]?.(e))}),this},add(...t){return t.map(pg).forEach(e=>{e.type.forEach(i=>{const s=this._addHandlers,r=this._queue;s[i]?s[i]?.(e):(r[i]=r[i]||[],r[i]?.push(e))})}),this},handle(t,e,i){const s=this._addHandlers,r=this._removeHandlers;if(s[t]||r[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,r[t]=i;const n=this._queue;return n[t]&&(n[t]?.forEach(o=>e(o)),delete n[t]),this},handleByMap(t,e){return this.handle(t,i=>{i.name&&(e[i.name]=i.ref)},i=>{i.name&&delete e[i.name]})},handleByNamedList(t,e,i=-1){return this.handle(t,s=>{e.findIndex(n=>n.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((n,o)=>ra(o.value,i)-ra(n.value,i)))},s=>{const r=e.findIndex(n=>n.name===s.name);r!==-1&&e.splice(r,1)})},handleByList(t,e,i=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((r,n)=>ra(n,i)-ra(r,i)))},s=>{const r=e.indexOf(s.ref);r!==-1&&e.splice(r,1)})},mixin(t,...e){for(const i of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(i))}},NB={extension:{type:Ge.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await rn(()=>import("./BGXPt29z.js"),__vite__mapDeps([0,1,2]),import.meta.url)}},HB={extension:{type:Ge.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await rn(()=>import("./NyUCyhAm.js"),__vite__mapDeps([1,2]),import.meta.url)}};class ft{constructor(e,i,s){this._x=i||0,this._y=s||0,this._observer=e}clone(e){return new ft(e??this._observer,this._x,this._y)}set(e=0,i=e){return(this._x!==e||this._y!==i)&&(this._x=e,this._y=i,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}function O0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qp={exports:{}},Wv;function GB(){return Wv||(Wv=1,(function(t){var e=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function n(l,u,c,h,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,h||l,f),p=i?i+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new s:delete l._events[u]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(i?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=i?i+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,d=h.length,p=new Array(d);f<d;f++)p[f]=h[f].fn;return p},a.prototype.listenerCount=function(u){var c=i?i+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,f,d,p){var m=i?i+u:u;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,b,v;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,h),!0;case 4:return g.fn.call(g.context,c,h,f),!0;case 5:return g.fn.call(g.context,c,h,f,d),!0;case 6:return g.fn.call(g.context,c,h,f,d,p),!0}for(v=1,b=new Array(y-1);v<y;v++)b[v-1]=arguments[v];g.fn.apply(g.context,b)}else{var x=g.length,_;for(v=0;v<x;v++)switch(g[v].once&&this.removeListener(u,g[v].fn,void 0,!0),y){case 1:g[v].fn.call(g[v].context);break;case 2:g[v].fn.call(g[v].context,c);break;case 3:g[v].fn.call(g[v].context,c,h);break;case 4:g[v].fn.call(g[v].context,c,h,f);break;default:if(!b)for(_=1,b=new Array(y-1);_<y;_++)b[_-1]=arguments[_];g[v].fn.apply(g[v].context,b)}}return!0},a.prototype.on=function(u,c,h){return n(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return n(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,f){var d=i?i+u:u;if(!this._events[d])return this;if(!c)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!h||p.context===h)&&o(this,d);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==c||f&&!p[m].once||h&&p[m].context!==h)&&g.push(p[m]);g.length?this._events[d]=g.length===1?g[0]:g:o(this,d)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=i?i+u:u,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a})(qp)),qp.exports}var WB=GB();const Ti=O0(WB),VB=Math.PI*2,$B=180/Math.PI,qB=Math.PI/180;class Ae{constructor(e=0,i=0){this.x=0,this.y=0,this.x=e,this.y=i}clone(){return new Ae(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,i=e){return this.x=e,this.y=i,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Yp.x=0,Yp.y=0,Yp}}const Yp=new Ae;class Ie{constructor(e=1,i=0,s=0,r=1,n=0,o=0){this.array=null,this.a=e,this.b=i,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,i,s,r,n,o){return this.a=e,this.b=i,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(e,i){this.array||(this.array=new Float32Array(9));const s=i||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,i){i=i||new Ae;const s=e.x,r=e.y;return i.x=this.a*s+this.c*r+this.tx,i.y=this.b*s+this.d*r+this.ty,i}applyInverse(e,i){i=i||new Ae;const s=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,l=this.ty,u=1/(s*o+n*-r),c=e.x,h=e.y;return i.x=o*u*c+-n*u*h+(l*n-a*o)*u,i.y=s*u*h+-r*u*c+(-l*s+a*r)*u,i}translate(e,i){return this.tx+=e,this.ty+=i,this}scale(e,i){return this.a*=e,this.d*=i,this.c*=e,this.b*=i,this.tx*=e,this.ty*=i,this}rotate(e){const i=Math.cos(e),s=Math.sin(e),r=this.a,n=this.c,o=this.tx;return this.a=r*i-this.b*s,this.b=r*s+this.b*i,this.c=n*i-this.d*s,this.d=n*s+this.d*i,this.tx=o*i-this.ty*s,this.ty=o*s+this.ty*i,this}append(e){const i=this.a,s=this.b,r=this.c,n=this.d;return this.a=e.a*i+e.b*r,this.b=e.a*s+e.b*n,this.c=e.c*i+e.d*r,this.d=e.c*s+e.d*n,this.tx=e.tx*i+e.ty*r+this.tx,this.ty=e.tx*s+e.ty*n+this.ty,this}appendFrom(e,i){const s=e.a,r=e.b,n=e.c,o=e.d,a=e.tx,l=e.ty,u=i.a,c=i.b,h=i.c,f=i.d;return this.a=s*u+r*h,this.b=s*c+r*f,this.c=n*u+o*h,this.d=n*c+o*f,this.tx=a*u+l*h+i.tx,this.ty=a*c+l*f+i.ty,this}setTransform(e,i,s,r,n,o,a,l,u){return this.a=Math.cos(a+u)*n,this.b=Math.sin(a+u)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(s*this.a+r*this.c),this.ty=i-(s*this.b+r*this.d),this}prepend(e){const i=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,r=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=i*e.a+this.ty*e.c+e.tx,this.ty=i*e.b+this.ty*e.d+e.ty,this}decompose(e){const i=this.a,s=this.b,r=this.c,n=this.d,o=e.pivot,a=-Math.atan2(-r,n),l=Math.atan2(s,i),u=Math.abs(a+l);return u<1e-5||Math.abs(VB-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(i*i+s*s),e.scale.y=Math.sqrt(r*r+n*n),e.position.x=this.tx+(o.x*i+o.y*r),e.position.y=this.ty+(o.x*s+o.y*n),e}invert(){const e=this.a,i=this.b,s=this.c,r=this.d,n=this.tx,o=e*r-i*s;return this.a=r/o,this.b=-i/o,this.c=-s/o,this.d=e/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(e*this.ty-i*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Ie;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return XB.identity()}static get shared(){return YB.identity()}}const YB=new Ie,XB=new Ie,Qs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],er=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],tr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ir=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],mg=[],w2=[],na=Math.sign;function jB(){for(let t=0;t<16;t++){const e=[];mg.push(e);for(let i=0;i<16;i++){const s=na(Qs[t]*Qs[i]+tr[t]*er[i]),r=na(er[t]*Qs[i]+ir[t]*er[i]),n=na(Qs[t]*tr[i]+tr[t]*ir[i]),o=na(er[t]*tr[i]+ir[t]*ir[i]);for(let a=0;a<16;a++)if(Qs[a]===s&&er[a]===r&&tr[a]===n&&ir[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Ie;e.set(Qs[t],er[t],tr[t],ir[t],0,0),w2.push(e)}}jB();const We={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>Qs[t],uY:t=>er[t],vX:t=>tr[t],vY:t=>ir[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>mg[t][e],sub:(t,e)=>mg[t][We.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?We.S:We.N:Math.abs(e)*2<=Math.abs(t)?t>0?We.E:We.W:e>0?t>0?We.SE:We.SW:t>0?We.NE:We.NW,matrixAppendRotationInv:(t,e,i=0,s=0)=>{const r=w2[We.inv(e)];r.tx=i,r.ty=s,t.append(r)},transformRectCoords:(t,e,i,s)=>{const{x:r,y:n,width:o,height:a}=t,{x:l,y:u,width:c,height:h}=e;return i===We.E?(s.set(r+l,n+u,o,a),s):i===We.S?s.set(c-n-a+l,r+u,a,o):i===We.W?s.set(c-r-o+l,h-n-a+u,o,a):i===We.N?s.set(n+l,h-r-o+u,a,o):s.set(r+l,n+u,o,a)}},oa=[new Ae,new Ae,new Ae,new Ae];class Se{constructor(e=0,i=0,s=0,r=0){this.type="rectangle",this.x=Number(e),this.y=Number(i),this.width=Number(s),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Se(0,0,0,0)}clone(){return new Se(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,i){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height}strokeContains(e,i,s,r=.5){const{width:n,height:o}=this;if(n<=0||o<=0)return!1;const a=this.x,l=this.y,u=s*(1-r),c=s-u,h=a-u,f=a+n+u,d=l-u,p=l+o+u,m=a+c,g=a+n-c,y=l+c,b=l+o-c;return e>=h&&e<=f&&i>=d&&i<=p&&!(e>m&&e<g&&i>y&&i<b)}intersects(e,i){if(!i){const A=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=A)return!1;const k=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>k}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=oa[0].set(e.left,e.top),l=oa[1].set(e.left,e.bottom),u=oa[2].set(e.right,e.top),c=oa[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(i.a*i.d-i.b*i.c);if(h===0||(i.apply(a,a),i.apply(l,l),i.apply(u,u),i.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=s||Math.min(a.x,l.x,u.x,c.x)>=r||Math.max(a.y,l.y,u.y,c.y)<=n||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const f=h*(l.y-a.y),d=h*(a.x-l.x),p=f*s+d*n,m=f*r+d*n,g=f*s+d*o,y=f*r+d*o;if(Math.max(p,m,g,y)<=f*a.x+d*a.y||Math.min(p,m,g,y)>=f*c.x+d*c.y)return!1;const b=h*(a.y-u.y),v=h*(u.x-a.x),x=b*s+v*n,_=b*r+v*n,S=b*s+v*o,T=b*r+v*o;return!(Math.max(x,_,S,T)<=b*a.x+v*a.y||Math.min(x,_,S,T)>=b*c.x+v*c.y)}pad(e=0,i=e){return this.x-=e,this.y-=i,this.width+=e*2,this.height+=i*2,this}fit(e){const i=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=i,this.width=Math.max(s-i,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(e=1,i=.001){const s=Math.ceil((this.x+this.width-i)*e)/e,r=Math.ceil((this.y+this.height-i)*e)/e;return this.x=Math.floor((this.x+i)*e)/e,this.y=Math.floor((this.y+i)*e)/e,this.width=s-this.x,this.height=r-this.y,this}scale(e,i=e){return this.x*=e,this.y*=i,this.width*=e,this.height*=i,this}enlarge(e){const i=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=i,this.width=s-i,this.y=r,this.height=n-r,this}getBounds(e){return e||(e=new Se),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const i=e.x,s=e.y,r=e.x+e.width,n=e.y+e.height;return i>=this.x&&i<this.x+this.width&&s>=this.y&&s<this.y+this.height&&r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(e,i,s,r){return this.x=e,this.y=i,this.width=s,this.height=r,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Xp={default:-1};function tt(t="default"){return Xp[t]===void 0&&(Xp[t]=-1),++Xp[t]}const Vv=new Set,Ne="8.0.0",KB="8.3.4",Gr={quiet:!1,noColor:!1},ve=(t,e,i=3)=>{if(Gr.quiet||Vv.has(e))return;let s=new Error().stack;const r=`${e}
Deprecated since v${t}`,n=typeof console.groupCollapsed=="function"&&!Gr.noColor;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",r):(s=s.split(`
`).splice(i).join(`
`),n?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r),console.warn(s))),Vv.add(e)};Object.defineProperties(ve,{quiet:{get:()=>Gr.quiet,set:t=>{Gr.quiet=t},enumerable:!0,configurable:!1},noColor:{get:()=>Gr.noColor,set:t=>{Gr.noColor=t},enumerable:!0,configurable:!1}});const S2=()=>{};function yl(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function $v(t){return!(t&t-1)&&!!t}function C2(t){const e={};for(const i in t)t[i]!==void 0&&(e[i]=t[i]);return e}const qv=Object.create(null);function ZB(t){const e=qv[t];return e===void 0&&(qv[t]=tt("resource")),e}const T2=class k2 extends Ti{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...k2.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){ve(Ne,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=ZB(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};T2.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let vl=T2;const A2=class I2 extends Ti{constructor(e={}){super(),this.options=e,this.uid=tt("textureSource"),this._resourceType="textureSource",this._resourceId=tt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...I2.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new vl(C2(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=tt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,i,s){s||(s=this._resolution),e||(e=this.width),i||(i=this.height);const r=Math.round(e*s),n=Math.round(i*s);return this.width=r/s,this.height=n/s,this._resolution=s,this.pixelWidth===r&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this._resourceId=tt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=$v(this.pixelWidth)&&$v(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};A2.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let fi=A2;class D0 extends fi{constructor(e){const i=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(i instanceof Float32Array?s="rgba32float":i instanceof Int32Array||i instanceof Uint32Array?s="rgba32uint":i instanceof Int16Array||i instanceof Uint16Array?s="rgba16uint":(i instanceof Int8Array,s="bgra8unorm")),super({...e,resource:i,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}D0.extension=Ge.TextureSource;const Yv=new Ie;class JB{constructor(e,i){this.mapCoord=new Ie,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof i>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=i,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,i){i===void 0&&(i=e);const s=this.mapCoord;for(let r=0;r<e.length;r+=2){const n=e[r],o=e[r+1];i[r]=n*s.a+o*s.c+s.tx,i[r+1]=n*s.b+o*s.d+s.ty}return i}update(){const e=this._texture;this._updateID++;const i=e.uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const s=e.orig,r=e.trim;r&&(Yv.set(s.width/r.width,0,0,s.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Yv));const n=e.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,l=this.clampOffset/n._resolution;return o[0]=(e.frame.x+a+l)/n.width,o[1]=(e.frame.y+a+l)/n.height,o[2]=(e.frame.x+e.frame.width-a+l)/n.width,o[3]=(e.frame.y+e.frame.height-a+l)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=e.frame.width===n.width&&e.frame.height===n.height&&e.rotate===0,!0}}class xe extends Ti{constructor({source:e,label:i,frame:s,orig:r,trim:n,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:u}={}){if(super(),this.uid=tt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Se,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=i,this.source=e?.source??new fi,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:c,height:h}=this._source;this.frame.width=c,this.frame.height=h}this.orig=r||this.frame,this.trim=n,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=u||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new JB(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:i}=this,{width:s,height:r}=this._source,n=i.x/s,o=i.y/r,a=i.width/s,l=i.height/r;let u=this.rotate;if(u){const c=a/2,h=l/2,f=n+c,d=o+h;u=We.add(u,We.NW),e.x0=f+c*We.uX(u),e.y0=d+h*We.uY(u),u=We.add(u,2),e.x1=f+c*We.uX(u),e.y1=d+h*We.uY(u),u=We.add(u,2),e.x2=f+c*We.uX(u),e.y2=d+h*We.uY(u),u=We.add(u,2),e.x3=f+c*We.uX(u),e.y3=d+h*We.uY(u)}else e.x0=n,e.y0=o,e.x1=n+a,e.y1=o,e.x2=n+a,e.y2=o+l,e.x3=n,e.y3=o+l}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ve(Ne,"Texture.baseTexture is now Texture.source"),this._source}}xe.EMPTY=new xe({label:"EMPTY",source:new fi({label:"EMPTY"})});xe.EMPTY.destroy=S2;xe.WHITE=new xe({source:new D0({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});xe.WHITE.destroy=S2;function QB(t,e,i){const{width:s,height:r}=i.orig,n=i.trim;if(n){const o=n.width,a=n.height;t.minX=n.x-e._x*s,t.maxX=t.minX+o,t.minY=n.y-e._y*r,t.maxY=t.minY+a}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*r,t.maxY=t.minY+r}const Xv=new Ie;class wi{constructor(e=1/0,i=1/0,s=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xv,this.minX=e,this.minY=i,this.maxX=s,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Se);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xv,this}set(e,i,s,r){this.minX=e,this.minY=i,this.maxX=s,this.maxY=r}addFrame(e,i,s,r,n){n||(n=this.matrix);const o=n.a,a=n.b,l=n.c,u=n.d,c=n.tx,h=n.ty;let f=this.minX,d=this.minY,p=this.maxX,m=this.maxY,g=o*e+l*i+c,y=a*e+u*i+h;g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*s+l*i+c,y=a*s+u*i+h,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*e+l*r+c,y=a*e+u*r+h,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*s+l*r+c,y=a*s+u*r+h,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),this.minX=f,this.minY=d,this.maxX=p,this.maxY=m}addRect(e,i){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,i)}addBounds(e,i){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,i)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const i=this.minX,s=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:l,d:u,tx:c,ty:h}=e;let f=o*i+l*s+c,d=a*i+u*s+h;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=o*r+l*s+c,d=a*r+u*s+h,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*i+l*n+c,d=a*i+u*n+h,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*r+l*n+c,d=a*r+u*n+h,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,i,s,r){return this.minX<e&&(this.minX=e),this.maxX>i&&(this.maxX=i),this.minY<s&&(this.minY=s),this.maxY>r&&(this.maxY=r),this}pad(e,i=e){return this.minX-=e,this.maxX+=e,this.minY-=i,this.maxY+=i,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new wi(this.minX,this.minY,this.maxX,this.maxY)}scale(e,i=e){return this.minX*=e,this.minY*=i,this.maxX*=e,this.maxY*=i,this}get x(){return this.minX}set x(e){const i=this.maxX-this.minX;this.minX=e,this.maxX=e+i}get y(){return this.minY}set y(e){const i=this.maxY-this.minY;this.minY=e,this.maxY=e+i}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,i,s,r){let n=this.minX,o=this.minY,a=this.maxX,l=this.maxY;r||(r=this.matrix);const u=r.a,c=r.b,h=r.c,f=r.d,d=r.tx,p=r.ty;for(let m=i;m<s;m+=2){const g=e[m],y=e[m+1],b=u*g+h*y+d,v=c*g+f*y+p;n=b<n?b:n,o=v<o?v:o,a=b>a?b:a,l=v>l?v:l}this.minX=n,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,i){return this.minX<=e&&this.minY<=i&&this.maxX>=e&&this.maxY>=i}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var eO={grad:.9,turn:360,rad:360/(2*Math.PI)},Xi=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},ht=function(t,e,i){return e===void 0&&(e=0),i===void 0&&(i=Math.pow(10,e)),Math.round(i*t)/i+0},ri=function(t,e,i){return e===void 0&&(e=0),i===void 0&&(i=1),t>i?i:t>e?t:e},P2=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},jv=function(t){return{r:ri(t.r,0,255),g:ri(t.g,0,255),b:ri(t.b,0,255),a:ri(t.a)}},jp=function(t){return{r:ht(t.r),g:ht(t.g),b:ht(t.b),a:ht(t.a,3)}},tO=/^#([0-9a-f]{3,8})$/i,aa=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},E2=function(t){var e=t.r,i=t.g,s=t.b,r=t.a,n=Math.max(e,i,s),o=n-Math.min(e,i,s),a=o?n===e?(i-s)/o:n===i?2+(s-e)/o:4+(e-i)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},M2=function(t){var e=t.h,i=t.s,s=t.v,r=t.a;e=e/360*6,i/=100,s/=100;var n=Math.floor(e),o=s*(1-i),a=s*(1-(e-n)*i),l=s*(1-(1-e+n)*i),u=n%6;return{r:255*[s,a,o,o,l,s][u],g:255*[l,s,s,a,o,o][u],b:255*[o,o,l,s,s,a][u],a:r}},Kv=function(t){return{h:P2(t.h),s:ri(t.s,0,100),l:ri(t.l,0,100),a:ri(t.a)}},Zv=function(t){return{h:ht(t.h),s:ht(t.s),l:ht(t.l),a:ht(t.a,3)}},Jv=function(t){return M2((i=(e=t).s,{h:e.h,s:(i*=((s=e.l)<50?s:100-s)/100)>0?2*i/(s+i)*100:0,v:s+i,a:e.a}));var e,i,s},so=function(t){return{h:(e=E2(t)).h,s:(r=(200-(i=e.s))*(s=e.v)/100)>0&&r<200?i*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,i,s,r},iO=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sO=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rO=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nO=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,gg={string:[[function(t){var e=tO.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?ht(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?ht(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=rO.exec(t)||nO.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:jv({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=iO.exec(t)||sO.exec(t);if(!e)return null;var i,s,r=Kv({h:(i=e[1],s=e[2],s===void 0&&(s="deg"),Number(i)*(eO[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Jv(r)},"hsl"]],object:[[function(t){var e=t.r,i=t.g,s=t.b,r=t.a,n=r===void 0?1:r;return Xi(e)&&Xi(i)&&Xi(s)?jv({r:Number(e),g:Number(i),b:Number(s),a:Number(n)}):null},"rgb"],[function(t){var e=t.h,i=t.s,s=t.l,r=t.a,n=r===void 0?1:r;if(!Xi(e)||!Xi(i)||!Xi(s))return null;var o=Kv({h:Number(e),s:Number(i),l:Number(s),a:Number(n)});return Jv(o)},"hsl"],[function(t){var e=t.h,i=t.s,s=t.v,r=t.a,n=r===void 0?1:r;if(!Xi(e)||!Xi(i)||!Xi(s))return null;var o=(function(a){return{h:P2(a.h),s:ri(a.s,0,100),v:ri(a.v,0,100),a:ri(a.a)}})({h:Number(e),s:Number(i),v:Number(s),a:Number(n)});return M2(o)},"hsv"]]},Qv=function(t,e){for(var i=0;i<e.length;i++){var s=e[i][0](t);if(s)return[s,e[i][1]]}return[null,void 0]},oO=function(t){return typeof t=="string"?Qv(t.trim(),gg.string):typeof t=="object"&&t!==null?Qv(t,gg.object):[null,void 0]},Kp=function(t,e){var i=so(t);return{h:i.h,s:ri(i.s+100*e,0,100),l:i.l,a:i.a}},Zp=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},ex=function(t,e){var i=so(t);return{h:i.h,s:i.s,l:ri(i.l+100*e,0,100),a:i.a}},yg=(function(){function t(e){this.parsed=oO(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return ht(Zp(this.rgba),2)},t.prototype.isDark=function(){return Zp(this.rgba)<.5},t.prototype.isLight=function(){return Zp(this.rgba)>=.5},t.prototype.toHex=function(){return e=jp(this.rgba),i=e.r,s=e.g,r=e.b,o=(n=e.a)<1?aa(ht(255*n)):"","#"+aa(i)+aa(s)+aa(r)+o;var e,i,s,r,n,o},t.prototype.toRgb=function(){return jp(this.rgba)},t.prototype.toRgbString=function(){return e=jp(this.rgba),i=e.r,s=e.g,r=e.b,(n=e.a)<1?"rgba("+i+", "+s+", "+r+", "+n+")":"rgb("+i+", "+s+", "+r+")";var e,i,s,r,n},t.prototype.toHsl=function(){return Zv(so(this.rgba))},t.prototype.toHslString=function(){return e=Zv(so(this.rgba)),i=e.h,s=e.s,r=e.l,(n=e.a)<1?"hsla("+i+", "+s+"%, "+r+"%, "+n+")":"hsl("+i+", "+s+"%, "+r+"%)";var e,i,s,r,n},t.prototype.toHsv=function(){return e=E2(this.rgba),{h:ht(e.h),s:ht(e.s),v:ht(e.v),a:ht(e.a,3)};var e},t.prototype.invert=function(){return Mi({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Mi(Kp(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Mi(Kp(this.rgba,-e))},t.prototype.grayscale=function(){return Mi(Kp(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Mi(ex(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Mi(ex(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Mi({r:(i=this.rgba).r,g:i.g,b:i.b,a:e}):ht(this.rgba.a,3);var i},t.prototype.hue=function(e){var i=so(this.rgba);return typeof e=="number"?Mi({h:e,s:i.s,l:i.l,a:i.a}):ht(i.h)},t.prototype.isEqual=function(e){return this.toHex()===Mi(e).toHex()},t})(),Mi=function(t){return t instanceof yg?t:new yg(t)},tx=[],aO=function(t){t.forEach(function(e){tx.indexOf(e)<0&&(e(yg,gg),tx.push(e))})};function lO(t,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in i)s[i[r]]=r;var n={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=s[this.toHex()];if(u)return u;if(o?.closest){var c=this.toRgb(),h=1/0,f="black";if(!n.length)for(var d in i)n[d]=new t(i[d]).toRgb();for(var p in i){var m=(a=c,l=n[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<h&&(h=m,f=p)}return f}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":i[a];return l?new t(l).toRgb():null},"name"])}aO([lO]);const nn=class Hn{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Hn)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,i){const s=typeof e;if(s!==typeof i)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===i;if(Array.isArray(e)&&Array.isArray(i)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(i))return e.length!==i.length?!1:e.every((n,o)=>n===i[o]);if(e!==null&&i!==null){const n=Object.keys(e),o=Object.keys(i);return n.length!==o.length?!1:n.every(a=>e[a]===i[a])}return e===i}toRgba(){const[e,i,s,r]=this._components;return{r:e,g:i,b:s,a:r}}toRgb(){const[e,i,s]=this._components;return{r:e,g:i,b:s}}toRgbaString(){const[e,i,s]=this.toUint8RgbArray();return`rgba(${e},${i},${s},${this.alpha})`}toUint8RgbArray(e){const[i,s,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(i*255),e[1]=Math.round(s*255),e[2]=Math.round(r*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[i,s,r,n]=this._components;return e[0]=i,e[1]=s,e[2]=r,e[3]=n,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[i,s,r]=this._components;return e[0]=i,e[1]=s,e[2]=r,e}toNumber(){return this._int}toBgrNumber(){const[e,i,s]=this.toUint8RgbArray();return(s<<16)+(i<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[i,s,r,n]=Hn._temp.setValue(e)._components;return this._components[0]*=i,this._components[1]*=s,this._components[2]*=r,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(e,i=!0){return i&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,i=!0){if(e===1)return(255<<24)+this._int;if(e===0)return i?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return i&&(s=s*e+.5|0,r=r*e+.5|0,n=n*e+.5|0),(e*255<<24)+(s<<16)+(r<<8)+n}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const i=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-i.length)+i}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let i,s,r,n;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;i=(o>>16&255)/255,s=(o>>8&255)/255,r=(o&255)/255,n=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[i,s,r,n=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[i,s,r,n=255]=e,i/=255,s/=255,r/=255,n/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Hn.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=Mi(e);o.isValid()&&({r:i,g:s,b:r,a:n}=o.rgba,i/=255,s/=255,r/=255)}if(i!==void 0)this._components[0]=i,this._components[1]=s,this._components[2]=r,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,i,s]=this._components;this._int=(e*255<<16)+(i*255<<8)+(s*255|0)}_clamp(e,i=0,s=1){return typeof e=="number"?Math.min(Math.max(e,i),s):(e.forEach((r,n)=>{e[n]=Math.min(Math.max(r,i),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Hn||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};nn.shared=new nn;nn._temp=new nn;nn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let st=nn;const cO={cullArea:null,cullable:!1,cullableChildren:!0};let Jp=0;const ix=500;function gt(...t){Jp!==ix&&(Jp++,Jp===ix?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}const zo={_registeredResources:new Set,register(t){this._registeredResources.add(t)},unregister(t){this._registeredResources.delete(t)},release(){this._registeredResources.forEach(t=>t.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(t){return this._registeredResources.has(t)},reset(){this._registeredResources.clear()}};class uO{constructor(e,i){this._pool=[],this._count=0,this._index=0,this._classType=e,i&&this.prepopulate(i)}prepopulate(e){for(let i=0;i<e;i++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let i;return this._index>0?i=this._pool[--this._index]:(i=new this._classType,this._count++),i.init?.(e),i}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class hO{constructor(){this._poolsByClass=new Map}prepopulate(e,i){this.getPool(e).prepopulate(i)}get(e,i){return this.getPool(e).get(i)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new uO(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(i=>{const s=e[i._classType.name]?i._classType.name+i._classType.ID:i._classType.name;e[s]={free:i.totalFree,used:i.totalUsed,size:i.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const ai=new hO;zo.register(ai);const dO={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){ve("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function fO(t,e,i){const s=t.length;let r;if(e>=s||i===0)return;i=e+i>s?s-e:i;const n=s-i;for(r=e;r<n;++r)t[r]=t[r+i];t.length=n}const pO={allowChildren:!0,removeChildren(t=0,e){const i=e??this.children.length,s=i-t,r=[];if(s>0&&s<=i){for(let o=i-1;o>=t;o--){const a=this.children[o];a&&(r.push(a),a.parent=null)}fO(this.children,t,i);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(r);for(let o=0;o<r.length;++o){const a=r[o];a.parentRenderLayer?.detach(a),this.emit("childRemoved",a,this,o),r[o].emit("removed",this)}return r.length>0&&this._didViewChangeTick++,r}else if(s===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||ve(Ne,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:i}=this;if(e<0||e>i.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${i.length}`);if(t.parent){const r=t.parent.children.indexOf(t);if(t.parent===this&&r===e)return t;r!==-1&&t.parent.children.splice(r,1)}e===i.length?i.push(t):i.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const i=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),i.prepend(s),t.setFromMatrix(i),t},replaceChild(t,e){t.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(t)),e.setFromMatrix(t.localTransform),e.updateLocalTransform(),this.removeChild(t)}},mO={collectRenderables(t,e,i){this.parentRenderLayer&&this.parentRenderLayer!==i||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,i):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,i))},collectRenderablesSimple(t,e,i){const s=this.children,r=s.length;for(let n=0;n<r;n++)s[n].collectRenderables(t,e,i)},collectRenderablesWithEffects(t,e,i){const{renderPipes:s}=e;for(let r=0;r<this.effects.length;r++){const n=this.effects[r];s[n.pipe].push(n,this,t)}this.collectRenderablesSimple(t,e,i);for(let r=this.effects.length-1;r>=0;r--){const n=this.effects[r];s[n.pipe].pop(n,this,t)}}};class sx{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class gO{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let i=0;i<this._tests.length;i++){const s=this._tests[i];if(s.test(e))return ai.get(s.maskClass,e)}return e}returnMaskEffect(e){ai.return(e)}}const vg=new gO;di.handleByList(Ge.MaskEffect,vg._effectClasses);const yO={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((i,s)=>i.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),vg.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=vg.getMaskEffect(t),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new sx);t=t;const i=t?.length>0,s=e.filters?.length>0,r=i!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),r&&(i?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new sx),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},vO={label:null,get name(){return ve(Ne,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){ve(Ne,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const i=this.children;for(let s=0;s<i.length;s++){const r=i[s];if(r.label===t||t instanceof RegExp&&t.test(r.label))return r}if(e)for(let s=0;s<i.length;s++){const n=i[s].getChildByLabel(t,!0);if(n)return n}return null},getChildrenByLabel(t,e=!1,i=[]){const s=this.children;for(let r=0;r<s.length;r++){const n=s[r];(n.label===t||t instanceof RegExp&&t.test(n.label))&&i.push(n)}if(e)for(let r=0;r<s.length;r++)s[r].getChildrenByLabel(t,!0,i);return i}},Et=ai.getPool(Ie),Qi=ai.getPool(wi),xO=new Ie,bO={getFastGlobalBounds(t,e){e||(e=new wi),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const i=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(i.worldTransform),e},_getGlobalBoundsRecursive(t,e,i){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==i||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(s=Qi.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;s.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const n=this.children;for(let o=0;o<n.length;o++)n[o]._getGlobalBoundsRecursive(t,s,i)}if(r){let n=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(n||(n=!0,s.applyMatrix(o.worldTransform)),this.effects[a].addBounds(s,!0));n&&s.applyMatrix(o.worldTransform.copyTo(xO).invert()),e.addBounds(s),Qi.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Qi.return(s))}};function F2(t,e,i){i.clear();let s,r;return t.parent?e?s=t.parent.worldTransform:(r=Et.get().identity(),s=L0(t,r)):s=Ie.IDENTITY,R2(t,i,s,e),r&&Et.return(r),i.isValid||i.set(0,0,0,0),i}function R2(t,e,i,s){if(!t.visible||!t.measurable)return;let r;s?r=t.worldTransform:(t.updateLocalTransform(),r=Et.get(),r.appendFrom(t.localTransform,i));const n=e,o=!!t.effects.length;if(o&&(e=Qi.get().clear()),t.boundsArea)e.addRect(t.boundsArea,r);else{const a=t.bounds;a&&!a.isEmpty()&&(e.matrix=r,e.addBounds(a));for(let l=0;l<t.children.length;l++)R2(t.children[l],e,r,s)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);n.addBounds(e,Ie.IDENTITY),Qi.return(e)}s||Et.return(r)}function L0(t,e){const i=t.parent;return i&&(L0(i,e),i.updateLocalTransform(),e.append(i.localTransform)),e}function z2(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const i=t>>16&255,s=t>>8&255,r=t&255,n=e>>16&255,o=e>>8&255,a=e&255,l=i*n/255|0,u=s*o/255|0,c=r*a/255|0;return(l<<16)+(u<<8)+c}const rx=16777215;function nx(t,e){return t===rx?e:e===rx?t:z2(t,e)}function Ha(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const _O={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,i=this.parent;for(;i;)e*=i.alpha,i=i.parent;return e},getGlobalTransform(t=new Ie,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const i=L0(this,Et.get().identity());return t.appendFrom(this.localTransform,i),Et.return(i),t},getGlobalTint(t){if(t)return this.renderGroup?Ha(this.renderGroup.worldColor):this.parentRenderGroup?Ha(nx(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,i=this.parent;for(;i;)e=nx(e,i.localColor),i=i.parent;return Ha(e)}};function U2(t,e,i){return e.clear(),i||(i=Ie.IDENTITY),B2(t,e,i,t,!0),e.isValid||e.set(0,0,0,0),e}function B2(t,e,i,s,r){let n;if(r)n=Et.get(),n=i.copyTo(n);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;n=Et.get(),n.appendFrom(l,i)}const o=e,a=!!t.effects.length;if(a&&(e=Qi.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{t.renderPipeId&&(e.matrix=n,e.addBounds(t.bounds));const l=t.children;for(let u=0;u<l.length;u++)B2(l[u],e,n,s,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);o.addBounds(e,Ie.IDENTITY),Qi.return(e)}Et.return(n)}function O2(t,e){const i=t.children;for(let s=0;s<i.length;s++){const r=i[s],n=r.uid,o=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,a=e.index;(e.data[a]!==n||e.data[a+1]!==o)&&(e.data[e.index]=n,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,r.children.length&&O2(r,e)}return e.didChange}const wO=new Ie,SO={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const i=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*i:this.scale.x=i},_setHeight(t,e){const i=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*i:this.scale.y=i},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new wi});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),O2(this,t),t.didChange&&U2(this,t.localBounds,wO),t.localBounds},getBounds(t,e){return F2(this,t,e||new wi)}},CO={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},TO={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(kO))}};function kO(t,e){return t._zIndex-e._zIndex}const AO={getGlobalPosition(t=new Ae,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,i=!1){const s=this.getGlobalTransform(Et.get(),i);return e=s.apply(t,e),Et.return(s),e},toLocal(t,e,i,s){e&&(t=e.toGlobal(t,i,s));const r=this.getGlobalTransform(Et.get(),s);return i=r.applyInverse(t,i),Et.return(r),i}};class D2{constructor(){this.uid=tt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let IO=0;class PO{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new vl(this.textureOptions)}createTexture(e,i,s){const r=new fi({...this.textureOptions,width:e,height:i,resolution:1,antialias:s,autoGarbageCollect:!1});return new xe({source:r,label:`texturePool_${IO++}`})}getOptimalTexture(e,i,s=1,r){let n=Math.ceil(e*s-1e-6),o=Math.ceil(i*s-1e-6);n=yl(n),o=yl(o);const a=(n<<17)+(o<<1)+(r?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(n,o,r)),l.source._resolution=s,l.source.width=n/s,l.source.height=o/s,l.source.pixelWidth=n,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=i,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,i=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,i)}returnTexture(e,i=!1){const s=this._poolKeyHash[e.uid];i&&(e.source.style=this.textureStyle),this._texturePool[s].push(e)}clear(e){if(e=e!==!1,e)for(const i in this._texturePool){const s=this._texturePool[i];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this._texturePool={}}}const on=new PO;zo.register(on);class EO{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Ie,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new D2,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const i=e.children;for(let s=0;s<i.length;s++){const r=i[s];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(on.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const i=this.childrenToUpdate[e];i.list.fill(null),i.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const i=this.renderGroupChildren.indexOf(e);i>-1&&this.renderGroupChildren.splice(i,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const i=e.children;for(let s=0;s<i.length;s++)this.addChild(i[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const i=e.children;for(let s=0;s<i.length;s++)this.removeChild(i[s])}removeChildren(e){for(let i=0;i<e.length;i++)this.removeChild(e[i])}onChildUpdate(e){let i=this.childrenToUpdate[e.relativeRenderGroupDepth];i||(i=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),i.list[i.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let i=0;i<this._onRenderContainers.length;i++)this._onRenderContainers[i]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const i=this.root.children;for(let s=0;s<i.length;s++)this._getChildren(i[s],e);return e}_getChildren(e,i=[]){if(i.push(e),e.renderGroup)return i;const s=e.children;for(let r=0;r<s.length;r++)this._getChildren(s[r],i);return i}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new Ie),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new Ie),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new Ie),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function MO(t,e,i={}){for(const s in e)!i[s]&&e[s]!==void 0&&(t[s]=e[s])}const Qp=new ft(null),la=new ft(null),em=new ft(null,1,1),ca=new ft(null),ox=1,FO=2,tm=4;class it extends Ti{constructor(e={}){super(),this.uid=tt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new Ie,this.relativeGroupTransform=new Ie,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ft(this,0,0),this._scale=em,this._pivot=la,this._origin=ca,this._skew=Qp,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],MO(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(i=>this.addChild(i)),e.parent?.addChild(this)}static mixin(e){ve("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),di.mixin(it,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||ve(Ne,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let r=0;r<e.length;r++)this.addChild(e[r]);return e[0]}const i=e[0],s=this.renderGroup||this.parentRenderGroup;return i.parent===this?(this.children.splice(this.children.indexOf(i),1),this.children.push(i),s&&(s.structureDidChange=!0),i):(i.parent&&i.parent.removeChild(i),this.children.push(i),this.sortableChildren&&(this.sortDirty=!0),i.parent=this,i.didChange=!0,i._updateFlags=15,s&&s.addChild(i),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this),this._didViewChangeTick++,i._zIndex!==0&&i.depthOfChildModified(),i)}removeChild(...e){if(e.length>1){for(let r=0;r<e.length;r++)this.removeChild(e[r]);return e[0]}const i=e[0],s=this.children.indexOf(i);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(i):this.parentRenderGroup&&this.parentRenderGroup.removeChild(i),i.parentRenderLayer&&i.parentRenderLayer.detach(i),i.parent=null,this.emit("childRemoved",i,this,s),i.emit("removed",this)),i}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=ai.get(EO,this),this.groupTransform=Ie.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),ai.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Ie),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*$B}set angle(e){this.rotation=e*qB}get pivot(){return this._pivot===la&&(this._pivot=new ft(this,0,0)),this._pivot}set pivot(e){this._pivot===la&&(this._pivot=new ft(this,0,0),this._origin!==ca&&gt("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Qp&&(this._skew=new ft(this,0,0)),this._skew}set skew(e){this._skew===Qp&&(this._skew=new ft(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===em&&(this._scale=new ft(this,1,1)),this._scale}set scale(e){this._scale===em&&(this._scale=new ft(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===ca&&(this._origin=new ft(this,0,0)),this._origin}set origin(e){this._origin===ca&&(this._origin=new ft(this,0,0),this._pivot!==la&&gt("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const i=this.getLocalBounds().width;this._setWidth(e,i)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const i=this.getLocalBounds().height;this._setHeight(e,i)}getSize(e){e||(e={});const i=this.getLocalBounds();return e.width=Math.abs(this.scale.x*i.width),e.height=Math.abs(this.scale.y*i.height),e}setSize(e,i){const s=this.getLocalBounds();typeof e=="object"?(i=e.height??e.width,e=e.width):i??(i=e),e!==void 0&&this._setWidth(e,s.width),i!==void 0&&this._setHeight(i,s.height)}_updateSkew(){const e=this._rotation,i=this._skew;this._cx=Math.cos(e+i._y),this._sx=Math.sin(e+i._y),this._cy=-Math.sin(e-i._x),this._sy=Math.cos(e-i._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const i=this.localTransform,s=this._scale,r=this._pivot,n=this._origin,o=this._position,a=s._x,l=s._y,u=r._x,c=r._y,h=-n._x,f=-n._y;i.a=this._cx*a,i.b=this._sx*a,i.c=this._cy*l,i.d=this._sy*l,i.tx=o._x-(u*i.a+c*i.c)+(h*i.a+f*i.c)-h,i.ty=o._y-(u*i.b+c*i.d)+(h*i.b+f*i.d)-f}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=ox,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=st.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=ox,this._onUpdate())}get tint(){return Ha(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=FO,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const i=e?2:0;(this.localDisplayStatus&2)!==i&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=tm,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const i=e?0:4;(this.localDisplayStatus&4)!==i&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=tm,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const i=e?1:0;(this.localDisplayStatus&1)!==i&&(this._updateFlags|=tm,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let i;if(this.children.length&&(i=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&i)for(let r=0;r<i.length;++r)i[r].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}di.mixin(it,pO,bO,AO,CO,SO,yO,vO,TO,cO,dO,_O,mO);class N0 extends it{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new wi(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const i=this.bounds,{x:s,y:r}=e;return s>=i.minX&&s<=i.maxX&&r>=i.minY&&r<=i.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null;for(const i in this._gpuData)this._gpuData[i].destroy?.();this._gpuData=null}collectRenderablesSimple(e,i,s){const{renderPipes:r}=i;r.blendMode.pushBlendMode(this,this.groupBlendMode,e),r[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let l=0;l<a;l++)o[l].collectRenderables(e,i,s);r.blendMode.popBlendMode(e)}}class Zt extends N0{constructor(e=xe.EMPTY){e instanceof xe&&(e={texture:e});const{texture:i=xe.EMPTY,anchor:s,roundPixels:r,width:n,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ft({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:i.defaultAnchor&&(this.anchor=i.defaultAnchor),this.texture=i,this.allowChildren=!1,this.roundPixels=r??!1,n!==void 0&&(this.width=n),o!==void 0&&(this.height=o)}static from(e,i=!1){return e instanceof xe?new Zt(e):new Zt(xe.from(e,i))}set texture(e){e||(e=xe.EMPTY);const i=this._texture;i!==e&&(i&&i.dynamic&&i.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return QB(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return ve("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,i=this._texture,s=this._bounds,{width:r,height:n}=i.orig;s.minX=-e._x*r,s.maxX=s.minX+r,s.minY=-e._y*n,s.maxY=s.minY+n}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,i){typeof e=="object"?(i=e.height??e.width,e=e.width):i??(i=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),i!==void 0&&this._setHeight(i,this._texture.orig.height)}}const RO=new wi;function L2(t,e,i){const s=RO;t.measurable=!0,F2(t,i,s),e.addBoundsMask(s),t.measurable=!1}function N2(t,e,i){const s=Qi.get();t.measurable=!0;const r=Et.get().identity(),n=H2(t,i,r);U2(t,s,n),t.measurable=!1,e.addBoundsMask(s),Et.return(r),Qi.return(s)}function H2(t,e,i){return t?(t!==e&&(H2(t.parent,e,i),t.updateLocalTransform(),i.append(t.localTransform)),i):(gt("Mask bounds, renderable is not inside the root container"),i)}class G2{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Zt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,i){this.inverse||L2(this.mask,e,i)}addLocalBounds(e,i){N2(this.mask,e,i)}containsPoint(e,i){const s=this.mask;return i(s,e)}destroy(){this.reset()}static test(e){return e instanceof Zt}}G2.extension=Ge.MaskEffect;class W2{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}W2.extension=Ge.MaskEffect;class V2{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,i){L2(this.mask,e,i)}addLocalBounds(e,i){N2(this.mask,e,i)}containsPoint(e,i){const s=this.mask;return i(s,e)}destroy(){this.reset()}static test(e){return e instanceof it}}V2.extension=Ge.MaskEffect;const zO={createCanvas:(t,e)=>{const i=document.createElement("canvas");return i.width=t,i.height=e,i},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let ax=zO;const li={get(){return ax},set(t){ax=t}};class $2 extends fi{constructor(e){e.resource||(e.resource=li.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,i=this.height,s=this._resolution){const r=super.resize(e,i,s);return r&&this.resizeCanvas(),r}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}$2.extension=Ge.TextureSource;class zs extends fi{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}zs.extension=Ge.TextureSource;var xg=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(xg||{});class im{constructor(e,i=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=i,this.priority=s,this._once=r}match(e,i=null){return this._fn===e&&this._context===i}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const i=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const i=this.next;return this.next=e?null:i,this.previous=null,i}}const q2=class Vt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new im(null,null,1/0),this.deltaMS=1/Vt.targetFPMS,this.elapsedMS=1/Vt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,i,s=xg.NORMAL){return this._addListener(new im(e,i,s))}addOnce(e,i,s=xg.NORMAL){return this._addListener(new im(e,i,s,!0))}_addListener(e){let i=this._head.next,s=this._head;if(!i)e.connect(s);else{for(;i;){if(e.priority>i.priority){e.connect(s);break}s=i,i=i.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,i){let s=this._head.next;for(;s;)s.match(e,i)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,i=this._head;for(;i=i.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let i;if(e>this.lastTime){if(i=this.elapsedMS=e-this.lastTime,i>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){const n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*Vt.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const i=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,i)/1e3,Vt.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const i=Math.max(this.minFPS,e);this._minElapsedMS=1/(i/1e3)}}static get shared(){if(!Vt._shared){const e=Vt._shared=new Vt;e.autoStart=!0,e._protected=!0}return Vt._shared}static get system(){if(!Vt._system){const e=Vt._system=new Vt;e.autoStart=!0,e._protected=!0}return Vt._system}};q2.targetFPMS=.06;let Gn=q2,sm;async function UO(){return sm??(sm=(async()=>{const e=li.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const i=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!i)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i);const n=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),e.deleteFramebuffer(r),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),sm}const ic=class Y2 extends fi{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Y2.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=Gn.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,i=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(i.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await UO(),this._load=new Promise((s,r)=>{this.isValid?s(this):(this._resolve=s,this._reject=r,i.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${i.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Gn.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Gn.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Gn.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};ic.extension=Ge.TextureSource;ic.defaultOptions={...fi.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ic.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let BO=ic;const zr=(t,e,i=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||i?e(s):s):t);class OO{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const i=this._cache.get(e);return i||gt(`[Assets] Asset id ${e} was not found in the Cache`),i}set(e,i){const s=zr(e);let r;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.test(i)){r=u.getCacheableAssets(s,i);break}}const n=new Map(Object.entries(r||{}));r||s.forEach(l=>{n.set(l,i)});const o=[...n.keys()],a={cacheKeys:o,keys:s};s.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const u=r?r[l]:i;this._cache.has(l)&&this._cache.get(l)!==u&&gt("[Cache] already has key:",l),this._cache.set(l,n.get(l))})}remove(e){if(!this._cacheMap.has(e)){gt(`[Assets] Asset id ${e} was not found in the Cache`);return}const i=this._cacheMap.get(e);i.cacheKeys.forEach(r=>{this._cache.delete(r)}),i.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const qt=new OO,bg=[];di.handleByList(Ge.TextureSource,bg);function X2(t={}){const e=t&&t.resource,i=e?t.resource:t,s=e?t:{resource:t};for(let r=0;r<bg.length;r++){const n=bg[r];if(n.test(i))return new n(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function DO(t={},e=!1){const i=t&&t.resource,s=i?t.resource:t,r=i?t:{resource:t};if(!e&&qt.has(s))return qt.get(s);const n=new xe({source:X2(r)});return n.on("destroy",()=>{qt.has(s)&&qt.remove(s)}),e||qt.set(s,n),n}function LO(t,e=!1){return typeof t=="string"?qt.get(t):t instanceof fi?new xe({source:t}):DO(t,e)}xe.from=LO;fi.from=X2;di.add(G2,W2,V2,BO,zs,$2,D0);var j2=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(j2||{});function mi(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function An(t){return t.split("?")[0].split("#")[0]}function NO(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function HO(t,e,i){return t.replace(new RegExp(NO(e),"g"),i)}function GO(t,e){let i="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(i.length<2||s!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){const l=i.lastIndexOf("/");if(l!==i.length-1){l===-1?(i="",s=0):(i=i.slice(0,l),s=i.length-1-i.lastIndexOf("/")),r=a,n=0;continue}}else if(i.length===2||i.length===1){i="",s=0,r=a,n=0;continue}}}else i.length>0?i+=`/${t.slice(r+1,a)}`:i=t.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return i}const xo={toPosix(t){return HO(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){mi(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const i=/^[^/:]+:\/{0,2}/.exec(t);return i?i[0]:""},toAbsolute(t,e,i){if(mi(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=An(this.toPosix(e??li.get().getBaseUrl())),r=An(this.toPosix(i??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?xo.join(r,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(mi(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const i=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=GO(t),t.length>0&&s&&(t+="/"),i?`/${t}`:e+t},isAbsolute(t){return mi(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let i=0;i<t.length;++i){const s=t[i];if(mi(s),s.length>0)if(e===void 0)e=s;else{const r=t[i-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(mi(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const i=e===47;let s=-1,r=!0;const n=this.getProtocol(t),o=t;t=t.slice(n.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!r){s=a;break}}else r=!1;return s===-1?i?"/":this.isUrl(o)?n+t:n:i&&s===1?"//":n+t.slice(0,s)},rootname(t){mi(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const i=t.indexOf("/",e.length);i!==-1?e=t.slice(0,i):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){mi(t),e&&mi(e),t=An(this.toPosix(t));let i=0,s=-1,r=!0,n;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(n=t.length-1;n>=0;--n){const l=t.charCodeAt(n);if(l===47){if(!r){i=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=t.length),t.slice(i,s)}for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":t.slice(i,s)},extname(t){mi(t),t=An(this.toPosix(t));let e=-1,i=0,s=-1,r=!0,n=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!r){i=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?e===-1?e=o:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||s===-1||n===0||n===1&&e===s-1&&e===i+1?"":t.slice(e,s)},parse(t){mi(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=An(this.toPosix(t));let i=t.charCodeAt(0);const s=this.isAbsolute(t);let r;e.root=this.rootname(t),s||this.hasProtocol(t)?r=1:r=0;let n=-1,o=0,a=-1,l=!0,u=t.length-1,c=0;for(;u>=r;--u){if(i=t.charCodeAt(u),i===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),i===46?n===-1?n=u:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&s?(e.name=t.slice(1,n),e.base=t.slice(1,a)):(e.name=t.slice(o,n),e.base=t.slice(o,a)),e.ext=t.slice(n,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function K2(t,e,i,s,r){const n=e[i];for(let o=0;o<n.length;o++){const a=n[o];i<e.length-1?K2(t.replace(s[i],a),e,i+1,s,r):r.push(t.replace(s[i],a))}}function WO(t){const e=/\{(.*?)\}/g,i=t.match(e),s=[];if(i){const r=[];i.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),K2(t,r,0,i,s)}else s.push(t);return s}const lx=t=>!Array.isArray(t);class Z2{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,i)=>`${e}${this._bundleIdConnector}${i}`,extractAssetIdFromBundle:(e,i)=>i.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(i=>{this._preferredOrder.push(i),i.priority||(i.priority=Object.keys(i.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const i=e;this._defaultSearchParams=Object.keys(i).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(i[s])}`).join("&")}}getAlias(e){const{alias:i,src:s}=e;return zr(i||s,n=>typeof n=="string"?n:Array.isArray(n)?n.map(o=>o?.src??o):n?.src?n.src:n,!0)}addManifest(e){this._manifest&&gt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(i=>{this.addBundle(i.name,i.assets)})}addBundle(e,i){const s=[];let r=i;Array.isArray(i)||(r=Object.entries(i).map(([n,o])=>typeof o=="string"||Array.isArray(o)?{alias:n,src:o}:{alias:n,...o})),r.forEach(n=>{const o=n.src,a=n.alias;let l;if(typeof a=="string"){const u=this._createBundleAssetId(e,a);s.push(u),l=[a,u]}else{const u=a.map(c=>this._createBundleAssetId(e,c));s.push(...u),l=[...a,...u]}this.add({...n,alias:l,src:o})}),this._bundles[e]=s}add(e){const i=[];Array.isArray(e)?i.push(...e):i.push(e);let s;s=n=>{this.hasKey(n)&&gt(`[Resolver] already has key: ${n} overwriting`)},zr(i).forEach(n=>{const{src:o}=n;let{data:a,format:l,loadParser:u,parser:c}=n;const h=zr(o).map(m=>typeof m=="string"?WO(m):Array.isArray(m)?m:[m]),f=this.getAlias(n);Array.isArray(f)?f.forEach(s):s(f);const d=[],p=m=>({...this._parsers.find(y=>y.test(m))?.parse(m),src:m});h.forEach(m=>{m.forEach(g=>{let y={};if(typeof g!="object"?y=p(g):(a=g.data??a,l=g.format??l,(g.loadParser||g.parser)&&(u=g.loadParser??u,c=g.parser??c),y={...p(g.src),...g}),!f)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:f,data:a,format:l,loadParser:u,parser:c,progressSize:n.progressSize}),d.push(y)})}),f.forEach(m=>{this._assetMap[m]=d})})}resolveBundle(e){const i=lx(e);e=zr(e);const s={};return e.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(r,l)]=u}s[r]=a}}),i?s[e[0]]:s}resolveUrl(e){const i=this.resolve(e);if(typeof e!="string"){const s={};for(const r in i)s[r]=i[r].src;return s}return i.src}resolve(e){const i=lx(e);e=zr(e);const s={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const u=n.filter(c=>c[a]?c[a]===l:!1);u.length&&(n=u)})}),this._resolverHash[r]=n[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),i?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let i=0;i<e.length;i++){const s=e[i],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const i=/\?/.test(e)?"&":"?";return`${e}${i}${this._defaultSearchParams}`}_buildResolvedAsset(e,i){const{aliases:s,data:r,loadParser:n,parser:o,format:a,progressSize:l}=i;return(this._basePath||this._rootPath)&&(e.src=xo.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=n??e.loadParser,e.parser=o??e.parser,e.format=a??e.format??VO(e.src),l!==void 0&&(e.progressSize=l),e}}Z2.RETINA_PREFIX=/@([0-9\.]+)x/;function VO(t){return t.split(".").pop().split("?").shift().split("#").shift()}const cx=(t,e)=>{const i=e.split("?")[1];return i&&(t+=`?${i}`),t},J2=class Wn{constructor(e,i){this.linkedSheets=[];let s=e;e?.source instanceof fi&&(s={texture:e,data:i});const{texture:r,data:n,cachePrefix:o=""}=s;this.cachePrefix=o,this._texture=r instanceof xe?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=n;const a=parseFloat(n.meta.scale);a?(this.resolution=a,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Wn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let i=e;const s=Wn.BATCH_SIZE;for(;i-e<s&&i<this._frameKeys.length;){const r=this._frameKeys[i],n=this._frames[r],o=n.frame;if(o){let a=null,l=null;const u=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new Se(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);n.rotated?a=new Se(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Se(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new Se(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new xe({source:this.textureSource,frame:a,orig:c,trim:l,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:r.toString()})}i++}}_processAnimations(){const e=this.data.animations||{};for(const i in e){this.animations[i]=[];for(let s=0;s<e[i].length;s++){const r=e[i][s];this.animations[i].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Wn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Wn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};J2.BATCH_SIZE=1e3;let ux=J2;const $O=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Q2(t,e,i){const s={};if(t.forEach(r=>{s[r]=e}),Object.keys(e.textures).forEach(r=>{s[`${e.cachePrefix}${r}`]=e.textures[r]}),!i){const r=xo.dirname(t[0]);e.linkedSheets.forEach((n,o)=>{const a=Q2([`${r}/${e.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(s,a)})}return s}const qO={extension:Ge.Asset,cache:{test:t=>t instanceof ux,getCacheableAssets:(t,e)=>Q2(t,e,!1)},resolver:{extension:{type:Ge.ResolveParser,name:"resolveSpritesheet"},test:t=>{const i=t.split("?")[0].split("."),s=i.pop(),r=i.pop();return s==="json"&&$O.includes(r)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Z2.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:Ge.LoadParser,priority:j2.Normal,name:"spritesheetLoader"},async testParse(t,e){return xo.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,i){const{texture:s,imageFilename:r,textureOptions:n,cachePrefix:o}=e?.data??{};let a=xo.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(s instanceof xe)l=s;else{const h=cx(a+(r??t.meta.image),e.src);l=(await i.load([{src:h,data:n}]))[h]}const u=new ux({texture:l.source,data:t,cachePrefix:o});await u.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const h=[];for(const d of c){if(typeof d!="string")continue;let p=a+d;e.data?.ignoreMultiPack||(p=cx(p,e.src),h.push(i.load({src:p,data:{textureOptions:n,ignoreMultiPack:!0}})))}const f=await Promise.all(h);u.linkedSheets=f,f.forEach(d=>{d.linkedSheets=[u].concat(u.linkedSheets.filter(p=>p!==d))})}return u},async unload(t,e,i){await i.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};di.add(qO);const rm=Object.create(null),hx=Object.create(null);function H0(t,e){let i=hx[t];return i===void 0&&(rm[e]===void 0&&(rm[e]=1),hx[t]=i=rm[e]++),i}let ua;function eS(){return(!ua||ua?.isContextLost())&&(ua=li.get().createCanvas().getContext("webgl",{})),ua}let ha;function YO(){if(!ha){ha="mediump";const t=eS();t&&t.getShaderPrecisionFormat&&(ha=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return ha}function XO(t,e,i){return e?t:i?(t=t.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function jO(t,e,i){const s=i?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let r=i?e.requestedFragmentPrecision:e.requestedVertexPrecision;return r==="highp"&&s!=="highp"&&(r="mediump"),`precision ${r} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function KO(t,e){return e?`#version 300 es
${t}`:t}const ZO={},JO={};function QO(t,{name:e="pixi-program"},i=!0){e=e.replace(/\s+/g,"-"),e+=i?"-fragment":"-vertex";const s=i?ZO:JO;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function eD(t,e){return e?t.replace("#version 300 es",""):t}const nm={stripVersion:eD,ensurePrecision:jO,addProgramDefines:XO,setProgramName:QO,insertVersion:KO},In=Object.create(null),tS=class _g{constructor(e){e={..._g.defaultOptions,...e};const i=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:i,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:YO()},setProgramName:{name:e.name},addProgramDefines:i,insertVersion:i};let r=e.fragment,n=e.vertex;Object.keys(nm).forEach(o=>{const a=s[o];r=nm[o](r,a,!0),n=nm[o](n,a,!1)}),this.fragment=r,this.vertex=n,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=H0(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,In[this._cacheKey]=null}static from(e){const i=`${e.vertex}:${e.fragment}`;return In[i]||(In[i]=new _g(e),In[i]._cacheKey=i),In[i]}};tS.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let mn=tS;const dx={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function tD(t){return dx[t]??dx.float32}const iD={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function sD({source:t,entryPoint:e}){const i={},s=t.indexOf(`fn ${e}`);if(s!==-1){const r=t.indexOf("->",s);if(r!==-1){const n=t.substring(s,r),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(n))!==null;){const l=iD[a[3]]??"float32";i[a[2]]={location:parseInt(a[1],10),format:l,stride:tD(l).stride,offset:0,instance:!1,start:0}}}}return i}function om(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,i=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,u=t.match(e)?.map(h=>({group:parseInt(h.match(i)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(r)[2],isUniform:h.match(r)[1]==="<uniform>",type:h.match(n)[1]}));if(!u)return{groups:[],structs:[]};const c=t.match(o)?.map(h=>{const f=h.match(l)[1],d=h.match(a).reduce((p,m)=>{const[g,y]=m.split(":");return p[g.trim()]=y.trim(),p},{});return d?{name:f,members:d}:null}).filter(({name:h})=>u.some(f=>f.type===h))??[];return{groups:u,structs:c}}var Vn=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Vn||{});function rD({groups:t}){const e=[];for(let i=0;i<t.length;i++){const s=t[i];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:Vn.VERTEX|Vn.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:Vn.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:Vn.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function nD({groups:t}){const e=[];for(let i=0;i<t.length;i++){const s=t[i];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function oD(t,e){const i=new Set,s=new Set,r=[...t.structs,...e.structs].filter(o=>i.has(o.name)?!1:(i.add(o.name),!0)),n=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return s.has(a)?!1:(s.add(a),!0)});return{structs:r,groups:n}}const Pn=Object.create(null);class gn{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:i,vertex:s,layout:r,gpuLayout:n,name:o}=e;if(this.name=o,this.fragment=i,this.vertex=s,i.source===s.source){const a=om(i.source);this.structsAndGroups=a}else{const a=om(s.source),l=om(i.source);this.structsAndGroups=oD(a,l)}this.layout=r??nD(this.structsAndGroups),this.gpuLayout=n??rD(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:i}=this,s=e.source+i.source+e.entryPoint+i.entryPoint;this._layoutKey=H0(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=sD(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,Pn[this._cacheKey]=null}static from(e){const i=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return Pn[i]||(Pn[i]=new gn(e),Pn[i]._cacheKey=i),Pn[i]}}const iS=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],aD=iS.reduce((t,e)=>(t[e]=!0,t),{});function lD(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const sS=class rS{constructor(e,i){this._touched=0,this.uid=tt("uniform"),this._resourceType="uniformGroup",this._resourceId=tt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,i={...rS.defaultOptions,...i},this.uniformStructures=e;const s={};for(const r in e){const n=e[r];if(n.name=r,n.size=n.size??1,!aD[n.type]){const o=n.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,l]=o;throw new Error(`Uniform type ${n.type} is not supported. Use type: '${a}', size: ${l} instead.`)}throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${iS.join(", ")}`)}n.value??(n.value=lD(n.type,n.size)),s[r]=n.value}this.uniforms=s,this._dirtyId=1,this.ubo=i.ubo,this.isStatic=i.isStatic,this._signature=H0(Object.keys(s).map(r=>`${r}-${e[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};sS.defaultOptions={ubo:!1,isStatic:!1};let nS=sS;class Ga{constructor(e){this.resources=Object.create(null),this._dirty=!0;let i=0;for(const s in e){const r=e[s];this.setResource(r,i++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let i=0;for(const s in this.resources)e[i++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,i){const s=this.resources[i];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[i]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const i=this.resources;for(const s in i)i[s]._touched=e}destroy(){const e=this.resources;for(const i in e)e[i]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const i=this.resources;for(const s in i)i[s]===e&&(i[s]=null)}else this._updateKey()}}var bo=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(bo||{});class sc extends Ti{constructor(e){super(),this.uid=tt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:i,glProgram:s,groups:r,resources:n,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=i,this.glProgram=s,o===void 0&&(o=0,i&&(o|=bo.WEBGPU),s&&(o|=bo.WEBGL)),this.compatibleRenderers=o;const l={};if(!n&&!r&&(n={}),n&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!i&&r&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!i&&r&&a)for(const u in a)for(const c in a[u]){const h=a[u][c];l[h]={group:u,binding:c,name:h}}else if(i&&r&&!a){const u=i.structsAndGroups.groups;a={},u.forEach(c=>{a[c.group]=a[c.group]||{},a[c.group][c.binding]=c.name,l[c.name]=c})}else if(n){r={},a={},i&&i.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let u=0;for(const c in n)l[c]||(r[99]||(r[99]=new Ga,this._ownedBindGroups.push(r[99])),l[c]={group:99,binding:u,name:c},a[99]=a[99]||{},a[99][u]=c,u++);for(const c in n){const h=c;let f=n[c];!f.source&&!f._resourceType&&(f=new nS(f));const d=l[h];d&&(r[d.group]||(r[d.group]=new Ga,this._ownedBindGroups.push(r[d.group])),r[d.group].setResource(f,d.binding))}}this.groups=r,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(r,l)}addResource(e,i,s){var r,n;(r=this._uniformBindMap)[i]||(r[i]={}),(n=this._uniformBindMap[i])[s]||(n[s]=e),this.groups[i]||(this.groups[i]=new Ga,this._ownedBindGroups.push(this.groups[i]))}_buildResourceAccessor(e,i){const s={};for(const r in i){const n=i[r];Object.defineProperty(s,n.name,{get(){return e[n.group].getResource(n.binding)},set(o){e[n.group].setResource(o,n.binding)}})}return s}destroy(e=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(i=>{i.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:i,gl:s,...r}=e;let n,o;return i&&(n=gn.from(i)),s&&(o=mn.from(s)),new sc({gpuProgram:n,glProgram:o,...r})}}const cD={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},am=0,lm=1,cm=2,um=3,hm=4,dm=5,wg=class oS{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<am)}set blend(e){!!(this.data&1<<am)!==e&&(this.data^=1<<am)}get offsets(){return!!(this.data&1<<lm)}set offsets(e){!!(this.data&1<<lm)!==e&&(this.data^=1<<lm)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<cm)}set culling(e){!!(this.data&1<<cm)!==e&&(this.data^=1<<cm)}get depthTest(){return!!(this.data&1<<um)}set depthTest(e){!!(this.data&1<<um)!==e&&(this.data^=1<<um)}get depthMask(){return!!(this.data&1<<dm)}set depthMask(e){!!(this.data&1<<dm)!==e&&(this.data^=1<<dm)}get clockwiseFrontFace(){return!!(this.data&1<<hm)}set clockwiseFrontFace(e){!!(this.data&1<<hm)!==e&&(this.data^=1<<hm)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=cD[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new oS;return e.depthTest=!1,e.blend=!0,e}};wg.default2d=wg.for2d();let uD=wg;const aS=class Sg extends sc{constructor(e){e={...Sg.defaultOptions,...e},super(e),this.enabled=!0,this._state=uD.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1),e.blendRequired&&this.addResource("uBackTexture",0,3)}apply(e,i,s,r){e.applyFilter(this,i,s,r)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:i,gl:s,...r}=e;let n,o;return i&&(n=gn.from(i)),s&&(o=mn.from(s)),new Sg({gpuProgram:n,glProgram:o,...r})}};aS.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let rc=aS;const Cg=[];di.handleByNamedList(Ge.Environment,Cg);async function hD(t){if(!t)for(let e=0;e<Cg.length;e++){const i=Cg[e];if(i.value.test()){await i.value.load();return}}}let En;function dD(){if(typeof En=="boolean")return En;try{En=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{En=!1}return En}function fx(t,e,i=2){const s=e&&e.length,r=s?e[0]*i:t.length;let n=lS(t,0,r,i,!0);const o=[];if(!n||n.next===n.prev)return o;let a,l,u;if(s&&(n=yD(t,e,n,i)),t.length>80*i){a=t[0],l=t[1];let c=a,h=l;for(let f=i;f<r;f+=i){const d=t[f],p=t[f+1];d<a&&(a=d),p<l&&(l=p),d>c&&(c=d),p>h&&(h=p)}u=Math.max(c-a,h-l),u=u!==0?32767/u:0}return _o(n,o,i,a,l,u,0),o}function lS(t,e,i,s,r){let n;if(r===ID(t,e,i,s)>0)for(let o=e;o<i;o+=s)n=px(o/s|0,t[o],t[o+1],n);else for(let o=i-s;o>=e;o-=s)n=px(o/s|0,t[o],t[o+1],n);return n&&an(n,n.next)&&(So(n),n=n.next),n}function xr(t,e){if(!t)return t;e||(e=t);let i=t,s;do if(s=!1,!i.steiner&&(an(i,i.next)||Je(i.prev,i,i.next)===0)){if(So(i),i=e=i.prev,i===i.next)break;s=!0}else i=i.next;while(s||i!==e);return e}function _o(t,e,i,s,r,n,o){if(!t)return;!o&&n&&wD(t,s,r,n);let a=t;for(;t.prev!==t.next;){const l=t.prev,u=t.next;if(n?pD(t,s,r,n):fD(t)){e.push(l.i,t.i,u.i),So(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=mD(xr(t),e),_o(t,e,i,s,r,n,2)):o===2&&gD(t,e,i,s,r,n):_o(xr(t),e,i,s,r,n,1);break}}}function fD(t){const e=t.prev,i=t,s=t.next;if(Je(e,i,s)>=0)return!1;const r=e.x,n=i.x,o=s.x,a=e.y,l=i.y,u=s.y,c=Math.min(r,n,o),h=Math.min(a,l,u),f=Math.max(r,n,o),d=Math.max(a,l,u);let p=s.next;for(;p!==e;){if(p.x>=c&&p.x<=f&&p.y>=h&&p.y<=d&&$n(r,a,n,l,o,u,p.x,p.y)&&Je(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function pD(t,e,i,s){const r=t.prev,n=t,o=t.next;if(Je(r,n,o)>=0)return!1;const a=r.x,l=n.x,u=o.x,c=r.y,h=n.y,f=o.y,d=Math.min(a,l,u),p=Math.min(c,h,f),m=Math.max(a,l,u),g=Math.max(c,h,f),y=Tg(d,p,e,i,s),b=Tg(m,g,e,i,s);let v=t.prevZ,x=t.nextZ;for(;v&&v.z>=y&&x&&x.z<=b;){if(v.x>=d&&v.x<=m&&v.y>=p&&v.y<=g&&v!==r&&v!==o&&$n(a,c,l,h,u,f,v.x,v.y)&&Je(v.prev,v,v.next)>=0||(v=v.prevZ,x.x>=d&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&$n(a,c,l,h,u,f,x.x,x.y)&&Je(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;v&&v.z>=y;){if(v.x>=d&&v.x<=m&&v.y>=p&&v.y<=g&&v!==r&&v!==o&&$n(a,c,l,h,u,f,v.x,v.y)&&Je(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=b;){if(x.x>=d&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&$n(a,c,l,h,u,f,x.x,x.y)&&Je(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function mD(t,e){let i=t;do{const s=i.prev,r=i.next.next;!an(s,r)&&uS(s,i,i.next,r)&&wo(s,r)&&wo(r,s)&&(e.push(s.i,i.i,r.i),So(i),So(i.next),i=t=r),i=i.next}while(i!==t);return xr(i)}function gD(t,e,i,s,r,n){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&TD(o,a)){let l=hS(o,a);o=xr(o,o.next),l=xr(l,l.next),_o(o,e,i,s,r,n,0),_o(l,e,i,s,r,n,0);return}a=a.next}o=o.next}while(o!==t)}function yD(t,e,i,s){const r=[];for(let n=0,o=e.length;n<o;n++){const a=e[n]*s,l=n<o-1?e[n+1]*s:t.length,u=lS(t,a,l,s,!1);u===u.next&&(u.steiner=!0),r.push(CD(u))}r.sort(vD);for(let n=0;n<r.length;n++)i=xD(r[n],i);return i}function vD(t,e){let i=t.x-e.x;if(i===0&&(i=t.y-e.y,i===0)){const s=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);i=s-r}return i}function xD(t,e){const i=bD(t,e);if(!i)return e;const s=hS(i,t);return xr(s,s.next),xr(i,i.next)}function bD(t,e){let i=e;const s=t.x,r=t.y;let n=-1/0,o;if(an(t,i))return i;do{if(an(t,i.next))return i.next;if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){const h=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(h<=s&&h>n&&(n=h,o=i.x<i.next.x?i:i.next,h===s))return o}i=i.next}while(i!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let c=1/0;i=o;do{if(s>=i.x&&i.x>=l&&s!==i.x&&cS(r<u?s:n,r,l,u,r<u?n:s,r,i.x,i.y)){const h=Math.abs(r-i.y)/(s-i.x);wo(i,t)&&(h<c||h===c&&(i.x>o.x||i.x===o.x&&_D(o,i)))&&(o=i,c=h)}i=i.next}while(i!==a);return o}function _D(t,e){return Je(t.prev,t,e.prev)<0&&Je(e.next,t,t.next)<0}function wD(t,e,i,s){let r=t;do r.z===0&&(r.z=Tg(r.x,r.y,e,i,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,SD(r)}function SD(t){let e,i=1;do{let s=t,r;t=null;let n=null;for(e=0;s;){e++;let o=s,a=0;for(let u=0;u<i&&(a++,o=o.nextZ,!!o);u++);let l=i;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||s.z<=o.z)?(r=s,s=s.nextZ,a--):(r=o,o=o.nextZ,l--),n?n.nextZ=r:t=r,r.prevZ=n,n=r;s=o}n.nextZ=null,i*=2}while(e>1);return t}function Tg(t,e,i,s,r){return t=(t-i)*r|0,e=(e-s)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function CD(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function cS(t,e,i,s,r,n,o,a){return(r-o)*(e-a)>=(t-o)*(n-a)&&(t-o)*(s-a)>=(i-o)*(e-a)&&(i-o)*(n-a)>=(r-o)*(s-a)}function $n(t,e,i,s,r,n,o,a){return!(t===o&&e===a)&&cS(t,e,i,s,r,n,o,a)}function TD(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!kD(t,e)&&(wo(t,e)&&wo(e,t)&&AD(t,e)&&(Je(t.prev,t,e.prev)||Je(t,e.prev,e))||an(t,e)&&Je(t.prev,t,t.next)>0&&Je(e.prev,e,e.next)>0)}function Je(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function an(t,e){return t.x===e.x&&t.y===e.y}function uS(t,e,i,s){const r=fa(Je(t,e,i)),n=fa(Je(t,e,s)),o=fa(Je(i,s,t)),a=fa(Je(i,s,e));return!!(r!==n&&o!==a||r===0&&da(t,i,e)||n===0&&da(t,s,e)||o===0&&da(i,t,s)||a===0&&da(i,e,s))}function da(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function fa(t){return t>0?1:t<0?-1:0}function kD(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&uS(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function wo(t,e){return Je(t.prev,t,t.next)<0?Je(t,e,t.next)>=0&&Je(t,t.prev,e)>=0:Je(t,e,t.prev)<0||Je(t,t.next,e)<0}function AD(t,e){let i=t,s=!1;const r=(t.x+e.x)/2,n=(t.y+e.y)/2;do i.y>n!=i.next.y>n&&i.next.y!==i.y&&r<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next;while(i!==t);return s}function hS(t,e){const i=kg(t.i,t.x,t.y),s=kg(e.i,e.x,e.y),r=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}function px(t,e,i,s){const r=kg(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function So(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function kg(t,e,i){return{i:t,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ID(t,e,i,s){let r=0;for(let n=e,o=i-s;n<i;n+=s)r+=(t[o]-t[n])*(t[n+1]+t[o+1]),o=n;return r}const PD=fx.default||fx;var dS=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(dS||{});class ED{constructor(e){this.items=[],this._name=e}emit(e,i,s,r,n,o,a,l){const{name:u,items:c}=this;for(let h=0,f=c.length;h<f;h++)c[h][u](e,i,s,r,n,o,a,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const i=this.items.indexOf(e);return i!==-1&&this.items.splice(i,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const MD=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],fS=class pS extends Ti{constructor(e){super(),this.uid=tt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const i=[...MD,...this.config.runners??[]];this._addRunners(...i),this._unsafeEvalCheck()}async init(e={}){const i=e.skipExtensionImports===!0?!0:e.manageImports===!1;await hD(i),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)e={...this._systemsHash[s].constructor.defaultOptions,...e};e={...pS.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(e);this._initOptions=e}render(e,i){let s=e;if(s instanceof it&&(s={container:s},i&&(ve(Ne,"passing a second argument is deprecated, please use render options instead"),s.target=i.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor??(s.clearColor=this.background.colorRgba),s.clear??(s.clear=this.background.clearBeforeRender)),s.clearColor){const r=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=r?s.clearColor:st.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),s.container.visible&&(s.container.enableRenderGroup(),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s))}resize(e,i,s){const r=this.view.resolution;this.view.resize(e,i,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==r&&this.runners.resolutionChange.emit(s)}clear(e={}){const i=this;e.target||(e.target=i.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=dS.ALL);const{clear:s,clearColor:r,target:n}=e;st.shared.setValue(r??this.background.colorRgba),i.renderTarget.clear(n,s,st.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(i=>{this.runners[i]=new ED(i)})}_addSystems(e){let i;for(i in e){const s=e[i];this._addSystem(s.value,s.name)}}_addSystem(e,i){const s=new e(this);if(this[i])throw new Error(`Whoops! The name "${i}" is already in use`);this[i]=s,this._systemsHash[i]=s;for(const r in this.runners)this.runners[r].add(s);return this}_addPipes(e,i){const s=i.reduce((r,n)=>(r[n.name]=n.value,r),{});e.forEach(r=>{const n=r.value,o=r.name,a=s[o];this.renderPipes[o]=new n(this,a?new a:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&zo.release(),Object.values(this.runners).forEach(i=>{i.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!dD())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};fS.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let mS=fS,pa;function FD(t){return pa!==void 0||(pa=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:t??mS.defaultOptions.failIfMajorPerformanceCaveat};try{if(!li.get().getWebGLRenderingContext())return!1;let s=li.get().createCanvas().getContext("webgl",e);const r=!!s?.getContextAttributes()?.stencil;if(s){const n=s.getExtension("WEBGL_lose_context");n&&n.loseContext()}return s=null,r}catch{return!1}})()),pa}let ma;async function RD(t={}){return ma!==void 0||(ma=await(async()=>{const e=li.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(t)).requestDevice(),!0}catch{return!1}})()),ma}const mx=["webgl","webgpu","canvas"];async function zD(t){let e=[];t.preference?(e.push(t.preference),mx.forEach(n=>{n!==t.preference&&e.push(n)})):e=mx.slice();let i,s={};for(let n=0;n<e.length;n++){const o=e[n];if(o==="webgpu"&&await RD()){const{WebGPURenderer:a}=await rn(async()=>{const{WebGPURenderer:l}=await import("./QQapFv0N.js");return{WebGPURenderer:l}},__vite__mapDeps([3,2,4]),import.meta.url);i=a,s={...t,...t.webgpu};break}else if(o==="webgl"&&FD(t.failIfMajorPerformanceCaveat??mS.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await rn(async()=>{const{WebGLRenderer:l}=await import("./DffiAYRW.js");return{WebGLRenderer:l}},__vite__mapDeps([5,2,4]),import.meta.url);i=a,s={...t,...t.webgl};break}else if(o==="canvas")throw s={...t},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!i)throw new Error("No available renderer for the current environment");const r=new i;return await r.init(s),r}const gS="8.14.3";class yS{static init(){globalThis.__PIXI_APP_INIT__?.(this,gS)}static destroy(){}}yS.extension=Ge.Application;class UD{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,gS)}destroy(){this._renderer=null}}UD.extension={type:[Ge.WebGLSystem,Ge.WebGPUSystem],name:"initHook",priority:-10};const vS=class Ag{constructor(...e){this.stage=new it,e[0]!==void 0&&ve(Ne,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.stage||(this.stage=new it),this.renderer=await zD(e),Ag._plugins.forEach(i=>{i.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return ve(Ne,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,i=!1){const s=Ag._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(i),this.stage=null,this.renderer.destroy(e),this.renderer=null}};vS._plugins=[];let xS=vS;di.handleByList(Ge.Application,xS._plugins);di.add(yS);class BD extends Ti{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return ve(Ne,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return ve(Ne,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return ve(Ne,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return ve(Ne,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return ve(Ne,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)this.chars[i].texture?.destroy();this.chars=null,e&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}class OD{constructor(e=0,i=0,s=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=s,this.size=0,this.ttl=i}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const i=this.items[e];delete this.items[e],this.size--,i.prev!==null&&(i.prev.next=i.next),i.next!==null&&(i.next.prev=i.prev),this.first===i&&(this.first=i.next),this.last===i&&(this.last=i.prev)}return this}entries(e=this.keys()){return e.map(i=>[i,this.get(i)])}evict(e=!1){if(e||this.size>0){const i=this.first;delete this.items[i.key],--this.size===0?(this.first=null,this.last=null):(this.first=i.next,this.first.prev=null)}return this}expiresAt(e){let i;return this.has(e)&&(i=this.items[e].expiry),i}get(e){const i=this.items[e];if(i!==void 0){if(this.ttl>0&&i.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(i),i.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let i=this.first;for(;i!==null;)e.push(i.key),i=i.next;return e}setWithEvicted(e,i,s=this.resetTtl){let r=null;if(this.has(e))this.set(e,i,!0,s);else{this.max>0&&this.size===this.max&&(r={...this.first},this.evict(!0));let n=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:i};++this.size===1?this.first=n:this.last.next=n,this.last=n}return r}set(e,i,s=!1,r=this.resetTtl){let n=this.items[e];return s||n!==void 0?(n.value=i,s===!1&&r&&(n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(n)):(this.max>0&&this.size===this.max&&this.evict(!0),n=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:i},++this.size===1?this.first=n:this.last.next=n,this.last=n),this}values(e=this.keys()){return e.map(i=>this.get(i))}}function bS(t=1e3,e=0,i=!1){if(isNaN(t)||t<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof i!="boolean")throw new TypeError("Invalid resetTtl value");return new OD(t,e,i)}const DD=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ig(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let i=t.fontFamily;Array.isArray(t.fontFamily)||(i=t.fontFamily.split(","));for(let s=i.length-1;s>=0;s--){let r=i[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!DD.includes(r)&&(r=`"${r}"`),i[s]=r}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${i.join(",")}`}const fm={willReadFrequently:!0},ki=class le{static get experimentalLetterSpacingSupported(){let e=le._experimentalLetterSpacingSupported;if(e===void 0){const i=li.get().getCanvasRenderingContext2D().prototype;e=le._experimentalLetterSpacingSupported="letterSpacing"in i||"textLetterSpacing"in i}return e}constructor(e,i,s,r,n,o,a,l,u){this.text=e,this.style=i,this.width=s,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e=" ",i,s=le._canvas,r=i.wordWrap){const n=`${e}-${i.styleKey}-wordWrap-${r}`;if(le._measurementCache.has(n))return le._measurementCache.get(n);const o=Ig(i),a=le.measureFont(o);a.fontSize===0&&(a.fontSize=i.fontSize,a.ascent=i.fontSize);const l=le.__context;l.font=o;const c=(r?le._wordWrap(e,i,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(c.length);let f=0;for(let b=0;b<c.length;b++){const v=le._measureText(c[b],i.letterSpacing,l);h[b]=v,f=Math.max(f,v)}const d=i._stroke?.width||0;let p=f+d;i.dropShadow&&(p+=i.dropShadow.distance);const m=i.lineHeight||a.fontSize;let g=Math.max(m,a.fontSize+d)+(c.length-1)*(m+i.leading);i.dropShadow&&(g+=i.dropShadow.distance);const y=new le(e,i,p,g,c,h,m+i.leading,f,a);return le._measurementCache.set(n,y),y}static _measureText(e,i,s){let r=!1;le.experimentalLetterSpacingSupported&&(le.experimentalLetterSpacing?(s.letterSpacing=`${i}px`,s.textLetterSpacing=`${i}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const n=s.measureText(e);let o=n.width;const a=-n.actualBoundingBoxLeft;let u=n.actualBoundingBoxRight-a;if(o>0)if(r)o-=i,u-=i;else{const c=(le.graphemeSegmenter(e).length-1)*i;o+=c,u+=c}return Math.max(o,u)}static _wordWrap(e,i,s=le._canvas){const r=s.getContext("2d",fm);let n=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:c}=i,h=le._collapseSpaces(c),f=le._collapseNewlines(c);let d=!h;const p=i.wordWrapWidth+u,m=le._tokenize(e);for(let g=0;g<m.length;g++){let y=m[g];if(le._isNewline(y)){if(!f){a+=le._addLine(o),d=!h,o="",n=0;continue}y=" "}if(h){const v=le.isBreakingSpace(y),x=le.isBreakingSpace(o[o.length-1]);if(v&&x)continue}const b=le._getFromCache(y,u,l,r);if(b>p)if(o!==""&&(a+=le._addLine(o),o="",n=0),le.canBreakWords(y,i.breakWords)){const v=le.wordWrapSplit(y);for(let x=0;x<v.length;x++){let _=v[x],S=_,T=1;for(;v[x+T];){const w=v[x+T];if(!le.canBreakChars(S,w,y,x,i.breakWords))_+=w;else break;S=w,T++}x+=T-1;const A=le._getFromCache(_,u,l,r);A+n>p&&(a+=le._addLine(o),d=!1,o="",n=0),o+=_,n+=A}}else{o.length>0&&(a+=le._addLine(o),o="",n=0);const v=g===m.length-1;a+=le._addLine(y,!v),d=!1,o="",n=0}else b+n>p&&(d=!1,a+=le._addLine(o),o="",n=0),(o.length>0||!le.isBreakingSpace(y)||d)&&(o+=y,n+=b)}return a+=le._addLine(o,!1),a}static _addLine(e,i=!0){return e=le._trimRight(e),e=i?`${e}
`:e,e}static _getFromCache(e,i,s,r){let n=s[e];return typeof n!="number"&&(n=le._measureText(e,i,r)+i,s[e]=n),n}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let i=e.length-1;i>=0;i--){const s=e[i];if(!le.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:le._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,i){return typeof e!="string"?!1:le._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const i=[];let s="";if(typeof e!="string")return i;for(let r=0;r<e.length;r++){const n=e[r],o=e[r+1];if(le.isBreakingSpace(n,o)||le._isNewline(n)){s!==""&&(i.push(s),s=""),n==="\r"&&o===`
`?(i.push(`\r
`),r++):i.push(n);continue}s+=n}return s!==""&&i.push(s),i}static canBreakWords(e,i){return i}static canBreakChars(e,i,s,r,n){return!0}static wordWrapSplit(e){return le.graphemeSegmenter(e)}static measureFont(e){if(le._fonts[e])return le._fonts[e];const i=le._context;i.font=e;const s=i.measureText(le.METRICS_STRING+le.BASELINE_SYMBOL),r={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return le._fonts[e]=r,r}static clearMetrics(e=""){e?delete le._fonts[e]:le._fonts={}}static get _canvas(){if(!le.__canvas){let e;try{const i=new OffscreenCanvas(0,0);if(i.getContext("2d",fm)?.measureText)return le.__canvas=i,i;e=li.get().createCanvas()}catch{e=li.get().createCanvas()}e.width=e.height=10,le.__canvas=e}return le.__canvas}static get _context(){return le.__context||(le.__context=le._canvas.getContext("2d",fm)),le.__context}};ki.METRICS_STRING="|q";ki.BASELINE_SYMBOL="M";ki.BASELINE_MULTIPLIER=1.4;ki.HEIGHT_MULTIPLIER=2;ki.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>{const i=t.segment(e),s=[];let r=0;for(const n of i)s[r++]=n.segment;return s}}return t=>[...t]})();ki.experimentalLetterSpacing=!1;ki._fonts={};ki._newlines=[10,13];ki._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ki._measurementCache=bS(1e3);let hr=ki;const gx=[{offset:0,color:"white"},{offset:1,color:"black"}],G0=class Pg{constructor(...e){this.uid=tt("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let i=LD(e);i={...i.type==="radial"?Pg.defaultRadialOptions:Pg.defaultLinearOptions,...C2(i)},this._textureSize=i.textureSize,this._wrapMode=i.wrapMode,i.type==="radial"?(this.center=i.center,this.outerCenter=i.outerCenter??this.center,this.innerRadius=i.innerRadius,this.outerRadius=i.outerRadius,this.scale=i.scale,this.rotation=i.rotation):(this.start=i.start,this.end=i.end),this.textureSpace=i.textureSpace,this.type=i.type,i.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(e,i){return this.colorStops.push({offset:e,color:st.shared.setValue(i).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:i}=this.start,{x:s,y:r}=this.end,n=s-e,o=r-i;const a=n<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(n<0){const g=e;e=s,s=g,n*=-1}if(o<0){const g=i;i=r,r=g,o*=-1}}const l=this.colorStops.length?this.colorStops:gx,u=this._textureSize,{canvas:c,context:h}=vx(u,1),f=a?h.createLinearGradient(this._textureSize,0,0,0):h.createLinearGradient(0,0,this._textureSize,0);yx(f,l),h.fillStyle=f,h.fillRect(0,0,u,1),this.texture=new xe({source:new zs({resource:c,addressMode:this._wrapMode})});const d=Math.sqrt(n*n+o*o),p=Math.atan2(o,n),m=new Ie;m.scale(d/u,1),m.rotate(p),m.translate(e,i),this.textureSpace==="local"&&m.scale(u,u),this.transform=m}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:gx,i=this._textureSize,{canvas:s,context:r}=vx(i,i),{x:n,y:o}=this.center,{x:a,y:l}=this.outerCenter,u=this.innerRadius,c=this.outerRadius,h=a-c,f=l-c,d=i/(c*2),p=(n-h)*d,m=(o-f)*d,g=r.createRadialGradient(p,m,u*d,(a-h)*d,(l-f)*d,c*d);yx(g,e),r.fillStyle=e[e.length-1].color,r.fillRect(0,0,i,i),r.fillStyle=g,r.translate(p,m),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-p,-m),r.fillRect(0,0,i,i),this.texture=new xe({source:new zs({resource:s,addressMode:this._wrapMode})});const y=new Ie;y.scale(1/d,1/d),y.translate(h,f),this.textureSpace==="local"&&y.scale(i,i),this.transform=y}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};G0.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};G0.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let ui=G0;function yx(t,e){for(let i=0;i<e.length;i++){const s=e[i];t.addColorStop(s.offset,s.color)}}function vx(t,e){const i=li.get().createCanvas(t,e),s=i.getContext("2d");return{canvas:i,context:s}}function LD(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(ve("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??ui.defaultLinearOptions.textureSize}),e}const xx={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class nc{constructor(e,i){this.uid=tt("fillPattern"),this._tick=0,this.transform=new Ie,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),i&&(e.source.style.addressModeU=xx[i].addressModeU,e.source.style.addressModeV=xx[i].addressModeV)}setTransform(e){const i=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/i.frame.width,1/i.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var pm,bx;function ND(){if(bx)return pm;bx=1,pm=i;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function i(n){var o=[];return n.replace(e,function(a,l,u){var c=l.toLowerCase();for(u=r(u),c=="m"&&u.length>2&&(o.push([l].concat(u.splice(0,2))),c="l",l=l=="m"?"l":"L");;){if(u.length==t[c])return u.unshift(l),o.push(u);if(u.length<t[c])throw new Error("malformed path data");o.push([l].concat(u.splice(0,t[c])))}}),o}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(n){var o=n.match(s);return o?o.map(Number):[]}return pm}var HD=ND();const GD=O0(HD);function WD(t,e){const i=GD(t),s=[];let r=null,n=0,o=0;for(let a=0;a<i.length;a++){const l=i[a],u=l[0],c=l;switch(u){case"M":n=c[1],o=c[2],e.moveTo(n,o);break;case"m":n+=c[1],o+=c[2],e.moveTo(n,o);break;case"H":n=c[1],e.lineTo(n,o);break;case"h":n+=c[1],e.lineTo(n,o);break;case"V":o=c[1],e.lineTo(n,o);break;case"v":o+=c[1],e.lineTo(n,o);break;case"L":n=c[1],o=c[2],e.lineTo(n,o);break;case"l":n+=c[1],o+=c[2],e.lineTo(n,o);break;case"C":n=c[5],o=c[6],e.bezierCurveTo(c[1],c[2],c[3],c[4],n,o);break;case"c":e.bezierCurveTo(n+c[1],o+c[2],n+c[3],o+c[4],n+c[5],o+c[6]),n+=c[5],o+=c[6];break;case"S":n=c[3],o=c[4],e.bezierCurveToShort(c[1],c[2],n,o);break;case"s":e.bezierCurveToShort(n+c[1],o+c[2],n+c[3],o+c[4]),n+=c[3],o+=c[4];break;case"Q":n=c[3],o=c[4],e.quadraticCurveTo(c[1],c[2],n,o);break;case"q":e.quadraticCurveTo(n+c[1],o+c[2],n+c[3],o+c[4]),n+=c[3],o+=c[4];break;case"T":n=c[1],o=c[2],e.quadraticCurveToShort(n,o);break;case"t":n+=c[1],o+=c[2],e.quadraticCurveToShort(n,o);break;case"A":n=c[6],o=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,o);break;case"a":n+=c[6],o+=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,o);break;case"Z":case"z":e.closePath(),s.length>0&&(r=s.pop(),r?(n=r.startX,o=r.startY):(n=0,o=0)),r=null;break;default:gt(`Unknown SVG path command: ${u}`)}u!=="Z"&&u!=="z"&&r===null&&(r={startX:n,startY:o},s.push(r))}return e}class oc{constructor(e=0,i=0,s=0){this.type="circle",this.x=e,this.y=i,this.radius=s}clone(){return new oc(this.x,this.y,this.radius)}contains(e,i){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-e,n=this.y-i;return r*=r,n*=n,r+n<=s}strokeContains(e,i,s,r=.5){if(this.radius===0)return!1;const n=this.x-e,o=this.y-i,a=this.radius,l=(1-r)*s,u=Math.sqrt(n*n+o*o);return u<=a+l&&u>a-(s-l)}getBounds(e){return e||(e=new Se),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class W0{constructor(e=0,i=0,s=0,r=0){this.type="ellipse",this.x=e,this.y=i,this.halfWidth=s,this.halfHeight=r}clone(){return new W0(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,i){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,r=(i-this.y)/this.halfHeight;return s*=s,r*=r,s+r<=1}strokeContains(e,i,s,r=.5){const{halfWidth:n,halfHeight:o}=this;if(n<=0||o<=0)return!1;const a=s*(1-r),l=s-a,u=n-l,c=o-l,h=n+a,f=o+a,d=e-this.x,p=i-this.y,m=d*d/(u*u)+p*p/(c*c),g=d*d/(h*h)+p*p/(f*f);return m>1&&g<=1}getBounds(e){return e||(e=new Se),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function VD(t,e,i,s,r,n){const o=t-i,a=e-s,l=r-i,u=n-s,c=o*l+a*u,h=l*l+u*u;let f=-1;h!==0&&(f=c/h);let d,p;f<0?(d=i,p=s):f>1?(d=r,p=n):(d=i+f*l,p=s+f*u);const m=t-d,g=e-p;return m*m+g*g}let $D,qD;class ro{constructor(...e){this.type="polygon";let i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){const s=[];for(let r=0,n=i.length;r<n;r++)s.push(i[r].x,i[r].y);i=s}this.points=i,this.closePath=!0}isClockwise(){let e=0;const i=this.points,s=i.length;for(let r=0;r<s;r+=2){const n=i[r],o=i[r+1],a=i[(r+2)%s],l=i[(r+3)%s];e+=(a-n)*(l+o)}return e<0}containsPolygon(e){const i=this.getBounds($D),s=e.getBounds(qD);if(!i.containsRect(s))return!1;const r=e.points;for(let n=0;n<r.length;n+=2){const o=r[n],a=r[n+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),i=new ro(e);return i.closePath=this.closePath,i}contains(e,i){let s=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],l=this.points[n*2+1],u=this.points[o*2],c=this.points[o*2+1];l>i!=c>i&&e<(u-a)*((i-l)/(c-l))+a&&(s=!s)}return s}strokeContains(e,i,s,r=.5){const n=s*s,o=n*(1-r),a=n-o,{points:l}=this,u=l.length-(this.closePath?0:2);for(let c=0;c<u;c+=2){const h=l[c],f=l[c+1],d=l[(c+2)%l.length],p=l[(c+3)%l.length],m=VD(e,i,h,f,d,p),g=Math.sign((d-h)*(i-f)-(p-f)*(e-h));if(m<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new Se);const i=this.points;let s=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,l=i.length;a<l;a+=2){const u=i[a],c=i[a+1];s=u<s?u:s,r=u>r?u:r,n=c<n?c:n,o=c>o?c:o}return e.x=s,e.width=r-s,e.y=n,e.height=o-n,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,i)=>`${e}, ${i}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return ve("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return ve("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const ga=(t,e,i,s,r,n,o)=>{const a=t-i,l=e-s,u=Math.sqrt(a*a+l*l);return u>=r-n&&u<=r+o};class V0{constructor(e=0,i=0,s=0,r=0,n=20){this.type="roundedRectangle",this.x=e,this.y=i,this.width=s,this.height=r,this.radius=n}getBounds(e){return e||(e=new Se),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new V0(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,i){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+s&&i<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let r=e-(this.x+s),n=i-(this.y+s);const o=s*s;if(r*r+n*n<=o||(r=e-(this.x+this.width-s),r*r+n*n<=o)||(n=i-(this.y+this.height-s),r*r+n*n<=o)||(r=e-(this.x+s),r*r+n*n<=o))return!0}return!1}strokeContains(e,i,s,r=.5){const{x:n,y:o,width:a,height:l,radius:u}=this,c=s*(1-r),h=s-c,f=n+u,d=o+u,p=a-u*2,m=l-u*2,g=n+a,y=o+l;return(e>=n-c&&e<=n+h||e>=g-h&&e<=g+c)&&i>=d&&i<=d+m||(i>=o-c&&i<=o+h||i>=y-h&&i<=y+c)&&e>=f&&e<=f+p?!0:e<f&&i<d&&ga(e,i,f,d,u,h,c)||e>g-u&&i<d&&ga(e,i,g-u,d,u,h,c)||e>g-u&&i>y-u&&ga(e,i,g-u,y-u,u,h,c)||e<f&&i>y-u&&ga(e,i,f,y-u,u,h,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const _S={};function YD(t,e,i){let s=2166136261;for(let r=0;r<e;r++)s^=t[r].uid,s=Math.imul(s,16777619),s>>>=0;return _S[s]||XD(t,e,s,i)}function XD(t,e,i,s){const r={};let n=0;for(let a=0;a<s;a++){const l=a<e?t[a]:xe.EMPTY.source;r[n++]=l.source,r[n++]=l.style}const o=new Ga(r);return _S[i]=o,o}class _x{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function wx(t,e){const i=t.byteLength/8|0,s=new Float64Array(t,0,i);new Float64Array(e,0,i).set(s);const n=t.byteLength-i*8;if(n>0){const o=new Uint8Array(t,i*8,n);new Uint8Array(e,i*8,n).set(o)}}const jD={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var KD=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(KD||{});function Sx(t,e){return e.alphaMode==="no-premultiply-alpha"&&jD[t]||t}const ZD=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function JD(t){let e="";for(let i=0;i<t;++i)i>0&&(e+=`
else `),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}function QD(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=ZD.replace(/%forloop%/gi,JD(t));if(e.shaderSource(i,s),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(i)}return t}let Pr=null;function e8(){if(Pr)return Pr;const t=eS();return Pr=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Pr=QD(Pr,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Pr}class t8{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const i=this.textures[e];this.textures[e]=null,this.ids[i.uid]=null}this.count=0}}class i8{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new t8,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const no=[];let xl=0;zo.register({clear:()=>{if(no.length>0)for(const t of no)t&&t.destroy();no.length=0,xl=0}});function Cx(){return xl>0?no[--xl]:new i8}function Tx(t){no[xl++]=t}let Mn=0;const wS=class SS{constructor(e){this.uid=tt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...SS.defaultOptions,...e},e.maxTextures||(ve("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=e8());const{maxTextures:i,attributesInitialSize:s,indicesInitialSize:r}=e;this.attributeBuffer=new _x(s*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=i}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Tx(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,i){const s=e._batch.textures.ids[i._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=i,!0)}updateElement(e){this.dirty=!0;const i=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,i.float32View,i.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,i.float32View,i.uint32View,e._attributeStart,e._textureId)}break(e){const i=this._elements;if(!i[this.elementStart])return;let s=Cx(),r=s.textures;r.clear();const n=i[this.elementStart];let o=Sx(n.blendMode,n.texture._source),a=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,u=this.attributeBuffer.uint32View,c=this.indexBuffer;let h=this._batchIndexSize,f=this._batchIndexStart,d="startBatch";const p=this.maxTextures;for(let m=this.elementStart;m<this.elementSize;++m){const g=i[m];i[m]=null;const b=g.texture._source,v=Sx(g.blendMode,b),x=o!==v||a!==g.topology;if(b._batchTick===Mn&&!x){g._textureId=b._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,u,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,u,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=s;continue}b._batchTick=Mn,(r.count>=p||x)&&(this._finishBatch(s,f,h-f,r,o,a,e,d),d="renderBatch",f=h,o=v,a=g.topology,s=Cx(),r=s.textures,r.clear(),++Mn),g._textureId=b._textureBindLocation=r.count,r.ids[b.uid]=r.count,r.textures[r.count++]=b,g._batch=s,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,u,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,u,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(s,f,h-f,r,o,a,e,d),f=h,++Mn),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=h}_finishBatch(e,i,s,r,n,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=r,e.blendMode=n,e.topology=o,e.start=i,e.size=s,++Mn,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const i=Math.max(e,this.attributeBuffer.size*2),s=new _x(i);wx(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const i=this.indexBuffer;let s=Math.max(e,i.length*1.5);s+=s%2;const r=s>65535?new Uint32Array(s):new Uint16Array(s);if(r.BYTES_PER_ELEMENT!==i.BYTES_PER_ELEMENT)for(let n=0;n<i.length;n++)r[n]=i[n];else wx(i.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(e,i,s){e[i]=s+0,e[i+1]=s+1,e[i+2]=s+2,e[i+3]=s+0,e[i+4]=s+2,e[i+5]=s+3}packIndex(e,i,s,r){const n=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let u=0;u<o;u++)i[s++]=r+n[u+a]-l}destroy(e={}){if(this.batches!==null){for(let i=0;i<this.batches.length;i++)Tx(this.batches[i]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&(this.shader?.destroy(),this.shader=null);for(let i=0;i<this._elements.length;i++)this._elements[i]&&(this._elements[i]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};wS.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let s8=wS;var Ot=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(Ot||{});class Co extends Ti{constructor(e){let{data:i,size:s}=e;const{usage:r,label:n,shrinkToFit:o}=e;super(),this.uid=tt("buffer"),this._resourceType="buffer",this._resourceId=tt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,i instanceof Array&&(i=new Float32Array(i)),this._data=i,s??(s=i?.byteLength);const a=!!i;this.descriptor={size:s,usage:r,mappedAtCreation:a,label:n},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Ot.STATIC)}set static(e){e?this.descriptor.usage|=Ot.STATIC:this.descriptor.usage&=~Ot.STATIC}setDataWithSize(e,i,s){if(this._updateID++,this._updateSize=i*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const r=this._data;if(this._data=e,this._dataInt32=null,!r||r.length!==e.length){!this.shrinkToFit&&r&&e.byteLength<r.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=tt("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function CS(t,e){if(!(t instanceof Co)){let i=e?Ot.INDEX:Ot.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),i=Ot.INDEX|Ot.COPY_DST):(t=new Float32Array(t),i=Ot.VERTEX|Ot.COPY_DST)),t=new Co({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:i})}return t}function r8(t,e,i){const s=t.getAttribute(e);if(!s)return i.minX=0,i.minY=0,i.maxX=0,i.maxY=0,i;const r=s.buffer.data;let n=1/0,o=1/0,a=-1/0,l=-1/0;const u=r.BYTES_PER_ELEMENT,c=(s.offset||0)/u,h=(s.stride||8)/u;for(let f=c;f<r.length;f+=h){const d=r[f],p=r[f+1];d>a&&(a=d),p>l&&(l=p),d<n&&(n=d),p<o&&(o=p)}return i.minX=n,i.minY=o,i.maxX=a,i.maxY=l,i}function n8(t){return(t instanceof Co||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=CS(t.buffer,!1),t}class o8 extends Ti{constructor(e={}){super(),this.uid=tt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new wi,this._boundsDirty=!0;const{attributes:i,indexBuffer:s,topology:r}=e;if(this.buffers=[],this.attributes={},i)for(const n in i)this.addAttribute(n,i[n]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const i=this.attributes[e];return i.buffer.data.length/(i.stride/4||i.size)}return 0}addAttribute(e,i){const s=n8(i);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=CS(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,r8(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(i=>i.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const a8=new Float32Array(1),l8=new Uint32Array(1);class c8 extends o8{constructor(){const i=new Co({data:a8,label:"attribute-batch-buffer",usage:Ot.VERTEX|Ot.COPY_DST,shrinkToFit:!1}),s=new Co({data:l8,label:"index-batch-buffer",usage:Ot.INDEX|Ot.COPY_DST,shrinkToFit:!1}),r=24;super({attributes:{aPosition:{buffer:i,format:"float32x2",stride:r,offset:0},aUV:{buffer:i,format:"float32x2",stride:r,offset:8},aColor:{buffer:i,format:"unorm8x4",stride:r,offset:16},aTextureIdAndRound:{buffer:i,format:"uint16x2",stride:r,offset:20}},indexBuffer:s})}}function kx(t,e,i){if(t)for(const s in t){const r=s.toLocaleLowerCase(),n=e[r];if(n){let o=t[s];s==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),i&&n.push(`//----${i}----//`),n.push(o)}else gt(`${s} placement hook does not exist in shader`)}}const u8=/\{\{(.*?)\}\}/g;function Ax(t){const e={};return(t.match(u8)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function Ix(t,e){let i;const s=/@in\s+([^;]+);/g;for(;(i=s.exec(t))!==null;)e.push(i[1])}function Px(t,e,i=!1){const s=[];Ix(e,s),t.forEach(a=>{a.header&&Ix(a.header,s)});const r=s;i&&r.sort();const n=r.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${n}
`),o}function Ex(t,e){let i;const s=/@out\s+([^;]+);/g;for(;(i=s.exec(t))!==null;)e.push(i[1])}function h8(t){const i=/\b(\w+)\s*:/g.exec(t);return i?i[1]:""}function d8(t){const e=/@.*?\s+/g;return t.replace(e,"")}function f8(t,e){const i=[];Ex(e,i),t.forEach(l=>{l.header&&Ex(l.header,i)});let s=0;const r=i.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),n=i.sort().map(l=>`       var ${d8(l)};`).join(`
`),o=`return VSOutput(
            ${i.sort().map(l=>` ${h8(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${r}
`),a=a.replace("{{start}}",`
${n}
`),a=a.replace("{{return}}",`
${o}
`),a}function Mx(t,e){let i=t;for(const s in e){const r=e[s];r.join(`
`).length?i=i.replace(`{{${s}}}`,`//-----${s} START-----//
${r.join(`
`)}
//----${s} FINISH----//`):i=i.replace(`{{${s}}}`,"")}return i}const Es=Object.create(null),mm=new Map;let p8=0;function m8({template:t,bits:e}){const i=TS(t,e);if(Es[i])return Es[i];const{vertex:s,fragment:r}=y8(t,e);return Es[i]=kS(s,r,e),Es[i]}function g8({template:t,bits:e}){const i=TS(t,e);return Es[i]||(Es[i]=kS(t.vertex,t.fragment,e)),Es[i]}function y8(t,e){const i=e.map(o=>o.vertex).filter(o=>!!o),s=e.map(o=>o.fragment).filter(o=>!!o);let r=Px(i,t.vertex,!0);r=f8(i,r);const n=Px(s,t.fragment,!0);return{vertex:r,fragment:n}}function TS(t,e){return e.map(i=>(mm.has(i)||mm.set(i,p8++),mm.get(i))).sort((i,s)=>i-s).join("-")+t.vertex+t.fragment}function kS(t,e,i){const s=Ax(t),r=Ax(e);return i.forEach(n=>{kx(n.vertex,s,n.name),kx(n.fragment,r,n.name)}),{vertex:Mx(t,s),fragment:Mx(e,r)}}const v8=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,x8=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,b8=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,_8=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,w8={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},S8={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function C8({bits:t,name:e}){const i=m8({template:{fragment:x8,vertex:v8},bits:[w8,...t]});return gn.from({name:e,vertex:{source:i.vertex,entryPoint:"main"},fragment:{source:i.fragment,entryPoint:"main"}})}function T8({bits:t,name:e}){return new mn({name:e,...g8({template:{vertex:b8,fragment:_8},bits:[S8,...t]})})}const k8={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},A8={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},gm={};function I8(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let i=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${i++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${i++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function P8(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let i=0;i<t;i++)i===t-1?e.push("  default:{"):e.push(`  case ${i}:{`),e.push(`      outColor = textureSampleGrad(textureSource${i+1}, textureSampler${i+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function E8(t){return gm[t]||(gm[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${I8(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${P8(t)}
            `}}),gm[t]}const ym={};function M8(t){const e=[];for(let i=0;i<t;i++)i>0&&e.push("else"),i<t-1&&e.push(`if(vTextureId < ${i}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${i}], vUV);`),e.push("}");return e.join(`
`)}function F8(t){return ym[t]||(ym[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${M8(t)}
            `}}),ym[t]}const R8={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},z8={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Fx={};function U8(t){let e=Fx[t];if(e)return e;const i=new Int32Array(t);for(let s=0;s<t;s++)i[s]=s;return e=Fx[t]=new nS({uTextures:{value:i,type:"i32",size:t}},{isStatic:!0}),e}class Rx extends sc{constructor(e){const i=T8({name:"batch",bits:[A8,F8(e),z8]}),s=C8({name:"batch",bits:[k8,E8(e),R8]});super({glProgram:i,gpuProgram:s,resources:{batchSamplers:U8(e)}}),this.maxTextures=e}}let Fn=null;const AS=class IS extends s8{constructor(e){super(e),this.geometry=new c8,this.name=IS.extension.name,this.vertexSize=6,Fn??(Fn=new Rx(e.maxTextures)),this.shader=Fn}packAttributes(e,i,s,r,n){const o=n<<16|e.roundPixels&65535,a=e.transform,l=a.a,u=a.b,c=a.c,h=a.d,f=a.tx,d=a.ty,{positions:p,uvs:m}=e,g=e.color,y=e.attributeOffset,b=y+e.attributeSize;for(let v=y;v<b;v++){const x=v*2,_=p[x],S=p[x+1];i[r++]=l*_+c*S+f,i[r++]=h*S+u*_+d,i[r++]=m[x],i[r++]=m[x+1],s[r++]=g,s[r++]=o}}packQuadAttributes(e,i,s,r,n){const o=e.texture,a=e.transform,l=a.a,u=a.b,c=a.c,h=a.d,f=a.tx,d=a.ty,p=e.bounds,m=p.maxX,g=p.minX,y=p.maxY,b=p.minY,v=o.uvs,x=e.color,_=n<<16|e.roundPixels&65535;i[r+0]=l*g+c*b+f,i[r+1]=h*b+u*g+d,i[r+2]=v.x0,i[r+3]=v.y0,s[r+4]=x,s[r+5]=_,i[r+6]=l*m+c*b+f,i[r+7]=h*b+u*m+d,i[r+8]=v.x1,i[r+9]=v.y1,s[r+10]=x,s[r+11]=_,i[r+12]=l*m+c*y+f,i[r+13]=h*y+u*m+d,i[r+14]=v.x2,i[r+15]=v.y2,s[r+16]=x,s[r+17]=_,i[r+18]=l*g+c*y+f,i[r+19]=h*y+u*g+d,i[r+20]=v.x3,i[r+21]=v.y3,s[r+22]=x,s[r+23]=_}_updateMaxTextures(e){this.shader.maxTextures!==e&&(Fn=new Rx(e),this.shader=Fn)}destroy(){this.shader=null,super.destroy()}};AS.extension={type:[Ge.Batcher],name:"default"};let B8=AS;function O8(t,e,i,s,r,n,o,a=null){let l=0;i*=e,r*=n;const u=a.a,c=a.b,h=a.c,f=a.d,d=a.tx,p=a.ty;for(;l<o;){const m=t[i],g=t[i+1];s[r]=u*m+h*g+d,s[r+1]=c*m+f*g+p,r+=n,i+=e,l++}}function D8(t,e,i,s){let r=0;for(e*=i;r<s;)t[e]=0,t[e+1]=0,e+=i,r++}function PS(t,e,i,s,r){const n=e.a,o=e.b,a=e.c,l=e.d,u=e.tx,c=e.ty;i||(i=0),s||(s=2),r||(r=t.length/s-i);let h=i*s;for(let f=0;f<r;f++){const d=t[h],p=t[h+1];t[h]=n*d+a*p+u,t[h+1]=o*d+l*p+c,h+=s}}const L8=new Ie;class ES{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,i=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?z2(i,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):i+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||L8}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const To={extension:{type:Ge.ShapeBuilder,name:"circle"},build(t,e){let i,s,r,n,o,a;if(t.type==="circle"){const x=t;if(o=a=x.radius,o<=0)return!1;i=x.x,s=x.y,r=n=0}else if(t.type==="ellipse"){const x=t;if(o=x.halfWidth,a=x.halfHeight,o<=0||a<=0)return!1;i=x.x,s=x.y,r=n=0}else{const x=t,_=x.width/2,S=x.height/2;i=x.x+_,s=x.y+S,o=a=Math.max(0,Math.min(x.radius,Math.min(_,S))),r=_-o,n=S-a}if(r<0||n<0)return!1;const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(r?4:0)+(n?4:0);if(u===0)return!1;if(l===0)return e[0]=e[6]=i+r,e[1]=e[3]=s+n,e[2]=e[4]=i-r,e[5]=e[7]=s-n,!0;let c=0,h=l*4+(r?2:0)+2,f=h,d=u,p=r+o,m=n,g=i+p,y=i-p,b=s+m;if(e[c++]=g,e[c++]=b,e[--h]=b,e[--h]=y,n){const x=s-m;e[f++]=y,e[f++]=x,e[--d]=x,e[--d]=g}for(let x=1;x<l;x++){const _=Math.PI/2*(x/l),S=r+Math.cos(_)*o,T=n+Math.sin(_)*a,A=i+S,w=i-S,k=s+T,F=s-T;e[c++]=A,e[c++]=k,e[--h]=k,e[--h]=w,e[f++]=w,e[f++]=F,e[--d]=F,e[--d]=A}p=r,m=n+a,g=i+p,y=i-p,b=s+m;const v=s-m;return e[c++]=g,e[c++]=b,e[--d]=v,e[--d]=g,r&&(e[c++]=y,e[c++]=b,e[--d]=v,e[--d]=y),!0},triangulate(t,e,i,s,r,n){if(t.length===0)return;let o=0,a=0;for(let c=0;c<t.length;c+=2)o+=t[c],a+=t[c+1];o/=t.length/2,a/=t.length/2;let l=s;e[l*i]=o,e[l*i+1]=a;const u=l++;for(let c=0;c<t.length;c+=2)e[l*i]=t[c],e[l*i+1]=t[c+1],c>0&&(r[n++]=l,r[n++]=u,r[n++]=l-1),l++;r[n++]=u+1,r[n++]=u,r[n++]=l-1}},N8={...To,extension:{...To.extension,name:"ellipse"}},H8={...To,extension:{...To.extension,name:"roundedRectangle"}},MS=1e-4,zx=1e-4;function G8(t){const e=t.length;if(e<6)return 1;let i=0;for(let s=0,r=t[e-2],n=t[e-1];s<e;s+=2){const o=t[s],a=t[s+1];i+=(o-r)*(a+n),r=o,n=a}return i<0?-1:1}function Ux(t,e,i,s,r,n,o,a){const l=t-i*r,u=e-s*r,c=t+i*n,h=e+s*n;let f,d;o?(f=s,d=-i):(f=-s,d=i);const p=l+f,m=u+d,g=c+f,y=h+d;return a.push(p,m),a.push(g,y),2}function Zs(t,e,i,s,r,n,o,a){const l=i-t,u=s-e;let c=Math.atan2(l,u),h=Math.atan2(r-t,n-e);a&&c<h?c+=Math.PI*2:!a&&c>h&&(h+=Math.PI*2);let f=c;const d=h-c,p=Math.abs(d),m=Math.sqrt(l*l+u*u),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=d/g;if(f+=y,a){o.push(t,e),o.push(i,s);for(let b=1,v=f;b<g;b++,v+=y)o.push(t,e),o.push(t+Math.sin(v)*m,e+Math.cos(v)*m);o.push(t,e),o.push(r,n)}else{o.push(i,s),o.push(t,e);for(let b=1,v=f;b<g;b++,v+=y)o.push(t+Math.sin(v)*m,e+Math.cos(v)*m),o.push(t,e);o.push(r,n),o.push(t,e)}return g*2}function W8(t,e,i,s,r,n){const o=MS;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let U=G8(t);l=(l-.5)*U+.5}const u=new Ae(t[0],t[1]),c=new Ae(t[t.length-2],t[t.length-1]),h=s,f=Math.abs(u.x-c.x)<o&&Math.abs(u.y-c.y)<o;if(h){t=t.slice(),f&&(t.pop(),t.pop(),c.set(t[t.length-2],t[t.length-1]));const U=(u.x+c.x)*.5,Z=(c.y+u.y)*.5;t.unshift(U,Z),t.push(U,Z)}const d=r,p=t.length/2;let m=t.length;const g=d.length/2,y=a.width/2,b=y*y,v=a.miterLimit*a.miterLimit;let x=t[0],_=t[1],S=t[2],T=t[3],A=0,w=0,k=-(_-T),F=x-S,O=0,V=0,W=Math.sqrt(k*k+F*F);k/=W,F/=W,k*=y,F*=y;const ie=l,R=(1-ie)*2,I=ie*2;h||(a.cap==="round"?m+=Zs(x-k*(R-I)*.5,_-F*(R-I)*.5,x-k*R,_-F*R,x+k*I,_+F*I,d,!0)+2:a.cap==="square"&&(m+=Ux(x,_,k,F,R,I,!0,d))),d.push(x-k*R,_-F*R),d.push(x+k*I,_+F*I);for(let U=1;U<p-1;++U){x=t[(U-1)*2],_=t[(U-1)*2+1],S=t[U*2],T=t[U*2+1],A=t[(U+1)*2],w=t[(U+1)*2+1],k=-(_-T),F=x-S,W=Math.sqrt(k*k+F*F),k/=W,F/=W,k*=y,F*=y,O=-(T-w),V=S-A,W=Math.sqrt(O*O+V*V),O/=W,V/=W,O*=y,V*=y;const Z=S-x,se=_-T,te=S-A,q=w-T,he=Z*te+se*q,J=se*te-q*Z,j=J<0;if(Math.abs(J)<.001*Math.abs(he)){d.push(S-k*R,T-F*R),d.push(S+k*I,T+F*I),he>=0&&(a.join==="round"?m+=Zs(S,T,S-k*R,T-F*R,S-O*R,T-V*R,d,!1)+4:m+=2,d.push(S-O*I,T-V*I),d.push(S+O*R,T+V*R));continue}const ce=(-k+x)*(-F+T)-(-k+S)*(-F+_),we=(-O+A)*(-V+T)-(-O+S)*(-V+w),ke=(Z*we-te*ce)/J,Ue=(q*ce-se*we)/J,Xe=(ke-S)*(ke-S)+(Ue-T)*(Ue-T),Ee=S+(ke-S)*R,C=T+(Ue-T)*R,P=S-(ke-S)*I,z=T-(Ue-T)*I,H=Math.min(Z*Z+se*se,te*te+q*q),D=j?R:I,L=H+D*D*b;Xe<=L?a.join==="bevel"||Xe/b>v?(j?(d.push(Ee,C),d.push(S+k*I,T+F*I),d.push(Ee,C),d.push(S+O*I,T+V*I)):(d.push(S-k*R,T-F*R),d.push(P,z),d.push(S-O*R,T-V*R),d.push(P,z)),m+=2):a.join==="round"?j?(d.push(Ee,C),d.push(S+k*I,T+F*I),m+=Zs(S,T,S+k*I,T+F*I,S+O*I,T+V*I,d,!0)+4,d.push(Ee,C),d.push(S+O*I,T+V*I)):(d.push(S-k*R,T-F*R),d.push(P,z),m+=Zs(S,T,S-k*R,T-F*R,S-O*R,T-V*R,d,!1)+4,d.push(S-O*R,T-V*R),d.push(P,z)):(d.push(Ee,C),d.push(P,z)):(d.push(S-k*R,T-F*R),d.push(S+k*I,T+F*I),a.join==="round"?j?m+=Zs(S,T,S+k*I,T+F*I,S+O*I,T+V*I,d,!0)+2:m+=Zs(S,T,S-k*R,T-F*R,S-O*R,T-V*R,d,!1)+2:a.join==="miter"&&Xe/b<=v&&(j?(d.push(P,z),d.push(P,z)):(d.push(Ee,C),d.push(Ee,C)),m+=2),d.push(S-O*R,T-V*R),d.push(S+O*I,T+V*I),m+=2)}x=t[(p-2)*2],_=t[(p-2)*2+1],S=t[(p-1)*2],T=t[(p-1)*2+1],k=-(_-T),F=x-S,W=Math.sqrt(k*k+F*F),k/=W,F/=W,k*=y,F*=y,d.push(S-k*R,T-F*R),d.push(S+k*I,T+F*I),h||(a.cap==="round"?m+=Zs(S-k*(R-I)*.5,T-F*(R-I)*.5,S-k*R,T-F*R,S+k*I,T+F*I,d,!1)+2:a.cap==="square"&&(m+=Ux(S,T,k,F,R,I,!1,d)));const E=zx*zx;for(let U=g;U<m+g-2;++U)x=d[U*2],_=d[U*2+1],S=d[(U+1)*2],T=d[(U+1)*2+1],A=d[(U+2)*2],w=d[(U+2)*2+1],!(Math.abs(x*(T-w)+S*(w-_)+A*(_-T))<E)&&n.push(U,U+1,U+2)}function V8(t,e,i,s){const r=MS;if(t.length===0)return;const n=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],u=e||Math.abs(n-a)<r&&Math.abs(o-l)<r,c=i,h=t.length/2,f=c.length/2;for(let d=0;d<h;d++)c.push(t[d*2]),c.push(t[d*2+1]);for(let d=0;d<h-1;d++)s.push(f+d,f+d+1);u&&s.push(f+h-1,f)}function FS(t,e,i,s,r,n,o){const a=PD(t,e,2);if(!a)return;for(let u=0;u<a.length;u+=3)n[o++]=a[u]+r,n[o++]=a[u+1]+r,n[o++]=a[u+2]+r;let l=r*s;for(let u=0;u<t.length;u+=2)i[l]=t[u],i[l+1]=t[u+1],l+=s}const $8=[],q8={extension:{type:Ge.ShapeBuilder,name:"polygon"},build(t,e){for(let i=0;i<t.points.length;i++)e[i]=t.points[i];return!0},triangulate(t,e,i,s,r,n){FS(t,$8,e,i,s,r,n)}},Y8={extension:{type:Ge.ShapeBuilder,name:"rectangle"},build(t,e){const i=t,s=i.x,r=i.y,n=i.width,o=i.height;return n>0&&o>0?(e[0]=s,e[1]=r,e[2]=s+n,e[3]=r,e[4]=s+n,e[5]=r+o,e[6]=s,e[7]=r+o,!0):!1},triangulate(t,e,i,s,r,n){let o=0;s*=i,e[s+o]=t[0],e[s+o+1]=t[1],o+=i,e[s+o]=t[2],e[s+o+1]=t[3],o+=i,e[s+o]=t[6],e[s+o+1]=t[7],o+=i,e[s+o]=t[4],e[s+o+1]=t[5],o+=i;const a=s/i;r[n++]=a,r[n++]=a+1,r[n++]=a+2,r[n++]=a+1,r[n++]=a+3,r[n++]=a+2}},X8={extension:{type:Ge.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,!0},triangulate(t,e,i,s,r,n){let o=0;s*=i,e[s+o]=t[0],e[s+o+1]=t[1],o+=i,e[s+o]=t[2],e[s+o+1]=t[3],o+=i,e[s+o]=t[4],e[s+o+1]=t[5];const a=s/i;r[n++]=a,r[n++]=a+1,r[n++]=a+2}},j8=new Ie,K8=new Se;function Z8(t,e,i,s){const r=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const o=i.getBounds(K8);e.width&&o.pad(e.width);const{x:a,y:l}=o,u=1/o.width,c=1/o.height,h=-a*u,f=-l*c,d=r.a,p=r.b,m=r.c,g=r.d;r.a*=u,r.b*=u,r.c*=c,r.d*=c,r.tx=h*d+f*m+r.tx,r.ty=h*p+f*g+r.ty}else r.translate(e.texture.frame.x,e.texture.frame.y),r.scale(1/e.texture.source.width,1/e.texture.source.height);const n=e.texture.source.style;return!(e.fill instanceof ui)&&n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update()),s&&r.append(j8.copyFrom(s).invert()),r}const ac={};di.handleByMap(Ge.ShapeBuilder,ac);di.add(Y8,q8,X8,To,N8,H8);const J8=new Se,Q8=new Ie;function e6(t,e){const{geometryData:i,batches:s}=e;s.length=0,i.indices.length=0,i.vertices.length=0,i.uvs.length=0;for(let r=0;r<t.instructions.length;r++){const n=t.instructions[r];if(n.action==="texture")t6(n.data,s,i);else if(n.action==="fill"||n.action==="stroke"){const o=n.action==="stroke",a=n.data.path.shapePath,l=n.data.style,u=n.data.hole;o&&u&&Bx(u.shapePath,l,!0,s,i),u&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=u.shapePath.shapePrimitives),Bx(a,l,o,s,i)}}}function t6(t,e,i){const s=[],r=ac.rectangle,n=J8;n.x=t.dx,n.y=t.dy,n.width=t.dw,n.height=t.dh;const o=t.transform;if(!r.build(n,s))return;const{vertices:a,uvs:l,indices:u}=i,c=u.length,h=a.length/2;o&&PS(s,o),r.triangulate(s,a,2,h,u,c);const f=t.image,d=f.uvs;l.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const p=ai.get(ES);p.indexOffset=c,p.indexSize=u.length-c,p.attributeOffset=h,p.attributeSize=a.length/2-h,p.baseColor=t.style,p.alpha=t.alpha,p.texture=f,p.geometryData=i,e.push(p)}function Bx(t,e,i,s,r){const{vertices:n,uvs:o,indices:a}=r;t.shapePrimitives.forEach(({shape:l,transform:u,holes:c})=>{const h=[],f=ac[l.type];if(!f.build(l,h))return;const d=a.length,p=n.length/2;let m="triangle-list";if(u&&PS(h,u),i){const v=l.closePath??!0,x=e;x.pixelLine?(V8(h,v,n,a),m="line-list"):W8(h,x,!1,v,n,a)}else if(c){const v=[],x=h.slice();i6(c).forEach(S=>{v.push(x.length/2),x.push(...S)}),FS(x,v,n,2,p,a,d)}else f.triangulate(h,n,2,p,a,d);const g=o.length/2,y=e.texture;if(y!==xe.WHITE){const v=Z8(Q8,e,l,u);O8(n,2,p,o,g,2,n.length/2-p,v)}else D8(o,g,2,n.length/2-p);const b=ai.get(ES);b.indexOffset=d,b.indexSize=a.length-d,b.attributeOffset=p,b.attributeSize=n.length/2-p,b.baseColor=e.color,b.alpha=e.alpha,b.texture=y,b.geometryData=r,b.topology=m,s.push(b)})}function i6(t){const e=[];for(let i=0;i<t.length;i++){const s=t[i].shape,r=[];ac[s.type].build(s,r)&&e.push(r)}return e}class s6{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class r6{constructor(){this.instructions=new D2}init(e){const i=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(i):this.batcher=new B8({maxTextures:i}),this.instructions.reset()}get geometry(){return ve(KB,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const $0=class Eg{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){Eg.defaultOptions.bezierSmoothness=e?.bezierSmoothness??Eg.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let i=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){i?this._cleanGraphicsContextData(e):i=this._initContext(e),e6(e,i);const s=e.batchMode;e.customShader||s==="no-batch"?i.isBatchable=!1:s==="auto"?i.isBatchable=i.geometryData.vertices.length<400:i.isBatchable=!0,e.dirty=!1}return i}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const i=ai.get(r6,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:s,geometryData:r}=this._gpuContextHash[e.uid],n=r.vertices.length,o=r.indices.length;for(let c=0;c<s.length;c++)s[c].applyTransform=!1;const a=i.batcher;a.ensureAttributeBuffer(n),a.ensureIndexBuffer(o),a.begin();for(let c=0;c<s.length;c++){const h=s[c];a.add(h)}a.finish(i.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const u=a.batches;for(let c=0;c<u.length;c++){const h=u[c];h.bindGroup=YD(h.textures.textures,h.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=i,i}_initContext(e){const i=new s6;return i.context=e,this._gpuContextHash[e.uid]=i,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const i=this._gpuContextHash[e.uid];i.isBatchable||this._graphicsDataContextHash[e.uid]&&(ai.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),i.batches&&i.batches.forEach(s=>{ai.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};$0.extension={type:[Ge.WebGLSystem,Ge.WebGPUSystem,Ge.CanvasSystem],name:"graphicsContext"};$0.defaultOptions={bezierSmoothness:.5};let RS=$0;const n6=8,ya=11920929e-14,o6=1;function zS(t,e,i,s,r,n,o,a,l,u){const h=Math.min(.99,Math.max(0,u??RS.defaultOptions.bezierSmoothness));let f=(o6-h)/1;return f*=f,a6(e,i,s,r,n,o,a,l,t,f),t}function a6(t,e,i,s,r,n,o,a,l,u){Mg(t,e,i,s,r,n,o,a,l,u,0),l.push(o,a)}function Mg(t,e,i,s,r,n,o,a,l,u,c){if(c>n6)return;const h=(t+i)/2,f=(e+s)/2,d=(i+r)/2,p=(s+n)/2,m=(r+o)/2,g=(n+a)/2,y=(h+d)/2,b=(f+p)/2,v=(d+m)/2,x=(p+g)/2,_=(y+v)/2,S=(b+x)/2;if(c>0){let T=o-t,A=a-e;const w=Math.abs((i-o)*A-(s-a)*T),k=Math.abs((r-o)*A-(n-a)*T);if(w>ya&&k>ya){if((w+k)*(w+k)<=u*(T*T+A*A)){l.push(_,S);return}}else if(w>ya){if(w*w<=u*(T*T+A*A)){l.push(_,S);return}}else if(k>ya){if(k*k<=u*(T*T+A*A)){l.push(_,S);return}}else if(T=_-(t+o)/2,A=S-(e+a)/2,T*T+A*A<=u){l.push(_,S);return}}Mg(t,e,h,f,y,b,_,S,l,u,c+1),Mg(_,S,v,x,m,g,o,a,l,u,c+1)}const l6=8,c6=11920929e-14,u6=1;function h6(t,e,i,s,r,n,o,a){const u=Math.min(.99,Math.max(0,a??RS.defaultOptions.bezierSmoothness));let c=(u6-u)/1;return c*=c,d6(e,i,s,r,n,o,t,c),t}function d6(t,e,i,s,r,n,o,a){Fg(o,t,e,i,s,r,n,a,0),o.push(r,n)}function Fg(t,e,i,s,r,n,o,a,l){if(l>l6)return;const u=(e+s)/2,c=(i+r)/2,h=(s+n)/2,f=(r+o)/2,d=(u+h)/2,p=(c+f)/2;let m=n-e,g=o-i;const y=Math.abs((s-n)*g-(r-o)*m);if(y>c6){if(y*y<=a*(m*m+g*g)){t.push(d,p);return}}else if(m=d-(e+n)/2,g=p-(i+o)/2,m*m+g*g<=a){t.push(d,p);return}Fg(t,e,i,u,c,d,p,a,l+1),Fg(t,d,p,h,f,n,o,a,l+1)}function US(t,e,i,s,r,n,o,a){let l=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),a=Math.max(a,3);let u=l/a,c=r;u*=o?-1:1;for(let h=0;h<a+1;h++){const f=Math.cos(c),d=Math.sin(c),p=e+f*s,m=i+d*s;t.push(p,m),c+=u}}function f6(t,e,i,s,r,n){const o=t[t.length-2],l=t[t.length-1]-i,u=o-e,c=r-i,h=s-e,f=Math.abs(l*h-u*c);if(f<1e-8||n===0){(t[t.length-2]!==e||t[t.length-1]!==i)&&t.push(e,i);return}const d=l*l+u*u,p=c*c+h*h,m=l*c+u*h,g=n*Math.sqrt(d)/f,y=n*Math.sqrt(p)/f,b=g*m/d,v=y*m/p,x=g*h+y*u,_=g*c+y*l,S=u*(y+b),T=l*(y+b),A=h*(g+v),w=c*(g+v),k=Math.atan2(T-_,S-x),F=Math.atan2(w-_,A-x);US(t,x+e,_+i,n,k,F,u*c>h*l)}const oo=Math.PI*2,vm={centerX:0,centerY:0,ang1:0,ang2:0},xm=({x:t,y:e},i,s,r,n,o,a,l)=>{t*=i,e*=s;const u=r*t-n*e,c=n*t+r*e;return l.x=u+o,l.y=c+a,l};function p6(t,e){const i=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:i,r=Math.cos(t),n=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:r-n*s,y:n+r*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Ox=(t,e,i,s)=>{const r=t*s-e*i<0?-1:1;let n=t*i+e*s;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},m6=(t,e,i,s,r,n,o,a,l,u,c,h,f)=>{const d=Math.pow(r,2),p=Math.pow(n,2),m=Math.pow(c,2),g=Math.pow(h,2);let y=d*p-d*g-p*m;y<0&&(y=0),y/=d*g+p*m,y=Math.sqrt(y)*(o===a?-1:1);const b=y*r/n*h,v=y*-n/r*c,x=u*b-l*v+(t+i)/2,_=l*b+u*v+(e+s)/2,S=(c-b)/r,T=(h-v)/n,A=(-c-b)/r,w=(-h-v)/n,k=Ox(1,0,S,T);let F=Ox(S,T,A,w);a===0&&F>0&&(F-=oo),a===1&&F<0&&(F+=oo),f.centerX=x,f.centerY=_,f.ang1=k,f.ang2=F};function g6(t,e,i,s,r,n,o,a=0,l=0,u=0){if(n===0||o===0)return;const c=Math.sin(a*oo/360),h=Math.cos(a*oo/360),f=h*(e-s)/2+c*(i-r)/2,d=-c*(e-s)/2+h*(i-r)/2;if(f===0&&d===0)return;n=Math.abs(n),o=Math.abs(o);const p=Math.pow(f,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(o,2);p>1&&(n*=Math.sqrt(p),o*=Math.sqrt(p)),m6(e,i,s,r,n,o,l,u,c,h,f,d,vm);let{ang1:m,ang2:g}=vm;const{centerX:y,centerY:b}=vm;let v=Math.abs(g)/(oo/4);Math.abs(1-v)<1e-7&&(v=1);const x=Math.max(Math.ceil(v),1);g/=x;let _=t[t.length-2],S=t[t.length-1];const T={x:0,y:0};for(let A=0;A<x;A++){const w=p6(m,g),{x:k,y:F}=xm(w[0],n,o,h,c,y,b,T),{x:O,y:V}=xm(w[1],n,o,h,c,y,b,T),{x:W,y:ie}=xm(w[2],n,o,h,c,y,b,T);zS(t,_,S,k,F,O,V,W,ie),_=W,S=ie,m+=g}}function y6(t,e,i){const s=(o,a)=>{const l=a.x-o.x,u=a.y-o.y,c=Math.sqrt(l*l+u*u),h=l/c,f=u/c;return{len:c,nx:h,ny:f}},r=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let n=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??i;if(l<=0){r(o,a),n=a;continue}const u=e[(o+1)%e.length],c=s(a,n),h=s(a,u);if(c.len<1e-4||h.len<1e-4){r(o,a),n=a;continue}let f=Math.asin(c.nx*h.ny-c.ny*h.nx),d=1,p=!1;c.nx*h.nx-c.ny*-h.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);const m=f/2;let g,y=Math.abs(Math.cos(m)*l/Math.sin(m));y>Math.min(c.len/2,h.len/2)?(y=Math.min(c.len/2,h.len/2),g=Math.abs(y*Math.sin(m)/Math.cos(m))):g=l;const b=a.x+h.nx*y+-h.ny*g*d,v=a.y+h.ny*y+h.nx*g*d,x=Math.atan2(c.ny,c.nx)+Math.PI/2*d,_=Math.atan2(h.ny,h.nx)-Math.PI/2*d;o===0&&t.moveTo(b+Math.cos(x)*g,v+Math.sin(x)*g),t.arc(b,v,g,x,_,p),n=a}}function v6(t,e,i,s){const r=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),n=(a,l,u)=>({x:a.x+(l.x-a.x)*u,y:a.y+(l.y-a.y)*u}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],u=l.radius??i;if(u<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const c=e[a],h=e[(a+2)%o],f=r(c,l);let d;if(f<1e-4)d=l;else{const g=Math.min(f/2,u);d=n(l,c,g/f)}const p=r(h,l);let m;if(p<1e-4)m=l;else{const g=Math.min(p/2,u);m=n(l,h,g/p)}a===0?t.moveTo(d.x,d.y):t.lineTo(d.x,d.y),t.quadraticCurveTo(l.x,l.y,m.x,m.y,s)}}const x6=new Se;class b6{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new wi,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,i){return this.startPoly(e,i),this}lineTo(e,i){this._ensurePoly();const s=this._currentPoly.points,r=s[s.length-2],n=s[s.length-1];return(r!==e||n!==i)&&s.push(e,i),this}arc(e,i,s,r,n,o){this._ensurePoly(!1);const a=this._currentPoly.points;return US(a,e,i,s,r,n,o),this}arcTo(e,i,s,r,n){this._ensurePoly();const o=this._currentPoly.points;return f6(o,e,i,s,r,n),this}arcToSvg(e,i,s,r,n,o,a){const l=this._currentPoly.points;return g6(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,i,s,r,n),this}bezierCurveTo(e,i,s,r,n,o,a){this._ensurePoly();const l=this._currentPoly;return zS(this._currentPoly.points,l.lastX,l.lastY,e,i,s,r,n,o,a),this}quadraticCurveTo(e,i,s,r,n){this._ensurePoly();const o=this._currentPoly;return h6(this._currentPoly.points,o.lastX,o.lastY,e,i,s,r,n),this}closePath(){return this.endPoly(!0),this}addPath(e,i){this.endPoly(),i&&!i.isIdentity()&&(e=e.clone(!0),e.transform(i));const s=this.shapePrimitives,r=s.length;for(let n=0;n<e.instructions.length;n++){const o=e.instructions[n];this[o.action](...o.data)}if(e.checkForHoles&&s.length-r>1){let n=null;for(let o=r;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const l=a.shape,u=n?.shape;u&&u.containsPolygon(l)?(n.holes||(n.holes=[]),n.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):n=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,i,s,r,n){return this.drawShape(new Se(e,i,s,r),n),this}circle(e,i,s,r){return this.drawShape(new oc(e,i,s),r),this}poly(e,i,s){const r=new ro(e);return r.closePath=i,this.drawShape(r,s),this}regularPoly(e,i,s,r,n=0,o){r=Math.max(r|0,3);const a=-1*Math.PI/2+n,l=Math.PI*2/r,u=[];for(let c=0;c<r;c++){const h=a-c*l;u.push(e+s*Math.cos(h),i+s*Math.sin(h))}return this.poly(u,!0,o),this}roundPoly(e,i,s,r,n,o=0,a){if(r=Math.max(r|0,3),n<=0)return this.regularPoly(e,i,s,r,o);const l=s*Math.sin(Math.PI/r)-.001;n=Math.min(n,l);const u=-1*Math.PI/2+o,c=Math.PI*2/r,h=(r-2)*Math.PI/r/2;for(let f=0;f<r;f++){const d=f*c+u,p=e+s*Math.cos(d),m=i+s*Math.sin(d),g=d+Math.PI+h,y=d-Math.PI-h,b=p+n*Math.cos(g),v=m+n*Math.sin(g),x=p+n*Math.cos(y),_=m+n*Math.sin(y);f===0?this.moveTo(b,v):this.lineTo(b,v),this.quadraticCurveTo(p,m,x,_,a)}return this.closePath()}roundShape(e,i,s=!1,r){return e.length<3?this:(s?v6(this,e,i,r):y6(this,e,i),this.closePath())}filletRect(e,i,s,r,n){if(n===0)return this.rect(e,i,s,r);const o=Math.min(s,r)/2,a=Math.min(o,Math.max(-o,n)),l=e+s,u=i+r,c=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,i+h).arcTo(e+c,i+c,e+h,i,h).lineTo(l-h,i).arcTo(l-c,i+c,l,i+h,h).lineTo(l,u-h).arcTo(l-c,u-c,e+s-h,u,h).lineTo(e+h,u).arcTo(e+c,u-c,e,u-h,h).closePath()}chamferRect(e,i,s,r,n,o){if(n<=0)return this.rect(e,i,s,r);const a=Math.min(n,Math.min(s,r)/2),l=e+s,u=i+r,c=[e+a,i,l-a,i,l,i+a,l,u-a,l-a,u,e+a,u,e,u-a,e,i+a];for(let h=c.length-1;h>=2;h-=2)c[h]===c[h-2]&&c[h-1]===c[h-3]&&c.splice(h-1,2);return this.poly(c,!0,o)}ellipse(e,i,s,r,n){return this.drawShape(new W0(e,i,s,r),n),this}roundRect(e,i,s,r,n,o){return this.drawShape(new V0(e,i,s,r,n),o),this}drawShape(e,i){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:i}),this}startPoly(e,i){let s=this._currentPoly;return s&&this.endPoly(),s=new ro,s.points.push(e,i),this._currentPoly=s,this}endPoly(e=!1){const i=this._currentPoly;return i&&i.points.length>2&&(i.closePath=e,this.shapePrimitives.push({shape:i})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new ro,e)){const i=this.shapePrimitives[this.shapePrimitives.length-1];if(i){let s=i.shape.x,r=i.shape.y;if(i.transform&&!i.transform.isIdentity()){const n=i.transform,o=s;s=n.a*s+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this._currentPoly.points.push(s,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let i=0;i<e.instructions.length;i++){const s=e.instructions[i];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const i=this.shapePrimitives;for(let s=0;s<i.length;s++){const r=i[s],n=r.shape.getBounds(x6);r.transform?e.addRect(n,r.transform):e.addRect(n)}return e}}class es{constructor(e,i=!1){this.instructions=[],this.uid=tt("graphicsPath"),this._dirty=!0,this.checkForHoles=i,typeof e=="string"?WD(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new b6(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,i){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,i]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,i,s,r,n){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(Ae.shared);let l=0,u=0;if(!o||o.action!=="bezierCurveTo")l=a.x,u=a.y;else{l=o.data[2],u=o.data[3];const c=a.x,h=a.y;l=c+(c-l),u=h+(h-u)}return this.instructions.push({action:"bezierCurveTo",data:[l,u,e,i,s,r,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,i,s){const r=this.instructions[this.instructions.length-1],n=this.getLastPoint(Ae.shared);let o=0,a=0;if(!r||r.action!=="quadraticCurveTo")o=n.x,a=n.y;else{o=r.data[0],a=r.data[1];const l=n.x,u=n.y;o=l+(l-o),a=u+(u-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,i,s]}),this._dirty=!0,this}rect(e,i,s,r,n){return this.instructions.push({action:"rect",data:[e,i,s,r,n]}),this._dirty=!0,this}circle(e,i,s,r){return this.instructions.push({action:"circle",data:[e,i,s,r]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,i,s,r,n,o,a){n||(n=r/2);const l=-1*Math.PI/2+o,u=s*2,c=Math.PI*2/u,h=[];for(let f=0;f<u;f++){const d=f%2?n:r,p=f*c+l;h.push(e+d*Math.cos(p),i+d*Math.sin(p))}return this.poly(h,!0,a),this}clone(e=!1){const i=new es;if(i.checkForHoles=this.checkForHoles,!e)i.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s];i.instructions.push({action:r.action,data:r.data.slice()})}return i}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const i=e.a,s=e.b,r=e.c,n=e.d,o=e.tx,a=e.ty;let l=0,u=0,c=0,h=0,f=0,d=0,p=0,m=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],b=y.data;switch(y.action){case"moveTo":case"lineTo":l=b[0],u=b[1],b[0]=i*l+r*u+o,b[1]=s*l+n*u+a;break;case"bezierCurveTo":c=b[0],h=b[1],f=b[2],d=b[3],l=b[4],u=b[5],b[0]=i*c+r*h+o,b[1]=s*c+n*h+a,b[2]=i*f+r*d+o,b[3]=s*f+n*d+a,b[4]=i*l+r*u+o,b[5]=s*l+n*u+a;break;case"quadraticCurveTo":c=b[0],h=b[1],l=b[2],u=b[3],b[0]=i*c+r*h+o,b[1]=s*c+n*h+a,b[2]=i*l+r*u+o,b[3]=s*l+n*u+a;break;case"arcToSvg":l=b[5],u=b[6],p=b[0],m=b[1],b[0]=i*p+r*m,b[1]=s*p+n*m,b[5]=i*l+r*u+o,b[6]=s*l+n*u+a;break;case"circle":b[4]=Rn(b[3],e);break;case"rect":b[4]=Rn(b[4],e);break;case"ellipse":b[8]=Rn(b[8],e);break;case"roundRect":b[5]=Rn(b[5],e);break;case"addPath":b[0].transform(e);break;case"poly":b[2]=Rn(b[2],e);break;default:gt("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let i=this.instructions.length-1,s=this.instructions[i];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(i--,i<0)return e.x=0,e.y=0,e;s=this.instructions[i]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function Rn(t,e){return t?t.prepend(e):e.clone()}function et(t,e,i){const s=t.getAttribute(e);return s?Number(s):i}function _6(t,e){const i=t.querySelectorAll("defs");for(let s=0;s<i.length;s++){const r=i[s];for(let n=0;n<r.children.length;n++){const o=r.children[n];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=w6(o);break;case"radialgradient":e.defs[o.id]=S6();break}}}}function w6(t){const e=et(t,"x1",0),i=et(t,"y1",0),s=et(t,"x2",1),r=et(t,"y2",0),n=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new ui(e,i,s,r,n==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],u=et(l,"offset",0),c=st.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(u,c)}return o}function S6(t){return gt("[SVG Parser] Radial gradients are not yet supported"),new ui(0,0,1,0)}function Dx(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Lx={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function BS(t,e){const i=t.getAttribute("style"),s={},r={},n={strokeStyle:s,fillStyle:r,useFill:!1,useStroke:!1};for(const o in Lx){const a=t.getAttribute(o);a&&Nx(e,n,o,a.trim())}if(i){const o=i.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[u,c]=l.split(":");Lx[u]&&Nx(e,n,u,c.trim())}}return{strokeStyle:n.useStroke?s:null,fillStyle:n.useFill?r:null,useFill:n.useFill,useStroke:n.useStroke}}function Nx(t,e,i,s){switch(i){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const r=Dx(s);e.strokeStyle.fill=t.defs[r]}else e.strokeStyle.color=st.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const r=Dx(s);e.fillStyle.fill=t.defs[r]}else e.fillStyle.color=st.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function C6(t){if(t.length<=2)return!0;const e=t.map(a=>a.area).sort((a,l)=>l-a),[i,s]=e,r=e[e.length-1],n=i/s,o=s/r;return!(n>3&&o<2)}function T6(t){return t.split(/(?=[Mm])/).filter(s=>s.trim().length>0)}function k6(t){const e=t.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const i=e.map(Number),s=[],r=[];for(let c=0;c<i.length;c+=2)c+1<i.length&&(s.push(i[c]),r.push(i[c+1]));if(s.length===0||r.length===0)return 0;const n=Math.min(...s),o=Math.max(...s),a=Math.min(...r),l=Math.max(...r);return(o-n)*(l-a)}function Hx(t,e){const i=new es(t,!1);for(const s of i.instructions)e.instructions.push(s)}function A6(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const i={context:e,defs:{},path:new es};_6(t,i);const s=t.children,{fillStyle:r,strokeStyle:n}=BS(t,i);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&OS(a,i,r,n)}return e}function OS(t,e,i,s){const r=t.children,{fillStyle:n,strokeStyle:o}=BS(t,e);n&&i?i={...i,...n}:n&&(i=n),o&&s?s={...s,...o}:o&&(s=o);const a=!i&&!s;a&&(i={color:0});let l,u,c,h,f,d,p,m,g,y,b,v,x,_,S,T,A;switch(t.nodeName.toLowerCase()){case"path":{_=t.getAttribute("d");const w=t.getAttribute("fill-rule"),k=T6(_),F=w==="evenodd",O=k.length>1;if(F&&O){const W=k.map(R=>({path:R,area:k6(R)}));if(W.sort((R,I)=>I.area-R.area),k.length>3||!C6(W))for(let R=0;R<W.length;R++){const I=W[R],E=R===0;e.context.beginPath();const U=new es(void 0,!0);Hx(I.path,U),e.context.path(U),E?(i&&e.context.fill(i),s&&e.context.stroke(s)):e.context.cut()}else for(let R=0;R<W.length;R++){const I=W[R],E=R%2===1;e.context.beginPath();const U=new es(void 0,!0);Hx(I.path,U),e.context.path(U),E?e.context.cut():(i&&e.context.fill(i),s&&e.context.stroke(s))}}else{const W=w?w==="evenodd":!0;S=new es(_,W),e.context.path(S),i&&e.context.fill(i),s&&e.context.stroke(s)}break}case"circle":p=et(t,"cx",0),m=et(t,"cy",0),g=et(t,"r",0),e.context.ellipse(p,m,g,g),i&&e.context.fill(i),s&&e.context.stroke(s);break;case"rect":l=et(t,"x",0),u=et(t,"y",0),T=et(t,"width",0),A=et(t,"height",0),y=et(t,"rx",0),b=et(t,"ry",0),y||b?e.context.roundRect(l,u,T,A,y||b):e.context.rect(l,u,T,A),i&&e.context.fill(i),s&&e.context.stroke(s);break;case"ellipse":p=et(t,"cx",0),m=et(t,"cy",0),y=et(t,"rx",0),b=et(t,"ry",0),e.context.beginPath(),e.context.ellipse(p,m,y,b),i&&e.context.fill(i),s&&e.context.stroke(s);break;case"line":c=et(t,"x1",0),h=et(t,"y1",0),f=et(t,"x2",0),d=et(t,"y2",0),e.context.beginPath(),e.context.moveTo(c,h),e.context.lineTo(f,d),s&&e.context.stroke(s);break;case"polygon":x=t.getAttribute("points"),v=x.match(/\d+/g).map(w=>parseInt(w,10)),e.context.poly(v,!0),i&&e.context.fill(i),s&&e.context.stroke(s);break;case"polyline":x=t.getAttribute("points"),v=x.match(/\d+/g).map(w=>parseInt(w,10)),e.context.poly(v,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{gt(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(i=null);for(let w=0;w<r.length;w++)OS(r[w],e,i,s)}function I6(t){return st.isColorLike(t)}function Gx(t){return t instanceof nc}function Wx(t){return t instanceof ui}function P6(t){return t instanceof xe}function E6(t,e,i){const s=st.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?i.alpha:s.alpha,t.texture=xe.WHITE,{...i,...t}}function M6(t,e,i){return t.texture=e,{...i,...t}}function Vx(t,e,i){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...i,...t}}function $x(t,e,i){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...i,...t}}function F6(t,e){const i={...e,...t},s=st.shared.setValue(i.color);return i.alpha*=s.alpha,i.color=s.toNumber(),i}function rr(t,e){if(t==null)return null;const i={},s=t;return I6(t)?E6(i,t,e):P6(t)?M6(i,t,e):Gx(t)?Vx(i,t,e):Wx(t)?$x(i,t,e):s.fill&&Gx(s.fill)?Vx(s,s.fill,e):s.fill&&Wx(s.fill)?$x(s,s.fill,e):F6(s,e)}function bl(t,e){const{width:i,alignment:s,miterLimit:r,cap:n,join:o,pixelLine:a,...l}=e,u=rr(t,l);return u?{width:i,alignment:s,miterLimit:r,cap:n,join:o,pixelLine:a,...u}:null}const R6=new Ae,qx=new Ie,q0=class Fi extends Ti{constructor(){super(...arguments),this.uid=tt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new es,this._transform=new Ie,this._fillStyle={...Fi.defaultFillStyle},this._strokeStyle={...Fi.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new wi,this._boundsDirty=!0}clone(){const e=new Fi;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=rr(e,Fi.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=bl(e,Fi.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=rr(e,Fi.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=rr(e,Fi.defaultStrokeStyle),this}texture(e,i,s,r,n,o){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:r||0,dw:n||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:i?st.shared.setValue(i).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new es,this}fill(e,i){let s;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="stroke"?s=r.data.path:s=this._activePath.clone(),s?(e!=null&&(i!==void 0&&typeof e=="number"&&(ve(Ne,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:i}),this._fillStyle=rr(e,Fi.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:i}=this._activePath.getLastPoint(Ae.shared);this._activePath.clear(),this._activePath.moveTo(e,i)}stroke(e){let i;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s?.action==="fill"?i=s.data.path:i=this._activePath.clone(),i?(e!=null&&(this._strokeStyle=bl(e,Fi.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const i=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(i&&(i.action==="stroke"||i.action==="fill"))if(i.data.hole)i.data.hole.addPath(s);else{i.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,i,s,r,n,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*i+a.tx,a.b*e+a.d*i+a.ty,s,r,n,o),this}arcTo(e,i,s,r,n){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*i+o.tx,o.b*e+o.d*i+o.ty,o.a*s+o.c*r+o.tx,o.b*s+o.d*r+o.ty,n),this}arcToSvg(e,i,s,r,n,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,i,s,r,n,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,i,s,r,n,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*i+l.tx,l.b*e+l.d*i+l.ty,l.a*s+l.c*r+l.tx,l.b*s+l.d*r+l.ty,l.a*n+l.c*o+l.tx,l.b*n+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,i,s,r){return this._tick++,this._activePath.ellipse(e,i,s,r,this._transform.clone()),this}circle(e,i,s){return this._tick++,this._activePath.circle(e,i,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,i){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*i+s.tx,s.b*e+s.d*i+s.ty),this}moveTo(e,i){this._tick++;const s=this._transform,r=this._activePath.instructions,n=s.a*e+s.c*i+s.tx,o=s.b*e+s.d*i+s.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=n,r[0].data[1]=o,this):(this._activePath.moveTo(n,o),this)}quadraticCurveTo(e,i,s,r,n){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*i+o.tx,o.b*e+o.d*i+o.ty,o.a*s+o.c*r+o.tx,o.b*s+o.d*r+o.ty,n),this}rect(e,i,s,r){return this._tick++,this._activePath.rect(e,i,s,r,this._transform.clone()),this}roundRect(e,i,s,r,n){return this._tick++,this._activePath.roundRect(e,i,s,r,n,this._transform.clone()),this}poly(e,i){return this._tick++,this._activePath.poly(e,i,this._transform.clone()),this}regularPoly(e,i,s,r,n=0,o){return this._tick++,this._activePath.regularPoly(e,i,s,r,n,o),this}roundPoly(e,i,s,r,n,o){return this._tick++,this._activePath.roundPoly(e,i,s,r,n,o),this}roundShape(e,i,s,r){return this._tick++,this._activePath.roundShape(e,i,s,r),this}filletRect(e,i,s,r,n){return this._tick++,this._activePath.filletRect(e,i,s,r,n),this}chamferRect(e,i,s,r,n,o){return this._tick++,this._activePath.chamferRect(e,i,s,r,n,o),this}star(e,i,s,r,n=0,o=0){return this._tick++,this._activePath.star(e,i,s,r,n,o,this._transform.clone()),this}svg(e){return this._tick++,A6(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,i=e){return this._transform.scale(e,i),this}setTransform(e,i,s,r,n,o){return e instanceof Ie?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,i,s,r,n,o),this)}transform(e,i,s,r,n,o){return e instanceof Ie?(this._transform.append(e),this):(qx.set(e,i,s,r,n,o),this._transform.append(qx),this)}translate(e,i=e){return this._transform.translate(e,i),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let i=0;i<this.instructions.length;i++){const s=this.instructions[i],r=s.action;if(r==="fill"){const n=s.data;e.addBounds(n.path.bounds)}else if(r==="texture"){const n=s.data;e.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(r==="stroke"){const n=s.data,o=n.style.alignment,a=n.style.width*(1-o),l=n.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const i=this.instructions;let s=!1;for(let r=0;r<i.length;r++){const n=i[r],o=n.data,a=o.path;if(!n.action||!a)continue;const l=o.style,u=a.shapePath.shapePrimitives;for(let c=0;c<u.length;c++){const h=u[c].shape;if(!l||!h)continue;const f=u[c].transform,d=f?f.applyInverse(e,R6):e;if(n.action==="fill")s=h.contains(d.x,d.y);else{const m=l;s=h.strokeContains(d.x,d.y,m.width,m.alignment)}const p=o.hole;if(p){const m=p.shapePath?.shapePrimitives;if(m)for(let g=0;g<m.length;g++)m[g].shape.contains(d.x,d.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(s)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(s))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};q0.defaultFillStyle={color:16777215,alpha:1,texture:xe.WHITE,matrix:null,fill:null,textureSpace:"local"};q0.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:xe.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let vi=q0;const Y0=class Ur extends Ti{constructor(e={}){super(),this.uid=tt("textStyle"),this._tick=0,z6(e);const i={...Ur.defaultTextStyle,...e};for(const s in i){const r=s;this[r]=i[s]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Ur.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Ur.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...vi.defaultFillStyle,...e},()=>{this._fill=rr({...this._originalFill},vi.defaultFillStyle)})),this._fill=rr(e===0?"black":e,vi.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...vi.defaultStrokeStyle,...e},()=>{this._stroke=bl({...this._originalStroke},vi.defaultStrokeStyle)})),this._stroke=bl(e,vi.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=Ur.defaultTextStyle;for(const i in e)this[i]=e[i]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new Ur({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let i=0;i<this._filters.length;i++)e+=this._filters[i].padding;return Math.max(this._padding,e)}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,i){return new Proxy(e,{set:(s,r,n)=>(s[r]===n||(s[r]=n,i?.(r,n),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(st.isColorLike(e)||e instanceof ui||e instanceof nc)}};Y0.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Y0.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Mt=Y0;function z6(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const i=Mt.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??i.alpha,angle:e.dropShadowAngle??i.angle,blur:e.dropShadowBlur??i.blur,color:e.dropShadowColor??i.color,distance:e.dropShadowDistance??i.distance}}if(e.strokeThickness!==void 0){ve(Ne,"strokeThickness is now a part of stroke");const i=e.stroke;let s={};if(st.isColorLike(i))s.color=i;else if(i instanceof ui||i instanceof nc)s.fill=i;else if(Object.hasOwnProperty.call(i,"color")||Object.hasOwnProperty.call(i,"fill"))s=i;else throw new Error("Invalid stroke value.");t.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(ve(Ne,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&gt("The number of fill colors must match the number of fill gradient stops.");const i=new ui({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),s=e.fillGradientStops.slice(),r=e.fill.map(n=>st.shared.setValue(n).toNumber());s.forEach((n,o)=>{i.addColorStop(n,r[o])}),t.fill={fill:i}}}class U6{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,i){const s=li.get().createCanvas();s.width=e,s.height=i;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(e,i,s=1){e=Math.ceil(e*s-1e-6),i=Math.ceil(i*s-1e-6),e=yl(e),i=yl(i);const r=(e<<17)+(i<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let n=this._canvasPool[r].pop();return n||(n=this._createCanvasAndContext(e,i)),n}returnCanvasAndContext(e){const i=e.canvas,{width:s,height:r}=i,n=(s<<17)+(r<<1);e.context.resetTransform(),e.context.clearRect(0,0,s,r),this._canvasPool[n].push(e)}clear(){this._canvasPool={}}}const Rg=new U6;zo.register(Rg);const Yx=1e5;function Xx(t,e,i,s=0){if(t.texture===xe.WHITE&&!t.fill)return st.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof nc){const r=t.fill,n=e.createPattern(r.texture.source.resource,"repeat"),o=r.transform.copyTo(Ie.shared);return o.scale(r.texture.frame.width,r.texture.frame.height),n.setTransform(o),n}else if(t.fill instanceof ui){const r=t.fill,n=r.type==="linear",o=r.textureSpace==="local";let a=1,l=1;o&&i&&(a=i.width+s,l=i.height+s);let u,c=!1;if(n){const{start:h,end:f}=r;u=e.createLinearGradient(h.x*a,h.y*l,f.x*a,f.y*l),c=Math.abs(f.x-h.x)<Math.abs((f.y-h.y)*.1)}else{const{center:h,innerRadius:f,outerCenter:d,outerRadius:p}=r;u=e.createRadialGradient(h.x*a,h.y*l,f*a,d.x*a,d.y*l,p*a)}if(c&&o&&i){const h=i.lineHeight/l;for(let f=0;f<i.lines.length;f++){const d=(f*i.lineHeight+s/2)/l;r.colorStops.forEach(p=>{const m=d+p.offset*h;u.addColorStop(Math.floor(m*Yx)/Yx,st.shared.setValue(p.color).toHex())})}}else r.colorStops.forEach(h=>{u.addColorStop(h.offset,st.shared.setValue(h.color).toHex())});return u}}else{const r=e.createPattern(t.texture.source.resource,"repeat"),n=t.matrix.copyTo(Ie.shared);return n.scale(t.texture.frame.width,t.texture.frame.height),r.setTransform(n),r}return gt("FillStyle not recognised",t),"red"}const DS=class LS extends BD{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const i={...LS.defaultOptions,...e};this._textureSize=i.textureSize,this._mipmap=i.mipmap;const s=i.style.clone();i.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=xe.WHITE,s._fill.fill=null),this.applyFillAsTint=i.overrideFill;const r=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const n=Ig(s);i.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/r):s.fontSize=this.baseRenderedFontSize=r,this._style=s,this._skipKerning=i.skipKerning??!1,this.resolution=i.resolution??1,this._padding=i.padding??4,i.textureStyle&&(this._textureStyle=i.textureStyle instanceof vl?i.textureStyle:new vl(i.textureStyle)),this.fontMetrics=hr.measureFont(n),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){const i=hr.graphemeSegmenter(e).filter(g=>!this._currentChars.includes(g)).filter((g,y,b)=>b.indexOf(g)===y);if(!i.length)return;this._currentChars=[...this._currentChars,...i];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:r,context:n}=s.canvasAndContext,o=s.texture.source;const a=this._style;let l=this._currentX,u=this._currentY,c=this._currentMaxCharHeight;const h=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*h;let d=!1;const p=r.width/this.resolution,m=r.height/this.resolution;for(let g=0;g<i.length;g++){const y=i[g],b=hr.measureText(y,a,r,!1);b.lineHeight=b.height;const v=b.width*h,x=Math.ceil((a.fontStyle==="italic"?2:1)*v),_=b.height*h,S=x+f*2,T=_+f*2;if(d=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(d=!0,c=Math.ceil(Math.max(T,c))),l+S>p&&(u+=c,c=T,l=0,u+c>m)){o.update();const w=this._nextPage();r=w.canvasAndContext.canvas,n=w.canvasAndContext.context,o=w.texture.source,l=0,u=0,c=0}const A=v/h-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:A,kerning:{}},d){this._drawGlyph(n,b,l+f,u+f,h,a);const w=o.width*h,k=o.height*h,F=new Se(l/w*o.width,u/k*o.height,S/w*o.width,T/k*o.height);this.chars[y].texture=new xe({source:o,frame:F}),l+=Math.ceil(S)}}o.update(),this._currentX=l,this._currentY=u,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(i,n)}get pageTextures(){return ve(Ne,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,i){const s=this._measureCache;for(let r=0;r<e.length;r++){const n=e[r];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=s[n];l||(l=s[n]=i.measureText(n).width);let u=s[a];u||(u=s[a]=i.measureText(a).width);let c=i.measureText(n+a).width,h=c-(l+u);h&&(this.chars[n].kerning[a]=h),c=i.measureText(n+a).width,h=c-(l+u),h&&(this.chars[a].kerning[n]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,i=Rg.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(i.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new xe({source:new zs({resource:i.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(r.source.style=this._textureStyle);const n={canvasAndContext:i,texture:r};return this.pages[this._currentPageIndex]=n,n}_setupContext(e,i,s){i.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=Ig(i),i.fontSize=this.baseMeasurementFontSize,e.textBaseline=i.textBaseline;const r=i._stroke,n=r?.width??0;if(r&&(e.lineWidth=n,e.lineJoin=r.join,e.miterLimit=r.miterLimit,e.strokeStyle=Xx(r,e)),i._fill&&(e.fillStyle=Xx(i._fill,e)),i.dropShadow){const o=i.dropShadow,a=st.shared.setValue(o.color).toArray(),l=o.blur*s,u=o.distance*s;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*u,e.shadowOffsetY=Math.sin(o.angle)*u}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,i,s,r,n,o){const a=i.text,l=i.fontProperties,c=(o._stroke?.width??0)*n,h=s+c/2,f=r-c/2,d=l.descent*n,p=i.lineHeight*n;let m=!1;o.stroke&&c&&(m=!0,e.strokeText(a,h,f+p-d));const{shadowBlur:g,shadowOffsetX:y,shadowOffsetY:b}=e;o._fill&&(m&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(a,h,f+p-d)),m&&(e.shadowBlur=g,e.shadowOffsetX=y,e.shadowOffsetY=b)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:i,texture:s}=this.pages[e];Rg.returnCanvasAndContext(i),s.destroy(!0)}this.pages=null}};DS.defaultOptions={textureSize:512,style:new Mt,mipmap:!0};let jx=DS;function NS(t,e,i,s){const r={width:0,height:0,offsetY:0,scale:e.fontSize/i.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=i.baseLineOffset;let n=r.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},u=i.baseMeasurementFontSize/e.fontSize,c=e.letterSpacing*u,h=e.wordWrapWidth*u,f=e.lineHeight?e.lineHeight*u:i.lineHeight,d=e.wordWrap&&e.breakWords,p=y=>{const b=n.width;for(let v=0;v<l.index;v++){const x=y.positions[v];n.chars.push(y.chars[v]),n.charPositions.push(x+b)}n.width+=y.width,a=!1,l.width=0,l.index=0,l.chars.length=0},m=()=>{let y=n.chars.length-1;if(s){let b=n.chars[y];for(;b===" ";)n.width-=i.chars[b].xAdvance,b=n.chars[--y]}r.width=Math.max(r.width,n.width),n={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,r.lines.push(n),r.height+=f},g=y=>y-c>h;for(let y=0;y<t.length+1;y++){let b;const v=y===t.length;v||(b=t[y]);const x=i.chars[b]||i.chars[" "];if(/(?:\s)/.test(b)||b==="\r"||b===`
`||v){if(!a&&e.wordWrap&&g(n.width+l.width)?(m(),p(l),v||n.charPositions.push(0)):(l.start=n.width,p(l),v||n.charPositions.push(0)),b==="\r"||b===`
`)m();else if(!v){const A=x.xAdvance+(x.kerning[o]||0)+c;n.width+=A,n.spaceWidth=A,n.spacesIndex.push(n.charPositions.length),n.chars.push(b)}}else{const T=x.kerning[o]||0,A=x.xAdvance+T+c;d&&g(n.width+l.width+A)&&(p(l),m()),l.positions[l.index++]=l.width+T,l.chars.push(b),l.width+=A}o=b}return m(),e.align==="center"?B6(r):e.align==="right"?O6(r):e.align==="justify"&&D6(r),r}function B6(t){for(let e=0;e<t.lines.length;e++){const i=t.lines[e],s=t.width/2-i.width/2;for(let r=0;r<i.charPositions.length;r++)i.charPositions[r]+=s}}function O6(t){for(let e=0;e<t.lines.length;e++){const i=t.lines[e],s=t.width-i.width;for(let r=0;r<i.charPositions.length;r++)i.charPositions[r]+=s}}function D6(t){const e=t.width;for(let i=0;i<t.lines.length;i++){const s=t.lines[i];let r=0,n=s.spacesIndex[r++],o=0;const a=s.spacesIndex.length,u=(e-s.width)/a;for(let c=0;c<s.charPositions.length;c++)c===n&&(n=s.spacesIndex[r++],o+=u),s.charPositions[c]+=o}}function L6(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let i=0,s=t.length;i<s;i++){const r=t[i];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(r[0].length===0||r[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}let va=0;class N6{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=bS(1e3)}getFont(e,i){let s=`${i.fontFamily}-bitmap`,r=!0;if(i._fill.fill&&!i._stroke?(s+=i._fill.fill.styleKey,r=!1):(i._stroke||i.dropShadow)&&(s=`${i.styleKey}-bitmap`,r=!1),!qt.has(s)){const o=Object.create(i);o.lineHeight=0;const a=new jx({style:o,overrideFill:r,overrideSize:!0,...this.defaultOptions});va++,va>50&&gt("BitmapText",`You have dynamically created ${va} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{va--,qt.remove(s)}),qt.set(s,a)}const n=qt.get(s);return n.ensureCharacters?.(e),n}getLayout(e,i,s=!0){const r=this.getFont(e,i),n=`${e}-${i.styleKey}-${s}`;if(this.measureCache.has(n))return this.measureCache.get(n);const o=hr.graphemeSegmenter(e),a=NS(o,i,r,s);return this.measureCache.set(n,a),a}measureText(e,i,s=!0){return this.getLayout(e,i,s)}install(...e){let i=e[0];typeof i=="string"&&(i={name:i,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},ve(Ne,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=i?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");i={...this.defaultOptions,...i};const r=i.style,n=r instanceof Mt?r:new Mt(r),o=i.dynamicFill??this._canUseTintForStyle(n),a=new jx({style:n,overrideFill:o,skipKerning:i.skipKerning,padding:i.padding,resolution:i.resolution,overrideSize:!1,textureStyle:i.textureStyle}),l=L6(i.chars);return a.ensureCharacters(l.join("")),qt.set(`${s}-bitmap`,a),a.once("destroy",()=>qt.remove(`${s}-bitmap`)),a}uninstall(e){const i=`${e}-bitmap`,s=qt.get(i);s&&s.destroy()}_canUseTintForStyle(e){return!e._stroke&&(!e.dropShadow||e.dropShadow.color===0)&&!e._fill.fill&&e._fill.color===16777215}}const HS=new N6,GS={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},H6=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function G6(t){const e=GS[t],i=e.length;let s=H6,r="";const n="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=n.replace("%index%",a.toString());o=a,a>=i&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),r+=l,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",t.toString()),s}const W6=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function V6(t,e){const i=Math.ceil(t/2);let s=W6,r="",n;e?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let o=0;o<t;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(i-1)}.0`),r+=a,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",t.toString()),s=s.replace("%dimension%",e?"z":"w"),s}function $6(t,e){const i=V6(e,t),s=G6(e);return mn.from({vertex:i,fragment:s,name:`blur-${t?"horizontal":"vertical"}-pass-filter`})}var q6=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function Y6(t,e){const i=GS[e],s=i.length,r=[],n=[],o=[];for(let h=0;h<e;h++){r[h]=`@location(${h}) offset${h}: vec2<f32>,`,t?n[h]=`filteredCord + vec2(${h-s+1} * pixelStrength, 0.0),`:n[h]=`filteredCord + vec2(0.0, ${h-s+1} * pixelStrength),`;const f=h<s?h:e-h-1,d=i[f].toString();o[h]=`finalColor += textureSample(uTexture, uSampler, offset${h}) * ${d};`}const a=r.join(`
`),l=n.join(`
`),u=o.join(`
`),c=q6.replace("%blur-struct%",a).replace("%blur-vertex-out%",l).replace("%blur-fragment-in%",a).replace("%blur-sampling%",u).replace("%dimension%",t?"z":"w");return gn.from({vertex:{source:c,entryPoint:"mainVertex"},fragment:{source:c,entryPoint:"mainFragment"}})}const WS=class VS extends rc{constructor(e){e={...VS.defaultOptions,...e};const i=$6(e.horizontal,e.kernelSize),s=Y6(e.horizontal,e.kernelSize);super({glProgram:i,gpuProgram:s,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...e}),this.horizontal=e.horizontal,this._quality=0,this.quality=e.quality,this.blur=e.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,i,s,r){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)e.applyFilter(this,i,s,r);else{const n=on.getSameSizeTexture(i);let o=i,a=n;this._state.blend=!1;const l=e.renderer.type===bo.WEBGPU;for(let u=0;u<this.passes-1;u++){e.applyFilter(this,o,a,u===0?!0:l);const c=a;a=o,o=c}this._state.blend=!0,e.applyFilter(this,o,s,r),on.returnTexture(n)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};WS.defaultOptions={strength:8,quality:4,kernelSize:5};let bm=WS;class $S extends rc{constructor(...e){let i=e[0]??{};typeof i=="number"&&(ve(Ne,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),i={strength:i},e[1]!==void 0&&(i.quality=e[1]),e[2]!==void 0&&(i.resolution=e[2]||"inherit"),e[3]!==void 0&&(i.kernelSize=e[3])),i={...bm.defaultOptions,...i};const{strength:s,strengthX:r,strengthY:n,quality:o,...a}=i;super({...a,compatibleRenderers:bo.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new bm({horizontal:!0,...i}),this.blurYFilter=new bm({horizontal:!1,...i}),this.quality=o,this.strengthX=r??s,this.strengthY=n??s,this.repeatEdgePixels=!1}apply(e,i,s,r){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=on.getSameSizeTexture(i);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,i,a,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,a,s,r),on.returnTexture(a)}else o?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,i,s,r)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,i,s,r))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return ve("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(e){ve("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}get blurX(){return ve("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(e){ve("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}get blurY(){return ve("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(e){ve("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}$S.defaultOptions={strength:8,quality:4,kernelSize:5};class dt extends N0{constructor(e){e instanceof vi&&(e={context:e});const{context:i,roundPixels:s,...r}=e||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",i?this._context=i:this._context=this._ownedContext=new vi,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=s??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,i){return this.context[e](...i),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new dt(this._context.clone()):(this._ownedContext=null,new dt(this._context))}lineStyle(e,i,s){ve(Ne,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return e&&(r.width=e),i&&(r.color=i),s&&(r.alpha=s),this.context.strokeStyle=r,this}beginFill(e,i){ve(Ne,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return e!==void 0&&(s.color=e),i!==void 0&&(s.alpha=i),this.context.fillStyle=s,this}endFill(){ve(Ne,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==vi.defaultStrokeStyle.width||e.color!==vi.defaultStrokeStyle.color||e.alpha!==vi.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return ve(Ne,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return ve(Ne,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return ve(Ne,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return ve(Ne,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return ve(Ne,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return ve(Ne,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class X6 extends N0{constructor(e,i){const{text:s,resolution:r,style:n,anchor:o,width:a,height:l,roundPixels:u,...c}=e;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=i,this.text=s??"",this.style=n,this.resolution=r??null,this.allowChildren=!1,this._anchor=new ft({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=u??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,i){typeof e=="object"?(i=e.height??e.width,e=e.width):i??(i=e),e!==void 0&&this._setWidth(e,this.bounds.width),i!==void 0&&this._setHeight(i,this.bounds.height)}containsPoint(e){const i=this.bounds.width,s=this.bounds.height,r=-i*this.anchor.x;let n=0;return e.x>=r&&e.x<=r+i&&(n=-s*this.anchor.y,e.y>=n&&e.y<=n+s)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function j6(t,e){let i=t[0]??{};return(typeof i=="string"||t[1])&&(ve(Ne,`use new ${e}({ text: "hi!", style }) instead`),i={text:i,style:t[1]}),i}class K6 extends X6{constructor(...e){var i;const s=j6(e,"BitmapText");s.style??(s.style=s.style||{}),(i=s.style).fill??(i.fill=16777215),super(s,Mt),this.renderPipeId="bitmapText"}updateBounds(){const e=this._bounds,i=this._anchor,s=HS.measureText(this.text,this._style),r=s.scale,n=s.offsetY*r;let o=s.width*r,a=s.height*r;const l=this._style._stroke;l&&(o+=l.width,a+=l.width),e.minX=-i._x*o,e.maxX=e.minX+o,e.minY=-i._y*(a+n),e.maxY=e.minY+a}set resolution(e){e!==null&&gt("[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.")}get resolution(){return this._resolution}}class jt extends xe{static create(e){return new jt({source:new fi(e)})}resize(e,i,s){return this.source.resize(e,i,s),this}}function Z6(t){const{text:e,style:i,chars:s}=t,r=i,n=HS.getFont(e,r),o=hr.graphemeSegmenter(e),a=NS(o,r,n,!0),l=a.scale,u=[],c=[],h=[],f=i.lineHeight?i.lineHeight:n.lineHeight*l;let d=0;for(const p of a.lines){if(p.chars.length===0)continue;const m=new it({label:"line"});m.y=d,h.push(m);let g=new it({label:"word"}),y=0;for(let b=0;b<p.chars.length;b++){const v=p.chars[b];if(!v||!n.chars[v])continue;const _=v===" ",S=b===p.chars.length-1;let T;s.length>0?(T=s.shift(),T.text=v,T.style=r,T.label=`char-${v}`,T.x=p.charPositions[b]*l-p.charPositions[y]*l):T=new K6({text:v,style:r,label:`char-${v}`,x:p.charPositions[b]*l-p.charPositions[y]*l}),_||(u.push(T),g.addChild(T)),(_||S)&&g.children.length>0&&(g.x=p.charPositions[y]*l,c.push(g),m.addChild(g),g=new it({label:"word"}),y=b+1)}d+=f}return{chars:u,lines:h,words:c}}class J6 extends it{constructor(e){const{text:i,style:s,autoSplit:r,lineAnchor:n,wordAnchor:o,charAnchor:a,...l}=e;super(l),this._dirty=!1,this._canReuseChars=!1,this.chars=[],this.words=[],this.lines=[],this._originalText=i,this._autoSplit=r,this._lineAnchor=n,this._wordAnchor=o,this._charAnchor=a,this.style=s}split(){const e=this.splitFn();this.chars=e.chars,this.words=e.words,this.lines=e.lines,this.addChild(...this.lines),this.charAnchor=this._charAnchor,this.wordAnchor=this._wordAnchor,this.lineAnchor=this._lineAnchor,this._dirty=!1,this._canReuseChars=!0}get text(){return this._originalText}set text(e){this._originalText=e,this.lines.forEach(i=>i.destroy({children:!0})),this.lines.length=0,this.words.length=0,this.chars.length=0,this._canReuseChars=!1,this.onTextUpdate()}_setOrigin(e,i,s){let r;typeof e=="number"?r={x:e,y:e}:r={x:e.x,y:e.y},i.forEach(n=>{const o=n.getLocalBounds(),a=o.minX+o.width*r.x,l=o.minY+o.height*r.y;n.origin.set(a,l)}),this[s]=e}get lineAnchor(){return this._lineAnchor}set lineAnchor(e){this._setOrigin(e,this.lines,"_lineAnchor")}get wordAnchor(){return this._wordAnchor}set wordAnchor(e){this._setOrigin(e,this.words,"_wordAnchor")}get charAnchor(){return this._charAnchor}set charAnchor(e){this._setOrigin(e,this.chars,"_charAnchor")}get style(){return this._style}set style(e){e||(e={}),this._style=new Mt(e),this.words.forEach(i=>i.destroy()),this.words.length=0,this.lines.forEach(i=>i.destroy()),this.lines.length=0,this._canReuseChars=!0,this.onTextUpdate()}onTextUpdate(){this._dirty=!0,this._autoSplit&&this.split()}destroy(e){super.destroy(e),this.chars=[],this.words=[],this.lines=[],(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._originalText=""}}const qS=class Wa extends J6{constructor(e){const i={...Wa.defaultOptions,...e};super(i)}static from(e,i){const s={...Wa.defaultOptions,...i,text:e.text,style:new Mt(e.style)};return new Wa({...s})}splitFn(){return Z6({text:this._originalText,style:this._style,chars:this._canReuseChars?this.chars:[]})}};qS.defaultOptions={autoSplit:!0,lineAnchor:0,wordAnchor:0,charAnchor:0};let _l=qS;di.add(NB,HB);function ut(t){if(t!=null){if(typeof t=="number")return t;if(typeof t=="string"){if(t==="transparent")return;if(t.startsWith("#")){const i=parseInt(t.slice(1),16);if(!isNaN(i))return i}if(t.startsWith("0x")){const i=parseInt(t,16);if(!isNaN(i))return i}const e=parseInt(t,16);if(!isNaN(e))return e;try{return new st(t).toNumber()}catch{return}}}}const YS=t=>t==="transparent",sr=(t,e=16777215)=>YS(t)?{color:e,alpha:0}:{color:ut(t)??e,alpha:1};class Ns extends qs{type="Caption";_meta={duration:1/0,width:0,height:0};get meta(){return{...this._meta}}_visualPaddingX=20;_visualPaddingY=15;_lastTickTime=0;get width(){return this._width}set width(e){Math.abs(this._width-e)<1||(this._width=e,e>0?(this._isWidthConstrained=!0,this.opts.wordWrapWidth=e,this.opts.wordWrap=!0,this.originalOpts&&(this.originalOpts.wordWrapWidth=e,this.originalOpts.wordWrap=!0)):(this._isWidthConstrained=!1,this.opts.wordWrapWidth=0,this.opts.wordWrap=!1,this.originalOpts&&(this.originalOpts.wordWrapWidth=0,this.originalOpts.wordWrap=!1)),this.refreshCaptions(),this.emit("propsChange",{width:e}))}get height(){return this._height}set height(e){Math.abs(this._height-e)<1||(this._height=e,this.refreshCaptions(),this.emit("propsChange",{height:e}))}get left(){return this._left}set left(e){Math.abs(this._left-e)<.1||(this._left=e,this._refreshing||(this._isXPositionedManually=!0),this.emit("propsChange",{left:e}))}get top(){return this._top}set top(e){Math.abs(this._top-e)<.1||(this._top=e,this.emit("propsChange",{top:e}))}_initialLayoutApplied=!1;_isXPositionedManually=!1;_isWidthConstrained=!1;_lastContentWidth=0;_lastContentHeight=0;_lastProcessedText="";_text="";get text(){return this._text}set text(e){if(this._text===e)return;this._text=e;const s=(this.opts?.words||[]).map(r=>r.text).join(" ");if(e.trim()!==s.trim()){const r=this.duration>0&&this.duration!==1/0?this.duration/1e3:5e3,n=e.split(`
`),o=[];if(n.forEach((a,l)=>{a.trim().split(/\s+/).filter(c=>c!=="").forEach(c=>{o.push({text:c,paragraphIndex:l})})}),o.length===0)this.opts.words=[];else{const a=r/o.length;this.opts.words=o.map((l,u)=>({text:l.text,from:u*a,to:(u+1)*a,isKeyWord:!1,paragraphIndex:l.paragraphIndex}))}}this.originalOpts&&(this.originalOpts.caption?this.originalOpts.caption.words=this.opts.words:this.originalOpts.words=this.opts.words),this.originalOpts&&this.textStyle&&this.refreshCaptions().then(()=>{this.emit("propsChange",{text:e})})}get style(){if(!this.originalOpts)return{};const e=this.originalOpts;return{fontSize:e.fontSize,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle,color:e.fill,align:e.align,textCase:e.textCase,verticalAlign:e.verticalAlign,wordsPerLine:e.wordsPerLine,stroke:e.stroke?typeof e.stroke=="object"?{color:e.stroke.color,width:e.stroke.width}:{color:e.stroke,width:e.strokeWidth??0}:void 0,shadow:e.dropShadow?{color:e.dropShadow.color??"#000000",alpha:e.dropShadow.alpha??.5,blur:e.dropShadow.blur??4,distance:e.dropShadow.distance??0,angle:e.dropShadow.angle??0}:void 0}}set style(e){this.updateStyle(e)}get wordsPerLine(){return this.opts.wordsPerLine}set wordsPerLine(e){this.updateStyle({wordsPerLine:e})}get fontFamily(){return this.opts.fontFamily}set fontFamily(e){this.updateStyle({fontFamily:e})}get fontUrl(){return this.opts.fontUrl}set fontUrl(e){this.updateStyle({fontUrl:e})}get fontSize(){return this.opts.fontSize}set fontSize(e){this.updateStyle({fontSize:e})}get fontWeight(){return this.opts.fontWeight}set fontWeight(e){this.updateStyle({fontWeight:e})}get fontStyle(){return this.opts.fontStyle}set fontStyle(e){this.updateStyle({fontStyle:e})}get fill(){return this.opts.fill}set fill(e){this.updateStyle({fill:e})}get align(){return this.opts.align}set align(e){this.updateStyle({align:e})}get stroke(){return this.originalOpts?.stroke}set stroke(e){this.updateStyle({stroke:e})}get strokeWidth(){return this.opts.strokeWidth}set strokeWidth(e){this.updateStyle({strokeWidth:e})}get dropShadow(){return this.originalOpts?.dropShadow}set dropShadow(e){this.updateStyle({dropShadow:e})}get caption(){return this.originalOpts?.caption}set caption(e){this.updateStyle({caption:e})}bottomOffset;get textCase(){return this.originalOpts?.textCase||"none"}set textCase(e){this.updateStyle({textCase:e})}id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;get mediaId(){return this.opts.mediaId}set mediaId(e){this.opts.mediaId=e,this.originalOpts&&(this.originalOpts.mediaId=e)}effects=[];get words(){return this.opts.words}set words(e){const i=e??[];this.opts.words=i,this.originalOpts&&(this.originalOpts.caption?this.originalOpts.caption.words=e:this.originalOpts.words=e);const s=i.map(r=>r.text).filter(r=>r&&r.trim()!=="").join(" ");this._text!==s?this.text=s:this.refreshCaptions().then(()=>{this.emit("propsChange",{words:e})})}opts;pixiTextContainer=null;renderTexture=null;wordTexts=[];textStyle;textStyleBase;_refreshing=!1;_needsRefresh=!1;externalRenderer=null;pixiApp=null;originalOpts=null;constructor(e,i={},s){super(),this.originalOpts={...i},this.externalRenderer=s??null,this.opts={fontSize:i.fontSize??30,fontFamily:i.fontFamily??"Arial",fontUrl:i.fontUrl??"",fontWeight:i.fontWeight??"normal",fontStyle:i.fontStyle??"normal",fill:i.fill??"#ffffff",strokeWidth:i.strokeWidth??0,align:i.align??"center",wordWrapWidth:i.wordWrapWidth??0,wordWrap:i.wordWrap??!1,lineHeight:i.lineHeight??1,letterSpacing:i.letterSpacing??0,textCase:i.textCase??"none",videoWidth:i.caption?.positioning?.videoWidth??i.videoWidth??1280,videoHeight:i.caption?.positioning?.videoHeight??i.videoHeight??720,bottomOffset:i.caption?.positioning?.bottomOffset??i.bottomOffset??30,keyword:i.caption?.colors?.keyword??i.colors?.keyword??"#ffff00",background:i.caption?.colors?.background??i.colors?.background??"#000000",active:i.caption?.colors?.active??i.colors?.active??"#ffffff",activeFill:i.caption?.colors?.activeFill??i.colors?.activeFill??"#00ff00",appeared:i.caption?.colors?.appeared??i.colors?.appeared??"#ffffff",words:i.caption?.words??i.words??[],preserveKeywordColor:i.caption?.preserveKeywordColor??i.preserveKeywordColor??!1,mediaId:i.mediaId,wordsPerLine:i.wordsPerLine??"multiple"},this._initialLayoutApplied=i.initialLayoutApplied??!1,this._initialLayoutApplied&&(this._isXPositionedManually=!0),this.opts.wordWrapWidth>0&&(this._isWidthConstrained=!0,this._width=this.opts.wordWrapWidth,this.opts.wordWrap=!0),this.text=e,this._lastProcessedText=this._text;const r={fontSize:this.opts.fontSize,fontFamily:this.opts.fontFamily,fontWeight:this.opts.fontWeight,fontStyle:this.opts.fontStyle,align:this.opts.align};if(i.fill&&typeof i.fill=="object"&&i.fill.type==="gradient"){const c=new ui(i.fill.x0,i.fill.y0,i.fill.x1,i.fill.y1);i.fill.colors.forEach(({ratio:h,color:f})=>{const d=typeof f=="number"?f:ut(f)??16777215;c.addColorStop(h,d)}),r.fill={fill:c}}else{let c;i.fill==="transparent"?c=16777215:(typeof i.fill=="string"||typeof i.fill=="number")&&(c=ut(i.fill)),r.fill=c??16777215}const n=c=>c==="transparent";if(i.stroke&&typeof i.stroke=="object"&&"color"in i.stroke){if(!n(i.stroke.color)){const c=ut(i.stroke.color);c!==void 0&&(r.stroke={color:c,width:i.stroke.width},i.stroke.join&&(r.stroke.join=i.stroke.join))}}else{const c=i.stroke??void 0;if(!n(c)){const h=ut(c);h!==void 0?r.stroke={color:h,width:this.opts.strokeWidth??0}:this.opts.strokeWidth&&this.opts.strokeWidth>0&&(r.stroke={color:0,width:this.opts.strokeWidth})}}if(i.dropShadow){const c=ut(i.dropShadow.color);c!==void 0&&(r.dropShadow={color:c,alpha:i.dropShadow.alpha??.5,blur:i.dropShadow.blur??4,angle:i.dropShadow.angle??Math.PI/6,distance:i.dropShadow.distance??2})}const o=new Mt(r);this.textStyle=o;const{align:a,fill:l,...u}=r;this.textStyleBase=new Mt(u),this.ready=(async()=>{await this.refreshCaptions();const c={...this._meta};return De.info("CaptionClip ready:",c),c})()}async updateStyle(e){this.originalOpts||(this.originalOpts={}),this.originalOpts={...this.originalOpts,...e},e.fontSize!==void 0&&(this.opts.fontSize=e.fontSize),e.fontFamily!==void 0&&(this.opts.fontFamily=e.fontFamily),e.fontUrl!==void 0&&(this.opts.fontUrl=e.fontUrl),e.fontWeight!==void 0&&(this.opts.fontWeight=e.fontWeight),e.fontStyle!==void 0&&(this.opts.fontStyle=e.fontStyle),e.fill!==void 0&&(this.opts.fill=e.fill),e.align!==void 0&&(this.opts.align=e.align),e.letterSpacing!==void 0&&(this.opts.letterSpacing=e.letterSpacing),e.lineHeight!==void 0&&(this.opts.lineHeight=e.lineHeight),e.textCase!==void 0&&(this.opts.textCase=e.textCase),e.wordWrapWidth!==void 0&&(this.opts.wordWrapWidth=e.wordWrapWidth,e.wordWrapWidth>0&&(this._isWidthConstrained=!0,this.opts.wordWrap=!0)),e.wordsPerLine!==void 0&&(this.opts.wordsPerLine=e.wordsPerLine),e.caption?.colors&&(e.caption.colors.appeared!==void 0&&(this.opts.appeared=e.caption.colors.appeared),e.caption.colors.active!==void 0&&(this.opts.active=e.caption.colors.active),e.caption.colors.activeFill!==void 0&&(this.opts.activeFill=e.caption.colors.activeFill),e.caption.colors.background!==void 0&&(this.opts.background=e.caption.colors.background),e.caption.colors.keyword!==void 0&&(this.opts.keyword=e.caption.colors.keyword)),e.caption?.preserveKeywordColor!==void 0&&(this.opts.preserveKeywordColor=e.caption.preserveKeywordColor);const i={fontSize:this.opts.fontSize,fontFamily:this.opts.fontFamily,fontWeight:this.opts.fontWeight,fontStyle:this.opts.fontStyle,align:this.opts.align};if(this.opts.fill&&typeof this.opts.fill=="object"&&this.opts.fill.type==="gradient"){const l=new ui(this.opts.fill.x0,this.opts.fill.y0,this.opts.fill.x1,this.opts.fill.y1);this.opts.fill.colors.forEach(({ratio:u,color:c})=>{const h=typeof c=="number"?c:ut(c)??16777215;l.addColorStop(u,h)}),i.fill={fill:l}}else i.fill=16777215;if(e.stroke!==void 0||e.strokeWidth!==void 0||this.originalOpts.stroke||this.originalOpts.strokeWidth){if(this.originalOpts.stroke&&typeof this.originalOpts.stroke=="object"&&"color"in this.originalOpts.stroke){const l=ut(this.originalOpts.stroke.color);l!==void 0&&(i.stroke={color:l,width:this.originalOpts.stroke.width},this.originalOpts.stroke.join&&(i.stroke.join=this.originalOpts.stroke.join))}else if(this.originalOpts?.stroke){const l=this.originalOpts.stroke,u=ut(typeof l=="object"&&l!==null&&"color"in l?l.color:l),c=e.strokeWidth!==void 0?e.strokeWidth:this.originalOpts.strokeWidth!==void 0?this.originalOpts.strokeWidth:0;u!==void 0?i.stroke={color:u,width:c}:c>0&&(i.stroke={color:0,width:c})}}const r=e.dropShadow!==void 0?e.dropShadow:this.originalOpts.dropShadow;if(r){const l=ut(r.color);l!==void 0&&(i.dropShadow={color:l,alpha:r.alpha!==void 0?r.alpha:.5,blur:r.blur!==void 0?r.blur:4,angle:r.angle!==void 0?r.angle:Math.PI/6,distance:r.distance!==void 0?r.distance:2})}this.textStyle=new Mt(i);const{align:n,fill:o,...a}=i;this.textStyleBase=new Mt(a),await this.refreshCaptions(),this.emit("propsChange",e)}async refreshCaptions(){if(this._refreshing){this._needsRefresh=!0;return}this._refreshing=!0,this._needsRefresh=!1;try{typeof document<"u"&&await document.fonts.ready;const e=this._width,i=this._height,s=this.originalOpts?.verticalAlign||"center";this.pixiTextContainer?this.pixiTextContainer.removeChildren():this.pixiTextContainer=new it;const r=hr.measureText(" ",this.textStyle),n=[];this.opts.words.forEach((q,he)=>{const J=this.opts.textCase;let j=q.text||"";J==="uppercase"?j=j.toUpperCase():J==="lowercase"?j=j.toLowerCase():J==="title"&&(j=j.replace(/\w\S*/g,we=>we.charAt(0).toUpperCase()+we.substring(1).toLowerCase())),j.split(/\s+/).filter(we=>we.length>0).forEach(we=>{const ke=new _l({text:we,style:this.textStyle});ke.segmentIndex=he;const Ue="#ffffff",Xe=typeof Ue=="object"&&Ue!==null&&"type"in Ue?16777215:Ue,Ee=ut(Xe);ke.tint=Ee??16777215,n.push(ke),this.pixiTextContainer.addChild(ke)})}),this.wordTexts=n;const o=this._visualPaddingX,a=this._visualPaddingY,l=this.opts.lineHeight*(this.opts.fontSize||30),u=new _l({text:" ",style:this.textStyleBase}),c=Math.ceil(u.getLocalBounds().width||u.width||r.width);u.destroy();const h=!this._isWidthConstrained&&(this.width===0||this._lastContentWidth===0||Math.abs(this.width-this._lastContentWidth)<2),f=this.opts.videoWidth||1280;let d=0;this.opts.wordWrapWidth>0&&this.opts.wordsPerLine!=="single"?d=this.opts.wordWrapWidth-o*2:this.opts.wordsPerLine==="single"?d=f*5:!h&&this.width>0?d=this.width+10:d=f*5,(isNaN(d)||d<=0)&&(d=f);const p=[];let m=[],g=0,y=0;this.wordTexts.forEach((q,he)=>{const J=q.getLocalBounds(),j=Math.ceil(J.width||q.width),ce=Math.ceil(J.height||q.height),we=q.segmentIndex,ke=this.opts.words[we],Ue=he>0?this.wordTexts[he-1]:null,Xe=Ue?this.opts.words[Ue.segmentIndex]:null,Ee=Xe&&ke&&ke.paragraphIndex!==void 0&&ke.paragraphIndex!==Xe.paragraphIndex||this.opts.wordsPerLine==="single",C=g+(g>0?c:0)+j;!Ee&&(C<=d+1||m.length===0)?(m.push(q),g=C,y=Math.max(y,ce)):(m.length>0&&p.push({words:m,width:g,height:Math.max(y,l)}),m=[q],g=j,y=ce)}),m.length>0&&p.push({words:m,width:g,height:Math.max(y,l)});let b=0,v=0;p.forEach(q=>{b=Math.max(b,q.width),v+=q.height});const x=b,_=v,S=this._text!==this._lastProcessedText;this._lastProcessedText=this._text;const T=x+o*2,A=_+a*2;let w=T,k=A;this._isWidthConstrained&&(S?w=T:w=Math.max(T,e),this.opts.wordWrapWidth>0&&(w=Math.min(w,this.opts.wordWrapWidth)));const F=w,O=k,V=_;let W=0;s==="top"?W=a:s==="bottom"?W=O-V-a:W=(O-V)/2;let ie=W;p.forEach(q=>{let he=o;this.opts.align==="center"?he=(F-q.width)/2:this.opts.align==="right"&&(he=F-q.width-o),q.words.forEach((J,j)=>{J.x=Math.round(he),J.y=Math.round(ie),he+=(J.getLocalBounds().width||J.width)+(j<q.words.length-1?c:0)}),ie+=q.height});const R=new dt;R.label="containerBackground";const I=this.opts.background==="transparent"||!this.opts.background,E=I?0:ut(this.opts.background),U=I?0:1;R.roundRect(0,0,F,O,10),R.fill({color:E,alpha:U}),this.pixiTextContainer.addChildAt(R,0),this.renderTexture?(Math.abs(this.renderTexture.width-F)>.5||Math.abs(this.renderTexture.height-O)>.5)&&(this.renderTexture.destroy(),this.renderTexture=jt.create({width:F,height:O})):this.renderTexture=jt.create({width:F,height:O}),this.updateState(this._lastTickTime);try{(await this.getRenderer()).render({container:this.pixiTextContainer,target:this.renderTexture})}catch(q){De.warn("CaptionClip: Could not render captions during refresh",q)}const se=!this._isWidthConstrained,te=this.height===0||this._lastContentHeight===0||Math.abs(this.height-this._lastContentHeight)<2;if(se&&this._initialLayoutApplied&&e>0&&i>0){const q=w-e;Math.abs(q)>.1&&!this._isXPositionedManually&&this.opts.align==="center"?this.left-=q/2:Math.abs(q)>.1&&!this._isXPositionedManually&&this.opts.align==="right"&&(this.left-=q)}if(this._meta.width=x,this._meta.height=_,this._meta.duration=1/0,this._width=F,this._height=O,this._lastContentWidth=this._width,this._lastContentHeight=this._height,!this._initialLayoutApplied&&(se||te)){const q=this.opts.videoWidth,he=this.opts.videoHeight,J=this.opts.bottomOffset,j=he-_-J,ce=(q-x)/2;this.top=j,this.left=ce,this._initialLayoutApplied=!0}}finally{this._refreshing=!1,this._needsRefresh&&this.refreshCaptions()}}lastLoggedTime=-1;updateState(e){const i=e/1e3,s=Math.floor(e/1e6);s!==this.lastLoggedTime&&(this.lastLoggedTime=s),this.wordTexts.forEach(r=>{const n=r.segmentIndex,o=this.opts.words[n];if(!o)return;const a=i>=o.from&&i<o.to,l=i>=o.to,u=o.isKeyWord&&!YS(this.opts.keyword);let c=16777215,h=1;if(o.isKeyWord&&a&&u)({color:c,alpha:h}=sr(this.opts.keyword));else if(a)({color:c,alpha:h}=sr(this.opts.active));else if(l&&this.opts.preserveKeywordColor&&u)({color:c,alpha:h}=sr(this.opts.keyword));else if(l)({color:c,alpha:h}=sr(this.opts.appeared));else{const d=this.opts.fill,p=typeof d=="object"&&d!==null&&"type"in d?16777215:d;({color:c,alpha:h}=sr(p))}r.children.forEach(d=>{d.label!=="bgRect"&&(d.tint=c,d.alpha=h)});const f=r.getChildByLabel("bgRect");if(a){const{color:d,alpha:p}=sr(this.opts.activeFill,16753920),m=15,g=40;f&&(f.visible=!1);const y=r.getLocalBounds();f&&(f.visible=!0);const b=10,v=f??new dt;v.label="bgRect",v.clear(),v.roundRect(y.x-g/2,y.y-m/2,y.width+g,y.height+m,b),v.fill({color:d,alpha:p}),v.tint=16777215,f||r.addChildAt(v,0)}else f&&(r.removeChild(f),f.destroy())})}async getTexture(){return this.pixiTextContainer==null||this.renderTexture==null?null:((await this.getRenderer()).render({container:this.pixiTextContainer,target:this.renderTexture}),this.renderTexture)}async offscreenRender(e,i){const s=i*this.playbackRate;this._lastTickTime=s*1e6,this.animate(s*1e6),this._render(e);const{width:r,height:n}=this,{video:o,audio:a,done:l}=await this.getFrame(i),u=a??[];return l?{audio:u,done:!0}:(o!=null&&(e.save(),e.drawImage(o,-r/2,-n/2,r,n),e.restore()),{audio:u,done:!1})}setRenderer(e){this.externalRenderer=e}async getRenderer(){if(this.externalRenderer!=null)return this.externalRenderer;if(this.pixiApp?.renderer==null)throw new Error("CaptionClip: No renderer available. Provide a renderer via setRenderer().");return this.pixiApp.renderer}async tick(e){if(await this.ready,this.pixiTextContainer==null||this.renderTexture==null)throw new Error("CaptionClip not initialized");this._lastTickTime=e,this.updateState(e);const i=await this.getRenderer();i.render({container:this.pixiTextContainer,target:this.renderTexture});const s=this.renderTexture.source?.resource?.source;let r;if(s instanceof HTMLCanvasElement)r=await createImageBitmap(s);else if(s instanceof OffscreenCanvas)r=await createImageBitmap(s);else{const o=i.extract.canvas(this.renderTexture);if(o instanceof HTMLCanvasElement||o instanceof OffscreenCanvas)r=await createImageBitmap(o);else throw new Error("Unable to extract canvas from render texture")}return{video:r,state:"success"}}async split(e){await this.ready;const i=await this.clone(),s=await this.clone();return[i,s]}addEffect(e){this.effects.push(e)}editEffect(e,i){const s=this.effects.find(r=>r.id===e);s&&Object.assign(s,i)}removeEffect(e){const i=this.effects.findIndex(s=>s.id===e);i!==-1&&this.effects.splice(i,1)}async clone(){await this.ready;const e=this.originalOpts||{},i=new Ns(this.text,e);return this.copyStateTo(i),i.id=this.id,i.effects=[...this.effects],i}destroy(){if(!this.destroyed){De.info("Caption destroy");try{this.wordTexts.forEach(e=>{e!=null&&!e.destroyed&&e.destroy({children:!0})})}catch{}finally{this.wordTexts=[]}try{this.pixiTextContainer!=null&&(this.pixiTextContainer.destroyed||this.pixiTextContainer.destroy({children:!0}))}catch{}finally{this.pixiTextContainer=null}try{this.renderTexture!=null&&(this.renderTexture.destroyed||this.renderTexture.destroy(!0))}catch{}finally{this.renderTexture=null}if(this.externalRenderer=null,this.pixiApp!=null)try{const e=this.pixiApp;e.destroyed!==!0&&e.renderer!=null&&this.pixiApp.destroy(!0,{children:!0,texture:!0})}catch{}finally{this.pixiApp=null}super.destroy()}}toJSON(e=!1){const i=super.toJSON(e),s={};if(this.originalOpts){const h=this.originalOpts;h.fontSize!==void 0&&(s.fontSize=h.fontSize),h.fontFamily!==void 0&&(s.fontFamily=h.fontFamily),h.fontWeight!==void 0&&(s.fontWeight=h.fontWeight),h.fontStyle!==void 0&&(s.fontStyle=h.fontStyle),h.fill!==void 0&&(s.color=h.fill),h.align!==void 0&&(s.align=h.align),h.textCase!==void 0&&(s.textCase=h.textCase),h.fontUrl!==void 0&&(s.fontUrl=h.fontUrl),h.verticalAlign!==void 0&&(s.verticalAlign=h.verticalAlign),h.wordWrapWidth!==void 0&&(s.wordWrapWidth=h.wordWrapWidth),h.wordWrap!==void 0&&(s.wordWrap=h.wordWrap),h.stroke&&(typeof h.stroke=="object"?s.stroke={color:h.stroke.color,width:h.stroke.width}:s.stroke={color:h.stroke,width:this.opts.strokeWidth??0}),h.dropShadow&&(s.shadow={color:h.dropShadow.color??"#000000",alpha:h.dropShadow.alpha??.5,blur:h.dropShadow.blur??4,distance:h.dropShadow.distance??0,angle:h.dropShadow.angle??0})}const r={};this.opts.words&&this.opts.words.length>0&&(r.words=this.opts.words);const n={},o=this.originalOpts?.caption?.colors??this.originalOpts?.colors;o?.appeared!==void 0&&(n.appeared=o.appeared),o?.active!==void 0&&(n.active=o.active),o?.activeFill!==void 0&&(n.activeFill=o.activeFill),o?.background!==void 0&&(n.background=o.background),o?.keyword!==void 0&&(n.keyword=o.keyword);let a;this.originalOpts?.caption?.preserveKeywordColor!==void 0?a=this.originalOpts.caption.preserveKeywordColor:this.originalOpts?.preserveKeywordColor!==void 0&&(a=this.originalOpts.preserveKeywordColor),Object.keys(n).length>0&&(r.colors=n),a!==void 0&&(r.preserveKeywordColor=a);const l={};this.bottomOffset!==void 0&&(l.bottomOffset=this.bottomOffset);const u=this.originalOpts?.caption?.positioning?.videoWidth??this.originalOpts?.videoWidth,c=this.originalOpts?.caption?.positioning?.videoHeight??this.originalOpts?.videoHeight;return u!==void 0&&(l.videoWidth=u),c!==void 0&&(l.videoHeight=c),Object.keys(l).length>0&&(r.positioning=l),{...i,type:"Caption",text:this.text,style:s,caption:Object.keys(r).length>0?r:void 0,id:this.id,effects:this.effects,mediaId:this.mediaId,wordsPerLine:this.opts.wordsPerLine}}static async fromObject(e){if(e.type!=="Caption")throw new Error(`Expected Caption, got ${e.type}`);const i=e.text||"",s=e.style||{},r={};s.fontSize!==void 0&&(r.fontSize=s.fontSize),s.fontFamily!==void 0&&(r.fontFamily=s.fontFamily),s.fontWeight!==void 0&&(r.fontWeight=s.fontWeight),s.fontStyle!==void 0&&(r.fontStyle=s.fontStyle),s.color!==void 0&&(r.fill=s.color),s.align!==void 0&&(r.align=s.align),s.textCase!==void 0&&(r.textCase=s.textCase),s.verticalAlign!==void 0&&(r.verticalAlign=s.verticalAlign),s.wordWrapWidth!==void 0&&(r.wordWrapWidth=s.wordWrapWidth),s.wordWrap!==void 0&&(r.wordWrap=s.wordWrap),s.wordsPerLine!==void 0?r.wordsPerLine=s.wordsPerLine:e.wordsPerLine!==void 0&&(r.wordsPerLine=e.wordsPerLine),s.fontUrl!==void 0?r.fontUrl=s.fontUrl:e.fontUrl!==void 0&&(r.fontUrl=e.fontUrl),e.mediaId&&(r.mediaId=e.mediaId),s.stroke&&(r.stroke=s.stroke.color,r.strokeWidth=s.stroke.width),s.shadow&&(r.dropShadow={color:s.shadow.color,alpha:s.shadow.alpha,blur:s.shadow.blur,distance:s.shadow.distance,angle:s.shadow.angle}),e.caption?r.caption=e.caption:(e.bottomOffset!==void 0&&(r.bottomOffset=e.bottomOffset),e.words!==void 0&&(r.words=e.words),(e.appearedColor!==void 0||e.activeColor!==void 0||e.activeFillColor!==void 0||e.backgroundColor!==void 0||e.isKeyWordColor!==void 0)&&(r.colors={},e.appearedColor!==void 0&&(r.colors.appeared=e.appearedColor),e.activeColor!==void 0&&(r.colors.active=e.activeColor),e.activeFillColor!==void 0&&(r.colors.activeFill=e.activeFillColor),e.backgroundColor!==void 0&&(r.colors.background=e.backgroundColor),e.isKeyWordColor!==void 0&&(r.colors.keyword=e.isKeyWordColor)),e.preservedColorKeyWord!==void 0&&(r.preserveKeywordColor=e.preservedColorKeyWord),e.videoWidth!==void 0&&(r.videoWidth=e.videoWidth),e.videoHeight!==void 0&&(r.videoHeight=e.videoHeight)),r.initialLayoutApplied=!0;const n=new Ns(i,r);return n.left=e.left,n.top=e.top,n.width=e.width,n.height=e.height,n.angle=e.angle,n.display.from=e.display.from,n.display.to=e.display.to,n.duration=e.duration,n.playbackRate=e.playbackRate,n.zIndex=e.zIndex,n.opacity=e.opacity,n.flip=e.flip,n.wordsPerLine=e.wordsPerLine??"multiple",e.animation&&n.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(n.id=e.id),e.effects&&(n.effects=e.effects),await n.ready,n}getVisibleHandles(){return["mr","mb","br","rot"]}}let zg=class bs extends qs{type="Image";ready;_meta={duration:0,width:0,height:0};get meta(){return{...this._meta}}img=null;pixiTexture=null;frames=[];id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;effects=[];static async fromUrl(e,i){let s=null,r;if(e.startsWith("blob:"))try{const o=await fetch(e);if(!o.ok)throw new Error(`Failed to fetch image: ${o.status} ${o.statusText}`);const a=await o.blob();r=await createImageBitmap(a);try{s=xe.from(r)}catch(l){De.warn("Failed to create Pixi texture from bitmap:",l)}}catch(o){throw De.error(`Failed to load blob image from ${e}`,o),o}else r=await sn.getImageBitmap(e);if(!r)throw new Error(`Failed to load image from ${e}`);const n=new bs(r,i||e);return s&&(n.pixiTexture=s),n}getTexture(){return this.pixiTexture}constructor(e,i){super(),this.src=i!==void 0?i:"";const s=r=>{this.img=r,this._meta.width=r.width,this._meta.height=r.height,this._meta.duration=1/0;const n={...this._meta};return this.width=this.width===0?n.width:this.width,this.height=this.height===0?n.height:this.height,this.duration===0&&n.duration!==1/0&&(this.duration=n.duration,this.display.to=this.display.from+this.duration),n};if(e instanceof ReadableStream)this.ready=new Response(e).blob().then(r=>createImageBitmap(r)).then(s);else if(e instanceof ImageBitmap)this.ready=Promise.resolve(s(e));else if(Array.isArray(e)&&e.every(r=>r instanceof VideoFrame)){this.frames=e;const r=this.frames[0];if(r==null)throw Error("The frame count must be greater than 0");this._meta={width:r.displayWidth,height:r.displayHeight,duration:this.frames.reduce((o,a)=>o+(a.duration??0),0)};const n={...this._meta,duration:1/0};this.width=this.width===0?n.width:this.width,this.height=this.height===0?n.height:this.height,this.duration===0&&n.duration!==1/0&&(this.duration=n.duration,this.display.to=this.display.from+this.duration),this.ready=Promise.resolve(n)}else if("type"in e)this.ready=this.initAnimateImg(e.stream,e.type).then(()=>{const r={width:this._meta.width,height:this._meta.height,duration:1/0};return this.width=this.width===0?r.width:this.width,this.height=this.height===0?r.height:this.height,this.duration===0&&r.duration!==1/0&&(this.duration=r.duration,this.display.to=this.display.from+this.duration),r});else throw Error("Illegal arguments")}async initAnimateImg(e,i){this.frames=await RB(e,i);const s=this.frames[0];if(s==null)throw Error("No frame available in gif");this._meta={duration:this.frames.reduce((r,n)=>r+(n.duration??0),0),width:s.codedWidth,height:s.codedHeight},De.info("Image ready:",this._meta)}tickInterceptor=async(e,i)=>i;async tick(e){if(this.img!=null)return await this.tickInterceptor(e,{video:await createImageBitmap(this.img),state:"success"});const i=e%this._meta.duration;return await this.tickInterceptor(e,{video:(this.frames.find(s=>i>=s.timestamp&&i<=s.timestamp+(s.duration??0))??this.frames[0]).clone(),state:"success"})}async split(e){if(await this.ready,this.img!=null)return[new bs(await createImageBitmap(this.img),this.src),new bs(await createImageBitmap(this.img),this.src)];let i=-1;for(let n=0;n<this.frames.length;n++){const o=this.frames[n];if(!(e>o.timestamp)){i=n;break}}if(i===-1)throw Error("Not found frame by time");const s=this.frames.slice(0,i).map(n=>new VideoFrame(n)),r=this.frames.slice(i).map(n=>new VideoFrame(n,{timestamp:n.timestamp-e}));return[new bs(s,this.src),new bs(r,this.src)]}async clone(){await this.ready;const e=this.img==null?this.frames.map(s=>s.clone()):await createImageBitmap(this.img),i=new bs(e,this.src);return i.tickInterceptor=this.tickInterceptor,this.copyStateTo(i),i.id=this.id,i.effects=[...this.effects],i.transition=this.transition,i}addEffect(e){this.effects.push(e)}editEffect(e,i){const s=this.effects.find(r=>r.id===e);s&&Object.assign(s,i)}removeEffect(e){const i=this.effects.findIndex(s=>s.id===e);i!==-1&&this.effects.splice(i,1)}destroy(){De.info("Image destroy"),this.img?.close(),this.frames.forEach(e=>e.close()),this.pixiTexture=null,super.destroy()}toJSON(e=!1){return{...super.toJSON(e),type:"Image",id:this.id,effects:this.effects}}static async fromObject(e){if(e.type!=="Image")throw new Error(`Expected Image, got ${e.type}`);if(!e.src||e.src.trim()==="")throw new Error("Image requires a valid source URL. Generated clips (like text-to-image) cannot be loaded from JSON without their source data.");let i;try{const s=await sn.getImageBitmap(e.src);i=new bs(s,e.src)}catch(s){throw s instanceof Error&&s.message.includes("could not be decoded")?new Error(`Failed to decode image from ${e.src}. The image may be corrupted, in an unsupported format, or there may be CORS issues.`):s}return await i.ready,i.left=e.left,i.top=e.top,i.width=e.width,i.height=e.height,i.angle=e.angle,i.display.from=e.display.from,i.display.to=e.display.to,i.duration=e.duration,i.playbackRate=e.playbackRate,i.zIndex=e.zIndex,i.opacity=e.opacity,i.flip=e.flip,e.style&&(i.style={...i.style,...e.style}),e.animation&&i.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(i.id=e.id),e.effects&&(i.effects=e.effects),e.transition&&(i.transition=e.transition),i}};function Q6(t,e){const i={},s=e.videoTracks[0];if(s!=null){const n=tL(t.getTrackById(s.id))?.buffer,o=eL(s.codec);o&&(i.videoTrackConf={timescale:s.timescale,duration:s.duration,width:s.video.width,height:s.video.height,brands:e.brands,type:o.type,[o.descKey]:n}),i.videoDecoderConf={codec:s.codec,codedHeight:s.video.height,codedWidth:s.video.width,description:n}}const r=e.audioTracks[0];if(r!=null){const n=iL(t),o=n?sL(n):{};i.audioTrackConf={timescale:r.timescale,samplerate:o.sampleRate??r.audio.sample_rate,channel_count:o.numberOfChannels??r.audio.channel_count,hdlr:"soun",type:r.codec.startsWith("mp4a")?"mp4a":r.codec,description:n},i.audioDecoderConf={codec:o.codec??si.codec,numberOfChannels:o.numberOfChannels??r.audio.channel_count,sampleRate:o.sampleRate??r.audio.sample_rate}}return i}function eL(t){return t.startsWith("avc1")?{descKey:"avcDecoderConfigRecord",type:"avc1"}:t.startsWith("hvc1")?{descKey:"hevcDecoderConfigRecord",type:"hvc1"}:null}function tL(t){for(const e of t.mdia.minf.stbl.stsd.entries){const i=e.avcC??e.hvcC??e.av1C??e.vpcC;if(i!=null){const s=new u2.DataStream(void 0,0,void 0);return i.write(s),new Uint8Array(s.buffer.slice(8))}}}function iL(t,e="mp4a"){return t.moov?.traks.flatMap(i=>i.mdia.minf.stbl.stsd.entries).find(i=>i.type===e)}function sL(t){const e=t.esd?.descs?.[0];if(!e)return{};let i=`mp4a.${e.oti.toString(16)}`;const s=e.descs?.[0];if(!s)return i.endsWith(".40")&&(i+=".2"),{codec:i};const r=s.data;if(!r)return{codec:i};const n=(r[0]&248)>>3;i+=`.${n}`;const o=(r[0]&7)<<1|r[1]>>7,a=(r[1]&120)>>3;return{codec:i,sampleRate:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][o],numberOfChannels:a}}async function rL(t,e,i){const s=u2.createFile(!1);s.onReady=o=>{e({mp4boxFile:s,info:o}),[o.videoTracks[0],o.audioTracks[0]].forEach(a=>{if(a){const l=a.video?"video":"audio";s.setExtractionOptions(a.id,l,{nbSamples:100})}}),s.start()},s.onSamples=i;let r=0;const n=30*1024*1024;for(;;){const o=await t.read(n,{at:r});if(o.byteLength===0)break;o.fileStart=r;const a=s.appendBuffer(o);if(a==null)break;r=a}s.stop()}function nL(t){if(t?.length!==9)return{};const e=new Int32Array(t.buffer),i=c=>c/65536,s=i(e[0]),r=i(e[1]),n=i(e[3]),o=i(e[4]),a=i(e[6]),l=i(e[7]),u=e[8]/(1<<30);return{scaleX:Math.sqrt(s*s+n*n),scaleY:Math.sqrt(r*r+o*o),rotationRad:Math.atan2(n,s),rotationDeg:Math.atan2(n,s)*180/Math.PI,translateX:a,translateY:l,perspective:u}}function oL(t,e,i){const s=(Math.round(i/90)*90+360)%360;if(s===0)return u=>u;const r=s===90||s===270,n=r?e:t,o=r?t:e,a=new OffscreenCanvas(n,o),l=a.getContext("2d");return l.translate(n/2,o/2),l.rotate(-s*Math.PI/180),l.translate(-t/2,-e/2),u=>{if(!u)return null;l.drawImage(u,0,0);const c=new VideoFrame(a,{timestamp:u.timestamp,duration:u.duration??void 0});return u.close(),c}}let X0=0;function _m(t){return t.kind==="file"&&t.createReader instanceof Function}class yi extends qs{type="Video";insId=X0++;logger=De.create(`Video id:${this.insId},`);ready;_meta={duration:0,width:0,height:0,audioSampleRate:0,audioChanCount:0};get meta(){return{...this._meta}}localFile;headerBoxPos=[];async getFileHeaderBinData(){await this.ready;const e=await this.localFile.getOriginFile();if(e==null)throw Error("Video localFile is not origin file");return await new Blob(this.headerBoxPos.map(({start:i,size:s})=>e.slice(i,i+s))).arrayBuffer()}parsedMatrix={perspective:1,rotationRad:0,rotationDeg:0,scaleX:1,scaleY:1,translateX:0,translateY:0};vfRotater=e=>e;videoSamples=[];audioSamples=[];videoFrameFinder=null;audioFrameFinder=null;decoderConf={video:null,audio:null};opts={audio:!0};audio=!0;id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;effects=[];static async fromUrl(e,i={}){const s=await sn.getReadableStream(e),r=new yi(s,{},e);return await r.ready,i.x!==void 0&&(r.left=i.x),i.y!==void 0&&(r.top=i.y),i.width!==void 0&&(r.width=i.width),i.height!==void 0&&(r.height=i.height),r}constructor(e,i={},s){if(super(),this.src=s!==void 0?s:"",!(e instanceof ReadableStream)&&!_m(e)&&!Array.isArray(e.videoSamples))throw Error("Illegal argument");this.opts={audio:!0,...i},this.audio=typeof this.opts.audio=="boolean"?this.opts.audio:!0,this.volume=typeof i.audio=="object"&&"volume"in i.audio?i.audio.volume:i.volume??1;const r=async n=>(await tc(this.localFile,n),this.localFile);this.localFile=_m(e)?e:"localFile"in e?e.localFile:lB(),this.ready=(e instanceof ReadableStream?r(e).then(n=>Kx(n,this.opts)):_m(e)?Kx(e,this.opts):Promise.resolve(e)).then(async({videoSamples:n,audioSamples:o,decoderConf:a,headerBoxPos:l,parsedMatrix:u})=>{this.videoSamples=n,this.audioSamples=o,this.decoderConf=a,this.headerBoxPos=l,this.parsedMatrix=u;const{videoFrameFinder:c,audioFrameFinder:h}=lL({video:a.video==null?null:{...a.video,hardwareAcceleration:this.opts.__unsafe_hardwareAcceleration__},audio:a.audio},await this.localFile.createReader(),n,o,this.opts.audio!==!1?this.volume:0);this.videoFrameFinder=c,this.audioFrameFinder=h;const{codedWidth:f,codedHeight:d}=a.video??{};f&&d&&(this.vfRotater=oL(f,d,u.rotationDeg)),this._meta=aL(a,n,o,u.rotationDeg),this.logger.info("Video meta:",this._meta);const p={...this._meta};this.width=this.width===0?p.width:this.width,this.height=this.height===0?p.height:this.height,this.trim.to=this.trim.to===0?p.duration:Math.min(this.trim.to,p.duration),this.trim.from=Math.min(this.trim.from,this.trim.to);const m=(this.trim.to-this.trim.from)/this.playbackRate;return this.duration=this.duration===0?m:this.duration,Math.abs(this.duration-m)>1&&(this.duration=m),this.display.to=this.display.from+this.duration,this.on("propsChange",g=>{g.volume!==void 0&&this.audioFrameFinder&&this.audioFrameFinder.setVolume(g.volume)}),p})}tickInterceptor=async(e,i)=>i;async tick(e){const i=e+this.trim.from;if(i>=this.trim.to||i>=this._meta.duration)return await this.tickInterceptor(e,{audio:await this.audioFrameFinder?.find(i)??[],state:"done"});const[s,r]=await Promise.all([this.audioFrameFinder?.find(i)??[],this.videoFrameFinder?.find(i).then(this.vfRotater)]);return r==null?await this.tickInterceptor(e,{audio:s,state:"success"}):await this.tickInterceptor(e,{video:r,audio:s,state:"success"})}thumbAborter=new AbortController;thumbFinder=null;async thumbnails(e=100,i){this.thumbAborter.abort(),this.thumbAborter=new AbortController;const s=this.thumbAborter.signal;await this.ready;const r="generate thumbnails aborted";if(s.aborted)throw Error(r);const{width:n,height:o}=this._meta,a=yL(e,Math.round(o*(e/n)),{quality:.1,type:"image/png"});return new Promise(async(l,u)=>{let c=[];const h=this.decoderConf.video;if(h==null||this.videoSamples.length===0){f();return}s.addEventListener("abort",()=>{u(Error(r))});async function f(){s.aborted||l(await Promise.all(c.map(async y=>({ts:y.ts,img:await y.img}))))}function d(y){c.push({ts:y.timestamp,img:a(y)})}const{start:p=0,end:m=this._meta.duration,step:g}=i??{};if(g){let y=p;for(this.thumbFinder&&(await this.thumbFinder.destroy(),this.thumbFinder=null),this.thumbFinder=new XS(await this.localFile.createReader(),this.videoSamples,{...h,hardwareAcceleration:this.opts.__unsafe_hardwareAcceleration__});y<=m&&!s.aborted;){const b=await this.thumbFinder.find(y);b&&d(b),y+=g}await this.thumbFinder.destroy(),this.thumbFinder=null,f()}else await gL(this.videoSamples,this.localFile,h,s,{start:p,end:m},(y,b)=>{y!=null&&d(y),b&&f()})})}async split(e){if(await this.ready,e<=0||e>=this._meta.duration)throw Error("time out of bounds");const[i,s]=fL(this.videoSamples,e),[r,n]=pL(this.audioSamples,e),o=new yi({localFile:this.localFile,videoSamples:i??[],audioSamples:r??[],decoderConf:this.decoderConf,headerBoxPos:this.headerBoxPos,parsedMatrix:this.parsedMatrix},this.opts,this.src),a=new yi({localFile:this.localFile,videoSamples:s??[],audioSamples:n??[],decoderConf:this.decoderConf,headerBoxPos:this.headerBoxPos,parsedMatrix:this.parsedMatrix},this.opts,this.src);return await Promise.all([o.ready,a.ready]),[o,a]}addEffect(e){this.effects.push(e)}editEffect(e,i){const s=this.effects.find(r=>r.id===e);s&&Object.assign(s,i)}removeEffect(e){const i=this.effects.findIndex(s=>s.id===e);i!==-1&&this.effects.splice(i,1)}async clone(){await this.ready;const e=new yi({localFile:this.localFile,videoSamples:[...this.videoSamples],audioSamples:[...this.audioSamples],decoderConf:this.decoderConf,headerBoxPos:this.headerBoxPos,parsedMatrix:this.parsedMatrix},this.opts,this.src);return await e.ready,e.tickInterceptor=this.tickInterceptor,this.copyStateTo(e),e.id=this.id,e.effects=[...this.effects],e}async splitTrack(){await this.ready;const e=[];if(this.videoSamples.length>0){const i=new yi({localFile:this.localFile,videoSamples:[...this.videoSamples],audioSamples:[],decoderConf:{video:this.decoderConf.video,audio:null},headerBoxPos:this.headerBoxPos,parsedMatrix:this.parsedMatrix},this.opts,this.src);await i.ready,i.tickInterceptor=this.tickInterceptor,e.push(i)}if(this.audioSamples.length>0){const i=new yi({localFile:this.localFile,videoSamples:[],audioSamples:[...this.audioSamples],decoderConf:{audio:this.decoderConf.audio,video:null},headerBoxPos:this.headerBoxPos,parsedMatrix:this.parsedMatrix},this.opts,this.src);await i.ready,i.tickInterceptor=this.tickInterceptor,e.push(i)}return e}cleanupThumbnails=async()=>{this.thumbAborter.abort(),this.thumbFinder&&(await this.thumbFinder.destroy(),this.thumbFinder=null)};destroy(){this.destroyed||(this.destroyed=!0,this.logger.info("Video destroy"),super.destroy(),this.thumbAborter.abort(),this.thumbFinder?.destroy(),this.thumbFinder=null,this.videoFrameFinder?.destroy(),this.audioFrameFinder?.destroy())}toJSON(e=!1){return{...super.toJSON(e),type:"Video",audio:this.audio,volume:this.volume,id:this.id,effects:this.effects}}static async fromObject(e){if(e.type!=="Video")throw new Error(`Expected Video, got ${e.type}`);const i=e.audio!==void 0?{audio:e.audio,volume:e.volume}:{volume:e.volume},s=await sn.getReadableStream(e.src),r=new yi(s,i,e.src);return await r.ready,r.left=e.left,r.top=e.top,r.width=e.width,r.height=e.height,r.angle=e.angle,r.display.from=e.display.from,r.display.to=e.display.to,r.duration=e.duration,r.playbackRate=e.playbackRate,r.zIndex=e.zIndex,r.opacity=e.opacity,r.flip=e.flip,e.style&&(r.style={...r.style,...e.style}),e.animation&&r.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(r.id=e.id),e.effects&&(r.effects=e.effects),e.transition&&(r.transition=e.transition),e.trim&&(r.trim.from=e.trim.from<1e6?e.trim.from*1e6:e.trim.from,r.trim.to=e.trim.to<1e6?e.trim.to*1e6:e.trim.to),e.volume!==void 0&&(r.volume=e.volume),r}async createPlaybackElement(){await this.ready;const i=this.localFile;if(!i||typeof i.getOriginFile!="function")throw new Error("Video does not have a local file for playback");const s=await i.getOriginFile();if(!s)throw new Error("Failed to get origin file from VideoClip");const r=URL.createObjectURL(s),n=document.createElement("video");return n.crossOrigin="anonymous",n.muted=!0,n.autoplay=!1,n.playsInline=!0,n.preload="auto",n.loop=!1,n.src=r,await new Promise((o,a)=>{const l=()=>{n.removeEventListener("loadeddata",l),n.removeEventListener("error",u),n.pause(),n.currentTime=0,o()},u=()=>{n.removeEventListener("loadeddata",l),n.removeEventListener("error",u),a(new Error("Failed to load video"))};n.addEventListener("loadeddata",l,{once:!0}),n.addEventListener("error",u,{once:!0}),n.load()}),{element:n,objectUrl:r}}async play(e,i){const s=e,r=i+this.trim.from/1e6;if(Math.abs(s.currentTime-r)>.1&&(s.currentTime=r),s.muted=!1,s.paused)try{await s.play()}catch{try{await s.play()}catch(o){console.warn("Failed to play video:",o)}}}pause(e){const i=e;i.pause(),i.muted=!0}async seek(e,i){const s=e,r=i+this.trim.from/1e6;return s.pause(),s.currentTime=r,new Promise(n=>{if(Math.abs(s.currentTime-i)<.01){n();return}const o=()=>{s.removeEventListener("seeked",o),n()};s.addEventListener("seeked",o,{once:!0}),setTimeout(()=>{s.removeEventListener("seeked",o),n()},500)})}syncPlayback(e,i,s){const r=e,n=(this.trim.to-this.trim.from)/1e6,o=s>=0&&s<n,a=s+this.trim.from/1e6;r.volume=this.volume,i&&o?r.paused?this.play(r,s).catch(console.warn):(r.muted&&(r.muted=!1),(r.ended||r.currentTime>=this.trim.to/1e6)&&(r.currentTime=a,r.play().catch(console.warn))):(r.paused||r.pause(),r.muted=!0,o&&Math.abs(r.currentTime-a)>.1&&(r.currentTime=a))}cleanupPlayback(e,i){const s=e;s.pause(),s.removeAttribute("src"),s.load(),i&&URL.revokeObjectURL(i)}async scaleToFit(e,i){await this.ready;const{width:s,height:r}=this.meta;if(s===0||r===0)return;const n=Math.min(e/s,i/r);this.width=s*n,this.height=r*n}async scaleToFill(e,i){await this.ready;const{width:s,height:r}=this.meta;if(s===0||r===0)return;const n=Math.max(e/s,i/r);this.width=s*n,this.height=r*n}centerInScene(e,i){this.left=(e-this.width)/2,this.top=(i-this.height)/2}}function aL(t,e,i,s){const r={duration:0,width:0,height:0,audioSampleRate:0,audioChanCount:0};if(t.video!=null&&e.length>0){r.width=t.video.codedWidth??0,r.height=t.video.codedHeight??0;const a=(Math.round(s/90)*90+360)%360;(a===90||a===270)&&([r.width,r.height]=[r.height,r.width])}t.audio!=null&&i.length>0&&(r.audioSampleRate=si.sampleRate,r.audioChanCount=si.channelCount);let n=0,o=0;if(e.length>0)for(let a=e.length-1;a>=0;a--){const l=e[a];if(!l.deleted){n=l.cts+l.duration;break}}if(i.length>0){const a=i.at(-1);o=a.cts+a.duration}return r.duration=Math.max(n,o),r}function lL(t,e,i,s,r){return{audioFrameFinder:r===0||t.audio==null||s.length===0?null:new uL(e,s,t.audio,{volume:r,targetSampleRate:si.sampleRate}),videoFrameFinder:t.video==null||i.length===0?null:new XS(e,i,t.video)}}async function Kx(t,e={}){let i=null;const s={video:null,audio:null};let r=[],n=[],o=[];const a={perspective:1,rotationRad:0,rotationDeg:0,scaleX:1,scaleY:1,translateX:0,translateY:0};let l=-1,u=-1;const c=await t.createReader();await rL(c,async f=>{i=f.info;const d=f.mp4boxFile.ftyp;o.push({start:d.start,size:d.size});const p=f.mp4boxFile.moov;o.push({start:p.start,size:p.size}),Object.assign(a,nL(i.videoTracks[0]?.matrix));let{videoDecoderConf:m,audioDecoderConf:g}=Q6(f.mp4boxFile,f.info);if(s.video=m??null,s.audio=g??null,m==null&&g==null&&De.error("Video no video and audio track"),g!=null){const{supported:y}=await AudioDecoder.isConfigSupported(g);y||De.error(`Video audio codec is not supported: ${g.codec}`)}if(m!=null){const{supported:y}=await VideoDecoder.isConfigSupported(m);y||De.error(`Video video codec is not supported: ${m.codec}`)}De.info("mp4BoxFile moov ready",{...f.info,tracks:null,videoTracks:null,audioTracks:null},s)},(f,d,p)=>{if(d==="video"){l===-1&&(l=p[0].dts);for(const m of p)r.push(Zx(m,l,"video"))}else if(d==="audio"&&e.audio){u===-1&&(u=p[0].dts);for(const m of p)n.push(Zx(m,u,"audio"))}}),await c.close();const h=r.at(-1)??n.at(-1);if(i==null)throw Error("Video stream is done, but not emit ready");if(h==null)throw Error("Video stream not contain any sample");return Bg(r),De.info("mp4 stream parsed"),{videoSamples:r,audioSamples:n,decoderConf:s,headerBoxPos:o,parsedMatrix:a}}function Zx(t,e=0,i){let s=t.offset;const r=i==="video"&&t.is_sync?mL(t.data,t.description.type):-1;let n=t.size;return r>0&&(s+=r,n-=r),{...t,is_idr:r>=0,offset:s,size:n,cts:(t.cts-e)/t.timescale*1e6,dts:(t.dts-e)/t.timescale*1e6,duration:t.duration/t.timescale*1e6,timescale:1e6,data:i==="video"?null:t.data}}class XS{constructor(e,i,s){this.localFileReader=e,this.samples=i,this.conf=s}decoder=null;timestamp=0;curAborter={abort:!1,st:performance.now()};find=async e=>{(this.decoder==null||this.decoder.state==="closed"||e<=this.timestamp||e-this.timestamp>3e6)&&this.reset(e),this.curAborter.abort=!0,this.timestamp=e,this.curAborter={abort:!1,st:performance.now()};const i=await this.parseFrame(e,this.decoder,this.curAborter);return this.sleepCnt=0,i};lastVfDur=0;downgradeSoftDecode=!1;videoDecCursorIdx=0;videoFrames=[];outputFrameCnt=0;inputChunkCnt=0;sleepCnt=0;predecodeErr=!1;parseFrame=async(e,i,s)=>{if(i==null||i.state==="closed"||s.abort)return null;if(this.videoFrames.length>0){const r=this.videoFrames[0];return e<r.timestamp?null:(this.videoFrames.shift(),e>r.timestamp+(r.duration??0)?(r.close(),await this.parseFrame(e,i,s)):(!this.predecodeErr&&this.videoFrames.length<10&&this.startDecode(i).catch(n=>{throw this.predecodeErr=!0,this.reset(e),n}),r))}if(this.decoding||this.outputFrameCnt<this.inputChunkCnt&&i.decodeQueueSize>0){if(performance.now()-s.st>6e3)throw Error(`Video.tick video timeout, ${JSON.stringify(this.getState())}`);this.sleepCnt+=1,await b2(15)}else{if(this.videoDecCursorIdx>=this.samples.length)return null;try{await this.startDecode(i)}catch(r){throw this.reset(e),r}}return await this.parseFrame(e,i,s)};decoding=!1;startDecode=async e=>{if(this.decoding||e.decodeQueueSize>600)return;let i=this.videoDecCursorIdx+1;if(i>this.samples.length)return;this.decoding=!0;let s=!1;for(;i<this.samples.length;i++){const r=this.samples[i];if(!s&&!r.deleted&&(s=!0),r.is_idr)break}if(s){const r=this.samples.slice(this.videoDecCursorIdx,i);if(r[0]?.is_idr!==!0)De.warn("First sample not idr frame");else{const n=performance.now(),o=await jS(r,this.localFileReader),a=performance.now()-n;if(a>1e3){const l=r[0],u=r.at(-1),c=u.offset+u.size-l.offset;De.warn(`Read video samples time cost: ${Math.round(a)}ms, file chunk size: ${c}`)}if(e.state==="closed")return;this.lastVfDur=o[0]?.duration??0,Ug(e,o,{onDecodingError:l=>{if(this.downgradeSoftDecode)throw l;this.outputFrameCnt===0&&(this.downgradeSoftDecode=!0,De.warn("Downgrade to software decode"),this.reset())}}),this.inputChunkCnt+=o.length}}this.videoDecCursorIdx=i,this.decoding=!1};reset=e=>{if(this.decoding=!1,this.videoFrames.forEach(s=>s.close()),this.videoFrames=[],e==null||e===0)this.videoDecCursorIdx=0;else{let s=0;for(let r=0;r<this.samples.length;r++){const n=this.samples[r];if(n.is_idr&&(s=r),!(n.cts<e)){this.videoDecCursorIdx=s;break}}}this.inputChunkCnt=0,this.outputFrameCnt=0,this.decoder?.state!=="closed"&&this.decoder?.close();const i={...this.conf,...this.downgradeSoftDecode?{hardwareAcceleration:"prefer-software"}:{}};this.decoder=new VideoDecoder({output:s=>{if(this.outputFrameCnt+=1,s.timestamp===-1){s.close();return}let r=s;s.duration==null&&(r=new VideoFrame(s,{duration:this.lastVfDur}),s.close()),this.videoFrames.push(r)},error:s=>{if(s.message.includes("Codec reclaimed due to inactivity")){this.decoder=null,De.warn(s.message);return}const r=`VideoFinder VideoDecoder err: ${s.message}, config: ${JSON.stringify(i)}, state: ${JSON.stringify(this.getState())}`;throw De.error(r),Error(r)}}),this.decoder.configure(i)};getState=()=>({time:this.timestamp,decState:this.decoder?.state,decQSize:this.decoder?.decodeQueueSize,decCursorIdx:this.videoDecCursorIdx,sampleLen:this.samples.length,inputCnt:this.inputChunkCnt,outputCnt:this.outputFrameCnt,cacheFrameLen:this.videoFrames.length,softDecode:this.downgradeSoftDecode,clipIdCnt:X0,sleepCnt:this.sleepCnt,memInfo:KS()});destroy=async()=>{if(this.curAborter.abort=!0,this.videoFrames.forEach(e=>e.close()),this.videoFrames=[],this.decoder&&this.decoder.state!=="closed"){try{await this.decoder.flush()}catch{}try{this.decoder.close()}catch{}}this.decoder=null,this.localFileReader.close()}}function cL(t,e){for(let i=0;i<e.length;i++){const s=e[i];if(t>=s.cts&&t<s.cts+s.duration)return i;if(s.cts>t)break}return 0}class uL{constructor(e,i,s,r){this.localFileReader=e,this.samples=i,this.conf=s,this.volume=r.volume,this.sampleRate=r.targetSampleRate}volume=1;sampleRate;setVolume(e){this.volume=e,this.reset()}decoder=null;curAborter={abort:!1,st:performance.now()};find=async e=>{const i=e<=this.timestamp||e-this.timestamp>1e5;(this.decoder==null||this.decoder.state==="closed"||i)&&this.reset(),i&&(this.timestamp=e,this.decCursorIdx=cL(e,this.samples)),this.curAborter.abort=!0;const s=e-this.timestamp;this.timestamp=e,this.curAborter={abort:!1,st:performance.now()};const r=await this.parseFrame(Math.ceil(s*(this.sampleRate/1e6)),this.decoder,this.curAborter);return this.sleepCnt=0,r};timestamp=0;decCursorIdx=0;pcmData={frameCnt:0,data:[]};sleepCnt=0;parseFrame=async(e,i=null,s)=>{if(i==null||s.abort||i.state==="closed"||e===0)return[];const r=this.pcmData.frameCnt-e;if(r>0)return r<si.sampleRate/10&&this.startDecode(i),Jx(this.pcmData,e);if(i.decoding){if(performance.now()-s.st>3e3)throw s.abort=!0,Error(`Video.tick audio timeout, ${JSON.stringify(this.getState())}`);this.sleepCnt+=1,await b2(15)}else{if(this.decCursorIdx>=this.samples.length-1)return Jx(this.pcmData,this.pcmData.frameCnt);this.startDecode(i)}return this.parseFrame(e,i,s)};startDecode=e=>{if(e.decodeQueueSize>10)return;const s=[];let r=this.decCursorIdx;for(;r<this.samples.length;){const n=this.samples[r];if(r+=1,!n.deleted&&(s.push(n),s.length>=10))break}this.decCursorIdx=r,e.decode(s.map(n=>new EncodedAudioChunk({type:"key",timestamp:n.cts,duration:n.duration,data:n.data})))};reset=()=>{this.timestamp=0,this.decCursorIdx=0,this.pcmData={frameCnt:0,data:[]},this.decoder?.close(),this.decoder=hL(this.conf,{resampleRate:si.sampleRate,volume:this.volume},e=>{this.pcmData.data.push(e),this.pcmData.frameCnt+=e[0].length})};getState=()=>({time:this.timestamp,decState:this.decoder?.state,decQSize:this.decoder?.decodeQueueSize,decCursorIdx:this.decCursorIdx,sampleLen:this.samples.length,pcmLen:this.pcmData.frameCnt,clipIdCnt:X0,sleepCnt:this.sleepCnt,memInfo:KS()});destroy=()=>{this.decoder=null,this.curAborter.abort=!0,this.pcmData={frameCnt:0,data:[]},this.localFileReader.close()}}function hL(t,e,i){let s=0,r=0;const n=c=>{if(r+=1,c.length!==0){if(e.volume!==1)for(const h of c)for(let f=0;f<h.length;f++)h[f]*=e.volume;c.length===1&&(c=[c[0],c[0]]),i(c)}},o=dL(n),a=e.resampleRate!==t.sampleRate;let l=new AudioDecoder({output:c=>{const h=kB(c);a?o(()=>PB(h,c.sampleRate,{rate:e.resampleRate,chanCount:c.numberOfChannels})):n(h),c.close()},error:c=>{c.message.includes("Codec reclaimed due to inactivity")||u("Video AudioDecoder err",c)}});l.configure(t);function u(c,h){const f=`${c}: ${h.message}, state: ${JSON.stringify({qSize:l.decodeQueueSize,state:l.state,inputCnt:s,outputCnt:r})}`;throw De.error(f),Error(f)}return{decode(c){s+=c.length;try{for(const h of c)l.decode(h)}catch(h){u("decode audio chunk error",h)}},close(){l.state!=="closed"&&l.close()},get decoding(){return s>r&&l.decodeQueueSize>0},get state(){return l.state},get decodeQueueSize(){return l.decodeQueueSize}}}function dL(t){const e=[];let i=0;function s(o,a){e[a]=o,r()}function r(){const o=e[i];o!=null&&(t(o),i+=1,r())}let n=0;return o=>{const a=n;n+=1,o().then(l=>s(l,a)).catch(l=>s(l,a))}}function Jx(t,e){const i=[new Float32Array(e),new Float32Array(e)];let s=0,r=0;for(;r<t.data.length;){const[n,o]=t.data[r];if(s+n.length>e){const a=e-s;i[0].set(n.subarray(0,a),s),i[1].set(o.subarray(0,a),s),t.data[r][0]=n.subarray(a,n.length),t.data[r][1]=o.subarray(a,o.length);break}else i[0].set(n,s),i[1].set(o,s),s+=n.length,r++}return t.data=t.data.slice(r),t.frameCnt-=e,i}async function jS(t,e){const i=t[0],s=t.at(-1);if(s==null)return[];const r=s.offset+s.size-i.offset;if(r<3e7){const n=new Uint8Array(await e.read(r,{at:i.offset}));return t.map(o=>{const a=o.offset-i.offset;return new EncodedVideoChunk({type:o.is_sync?"key":"delta",timestamp:o.cts,duration:o.duration,data:n.subarray(a,a+o.size)})})}return await Promise.all(t.map(async n=>new EncodedVideoChunk({type:n.is_sync?"key":"delta",timestamp:n.cts,duration:n.duration,data:await e.read(n.size,{at:n.offset})})))}function fL(t,e){if(t.length===0)return[];let i=0,s=0,r=-1;for(let l=0;l<t.length;l++){const u=t[l];if(r===-1&&e<u.cts&&(r=l-1),u.is_idr)if(r===-1)i=l;else{s=l;break}}const n=t[r];if(n==null)throw Error("Not found video sample by time");const o=t.slice(0,s===0?t.length:s).map(l=>({...l}));for(let l=i;l<o.length;l++){const u=o[l];e<u.cts&&(u.deleted=!0,u.cts=-1)}Bg(o);const a=t.slice(n.is_idr?r:i).map(l=>({...l,cts:l.cts-e}));for(const l of a)l.cts<0&&(l.deleted=!0,l.cts=-1);return Bg(a),[o,a]}function pL(t,e){if(t.length===0)return[];let i=-1;for(let n=0;n<t.length;n++){const o=t[n];if(!(e>o.cts)){i=n;break}}if(i===-1)throw Error("Not found audio sample by time");const s=t.slice(0,i).map(n=>({...n})),r=t.slice(i).map(n=>({...n,cts:n.cts-e}));return[s,r]}function Ug(t,e,i){if(t.state==="configured"){for(let s=0;s<e.length;s++)t.decode(e[s]);t.flush().catch(s=>{if(!(s instanceof Error))throw s;if(s.message.includes("Decoding error")&&i.onDecodingError!=null){i.onDecodingError(s);return}if(!s.message.includes("Aborted due to close"))throw s})}}function mL(t,e){if(e!=="avc1"&&e!=="hvc1")return 0;const i=new DataView(t.buffer);for(let s=0;s<t.byteLength-4;){if(e==="avc1"){const r=i.getUint8(s+4)&31;if(r===5||r===7||r===8)return s}else if(e==="hvc1"){const r=i.getUint8(s+4)>>1&63;if(r===19||r===20||r===32||r===33||r===34)return s}s+=i.getUint32(s)+4}return-1}function Bg(t){let e=0,i=null;for(const s of t)if(!s.deleted){if(s.is_sync&&(e+=1),e>=2)break;(i==null||s.cts<i.cts)&&(i=s)}i!=null&&i.cts<2e5&&(i.duration+=i.cts,i.cts=0)}function KS(){try{const t=performance.memory;return{jsHeapSizeLimit:t.jsHeapSizeLimit,totalJSHeapSize:t.totalJSHeapSize,usedJSHeapSize:t.usedJSHeapSize,percentUsed:(t.usedJSHeapSize/t.jsHeapSizeLimit).toFixed(3),percentTotal:(t.totalJSHeapSize/t.jsHeapSizeLimit).toFixed(3)}}catch{return{}}}async function gL(t,e,i,s,r,n){const o=await e.createReader(),a=await jS(t.filter(c=>!c.deleted&&c.is_sync&&c.cts>=r.start&&c.cts<=r.end),o);if(a.length===0||s.aborted){n(null,!0);return}let l=0;Ug(u(),a,{onDecodingError:c=>{De.warn("thumbnailsByKeyFrame",c),l===0?Ug(u(!0),a,{onDecodingError:h=>{o.close(),De.error("thumbnailsByKeyFrame retry soft deocde",h)}}):(n(null,!0),o.close())}});function u(c=!1){const h={...i,...c?{hardwareAcceleration:"prefer-software"}:{}},f=new VideoDecoder({output:d=>{l+=1;const p=l===a.length;n(d,p),p&&(o.close(),f.state!=="closed"&&f.close())},error:d=>{const p=`thumbnails decoder error: ${d.message}, config: ${JSON.stringify(h)}, state: ${JSON.stringify({qSize:f.decodeQueueSize,state:f.state,outputCnt:l,inputCnt:a.length})}`;throw De.error(p),Error(p)}});return s.addEventListener("abort",()=>{o.close(),f.state!=="closed"&&f.close()}),f.configure(h),f}}function yL(t,e,i){const s=new OffscreenCanvas(t,e),r=s.getContext("2d");return async n=>(r.drawImage(n,0,0,t,e),n.close(),await s.convertToBlob(i))}class Li extends qs{type="Text";ready;_meta={duration:1/0,width:0,height:0};get meta(){return{...this._meta}}get width(){return this._width}set width(e){this.width!==e&&(this._width=e,this.refreshText(),this.emit("propsChange",{width:e}))}get height(){return this._height}set height(e){this.height!==e&&(this._height=e,this.refreshText(),this.emit("propsChange",{height:e}))}_lastContentWidth=0;_lastContentHeight=0;_text="";get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this.originalOpts&&this.textStyle&&this.refreshText())}get style(){return{fontSize:this.originalOpts.fontSize,fontFamily:this.originalOpts.fontFamily,fontWeight:this.originalOpts.fontWeight,fontStyle:this.originalOpts.fontStyle,fill:this.originalOpts.fill,align:this.originalOpts.align,stroke:this.originalOpts.stroke?typeof this.originalOpts.stroke=="object"?{color:this.originalOpts.stroke.color,width:this.originalOpts.stroke.width,join:this.originalOpts.stroke.join,cap:this.originalOpts.stroke.cap,miterLimit:this.originalOpts.stroke.miterLimit}:{color:this.originalOpts.stroke,width:this.originalOpts.strokeWidth??0}:void 0,dropShadow:this.originalOpts.dropShadow?{color:this.originalOpts.dropShadow.color??"#000000",alpha:this.originalOpts.dropShadow.alpha??.5,blur:this.originalOpts.dropShadow.blur??4,distance:this.originalOpts.dropShadow.distance??0,angle:this.originalOpts.dropShadow.angle??0}:void 0,wordWrap:this.originalOpts.wordWrap,wordWrapWidth:this.originalOpts.wordWrapWidth,lineHeight:this.originalOpts.lineHeight,letterSpacing:this.originalOpts.letterSpacing,textCase:this.originalOpts.textCase,textDecoration:this.originalOpts.textDecoration}}set style(e){this.updateStyle(e)}get textAlign(){return this.originalOpts.align||this.originalOpts.textAlign||"left"}set textAlign(e){this.updateStyle({align:e})}get verticalAlign(){return this.originalOpts.verticalAlign||this.originalOpts.textDecoration||"top"}set verticalAlign(e){["underline","overline","strikethrough","line-through"].includes(e)?(this.updateStyle({textDecoration:e==="strikethrough"?"line-through":e}),this.originalOpts.verticalAlign=e):this.updateStyle({verticalAlign:e})}get textCase(){return this.originalOpts.textCase||"none"}set textCase(e){this.updateStyle({textCase:e})}pixiTextContainer=null;wordTexts=[];textStyle;textStyleBase;renderTexture=null;externalRenderer=null;pixiApp=null;originalOpts;id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;effects=[];constructor(e,i={},s){super(),this.originalOpts={...i},this.text=e,this.externalRenderer=s??null;const r=this.createStyleFromOpts(i),{wordWrap:n,wordWrapWidth:o,lineHeight:a,letterSpacing:l,fill:u,...c}=r,h=new Mt(r),f=new Mt(c);this.textStyle=h,this.textStyleBase=f,this.ready=(async()=>(await this.refreshText(),{...this._meta}))()}setRenderer(e){this.externalRenderer=e}async getRenderer(){if(this.externalRenderer!=null)return this.externalRenderer;if(this.pixiApp?.renderer==null)throw new Error("TextClip: Failed to create renderer. Please provide a renderer via constructor or setRenderer() method.");return this.pixiApp.renderer}async getTexture(){return this.pixiTextContainer==null||this.renderTexture==null?null:((await this.getRenderer()).render({container:this.pixiTextContainer,target:this.renderTexture}),this.renderTexture)}async tick(e){if(await this.ready,this.pixiTextContainer==null||this.renderTexture==null)throw new Error("Text not initialized");if(this.renderTexture.width<=0||this.renderTexture.height<=0)throw new Error(`Invalid RenderTexture dimensions: ${this.renderTexture.width}x${this.renderTexture.height}`);(await this.getRenderer()).render({container:this.pixiTextContainer,target:this.renderTexture});const s=this.renderTexture.source?.resource?.source;let r;if(s instanceof HTMLCanvasElement)r=await createImageBitmap(s);else if(s instanceof OffscreenCanvas)r=await createImageBitmap(s);else{const a=(await this.getRenderer()).extract.canvas(this.renderTexture);if(a instanceof HTMLCanvasElement||a instanceof OffscreenCanvas)r=await createImageBitmap(a);else{const l=this.renderTexture.width,u=this.renderTexture.height;throw new OffscreenCanvas(l,u).getContext("2d")==null?new Error("Failed to create 2d context for fallback rendering"):new Error("Unable to extract canvas from render texture")}}return{video:r,state:"success"}}async split(e){await this.ready;const i=await this.clone(),s=await this.clone();return[i,s]}addEffect(e){this.effects.push(e)}editEffect(e,i){const s=this.effects.find(r=>r.id===e);s&&Object.assign(s,i)}removeEffect(e){const i=this.effects.findIndex(s=>s.id===e);i!==-1&&this.effects.splice(i,1)}async clone(){await this.ready;const e=this.textStyle,i=this.originalOpts||{},s=o=>{if(o!=null){if(typeof o=="number")return o;if(o instanceof st)return o.toNumber()}},r={fontSize:i.fontSize??e.fontSize,fontFamily:i.fontFamily??(Array.isArray(e.fontFamily)?e.fontFamily[0]:typeof e.fontFamily=="string"?e.fontFamily:"Roboto"),fontWeight:i.fontWeight??e.fontWeight,fontStyle:i.fontStyle??e.fontStyle,align:i.align??(e.align==="justify"?"left":e.align),textCase:i.textCase,textDecoration:i.textDecoration};if(i.fill&&typeof i.fill=="object"&&"type"in i.fill&&i.fill.type==="gradient")r.fill=i.fill;else{const o=s(e.fill);r.fill=o??16777215}if(i.stroke&&typeof i.stroke=="object"&&"color"in i.stroke)r.stroke=i.stroke;else{const o=s(e.stroke);o!==void 0&&(r.stroke=o),r.strokeWidth=i.strokeWidth??e.strokeThickness??0}if(i.dropShadow)r.dropShadow=i.dropShadow;else if(e.dropShadow){const o=e.dropShadow,a=s(o.color);a!==void 0&&(r.dropShadow={color:a,alpha:o.alpha,blur:o.blur,angle:o.angle,distance:o.distance})}if(i.wordWrap!==void 0?(r.wordWrap=i.wordWrap,r.wordWrapWidth=i.wordWrapWidth):e.wordWrap&&(r.wordWrap=e.wordWrap,r.wordWrapWidth=e.wordWrapWidth),i.lineHeight!==void 0)r.lineHeight=i.lineHeight;else if(e.lineHeight!==void 0){const o=r.fontSize??e.fontSize??40;r.lineHeight=e.lineHeight/o}i.letterSpacing!==void 0?r.letterSpacing=i.letterSpacing:e.letterSpacing!==void 0&&(r.letterSpacing=e.letterSpacing);const n=new Li(this.text,r);return await n.ready,this.copyStateTo(n),n.id=this.id,n.effects=[...this.effects],n}async updateStyle(e){this.originalOpts={...this.originalOpts,...e};const i=this.createStyleFromOpts(this.originalOpts),{wordWrap:s,wordWrapWidth:r,lineHeight:n,letterSpacing:o,fill:a,...l}=i,u=new Mt(l),c=new Mt(i);this.textStyle=c,this.textStyleBase=u,await this.refreshText()}async refreshText(){const e=this.textStyle,i=this.textStyleBase;let s=this.text;const r=this.originalOpts.textCase;r==="uppercase"?s=s.toUpperCase():r==="lowercase"?s=s.toLowerCase():r==="title"&&(s=s.replace(/\w\S*/g,I=>I.charAt(0).toUpperCase()+I.substring(1).toLowerCase())),this.pixiTextContainer?this.pixiTextContainer.removeChildren():this.pixiTextContainer=new it;const n=s.split(/\s+/).filter(I=>I.length>0);this.wordTexts.forEach(I=>I.destroy()),this.wordTexts=n.map(I=>{const E=new _l({text:I,style:this.textStyle});return this.pixiTextContainer.addChild(E),E});const o=this.originalOpts.textDecoration||this.originalOpts.verticalAlign,a=this.originalOpts.lineHeight??1,l=e.fontSize??40,u=l*a,c=hr.measureText(" ",i),h=new _l({text:" ",style:this.textStyleBase}),f=Math.ceil(h.getLocalBounds().width||h.width||c.width);h.destroy();const d=e.wordWrap&&e.wordWrapWidth>0?e.wordWrapWidth:1e5,p=[];let m=[],g=0,y=0;this.wordTexts.forEach(I=>{const E=I.getLocalBounds(),U=Math.ceil(E.width||I.width),Z=Math.ceil(E.height||I.height),se=g+(g>0?f:0)+U;se<=d||m.length===0?(m.push(I),g=se,y=Math.max(y,Z)):(m.length>0&&p.push({words:m,width:g,height:Math.max(y,u)}),m=[I],g=U,y=Z)}),m.length>0&&p.push({words:m,width:g,height:Math.max(y,u)});let b=0,v=0;p.forEach(I=>{b=Math.max(b,I.width),v+=I.height});const x=b,_=v;let S=x;e.wordWrap&&e.wordWrapWidth>0&&(S=Math.max(S,e.wordWrapWidth));const T=_,A=this.width===0||Math.abs(this.width-this._lastContentWidth)<.1,w=this.height===0||Math.abs(this.height-this._lastContentHeight)<.1,k=A?S:Math.max(S,this.width||0),F=w?T:Math.max(T,this.height||0);this._lastContentWidth=S,this._lastContentHeight=T;let O=0;const V=this.originalOpts.verticalAlign||"top";V==="center"?O=(F-_)/2:V==="bottom"&&(O=F-_);let W=O;const ie=new dt;let R=!1;p.forEach(I=>{let E=0;const U=this.textAlign;U==="center"?E=(k-I.width)/2:U==="right"&&(E=k-I.width);const Z=E;if(I.words.forEach((se,te)=>{se.x=Math.round(E),se.y=Math.round(W),E+=(se.getLocalBounds().width||se.width)+(te<I.words.length-1?f:0)}),o&&o!=="none"&&["underline","overline","strikethrough","line-through"].includes(o)){R=!0;const se=o==="strikethrough"?"line-through":o,te=Math.max(1,l/12);let q=16777215;typeof e.fill=="number"?q=e.fill:e.fill&&typeof e.fill=="object"&&"fill"in e.fill&&(q=16777215);let he=0;se==="underline"?he=I.height:se==="line-through"?he=I.height/2:se==="overline"&&(he=0),ie.rect(Z,W+he,I.width,te),ie.fill(q)}W+=I.height}),R&&this.pixiTextContainer.addChild(ie),this.renderTexture&&this.renderTexture.destroy(),this.renderTexture=jt.create({width:k,height:F}),this._meta.width=k,this._meta.height=F,this._width=k,this._height=F,this.duration===0&&this._meta.duration!==1/0&&(this.duration=this._meta.duration,this.display.to=this.display.from+this.duration)}createStyleFromOpts(e){const i=e.fontSize??40,s=e.lineHeight??1,r={fontSize:i,fontFamily:e.fontFamily??"Roboto",fontWeight:e.fontWeight??"normal",fontStyle:e.fontStyle??"normal",align:e.align??"left",wordWrap:e.wordWrap??!1,wordWrapWidth:e.wordWrapWidth??100,lineHeight:i*s,letterSpacing:e.letterSpacing??0};if(e.fill&&typeof e.fill=="object"&&e.fill.type==="gradient"){const n=new ui(e.fill.x0,e.fill.y0,e.fill.x1,e.fill.y1);e.fill.colors.forEach(({ratio:o,color:a})=>{const l=typeof a=="number"?a:ut(a)??16777215;n.addColorStop(o,l)}),r.fill={fill:n}}else{const{color:n,alpha:o}=sr(e.fill);r.fill=n,o<1&&(r.fillAlpha=o)}if(e.stroke&&typeof e.stroke=="object"&&"color"in e.stroke){const n=ut(e.stroke.color);n!==void 0&&(r.stroke={color:n,width:e.stroke.width,join:e.stroke.join,cap:e.stroke.cap,miterLimit:e.stroke.miterLimit})}else{const n=ut(e.stroke),o=e.strokeWidth??0;n!==void 0&&o>0?r.stroke={color:n,width:o}:e.strokeWidth&&e.strokeWidth>0&&(r.stroke={color:0,width:e.strokeWidth})}if(e.dropShadow){const n=ut(e.dropShadow.color);n!==void 0&&(r.dropShadow={color:n,alpha:e.dropShadow.alpha??.5,blur:e.dropShadow.blur??4,angle:e.dropShadow.angle??Math.PI/6,distance:e.dropShadow.distance??2})}return r}destroy(){if(!this.destroyed){De.info("Text destroy");try{this.pixiTextContainer!=null&&(this.pixiTextContainer.destroyed||this.pixiTextContainer.destroy({children:!0}))}catch{}finally{this.pixiTextContainer=null}try{this.renderTexture!=null&&this.renderTexture.destroyed!==!0&&this.renderTexture.destroy(!0)}catch{}finally{this.renderTexture=null}if(this.externalRenderer=null,this.pixiApp!=null)try{const e=this.pixiApp;e.destroyed!==!0&&e.renderer!=null&&this.pixiApp.destroy(!0,{children:!0,texture:!0})}catch{}finally{this.pixiApp=null}super.destroy()}}toJSON(e=!1){const i=super.toJSON(e),s={};return this.originalOpts.fontSize!==void 0&&(s.fontSize=this.originalOpts.fontSize),this.originalOpts.fontFamily!==void 0&&(s.fontFamily=this.originalOpts.fontFamily),this.originalOpts.fontWeight!==void 0&&(s.fontWeight=this.originalOpts.fontWeight),this.originalOpts.fontStyle!==void 0&&(s.fontStyle=this.originalOpts.fontStyle),this.originalOpts.fill!==void 0&&(s.color=this.originalOpts.fill),this.originalOpts.align!==void 0&&(s.align=this.originalOpts.align),this.originalOpts.wordWrap!==void 0&&(s.wordWrap=this.originalOpts.wordWrap),this.originalOpts.wordWrapWidth!==void 0&&(s.wordWrapWidth=this.originalOpts.wordWrapWidth),this.originalOpts.lineHeight!==void 0&&(s.lineHeight=this.originalOpts.lineHeight),this.originalOpts.letterSpacing!==void 0&&(s.letterSpacing=this.originalOpts.letterSpacing),this.originalOpts.stroke&&(typeof this.originalOpts.stroke=="object"?s.stroke={color:this.originalOpts.stroke.color,width:this.originalOpts.stroke.width,join:this.originalOpts.stroke.join,cap:this.originalOpts.stroke.cap,miterLimit:this.originalOpts.stroke.miterLimit}:s.stroke={color:this.originalOpts.stroke,width:this.originalOpts.strokeWidth??0}),this.originalOpts.dropShadow&&(s.shadow={color:this.originalOpts.dropShadow.color??"#000000",alpha:this.originalOpts.dropShadow.alpha??.5,blur:this.originalOpts.dropShadow.blur??4,distance:this.originalOpts.dropShadow.distance??0,angle:this.originalOpts.dropShadow.angle??0}),{...i,type:"Text",text:this.text,style:s,id:this.id,effects:this.effects}}static async fromObject(e){if(e.type!=="Text")throw new Error(`Expected Text, got ${e.type}`);const i=e.text||"",s=e.style||{},r={};s.fontSize!==void 0&&(r.fontSize=s.fontSize),s.fontFamily!==void 0&&(r.fontFamily=s.fontFamily),s.fontWeight!==void 0&&(r.fontWeight=s.fontWeight),s.fontStyle!==void 0&&(r.fontStyle=s.fontStyle),s.color!==void 0&&(r.fill=s.color),s.align!==void 0&&(r.align=s.align),s.wordWrap!==void 0&&(r.wordWrap=s.wordWrap),s.wordWrapWidth!==void 0&&(r.wordWrapWidth=s.wordWrapWidth),s.lineHeight!==void 0&&(r.lineHeight=s.lineHeight),s.letterSpacing!==void 0&&(r.letterSpacing=s.letterSpacing),s.stroke&&(s.stroke.join||s.stroke.cap||s.stroke.miterLimit!==void 0?r.stroke={color:s.stroke.color,width:s.stroke.width,join:s.stroke.join,cap:s.stroke.cap,miterLimit:s.stroke.miterLimit}:(r.stroke=s.stroke.color,r.strokeWidth=s.stroke.width)),s.shadow&&(r.dropShadow={color:s.shadow.color,alpha:s.shadow.alpha,blur:s.shadow.blur,distance:s.shadow.distance,angle:s.shadow.angle});const n=new Li(i,r);return n.left=e.left,n.top=e.top,n.width=e.width,n.height=e.height,n.angle=e.angle,n.display.from=e.display.from,n.display.to=e.display.to,n.duration=e.duration,n.playbackRate=e.playbackRate,n.zIndex=e.zIndex,n.opacity=e.opacity,n.flip=e.flip,e.animation&&n.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(n.id=e.id),e.effects&&(n.effects=e.effects),await n.ready,n}getVisibleHandles(){return["mr","mb","br","rot"]}}class Us extends qs{type="Effect";ready;_meta={duration:5e6,width:0,height:0};get meta(){return{...this._meta}}id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;effect;constructor(e){super(),this.effect={id:`eff_${Date.now()}`,key:e,name:e},this.ready=Promise.resolve(this._meta),this.duration=this._meta.duration}async clone(){const e=new Us(this.effect.key);return this.copyStateTo(e),e.id=this.id,e}async tick(e){return{video:void 0,state:"success"}}async split(e){const i=await this.clone(),s=await this.clone();return[i,s]}toJSON(e=!1){return{...super.toJSON(e),type:"Effect",effect:this.effect,id:this.id,effects:this.effects}}static async fromObject(e){if(e.type!=="Effect")throw new Error(`Expected Effect, got ${e.type}`);const i=new Us(e.effect.key);return i.effect=e.effect,i.left=e.left,i.top=e.top,i.width=e.width,i.height=e.height,i.angle=e.angle,i.display.from=e.display.from,i.display.to=e.display.to,i.duration=e.duration,i.playbackRate=e.playbackRate,i.zIndex=e.zIndex,i.opacity=e.opacity,i.flip=e.flip,e.animation&&i.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(i.id=e.id),await i.ready,i}}class j0 extends qs{type="Placeholder";meta={width:0,height:0,duration:0};constructor(e,i={},s="Placeholder"){super(),this.type=s,this.src=e,this.meta={width:i.width||1280,height:i.height||720,duration:i.duration||5e6},this.width=this.meta.width,this.height=this.meta.height,this.duration=this.meta.duration,this.trim.to=this.duration,this.display.to=this.display.from+this.duration,this.ready=Promise.resolve(this.meta)}placeholderFrame=null;async tick(e){if(!this.placeholderFrame){const i=document.createElement("canvas");i.width=this.meta.width,i.height=this.meta.height;const s=i.getContext("2d");s&&(s.fillStyle="#1e1e1e",s.fillRect(0,0,i.width,i.height),s.fillStyle="#ffffff",s.font=`${Math.floor(i.height/10)}px sans-serif`,s.textAlign="center",s.textBaseline="middle",s.fillText("Loading...",i.width/2,i.height/2),s.strokeStyle="#333333",s.lineWidth=10,s.strokeRect(0,0,i.width,i.height)),this.placeholderFrame=await createImageBitmap(i)}return{video:this.placeholderFrame,state:e>=this.duration?"done":"success",audio:[]}}async clone(){const e=new j0(this.src,this.meta);return this.copyStateTo(e),e.id=this.id,e}async split(e){const i=await this.clone(),s=await this.clone();return i.trim.to=e+this.trim.from,s.trim.from=e+this.trim.from,i.duration=i.trim.to-i.trim.from,s.duration=s.trim.to-s.trim.from,i.display.to=i.display.from+i.duration,s.display.from=i.display.to,s.display.to=s.display.from+s.duration,[i,s]}}class Ms extends qs{type="Transition";ready;_meta={duration:2e6,width:0,height:0};get meta(){return{...this._meta}}id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;transitionEffect;fromClipId=null;toClipId=null;constructor(e){super(),this.transitionEffect={id:`trans_${Date.now()}`,key:e,name:e},this.ready=Promise.resolve(this._meta),this.duration=this._meta.duration}async clone(){const e=new Ms(this.transitionEffect.key);return this.copyStateTo(e),e.fromClipId=this.fromClipId,e.toClipId=this.toClipId,e}async tick(e){return{video:void 0,state:"success"}}async split(e){const i=await this.clone(),s=await this.clone();return[i,s]}toJSON(e=!1){return{...super.toJSON(e),type:"Transition",transitionEffect:this.transitionEffect,fromClipId:this.fromClipId,toClipId:this.toClipId,id:this.id,effects:this.effects}}static async fromObject(e){if(e.type!=="Transition")throw new Error(`Expected Transition, got ${e.type}`);const i=new Ms(e.transitionEffect.key);return i.transitionEffect=e.transitionEffect,i.fromClipId=e.fromClipId||null,i.toClipId=e.toClipId||null,i.left=e.left,i.top=e.top,i.width=e.width,i.height=e.height,i.angle=e.angle,i.display.from=e.display.from,i.display.to=e.display.to,i.duration=e.duration,i.playbackRate=e.playbackRate,i.zIndex=e.zIndex,i.opacity=e.opacity,i.flip=e.flip,e.animation&&i.setAnimation(e.animation.keyFrames,e.animation.opts),e.id&&(i.id=e.id),await i.ready,i}}const vL=`
in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,xL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform float rotationCount; 

void main(void)
{
    vec2 center = vec2(0.35, 0.35);
    vec2 uvs = vTextureCoord.xy - center;
    
    // Rotacin en funcin de la cantidad de vueltas
    float angle = uTime * rotationCount * 6.28318530718;
    
    float cosAngle = cos(angle);
    float sinAngle = sin(angle);
    mat2 rotation = mat2(cosAngle, -sinAngle, sinAngle, cosAngle);
    
    uvs = rotation * uvs;
    uvs += center;
    
    if (uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0) {
        discard;
    }
    
    vec4 fg = texture2D(uTexture, uvs);
    gl_FragColor = fg;
}
`,bL={uTime:{value:0,type:"f32"},rotationCount:{value:4,type:"f32"}},_L=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

void main(void)
{
    vec2 uvs = vTextureCoord.xy;

    vec4 fg = texture2D(uTexture, vTextureCoord);

    fg.r = uvs.y + sin(uTime);

    gl_FragColor = fg;

}
`,wL={uTime:{value:0,type:"f32"}},SL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 bubbleColor;
uniform float bubbleCount;

float rand(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

float softCircle(vec2 uv, vec2 c, float r, float g) {
    float d = distance(uv, c);
    float base = 1.0 - smoothstep(r * 0.9, r, d);
    float halo = (1.0 - smoothstep(r, r * (1.0 + g), d));
    return base + halo * 0.5;
}

vec2 bubblePos(float id) {
    float fx = rand(vec2(id, 1.234));
    float fy = rand(vec2(id, 9.345));
    return vec2(fx, fy);
}

float bubbleRadius(float id) {
    return mix(0.015, 0.025, rand(vec2(id, 44.123)));
}

void main(void)
{
    vec2 uvs = vTextureCoord.xy;
    vec4 fg = texture2D(uTexture, uvs);

    float bubbles = 0.0;

    for(float i = 0.0; i < 200.0; i++) {

        if(i >= bubbleCount) break;
        float spawnSpeed = 8.0; 
        float spawnTime = (i / bubbleCount) / spawnSpeed;
        float t = uTime - spawnTime;

        if(t < 0.0) continue;

        float grow = pow(clamp(t, 0.0, 1.0), 0.35);

        vec2 pos = bubblePos(i);
        vec2 bubbleCenter = pos;

        float baseR = bubbleRadius(i);

        float r = baseR * grow;

        float phase = rand(vec2(i, 999.0)) * 6.28318;
        float pulse = sin(t * 1.6 + phase) * 0.5 + 0.5;
        float opacity = mix(0.2, 1.0, pulse);

        bubbles += softCircle(uvs, bubbleCenter, r, 0.8) * opacity;
    }

    fg.rgb += bubbleColor * bubbles;
    gl_FragColor = fg;
}
`,CL={uTime:{value:0,type:"f32"},bubbleColor:{value:[1,.85,.4],type:"vec3<f32>"},bubbleCount:{value:150,type:"f32"}},TL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;      
uniform float maxIntensity; 

void main(void)
{
    vec2 uvs = vTextureCoord.xy;
    vec4 color = texture2D(uTexture, uvs);

    float intensity = (sin(uTime) * 0.5 + 0.5) * maxIntensity;

    vec3 sepiaColor;
    sepiaColor.r = dot(color.rgb, vec3(0.393, 0.769, 0.189));
    sepiaColor.g = dot(color.rgb, vec3(0.349, 0.686, 0.168));
    sepiaColor.b = dot(color.rgb, vec3(0.272, 0.534, 0.131));

    color.rgb = mix(color.rgb, sepiaColor, intensity);

    gl_FragColor = color;
}
`,kL={uTime:{value:0,type:"f32"},maxIntensity:{value:1,type:"f32"}},AL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform vec3 colorStart;  
uniform vec3 colorEnd;    
uniform int direction;  

void main(void)
{
    vec2 uvs = vTextureCoord.xy;
    vec4 fg = texture2D(uTexture, uvs);

    float t = 0.0;
    if(direction == 0) {
        t = uvs.x; 
    } else if(direction == 1) {
        t = uvs.y;
    } else {
        t = (uvs.x + uvs.y) * 0.5;
    }

    vec3 gradientColor = mix(colorStart, colorEnd, t);

    fg.rgb = fg.rgb * gradientColor; 

    gl_FragColor = fg;
}
`,IL={colorStart:{value:[1,0,0],type:"vec3<f32>"},colorEnd:{value:[0,0,1],type:"vec3<f32>"},direction:{value:0,type:"i32"}},PL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float intensity;
uniform int direction;   

vec3 rainbow(float t) {
    float r = 0.5 + 0.5 * sin(6.28318 * (t + 0.0));
    float g = 0.5 + 0.5 * sin(6.28318 * (t + 0.33));
    float b = 0.5 + 0.5 * sin(6.28318 * (t + 0.66));
    return vec3(r, g, b);
}

void main(void)
{
    vec2 uvs = vTextureCoord.xy;
    vec4 fg = texture2D(uTexture, uvs);

    float t = 0.0;
    if(direction == 0) {
        t = uvs.x; 
    } else if(direction == 1) {
        t = uvs.y; 
    } else {
        t = (uvs.x + uvs.y) * 0.5; 
    }

    vec3 rainbowColor = rainbow(t);

    fg.rgb = fg.rgb * rainbowColor*intensity;

    gl_FragColor = fg;
}
`,EL={intensity:{value:1,type:"f32"},direction:{value:0,type:"i32"}},ML=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;     
uniform float intensity;  
uniform float sliceCount;   
uniform float rgbShift;     

float rand(float n) { return fract(sin(n) * 43758.5453123); }
float rand2(vec2 p) { return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453); }

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    float sliceId = floor(uv.y * sliceCount);
    float sliceShift = (rand(sliceId + uTime * 10.0) - 0.5) * 0.2 * intensity;

    uv.x += sliceShift;

    float rShift = rgbShift * intensity;
    float gShift = -rgbShift * 0.5 * intensity;
    float bShift = rgbShift * 0.75 * intensity;

    vec3 col;
    col.r = texture2D(uTexture, uv + vec2(rShift, 0.0)).r;
    col.g = texture2D(uTexture, uv + vec2(gShift, 0.0)).g;
    col.b = texture2D(uTexture, uv + vec2(bShift, 0.0)).b;

    float noise = rand2(vec2(uTime * 50.0, uv.y * 100.0));
    float noiseIntensity = noise * 0.15 * intensity;

    col += noiseIntensity;

    gl_FragColor = vec4(col, 1.0);
}
`,FL={uTime:{value:0,type:"f32"},intensity:{value:.5,type:"f32"},sliceCount:{value:12,type:"f32"},rgbShift:{value:.01,type:"f32"}},ZS=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float pixelSize;
uniform float uTime;
uniform float jitterStrength;

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    vec2 pixelUV = floor(uv / pixelSize) * pixelSize;

    float n1 = hash(pixelUV + uTime * 1.5);
    float n2 = hash(pixelUV * 2.3 + uTime * 1.7);

    vec2 jitter = (vec2(n1, n2) - 0.5) * jitterStrength * pixelSize;

    vec2 finalUV = pixelUV + jitter;

    finalUV = clamp(finalUV, 0.0, 1.0);
    vec4 color = texture2D(uTexture, finalUV);

    gl_FragColor = color;
}
`,JS={pixelSize:{value:.02,type:"f32"},uTime:{value:0,type:"f32"},jitterStrength:{value:.8,type:"f32"}},RL=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float glitchStrength;
uniform float glitchSpeed;

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123);
}

float rand2(vec2 p) {
    return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);
    if (base.a < 0.01) {
        gl_FragColor = base;
        return;
    }

    float lineNoise =
        hash(vec2(floor(uv.y * 300.0), uTime * glitchSpeed));

    float rOffset =
        (hash(vec2(uTime, 1.0)) - 0.5) * glitchStrength;

    float gOffset =
        (hash(vec2(uTime, 2.0)) - 0.5) * glitchStrength * 0.5;

    float bOffset =
        (hash(vec2(uTime, 3.0)) - 0.5) * glitchStrength;

    float rShift = rOffset * lineNoise;
    float gShift = gOffset * lineNoise;
    float bShift = bOffset * lineNoise;

    vec2 uvR = clamp(uv + vec2(rShift, 0.0), 0.0, 1.0);
    vec2 uvG = clamp(uv + vec2(gShift, 0.0), 0.0, 1.0);
    vec2 uvB = clamp(uv + vec2(bShift, 0.0), 0.0, 1.0);

    vec3 col;
    col.r = texture2D(uTexture, uvR).r;
    col.g = texture2D(uTexture, uvG).g;
    col.b = texture2D(uTexture, uvB).b;

    float noise =
        (rand2(vec2(uTime * 50.0, uv.y * 100.0)) - 0.5) * 0.15;

    col += noise;

    gl_FragColor = vec4(col, base.a);
}
`,zL={uTime:{value:0,type:"f32"},glitchStrength:{value:.02,type:"f32"},glitchSpeed:{value:2,type:"f32"}},UL=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float shiftAmount;
uniform float angle;
uniform float uTime;
uniform float wobbleAmount;
uniform float wobbleSpeed;

void main(void)
{
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);

    if (base.a < 0.01) {
        gl_FragColor = base;
        return;
    }

    vec2 dir = vec2(cos(angle), sin(angle));
    float wobble = sin(uTime * wobbleSpeed) * wobbleAmount;

    vec2 rUV = uv + dir * shiftAmount + vec2(wobble, 0.0);
    vec2 gUV = uv;
    vec2 bUV = uv - dir * shiftAmount - vec2(wobble, 0.0);

    rUV = clamp(rUV, 0.0, 1.0);
    gUV = clamp(gUV, 0.0, 1.0);
    bUV = clamp(bUV, 0.0, 1.0);

    float r = texture2D(uTexture, rUV).r;
    float g = texture2D(uTexture, gUV).g;
    float b = texture2D(uTexture, bUV).b;

    gl_FragColor = vec4(r, g, b, base.a);
}
`,BL={shiftAmount:{value:.01,type:"f32"},angle:{value:0,type:"f32"},uTime:{value:0,type:"f32"},wobbleAmount:{value:.003,type:"f32"},wobbleSpeed:{value:20,type:"f32"}},OL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float dotSize;       
uniform float intensity;     
uniform float angle;         
uniform float uTime;        
uniform float vibrateStrength;

float luminance(vec3 c) {
    return dot(c, vec3(0.299, 0.587, 0.114));
}

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    float ca = cos(angle);
    float sa = sin(angle);
    mat2 rot = mat2(ca, -sa, sa, ca);
    vec2 rotatedUV = rot * (uv - 0.5) + 0.5;
    vec2 grid = rotatedUV / dotSize;
    vec2 cell = floor(grid) + 0.5;

    vec2 cellCenter = cell * dotSize;

    float jitter = sin(uTime * 10.0 + cell.x * 12.989 + cell.y * 78.233) * 0.5;
    float dist = distance(rotatedUV, cellCenter + jitter * vibrateStrength * dotSize);
    vec4 texColor = texture2D(uTexture, uv);
    float lum = luminance(texColor.rgb);
    float radius = (1.0 - lum) * dotSize * 0.5;
    float mask = smoothstep(radius, radius * 0.8, dist);

    vec3 halftone = texColor.rgb * mask;
    texColor.rgb = mix(texColor.rgb, halftone, intensity);

    gl_FragColor = texColor;
}
`,DL={dotSize:{value:.03,type:"f32"},intensity:{value:1,type:"f32"},angle:{value:0,type:"f32"},uTime:{value:0,type:"f32"},vibrateStrength:{value:.2,type:"f32"}},LL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;     
uniform float amplitude; 
uniform float frequency;  
uniform float speed;    
uniform int direction;    

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    vec2 offset = vec2(0.0);

    if(direction == 0) {
        offset.y = sin((uv.x + uTime * speed) * frequency * 6.2831853) * amplitude;
    } else {
        offset.x = sin((uv.y + uTime * speed) * frequency * 6.2831853) * amplitude;
    }

    vec4 color = texture2D(uTexture, uv + offset);
    gl_FragColor = color;
}
`,NL={uTime:{value:0,type:"f32"},amplitude:{value:.02,type:"f32"},frequency:{value:3,type:"f32"},speed:{value:.5,type:"f32"},direction:{value:0,type:"i32"}},HL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;          // tiempo para animacin
uniform vec3 shineColor;      // color de los rayos
uniform float rayWidth;       // grosor del rayo
uniform float rayCount;       // cantidad de rayos
uniform float rotationSpeed;  // velocidad de rotacin

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec2 center = vec2(0.3, 0.35);

    vec2 dir = uv - center;

    float angle = atan(dir.y, dir.x);

    angle += uTime * rotationSpeed;

    float normAngle = fract(angle / 6.28318530718); // 2

    float rays = sin(normAngle * rayCount * 6.28318530718);

    float intensity = smoothstep(0.0, rayWidth, rays) - smoothstep(rayWidth, rayWidth*1.5, rays);

    vec4 color = texture2D(uTexture, uv);

    color.rgb += shineColor * intensity;

    gl_FragColor = color;
}
`,GL={uTime:{value:0,type:"f32"},shineColor:{value:[1,1,1],type:"vec3<f32>"},rayWidth:{value:.05,type:"f32"},rayCount:{value:12,type:"f32"},rotationSpeed:{value:.5,type:"f32"}},WL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;    
uniform float blinkSpeed;  
uniform float minIntensity; 
uniform float maxIntensity; 

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec4 color = texture2D(uTexture, uv);
    float t = sin(uTime * blinkSpeed * 6.2831853) * 0.5 + 0.5;
    float intensity = mix(minIntensity, maxIntensity, t);

    color.rgb *= intensity;

    gl_FragColor = color;
}
`,VL={uTime:{value:0,type:"f32"},blinkSpeed:{value:2,type:"f32"},minIntensity:{value:.3,type:"f32"},maxIntensity:{value:1,type:"f32"}},$L=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;         
uniform float frequency;      
uniform float damping;      
uniform float strength;      

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    float spring = exp(-damping * uTime) *
                   sin(uTime * frequency * 6.2831853);

    uv.x += spring * strength;
    uv.y += spring * strength * 0.5; 

    vec4 color = texture2D(uTexture, uv);

    gl_FragColor = color;
}
`,qL={uTime:{value:0,type:"f32"},frequency:{value:2,type:"f32"},damping:{value:.8,type:"f32"},strength:{value:.04,type:"f32"}},YL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform vec3 colorA;     
uniform vec3 colorB;    
uniform float intensity; 

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    vec4 tex = texture2D(uTexture, uv);
    float gray = dot(tex.rgb, vec3(0.299, 0.587, 0.114));
    vec3 duo = mix(colorA, colorB, gray);
    tex.rgb = mix(tex.rgb, duo, intensity);
    gl_FragColor = tex;
}
`,XL={colorA:{value:[.1,.1,.5],type:"vec3<f32>"},colorB:{value:[1,.8,.2],type:"vec3<f32>"},intensity:{value:1,type:"f32"}},jL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform vec3 colorShadow;   
uniform vec3 colorMid;       
uniform vec3 colorHighlight;

uniform float intensity;    

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec4 tex = texture2D(uTexture, uv);
    float gray = dot(tex.rgb, vec3(0.299, 0.587, 0.114));


    vec3 duoA = mix(colorShadow, colorMid, smoothstep(0.0, 0.5, gray));
    vec3 duoB = mix(colorMid, colorHighlight, smoothstep(0.5, 1.0, gray));
    vec3 tritone = mix(duoA, duoB, smoothstep(0.33, 0.66, gray));
    tex.rgb = mix(tex.rgb, tritone, intensity);

    gl_FragColor = tex;
}
`,KL={colorShadow:{value:[.1,0,.3],type:"vec3<f32>"},colorMid:{value:[.2,.8,.8],type:"vec3<f32>"},colorHighlight:{value:[1,.9,.4],type:"vec3<f32>"},intensity:{value:1,type:"f32"}},ZL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;    
uniform float amount;    

vec3 hueShift(vec3 color, float angle) {
    float cosA = cos(angle);
    float sinA = sin(angle);
    mat3 rot = mat3(
        0.299 + 0.701 * cosA + 0.168 * sinA,
        0.587 - 0.587 * cosA + 0.330 * sinA,
        0.114 - 0.114 * cosA - 0.497 * sinA,

        0.299 - 0.299 * cosA - 0.328 * sinA,
        0.587 + 0.413 * cosA + 0.035 * sinA,
        0.114 - 0.114 * cosA + 0.292 * sinA,

        0.299 - 0.300 * cosA + 1.250 * sinA,
        0.587 - 0.588 * cosA - 1.050 * sinA,
        0.114 + 0.886 * cosA - 0.203 * sinA
    );

    return color * rot;
}

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec4 tex = texture2D(uTexture, uv);

    vec3 shifted = hueShift(tex.rgb, uTime*2.5);

    tex.rgb = mix(tex.rgb, shifted, amount);

    gl_FragColor = tex;
}
`,JL={uTime:{value:0,type:"f32"},amount:{value:1,type:"f32"}},QL=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;       
uniform float uStrength;  
uniform float swirl;      

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec2 center = vec2(0.5, 0.5);
    vec2 dir = uv - center;
    float dist = length(dir);
    float warpAmount = pow(dist, 2.0) * uStrength * uTime;
    float angle = swirl * uTime * 6.283185; 

    float s = sin(angle * dist);
    float c = cos(angle * dist);

    mat2 rot = mat2(c, -s, s, c);
    vec2 warpedUV = center + rot * dir * (1.0 - warpAmount);
    vec4 color = texture2D(uTexture, warpedUV);

    gl_FragColor = color;
}
`,eN={uTime:{value:0,type:"f32"},uStrength:{value:.8,type:"f32"},swirl:{value:.3,type:"f32"}},tN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;      
uniform float uStrength;  
uniform int direction;     

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    float offset;
    if(direction == 0) {
        offset = (uv.y - 0.5) * uStrength * uTime;
        uv.x += offset;
    } else {
        offset = (uv.x - 0.5) * uStrength * uTime;
        uv.y += offset;
    }

    vec4 color = texture2D(uTexture, uv);

    gl_FragColor = color;
}
`,iN={uTime:{value:0,type:"f32"},uStrength:{value:.2,type:"f32"},direction:{value:0,type:"i32"}},sN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uStrength;
uniform float uNoise;
uniform int direction;

float hash(float n) {
    return fract(sin(n) * 43758.5453);
}

float hash(vec2 p) {
    return fract(sin(dot(p ,vec2(12.9898,78.233))) * 43758.5453);
}

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    float offset;
    if(direction == 0) {
        offset = (uv.y - 0.5) * uStrength * uTime;
        uv.x += offset;
    } else {
        offset = (uv.x - 0.5) * uStrength * uTime;
        uv.y += offset;
    }

    float jitter = (hash(floor(uv * 100.0) + uTime) - 0.5) * uNoise;
    if(direction == 0) {
        uv.x += jitter;
    } else {
        uv.y += jitter;
    }

    float rOffset = (hash(uv + 1.0) - 0.5) * uNoise * 0.5;
    float gOffset = (hash(uv + 2.0) - 0.5) * uNoise * 0.5;
    float bOffset = (hash(uv + 3.0) - 0.5) * uNoise * 0.5;

    vec4 texR = texture2D(uTexture, uv + vec2(rOffset, 0.0));
    vec4 texG = texture2D(uTexture, uv + vec2(gOffset, 0.0));
    vec4 texB = texture2D(uTexture, uv + vec2(bOffset, 0.0));

    gl_FragColor = vec4(texR.r, texG.g, texB.b, 1.0);
}
`,rN={uTime:{value:0,type:"f32"},uStrength:{value:.2,type:"f32"},uNoise:{value:.05,type:"f32"},direction:{value:0,type:"i32"}},nN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;       
uniform float maxPixelSize; 

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    float pixelSize = maxPixelSize * uTime;
    pixelSize = max(pixelSize, 0.001);
    vec2 pixelUV = floor(uv / pixelSize) * pixelSize;

    vec4 color = texture2D(uTexture, pixelUV);

    gl_FragColor = color;
}
`,oN={uTime:{value:0,type:"f32"},maxPixelSize:{value:.05,type:"f32"}},aN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;       
uniform float maxBlur;    

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec4 color = vec4(0.0);
    float blur = maxBlur * (1.0 - uTime);

    if(blur < 0.001) {
        color = texture2D(uTexture, uv);
    } else {
        vec2 offsets[9];
        offsets[0] = vec2(-blur, -blur);
        offsets[1] = vec2(0.0, -blur);
        offsets[2] = vec2(blur, -blur);
        offsets[3] = vec2(-blur, 0.0);
        offsets[4] = vec2(0.0, 0.0);
        offsets[5] = vec2(blur, 0.0);
        offsets[6] = vec2(-blur, blur);
        offsets[7] = vec2(0.0, blur);
        offsets[8] = vec2(blur, blur);

        for(int i = 0; i < 9; i++) {
            color += texture2D(uTexture, uv + offsets[i]);
        }

        color /= 9.0;
    }

    gl_FragColor = color;
}
`,lN={uTime:{value:0,type:"f32"},maxBlur:{value:.01,type:"f32"}},cN=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float amount;

void main(void)
{
    vec2 uv = vTextureCoord;
    vec4 tex = texture2D(uTexture, uv);

    vec3 inverted = vec3(1.0) - tex.rgb;

    float strength = amount * tex.a;

    tex.rgb = mix(tex.rgb, inverted, strength);

    gl_FragColor = tex;
}
`,uN={amount:{value:1,type:"f32"}},hN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float amount; 

void main(void)
{
    vec2 uv = vTextureCoord.xy;
    vec4 tex = texture2D(uTexture, uv);
    float gray = dot(tex.rgb, vec3(0.299, 0.587, 0.114));
    vec3 grayscale = vec3(gray);

    tex.rgb = mix(tex.rgb, grayscale, amount);

    gl_FragColor = tex;
}
`,dN={amount:{value:1,type:"f32"}},fN=`
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uIntensity;  
uniform float uSoftness;  

void main(void)
{
    vec2 uv = vTextureCoord.xy;

    vec2 centered = uv - vec2(0.5);
    float dist = length(centered);
    float vignette = smoothstep(0.5, 0.5 - uSoftness, dist);
    vec4 color = texture(uTexture, uv);
    color.rgb *= 1.0 - (vignette * uIntensity);

    gl_FragColor = color;
}
`,pN={uIntensity:{value:.5,type:"f32"},uSoftness:{value:.2,type:"f32"}},mN=`
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uIntensity; 
uniform vec2 uDirection;  

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 offset = uDirection * uIntensity;
    float r = texture(uTexture, uv + offset).r;
    float g = texture(uTexture, uv).g;
    float b = texture(uTexture, uv - offset).b;
    vec4 color = vec4(r, g, b, 1.0);

    gl_FragColor = color;
}
`,gN={uIntensity:{value:.005,type:"f32"},uDirection:{value:[1,0],type:"vec2<f32>"}},yN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform float rotationCount;

uniform float swirlStrength; 
uniform float swirlRadius;   
uniform float rainbowIntensity;

vec3 hsv2rgb(vec3 c)
{
    vec3 rgb = clamp( abs(mod(c.x*6.0 + vec3(0.0,4.0,2.0), 6.0) - 3.0) - 1.0,
                      0.0,
                      1.0 );
    return c.z * mix(vec3(1.0), rgb, c.y);
}

float flamePattern(float dist, float angle, float time) {
    return pow(sin(dist * 10.0 - time * 5.0 + angle * 5.0) * 0.5 + 0.5, 2.0);
}

void main(void)
{
    vec2 center = vec2(0.3, 0.45);
    vec2 uvs = vTextureCoord - center;

    // fade del rainbow (0 cuando uTime >= 0.75)
    float fadeRainbow = clamp(1.0 - smoothstep(0.7, 0.75, uTime), 0.0, 1.0);

    // fade de swirl, wave y blur (disminuye entre 0.8 y 1.0)
    float fadeMotion = clamp(1.0 - smoothstep(0.8, 1.0, uTime), 0.0, 1.0);

    // ngulo total acumulado para mantener la direccin del giro
    float angleTotal = uTime * rotationCount * 6.2831853; 

    float cosA = cos(angleTotal);
    float sinA = sin(angleTotal);
    mat2 rotation = mat2(cosA, -sinA, sinA, cosA);
    vec2 rotatedUV = rotation * uvs + center;

    float dist = distance(rotatedUV, center);
    float d = clamp(dist / swirlRadius, 0.0, 1.0);

    // swirl disminuye suavemente sin invertir la direccin
    float swirlAngle = swirlStrength * d * d * 6.2831853 * fadeMotion;
    float cosS = cos(swirlAngle);
    float sinS = sin(swirlAngle);

    vec2 dir = rotatedUV - center;
    rotatedUV = vec2(
        dir.x * cosS - dir.y * sinS,
        dir.x * sinS + dir.y * cosS
    ) + center;

    float wave = sin(dist * 12.0 - uTime * 4.0) * 0.015 * fadeMotion; 
    rotatedUV += wave * normalize(dir);

    // blur de la textura
    vec4 color = vec4(0.0);
    float blurAmount = (0.004 + rotationCount * 0.001) * fadeMotion; 

    for (int i = -3; i <= 3; i++) {
        float offset = float(i) * blurAmount;
        vec2 blurUV = rotatedUV + vec2(offset * cosA, offset * sinA);
        color += texture2D(uTexture, blurUV);
    }
    color /= 7.0;

    // rainbow
    float rainbowScale = 0.05;
    float ang = atan(dir.y, dir.x);
    float hue = (ang / 6.2831853) + 0.5 + dist * rainbowScale;
    hue += uTime * 0.2 + rotationCount * 0.05;

    vec3 rainbow = hsv2rgb(vec3(hue, 0.35, 1.0));
    color.rgb = mix(color.rgb, rainbow, rainbowIntensity * fadeRainbow);

    // Flame disminuye con fadeMotion
    float flame = flamePattern(dist, ang, uTime) * fadeMotion;
    vec3 flameColor = vec3(1.0, 0.5, 0.0) * flame;
    flameColor = mix(flameColor, vec3(1.0,1.0,0.2), flame * 0.5);
    color.rgb += flameColor * 0.3;

    if (rotatedUV.x < 0.0 || rotatedUV.x > 1.0 || rotatedUV.y < 0.0 || rotatedUV.y > 1.0) {
        discard;
    }

    gl_FragColor = color;
}

`,vN={uTime:{value:0,type:"f32"},rotationCount:{value:4,type:"f32"},swirlStrength:{value:.9,type:"f32"},swirlRadius:{value:1,type:"f32"},rainbowIntensity:{value:.25,type:"f32"}},xN=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 heartColor;
uniform float heartCount;

float rand(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

float heartShape(vec2 p) {
    p = (p - 0.5) * 2.0;   
    p.y = -p.y;           
    p.y += 0.25;          
    float x = p.x;
    float y = p.y;
    float val = pow(x*x + y*y - 1.0, 3.0) - x*x * y*y*y;
    return smoothstep(0.0, 0.02, -val);
}

vec2 heartPos(float id) {
    float fx = rand(vec2(id, 1.234)) * 0.85 - 0.025; 
    float fy = rand(vec2(id, 1.345)) * 0.85 + 0.025;
    return vec2(fx, fy);
}

float heartSize(float id) {
    return mix(0.02, 0.05, rand(vec2(id, 44.123))); 
}

void main() {
    vec2 uv = vTextureCoord.xy;
    vec4 base = texture2D(uTexture, uv);

    float hearts = 0.0;

    for(float i = 0.0; i < 200.0; i++) {
        if(i >= heartCount) break;

        vec2 pos = heartPos(i);
        float size = heartSize(i);

        float vibX = (rand(vec2(i, uTime)) - 0.5) * 0.02;
        float vibY = (rand(vec2(i+1.0, uTime)) - 0.5) * 0.02;

        vec2 heartUV = (uv - (pos + vec2(vibX, vibY))) / size + 0.5;

        float h = heartShape(heartUV);

        float pulse = sin(uTime * 4.0 + i) * 0.2 + 1.0;
        h *= pulse;

        hearts += h;
    }

    base.rgb += heartColor * hearts;
    gl_FragColor = base;
}
`,bN={uTime:{value:0,type:"f32"},heartColor:{value:[1,.2,.5],type:"vec3<f32>"},heartCount:{value:150,type:"f32"}},_N=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 butterflyColor;
uniform float butterflyCount;

float rand(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

float wing(vec2 p) {
    float d = pow(p.x, 2.0) + pow(p.y * 1.2, 2.0);
    return smoothstep(0.3, 0.0, d);
}

float butterflyShape(vec2 uv) {
    vec2 p = (uv - 0.5) * 2.0;

    float body = smoothstep(0.12, 0.05, abs(p.x)) 
               * smoothstep(0.4, 0.0, abs(p.y));

    float wL = wing(vec2(p.x * 1.2 + 0.6, p.y));
    float wR = wing(vec2(p.x * 1.2 - 0.6, p.y));

    return clamp(wL + wR + body, 0.0, 1.0);
}
vec2 butterflyPos(float id) {
    float fx = rand(vec2(id, 1.234)) * 0.85 - 0.025;
    float fy = rand(vec2(id, 1.345)) * 0.85 + 0.025;
    return vec2(fx, fy);
}

float butterflySize(float id) {
    return mix(0.03, 0.08, rand(vec2(id, 44.123)));
}

void main() {
    vec2 uv = vTextureCoord.xy;
    vec4 base = texture2D(uTexture, uv);

    float butterflies = 0.0;

    for(float i = 0.0; i < 200.0; i++) {
        if(i >= butterflyCount) break;

        vec2 pos = butterflyPos(i);
        float size = butterflySize(i);

        float vibX = (rand(vec2(i, uTime)) - 0.5) * 0.02;
        float vibY = (rand(vec2(i+1.0, uTime)) - 0.5) * 0.02;

        vec2 bUV = (uv - (pos + vec2(vibX, vibY))) / size + 0.5;

        float b = butterflyShape(bUV);

        float pulse = sin(uTime * 3.0 + i) * 0.25 + 1.0;
        b *= pulse;

        butterflies += b;
    }

    base.rgb += butterflyColor * butterflies;
    gl_FragColor = base;
}
`,wN={uTime:{value:0,type:"f32"},butterflyColor:{value:[.5,.6,1],type:"vec3<f32>"},butterflyCount:{value:120,type:"f32"}},SN=`
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float amplitude; 
uniform float speed;     
uniform float uTime;  

void main() {
    vec2 p = vTextureCoord;
    vec2 center = vec2(0.28, 0.45);

    vec2 dir = p - center;
    float dist = length(dir);

    vec2 offset = vec2(0.0);

    if (dist <= uTime) {
        offset = dir * sin(dist * amplitude - uTime * speed);
    }

    gl_FragColor = texture2D(uTexture, p + offset);
}
`,CN={uTime:{value:0,type:"f32"},amplitude:{value:30,type:"f32"},speed:{value:30,type:"f32"}},TN=`
precision mediump float;

uniform sampler2D uTexture;
uniform float persp;      
uniform float unzoom;     
uniform float reflection; 
uniform float floating;   
uniform float uTime;

varying vec2 vTextureCoord;

bool inBounds(vec2 p) {
    return all(greaterThanEqual(p, vec2(0.0))) &&
           all(lessThanEqual(p, vec2(1.0)));
}

vec2 project(vec2 p) {
    return p * vec2(1.0, -1.2) + vec2(0.0, -floating / 100.0);
}

vec2 xskew(vec2 p, float persp, float center) {
    float x = mix(p.x, 1.0 - p.x, center);

    return (
        (
            vec2(
                x,
                (p.y - 0.5*(1.0-persp) * x) /
                (1.0+(persp-1.0)*x)
            )
            - vec2(0.5 - abs(center - 0.5), 0.0)
        )
        * vec2(
            0.5 / abs(center - 0.5) * (center < 0.5 ? 1.0 : -1.0),
            1.0
        )
        + vec2(center < 0.5 ? 0.0 : 1.0, 0.0)
    );
}

void main() {
    vec2 p = vTextureCoord;

    float uz = unzoom * sin(uTime * 0.5);
    p = -uz * 0.5 + (1.0 + uz) * p;

    vec2 warped = xskew(p, persp, 0.0);

    vec4 baseColor = vec4(0.0);

    if (inBounds(warped)) {
        baseColor = texture2D(uTexture, warped);
    }

    vec2 proj = project(warped);
    if (inBounds(proj)) {
        vec4 refl = texture2D(uTexture, proj);
        refl.rgb *= reflection * (1.0 - proj.y);
        baseColor += refl;
    }

    gl_FragColor = baseColor;
}

`,kN={uTime:{value:0,type:"f32"},persp:{value:.7,type:"f32"},unzoom:{value:.3,type:"f32"},reflection:{value:0,type:"f32"},floating:{value:3,type:"f32"}},AN=`
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;        
uniform float radius;       
uniform float spinPower;    
uniform float speed;       

void main() {
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.28, 0.45);

    vec2 pos = uv - center;

    float dist = length(pos);

    if (dist < radius) {
        float percent = (radius - dist) / radius;

        float theta = percent * percent * spinPower * sin(uTime * speed);

        float s = sin(theta);
        float c = cos(theta);

        pos = vec2(
            pos.x * c - pos.y * s,
            pos.x * s + pos.y * c
        );
    }

    uv = pos + center;

    gl_FragColor = texture2D(uTexture, uv);
}
`,IN={uTime:{value:0,type:"f32"},radius:{value:1,type:"f32"},spinPower:{value:18,type:"f32"},speed:{value:4,type:"f32"}},PN=`
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

uniform float speed;        
uniform float intensity;    
uniform int endx;
uniform int endy;

#define PI 3.14159265358979323

float rand(vec2 v) {
    return fract(sin(dot(v.xy , vec2(12.9898,78.233))) * 43758.5453);
}

vec2 rotate2d(vec2 v, float a) {
    mat2 rm = mat2(cos(a), -sin(a),
                   sin(a),  cos(a));
    return rm * v;
}

void main() {
    vec2 uv = vTextureCoord;

    vec2 p = uv - 0.5;

    float t = sin(uTime * speed) * 0.5 + 0.5;

    float warp = 1.0 + intensity * abs(t - 0.5);

    vec2 rp = p * warp;
    float tx = float(endx) + 0.5;
    float ty = float(endy) + 0.5;

    vec2 shifted = mix(vec2(0.5, 0.5), vec2(tx, ty), t*t);

    vec2 tiled = fract(rp + shifted);

    vec2 cell = floor(rp + shifted);

    bool isEnd = int(cell.x) == endx && int(cell.y) == endy;

    if (!isEnd) {
        float rnd = rand(cell);
        float angle = float(int(rnd * 4.0)) * 0.5 * PI;
        tiled = vec2(0.5) + rotate2d(tiled - vec2(0.5), angle);
    }
    gl_FragColor = texture2D(uTexture, tiled);
}
`,EN={uTime:{value:0,type:"f32"},speed:{value:2,type:"f32"},intensity:{value:1.5,type:"f32"},endx:{value:2,type:"i32"},endy:{value:-1,type:"i32"}},MN=`
precision highp float;

in vec2 vTextureCoord;
uniform sampler2D uTexture;
uniform float uTime;

uniform float intensity;    
uniform float speed;        
uniform int slices;         
uniform float randomness;   

#define PI 3.141592653589793
float rand(float x) {
    return fract(sin(x * 12.9898) * 43758.5453);
}

void main() {
    vec2 uv = vTextureCoord;

    float sliceHeight = 1.0 / float(slices);
    float sliceIndex = floor(uv.y / sliceHeight);

    float offsetX = (rand(sliceIndex + uTime * speed) - 0.5) * intensity;

    float offsetY = sin(uTime * speed + sliceIndex * 1.5) * 0.01 * randomness;

    uv.x += offsetX;
    uv.y += offsetY;
    vec4 color = texture(uTexture, uv);

    gl_FragColor = color;
}

`,FN={uTime:{value:0,type:"f32"},intensity:{value:.05,type:"f32"},speed:{value:2,type:"f32"},slices:{value:10,type:"i32"},randomness:{value:1,type:"f32"}},RN=`
precision highp float;

in vec2 vTextureCoord;
uniform sampler2D uTexture;
uniform float uTime;      
uniform float softness;   

void main() {
    vec2 uv = vTextureCoord;

    float t_raw = clamp(uTime, 0.0, 1.0);
    float t = pow(t_raw, 0.55);

    float mid = 0.5;

    float leftEdge = mid - t * mid;
    float rightEdge = mid + t * mid;

    float mask = smoothstep(leftEdge, leftEdge + softness, uv.x) *
                 (1.0 - smoothstep(rightEdge - softness, rightEdge, uv.x));

    vec4 color = texture(uTexture, uv);

    gl_FragColor = vec4(color.rgb * mask, color.a * mask);
}
`,zN={uTime:{value:0,type:"f32"},softness:{value:.2,type:"f32"}},UN=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float softness;
uniform float zoom;

#define PI 3.141592653589793

vec2 rotate2D(vec2 st, float angle) {
    st -= 0.5;
    st = mat2(cos(angle), -sin(angle),
              sin(angle),  cos(angle)) * st;
    st += 0.5;
    return st;
}

vec2 tile(vec2 st, float zoom) {
    st *= zoom;
    return fract(st);
}

vec2 rotateTile(vec2 st) {
    st *= 2.0;

    float index = 0.0;
    if (fract(st.x * 0.5) > 0.5) index += 1.0;
    if (fract(st.y * 0.5) > 0.5) index += 2.0;

    st = fract(st);

    if (index == 1.0)      st = rotate2D(st, PI * 0.5);
    else if (index == 2.0) st = rotate2D(st, PI * -0.5);
    else if (index == 3.0) st = rotate2D(st, PI);

    return st;
}

float triangleShape(vec2 st, float smoothness) {
    vec2 p0 = vec2(0.3, -0.5);
    vec2 p1 = vec2(0.7, -0.5);
    vec2 p2 = vec2(0.5, 1.0);

    vec3 e0, e1, e2;

    e0.xy = normalize(p1 - p0).yx * vec2(+1.0, -1.0);
    e1.xy = normalize(p2 - p1).yx * vec2(+1.0, -1.0);
    e2.xy = normalize(p0 - p2).yx * vec2(+1.0, -1.0);

    e0.z = dot(e0.xy, p0) - smoothness;
    e1.z = dot(e1.xy, p1) - smoothness;
    e2.z = dot(e2.xy, p2) - smoothness;

    float a = max(0.0, dot(e0.xy, st) - e0.z);
    float b = max(0.0, dot(e1.xy, st) - e1.z);
    float c = max(0.0, dot(e2.xy, st) - e2.z);

    return smoothstep(smoothness * 2.0, 1e-7, length(vec3(a, b, c)));
}

void main() {
    vec2 uv = vTextureCoord;
    vec2 st = uv;
    st = tile(st, zoom);
    st = rotateTile(st);
    st = rotate2D(st, -PI * 0.25 * uTime);

    float mask = triangleShape(st, softness);

    vec4 tex = texture(uTexture, uv);
    gl_FragColor = vec4(tex.rgb * mask, tex.a * mask);
}
`,BN={uTime:{value:0,type:"f32"},softness:{value:.2,type:"f32"},zoom:{value:8,type:"f32"}},ON=`
precision highp float;

in vec2 vTextureCoord;
uniform sampler2D uTexture;
uniform float uTime;

vec2 mirrorTile(vec2 st, float zoom) {
    st *= zoom;

    if (fract(st.y * 0.5) > 0.5) {
        st.x = st.x + 0.5;
        st.y = 1.0 - st.y;
    }

    return fract(st);
}

float zigzag(vec2 st) {
    float x = st.x * 2.0;
    float a = floor(1.0 + sin(x * 3.14159));
    float b = floor(1.0 + sin((x + 1.0) * 3.14159));
    float f = fract(x);
    return mix(a, b, f);
}

void main() {
    vec2 st = vTextureCoord;

    st = mirrorTile(st * vec2(1.0, 2.0), 5.0);

    float zz = zigzag(st);

    st.y += zz * 0.03;

    vec4 tex = texture(uTexture, st);

    gl_FragColor = tex;
}
`,DN={uTime:{value:0,type:"f32"}},LN=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
uniform float speed;      
uniform float intensity;  

void main(void)
{
    vec4 tex = texture2D(uTexture, vTextureCoord);
    float t = fract(uTime * speed);
    float wave = sin(t * 3.141592);
    float base = 0.6;
    float brightness = mix(base, 1.0, wave);
    float flash = 1.0 + brightness * intensity;

    vec3 color = tex.rgb * flash;

    gl_FragColor = vec4(color, tex.a);
}
`,NN={uTime:{value:0,type:"f32"},speed:{value:10.2,type:"f32"},intensity:{value:1.5,type:"f32"}},HN=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

uniform float framesPerScreen;
uniform float scrollSpeed;
uniform float gateWeave;

void main() {
    vec2 uv = vTextureCoord;

    vec3 color = vec3(0.0);

    uv.y += uTime * scrollSpeed;
    uv.y += sin(uTime * 2.0) * 0.003 * gateWeave;

    float stripLeft  = 0.025;
    float stripRight = 0.5;

    if (uv.x < stripLeft || uv.x > stripRight) {
        gl_FragColor = vec4(color, 1.0);
        return;
    }

    vec2 stripUV;
    stripUV.x = (uv.x - stripLeft) / (stripRight - stripLeft);
    stripUV.y = fract(uv.y);

    float holeZone = 0.06; 
    float frameZone = 1.0 - holeZone * 2.0;

    float frameH = 1.0 / framesPerScreen;
    float localY = fract(stripUV.y / frameH);

    bool inFrameX =
        stripUV.x > holeZone &&
        stripUV.x < holeZone + frameZone;

    float marginX = 0.08;
    float marginY = 0.10;


    bool insideFrame =
        inFrameX &&
        stripUV.x > holeZone + marginX &&
        stripUV.x < holeZone + frameZone - marginX &&
        localY > marginY &&
        localY < 1.0 - marginY;

    float frameZoneX = frameZone - marginX * 4.0;
    float centerOffset = (1.0 - frameZoneX - holeZone * 2.0) * 0.5;

    vec2 frameUV;
    frameUV.x = (stripUV.x - (holeZone + marginX * 2.0) - centerOffset) / frameZoneX;
    frameUV.y = (localY - marginY) / (1.0 - marginY * 2.0);

    float holeH = 0.01;
    float holeSpacing = frameH * 0.1;

    float holeRow = step(mod(stripUV.y, holeSpacing), holeH);

    bool leftHole  = stripUV.x < holeZone * 0.8;
    bool rightHole = stripUV.x > 1.0 - holeZone * 0.8;

    bool isHole = holeRow > 0.5 && (leftHole || rightHole);
    if (isHole) {
        color = vec3(1.0);
    }
    else if (insideFrame) {
        color = texture2D(uTexture, frameUV).rgb;
    }
    else {
        color = vec3(0.0);
    }

    gl_FragColor = vec4(color, 1.0);
}
`,GN={uTime:{value:0,type:"f32"},framesPerScreen:{value:2,type:"f32"},scrollSpeed:{value:.35,type:"f32"},gateWeave:{value:.6,type:"f32"}},WN=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;
float rand(vec2 co) {
    return fract(sin(dot(co, vec2(12.9898,78.233))) * 43758.5453);
}

float noise(float y) {
    return rand(vec2(y, uTime));
}

void main(void)
{
    vec2 uv = vTextureCoord;
    float flicker = 0.9 + 0.1 * sin(uTime * 30.0);
    float lineNoise = noise(floor(uv.y * 200.0));
    uv.x += (lineNoise - 0.5) * 0.03;
    uv.x += sin(uv.y * 40.0 + uTime * 10.0) * 0.005;
    float rgbShift = 0.004 * sin(uTime * 5.0);

    vec4 colR = texture2D(uTexture, uv + vec2(rgbShift, 0.0));
    vec4 colG = texture2D(uTexture, uv);
    vec4 colB = texture2D(uTexture, uv - vec2(rgbShift, 0.0));

    vec4 color;
    color.r = colR.r;
    color.g = colG.g;
    color.b = colB.b;
    color.a = colG.a;
    float staticNoise = rand(uv * uTime) * 0.08;
    color.rgb += staticNoise;
    float scanline = sin(uv.y * 800.0) * 0.04;
    color.rgb -= scanline;
    color.rgb *= flicker;

    gl_FragColor = color;
}

`,VN={uTime:{value:0,type:"f32"}},$N=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

/* Configuracin */
uniform float strength;   // fuerza de la omniflexin
uniform float frequency;  // frecuencia de ondas
uniform float speed;      // velocidad animacin

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.5);

    vec2 dir = uv - center;
    float dist = length(dir);
    float wave =
        sin(dist * frequency - uTime * speed) *
        strength;

    float lens = dist * dist;

    vec2 flexUV = uv + normalize(dir) * wave * lens;
    vec4 color = texture2D(uTexture, flexUV);

    gl_FragColor = color;
}

`,qN={uTime:{value:0,type:"f32"},strength:{value:.08,type:"f32"},frequency:{value:18,type:"f32"},speed:{value:3.5,type:"f32"}},YN=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

uniform float feather;

void main(void)
{
    vec2 uv = vTextureCoord;

    vec2 center = vec2(0.28, 0.48);

    float dist = distance(uv, center);

    float maxRadius = 0.8;

    float radius = mix(maxRadius, 0.0, uTime);

    float mask = smoothstep(
        radius - feather,
        radius + feather,
        dist
    );

    vec4 color = texture2D(uTexture, uv);

    gl_FragColor = vec4(color.rgb * mask, color.a);
}

`,XN={uTime:{value:0,type:"f32"},feather:{value:.03,type:"f32"}},jN=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

void main(void)
{
    vec2 uv = vTextureCoord;

    float openPhase = smoothstep(0.0, 0.6, uTime);
    float zoomPhase = smoothstep(0.6, 1.0, uTime);

    float zoom =
        1.0 +
        sin(zoomPhase * 3.141592) * 0.2;

    vec2 center = vec2(0.28, 0.35);
    vec2 zoomUV = (uv - center) / zoom + center;

    vec4 tex = texture2D(uTexture, zoomUV);

    float centerY = 0.48;
    float halfOpen = openPhase * 0.5;

    float mask = step(abs(zoomUV.y - centerY), halfOpen);

    gl_FragColor = vec4(tex.rgb * mask, tex.a);
}

`,KN={uTime:{value:0,type:"f32"}},ZN=`
precision highp float;

in vec2 vTextureCoord;
in vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

vec4 blur9(sampler2D tex, vec2 uv, vec2 resolution, float radius)
{
    vec4 color = vec4(0.0);
    vec2 off = radius / resolution;

    color += texture2D(tex, uv + off * vec2(-1.0, -1.0)) * 0.0625;
    color += texture2D(tex, uv + off * vec2( 0.0, -1.0)) * 0.125;
    color += texture2D(tex, uv + off * vec2( 1.0, -1.0)) * 0.0625;

    color += texture2D(tex, uv + off * vec2(-1.0,  0.0)) * 0.125;
    color += texture2D(tex, uv)                             * 0.25;
    color += texture2D(tex, uv + off * vec2( 1.0,  0.0)) * 0.125;

    color += texture2D(tex, uv + off * vec2(-1.0,  1.0)) * 0.0625;
    color += texture2D(tex, uv + off * vec2( 0.0,  1.0)) * 0.125;
    color += texture2D(tex, uv + off * vec2( 1.0,  1.0)) * 0.0625;

    return color;
}

void main(void)
{
    vec2 uv = vTextureCoord;

    float openPhase = smoothstep(0.0, 0.3, uTime);
    float zoomPhase = smoothstep(0.3, 1.0, uTime);

    float zoom =
        1.0 +
        sin(zoomPhase * 3.141592) * 0.2;

    vec2 center = vec2(0.28, 0.35);
    vec2 zoomUV = (uv - center) / zoom + center;

    float blurAmount = mix(10.0, 0.0, openPhase);

    vec4 blurred =
        blur9(uTexture, zoomUV, vec2(1024.0, 1024.0), blurAmount);

    float pulse =
    (sin(uTime * 2.0) * 0.5 + 0.5) * 0.8;
    blurred.rgb *= (1.0 + pulse);
    float centerY = 0.48;
    float halfOpen = openPhase * 0.5;

    float mask = step(abs(zoomUV.y - centerY), halfOpen);

    gl_FragColor = vec4(blurred.rgb * mask, blurred.a);
}

`,JN={uTime:{value:0,type:"f32"}},QN=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

uniform float strength;

uniform float frequency;

void main(void)
{
    vec2 uv = vTextureCoord;

    float waveX = sin((uv.y + uTime * 0.6) * frequency) * strength;
    float waveY = cos((uv.x + uTime * 0.4) * frequency) * strength;

    vec2 distortedUV = uv + vec2(waveX, waveY);

    distortedUV = clamp(distortedUV, 0.0, 1.0);

    vec4 color = texture2D(uTexture, distortedUV);

    gl_FragColor = color;
}
`,eH={uTime:{value:0,type:"f32"},strength:{value:.015,type:"f32"},frequency:{value:10,type:"f32"}},tH=`
precision mediump float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.28, 0.45);

    float dist = distance(uv, center);

    float speed = 0.7;
    float progress = mod(uTime * speed, 1.0);

    float width = mix(0.01, 0.07, progress);

    float lightning = smoothstep(progress + width, progress, dist);

    float noise = sin((uv.x + uv.y) * 30.0 + uTime * 12.0);
    lightning *= noise * 0.5 + 0.5;

    float explosion = smoothstep(0.85, 1.0, progress);
    float burst = explosion * smoothstep(0.25, 0.0, dist);

    vec3 lightningColor = vec3(1.0, 0.9, 0.6) * lightning * 2.5;
    vec3 explosionColor = vec3(1.0, 0.4, 0.2) * burst * 4.0;

    vec4 base = texture2D(uTexture, uv);

    gl_FragColor = vec4(base.rgb + lightningColor + explosionColor, base.a);
}
`,iH={uTime:{value:0,type:"f32"}},sH=`
precision mediump float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uTexture;
uniform float uTime;

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}

float noise(vec2 p) {
    vec2 i = floor(p);
    vec2 f = fract(p);

    float a = hash(i);
    float b = hash(i + vec2(1.0, 0.0));
    float c = hash(i + vec2(0.0, 1.0));
    float d = hash(i + vec2(1.0, 1.0));

    vec2 u = f * f * (3.0 - 2.0 * f);

    return mix(a, b, u.x) +
           (c - a) * u.y * (1.0 - u.x) +
           (d - b) * u.x * u.y;
}

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.5);

    vec2 dir = uv - center;
    float dist = length(dir);
    float t = uTime * 1.5;

    float veinNoise =
        noise(dir * 6.0 + t) * 0.6 +
        noise(dir * 12.0 - t * 1.3) * 0.3;

    float warpedDist = dist + veinNoise * 0.08;

    float thickness = 0.04 + veinNoise * 0.02;

    float lightning =
        smoothstep(thickness, 0.0, warpedDist);

    float branches =
        smoothstep(0.02, 0.0,
            abs(noise(dir * 20.0 + t) - 0.5));

    lightning += branches * 0.35;

    float pulse = sin(uTime * 10.0) * 0.3 + 0.7;
    lightning *= pulse;

    vec3 veinColor =
        vec3(0.6, 0.85, 1.0) * lightning * 2.5;

    vec4 base = texture2D(uTexture, uv);

    gl_FragColor =
        vec4(base.rgb + veinColor, base.a);
}
`,rH={uTime:{value:0,type:"f32"}},nH=`
precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

float rand(float x)
{
    return fract(sin(x) * 43758.5453123);
}

void main(void)
{
    vec2 uv = vTextureCoord;

    float pixelRows = 120.0;
    float row = floor(uv.y * pixelRows) / pixelRows;

    float offset =
        sin(row * 40.0 + uTime * 3.0) *
        0.015;

    offset += (rand(row * 10.0) - 0.5) * 0.01;

    vec2 distortedUV = vec2(uv.x + offset, uv.y);

    distortedUV = clamp(distortedUV, 0.0, 1.0);

    vec4 color = texture2D(uTexture, distortedUV);

    gl_FragColor = color;
}
`,oH={uTime:{value:0,type:"f32"}},aH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uIntensity;

uniform float neonR;
uniform float neonG;
uniform float neonB;

void main(void)
{
    vec4 base = texture2D(uTexture, vTextureCoord);

    float speed = 4.2;                 
    float t = fract(uTime * speed);    

    float rise = smoothstep(0.0, 0.25, t);
    float fall = smoothstep(0.85, 0.55, t);
    float flash = rise * fall;

    flash = mix(0.25, 1.0, flash);

    flash *= uIntensity;

    base.r += base.r * neonR * flash;
    base.g += base.g * neonG * flash;
    base.b += base.b * neonB * flash;

    gl_FragColor = base;
}
`,lH={uTime:{value:0,type:"f32"},uIntensity:{value:1.8,type:"f32"},neonR:{value:.1,type:"f32"},neonG:{value:.9,type:"f32"},neonB:{value:1,type:"f32"}},cH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uStrength;
uniform float uSpeed;

void main(void)
{
    vec2 uv = vTextureCoord;
    float time = uTime * uSpeed;

    float wave = sin((uv.y * 18.0) - time);

    float offsetX = wave * uStrength;

    vec2 distortedUV = uv + vec2(offsetX, 0.0);

    distortedUV = clamp(distortedUV, 0.0, 1.0);

    vec4 color = texture2D(uTexture, distortedUV);

    gl_FragColor = color;
}
`,uH={uTime:{value:0,type:"f32"},uStrength:{value:.02,type:"f32"},uSpeed:{value:20,type:"f32"}},hH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

const int BALL_COUNT = 10;
float radius = 0.05;
float border = 0.006;

vec2 bounce(vec2 p)
{
    return abs(fract(p) * 2.0 - 1.0);
}

void main(void)
{
    vec2 uv = vTextureCoord;

    /* Textura base */
    vec4 color = texture2D(uTexture, uv);

    float ballsAlpha = 0.0;

    for (int i = 0; i < BALL_COUNT; i++)
    {
        float id = float(i) + 1.0;

        vec2 speed = vec2(
            0.3 + id * 0.12,
            0.25 + id * 0.15
        );

        vec2 pos = bounce(vec2(
            uTime * speed.x + id * 0.17,
            uTime * speed.y + id * 0.29
        ));

        float d = distance(uv, pos);

        float edge =
            smoothstep(radius, radius - border, d) -
            smoothstep(radius - border, radius - border - 0.01, d);

        ballsAlpha += edge;
    }

    ballsAlpha = clamp(ballsAlpha, 0.0, 1.0);
    color.rgb = mix(color.rgb, vec3(1.0), ballsAlpha);

    gl_FragColor = color;
}
`,dH={uTime:{value:0,type:"f32"}},fH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uWaveStrength;
uniform float uWaveSpeed;

void main(void)
{
    vec2 uv = vTextureCoord;

    if (uv.y < 0.5)
    {
        gl_FragColor = texture2D(uTexture, uv);
        return;
    }

    vec2 reflectUV = uv;
    reflectUV.y = 1.0 - uv.y;

    float wave =
        sin(reflectUV.y * 30.0 + uTime * uWaveSpeed) *
        uWaveStrength;

    reflectUV.x += wave;
    reflectUV = clamp(reflectUV, 0.0, 1.0);

    vec4 reflectColor = texture2D(uTexture, reflectUV);

    float fade = smoothstep(0.5, 1.0, uv.y);

    reflectColor.rgb *= (1.0 - fade) * 0.85;
    reflectColor.a *= (1.0 - fade);

    gl_FragColor = reflectColor;
}
`,pH={uTime:{value:0,type:"f32"},uWaveStrength:{value:.02,type:"f32"},uWaveSpeed:{value:2.5,type:"f32"}},mH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uStrength;

float rand(vec2 co)
{
    return fract(sin(dot(co, vec2(12.9898,78.233))) * 43758.5453);
}

void main(void)
{
    vec2 uv = vTextureCoord;

    float t = floor(uTime * 6.0);

    float blockSize = 0.08;
    float blockY = floor(uv.y / blockSize) * blockSize;

    float noise = rand(vec2(blockY, t));

    float shift =
        step(0.65, noise) *
        (rand(vec2(blockY, t + 1.0)) - 0.5) *
        uStrength;

    vec2 glitchUV = uv + vec2(shift, 0.0);
    glitchUV = clamp(glitchUV, 0.0, 1.0);

    vec4 color = texture2D(uTexture, glitchUV);
    float darkPulse =
        step(0.75, noise) *
        (0.4 + rand(vec2(uv.x, t)) * 0.6);

    color.rgb *= 1.0 - darkPulse;
    float pixelNoise = rand(uv * t);
    color.rgb *= 1.0 - step(0.96, pixelNoise) * 0.8;

    gl_FragColor = color;
}
`,gH={uTime:{value:0,type:"f32"},uStrength:{value:.08,type:"f32"}},yH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;

vec4 blur5(sampler2D tex, vec2 uv, float strength)
{
    vec4 col = vec4(0.0);
    float s = strength;

    col += texture2D(tex, uv + vec2(-s, -s)) * 0.05;
    col += texture2D(tex, uv + vec2( 0.0, -s)) * 0.10;
    col += texture2D(tex, uv + vec2( s, -s)) * 0.05;

    col += texture2D(tex, uv + vec2(-s,  0.0)) * 0.10;
    col += texture2D(tex, uv)                * 0.40;
    col += texture2D(tex, uv + vec2( s,  0.0)) * 0.10;

    col += texture2D(tex, uv + vec2(-s,  s)) * 0.05;
    col += texture2D(tex, uv + vec2( 0.0,  s)) * 0.10;
    col += texture2D(tex, uv + vec2( s,  s)) * 0.05;

    return col;
}

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.5, 0.5);

    float t = clamp(uTime, 0.0, 1.0);
    float zoomPhase = smoothstep(0.0, 0.5, t) *
                      (1.0 - smoothstep(0.5, 1.0, t));

    float scale = 1.0 + zoomPhase * 0.5;

    vec2 offset = vec2(0.0);

    if (t < 0.33)
    {
        offset = vec2(0.12 * (t / 0.33), 0.0);
    }
    else if (t < 0.66)
    {
        offset = vec2(
            0.12 * (1.0 - (t - 0.33) / 0.33),
            0.0
        );
    }
    else
    {
        offset = vec2(
            0.08 * ((t - 0.66) / 0.34),
           -0.08 * ((t - 0.66) / 0.34)
        );
    }

    offset *= zoomPhase;
    vec2 transformedUV =
        (uv - center) / scale +
        center -
        offset;

    transformedUV = clamp(transformedUV, 0.0, 1.0);
    float blurStrength = zoomPhase * 0.015;

    vec4 color = blur5(uTexture, transformedUV, blurStrength);

    gl_FragColor = color;
}
`,vH={uTime:{value:0,type:"f32"}},xH=`
precision highp float;

in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uCutPos;


float noise(float x)
{
    return sin(x * 28.0) * 0.035;
}

vec4 blur5(sampler2D tex, vec2 uv, float s)
{
    vec4 c = vec4(0.0);
    c += texture2D(tex, uv + vec2(-s, -s)) * 0.05;
    c += texture2D(tex, uv + vec2( 0.0, -s)) * 0.10;
    c += texture2D(tex, uv + vec2( s, -s)) * 0.05;
    c += texture2D(tex, uv + vec2(-s,  0.0)) * 0.10;
    c += texture2D(tex, uv)                * 0.40;
    c += texture2D(tex, uv + vec2( s,  0.0)) * 0.10;
    c += texture2D(tex, uv + vec2(-s,  s)) * 0.05;
    c += texture2D(tex, uv + vec2( 0.0,  s)) * 0.10;
    c += texture2D(tex, uv + vec2( s,  s)) * 0.05;
    return c;
}

void main(void)
{
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.5);
    float movePhase  = smoothstep(0.0, 0.45, uTime);
    float settle     = smoothstep(0.45, 0.6, uTime);
    float cutPhase   = smoothstep(0.7, 0.9, uTime);
    float cleanPhase = smoothstep(0.9, 1.0, uTime);
    float scale = mix(1.5, 1.0, settle);

    float moveAlive = 1.0 - settle;

    vec2 movement = vec2(
        sin(uTime * 6.0) * 0.18 * moveAlive,
        0.0
    );

    vec2 uvScaled =
        (uv - center) / scale +
        center -
        movement;

    uvScaled = clamp(uvScaled, 0.0, 1.0);

    float blurStrength = (1.0 - cleanPhase) * 0.025;
    vec4 blurred = blur5(uTexture, uvScaled, blurStrength);
    vec4 clean = texture2D(uTexture, uv);

    float tearLine =
        mix(
            uCutPos,
            uCutPos + noise(uv.y + uTime * 3.0),
            cutPhase
        );

    tearLine = clamp(tearLine, uCutPos - 0.05, uCutPos + 0.05);

    float split = cutPhase * 0.35;

    vec2 leftUV  = uv;
    vec2 rightUV = uv;

    leftUV.x  -= split * step(uv.x, tearLine);
    rightUV.x += split * step(tearLine, uv.x);

    leftUV  = clamp(leftUV,  0.0, 1.0);
    rightUV = clamp(rightUV, 0.0, 1.0);

    vec4 left  = texture2D(uTexture, leftUV);
    vec4 right = texture2D(uTexture, rightUV);

    float cutMask =
        smoothstep(tearLine - 0.02, tearLine + 0.02, uv.x);

    vec4 broken = mix(left, right, cutMask);

    float edge =
        smoothstep(0.0, 0.02, abs(uv.x - tearLine)) *
        (1.0 - smoothstep(0.02, 0.05, abs(uv.x - tearLine)));

    vec3 edgeColor = vec3(1.0) * edge * cutPhase;

    broken.rgb += edgeColor;

    vec4 result = mix(blurred, broken, cutPhase);
    result = mix(result, clean, cleanPhase);

    gl_FragColor = result;
}
`,bH={uTime:{value:0,type:"f32"},uCutPos:{value:.28,type:"f32"}},_H=`
#ifdef GL_ES
precision mediump float;
#endif

varying vec2 vTextureCoord;

uniform float uTime;
uniform sampler2D uTexture;

float rand(vec2 st)
{
    return fract(sin(dot(st, vec2(12.9898,78.233))) * 43758.5453123);
}

float noise(vec2 st)
{
    vec2 i = floor(st);
    vec2 f = fract(st);

    float a = rand(i);
    float b = rand(i + vec2(1.0, 0.0));
    float c = rand(i + vec2(0.0, 1.0));
    float d = rand(i + vec2(1.0, 1.0));

    vec2 u = f * f * (3.0 - 2.0 * f);

    return mix(a, b, u.x) +
           (c - a) * u.y * (1.0 - u.x) +
           (d - b) * u.x * u.y;
}

float spray(vec2 st, float radius)
{
    float dist = length(st - vec2(0.28, 0.5));
    float base = smoothstep(radius, radius - 0.06, dist);

    float speckle =
        noise(st * 45.0 + uTime * 3.0) *
        noise(st * 90.0);

    return clamp(base + speckle * 0.7, 0.0, 1.0);
}

float drips(vec2 st, float mask)
{
    float column = noise(vec2(st.x * 25.0, 0.0));

    float drip =
        smoothstep(0.3, 0.7, column) *
        smoothstep(0.1, 1.0, 1.0 - st.y);

    float flow =
        noise(vec2(st.x * 35.0, st.y * 6.0 + uTime * 2.5));

    return drip * flow * mask;
}

void main(void)
{
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);

    vec3 graffitiColor = vec3(1.0, 0.0, 0.5);

    float reveal = smoothstep(0.0, 1.0, uTime);

    float sprayMask =
        spray(uv, 0.35 * reveal);

    float dripMask =
        drips(uv, sprayMask) * reveal;

    float graffitiMask =
        clamp(sprayMask + dripMask * 1.3, 0.0, 1.0);

    vec3 graffiti =
        graffitiColor * graffitiMask;

    vec3 Color =
        base.rgb + graffiti;

    gl_FragColor = vec4(Color, base.a);
}
`,wH={uTime:{value:0,type:"f32"}},SH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 uColor;
uniform float uThickness;
uniform float uIntensity;

float noise(float x) {
    return sin(x * 40.0) * 0.005;
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 baseColor = texture2D(uTexture, uv);

    float beamY = 0.48 + noise(uv.x + uTime * 5.0);

    float dist = abs(uv.y - beamY);

    float core = smoothstep(uThickness, 0.0, dist);

    float glow = smoothstep(uThickness * 4.0, uThickness, dist);

    float pulse = 0.6 + 0.4 * sin(uTime * 10.0);

    float laserMask = (core + glow * uIntensity) * pulse;

    vec3 laserColor = uColor * laserMask;

    vec3 color = baseColor.rgb + laserColor;

    gl_FragColor = vec4(color, baseColor.a);
}
`,CH={uTime:{value:0,type:"f32"},uColor:{value:[1,0,.2],type:"vec3<f32>"},uThickness:{value:.02,type:"f32"},uIntensity:{value:1.5,type:"f32"}},TH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uStrength;
uniform float uFrequency;
uniform float uSpeed;

void main() {
    vec2 uv = vTextureCoord;

    vec2 center = vec2(0.5, 0.5);

    float dist = distance(uv, center);

    float wave =
        sin(dist * uFrequency - uTime * uSpeed) *
        uStrength *
        smoothstep(1.0, 0.0, dist);

    vec2 dir = normalize(uv - center);

    vec2 distortedUV = uv + dir * wave;

    vec4 color = texture2D(uTexture, distortedUV);

    gl_FragColor = color;
}
`,kH={uTime:{value:0,type:"f32"},uStrength:{value:.02,type:"f32"},uFrequency:{value:20,type:"f32"},uSpeed:{value:4,type:"f32"}},AH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uDensity;
uniform float uSpeed;
uniform float uSize;

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}
vec3 randomColor(float h) {
    return vec3(
        0.5 + 0.5 * sin(h * 6.2831),
        0.5 + 0.5 * sin(h * 6.2831 + 2.1),
        0.5 + 0.5 * sin(h * 6.2831 + 4.2)
    );
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);

    vec3 sparkColor = vec3(0.0);
    float sparkAlpha = 0.0;

    vec2 grid = floor(uv * uDensity);
    vec2 id = grid;

    float h = hash(id);

    vec2 sparkPos = fract(vec2(
        h,
        h + uTime * uSpeed
    ));

    float d = distance(fract(uv * uDensity), sparkPos);

    float spark = smoothstep(uSize, 0.0, d);

    vec3 color = randomColor(h) * spark;

    sparkColor += color;
    sparkAlpha += spark;

    vec3 colorValue = base.rgb + sparkColor;

    gl_FragColor = vec4(colorValue, max(base.a, sparkAlpha));
}
`,IH={uTime:{value:0,type:"f32"},uDensity:{value:30,type:"f32"},uSpeed:{value:2.5,type:"f32"},uSize:{value:.15,type:"f32"}},PH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 uColor;      
uniform float uScanWidth; 
uniform float uIntensity; 

float noise(float x) {
    return sin(x * 120.0) * 0.02;
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);

    float scanPos = fract(uTime * 0.5);
    float scanLine = smoothstep(
        uScanWidth,
        0.0,
        abs(uv.y - scanPos)
    );

    float lines = 0.5 + 0.5 * sin(uv.y * 300.0 + uTime * 10.0);

    float flicker = 0.9 + 0.1 * sin(uTime * 50.0);

    float holo =
        scanLine +
        lines * 0.2 +
        noise(uv.x + uTime) * 0.5;

    holo *= uIntensity * flicker;

    vec3 holoColor = uColor * holo;

    vec3 colorValue = base.rgb + holoColor;

    gl_FragColor = vec4(colorValue, base.a);
}
`,EH={uTime:{value:0,type:"f32"},uColor:{value:[0,1,1],type:"vec3<f32>"},uScanWidth:{value:.02,type:"f32"},uIntensity:{value:1.2,type:"f32"}},MH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uGrain;     
uniform float uFade;      
uniform float uVignette;  

float noise(vec2 p) {
    return fract(sin(dot(p, vec2(12.9898,78.233)) + uTime) * 43758.5453);
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 color = texture2D(uTexture, uv);

    vec3 faded = mix(color.rgb, vec3(
        dot(color.rgb, vec3(0.393, 0.769, 0.189)),
        dot(color.rgb, vec3(0.349, 0.686, 0.168)),
        dot(color.rgb, vec3(0.272, 0.534, 0.131))
    ), uFade);

    float grain = (noise(uv * 500.0) - 0.5) * uGrain;
    faded += grain;

    float flicker = 0.97 + 0.03 * sin(uTime * 60.0);
    faded *= flicker;

    float dist = distance(uv, vec2(0.5));
    float vignette = smoothstep(0.8, uVignette, dist);
    faded *= 1.0 - vignette;

    gl_FragColor = vec4(faded, color.a);
}
`,FH={uTime:{value:0,type:"f32"},uGrain:{value:.08,type:"f32"},uFade:{value:.6,type:"f32"},uVignette:{value:1,type:"f32"}},RH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uThickness;
uniform vec3 uOutlineColor;

void main() {
    vec2 uv = vTextureCoord;

    vec2 px = vec2(uThickness) / vec2(1024.0, 1024.0);

    vec4 centerTex = texture2D(uTexture, uv);
    vec3 center = centerTex.rgb;

    vec3 up     = texture2D(uTexture, uv + vec2(0.0,  px.y)).rgb;
    vec3 down   = texture2D(uTexture, uv - vec2(0.0,  px.y)).rgb;
    vec3 left   = texture2D(uTexture, uv - vec2(px.x, 0.0)).rgb;
    vec3 right  = texture2D(uTexture, uv + vec2(px.x, 0.0)).rgb;

    float edge =
        length(center - up) +
        length(center - down) +
        length(center - left) +
        length(center - right);

    edge = smoothstep(0.15, 0.4, edge);

    vec3 colorValue = mix(center, uOutlineColor, edge);
    gl_FragColor = vec4(colorValue, centerTex.a);
}

`,zH={uThickness:{value:1.5,type:"f32"},uOutlineColor:{value:[1,1,1],type:"vec3<f32>"}},UH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uDensity;
uniform float uSize;
uniform float uIntensity;
uniform vec3 uColorA;
uniform vec3 uColorB;

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}

vec3 accentColor(float h) {
    return mix(uColorA, uColorB, fract(h * 7.0));
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 base = texture2D(uTexture, uv);

    vec2 gridUV = floor(uv * uDensity);
    float h = hash(gridUV);

    vec2 offset = vec2(
        fract(h * 13.3),
        fract(h * 7.7)
    );

    vec2 accentUV = fract(uv * uDensity) - offset;

    float dist = length(accentUV);

    float accent = smoothstep(uSize, 0.0, dist);

    accent *= 0.6 + 0.4 * sin(uTime * 10.0 + h * 6.28);

    vec3 color = accentColor(h) * accent * uIntensity;

    float alpha = accent;

    gl_FragColor = vec4(color + base.rgb, max(base.a, alpha));
}
`,BH={uTime:{value:0,type:"f32"},uDensity:{value:20,type:"f32"},uSize:{value:.25,type:"f32"},uIntensity:{value:1.2,type:"f32"},uColorA:{value:[1,.2,.6],type:"vec3<f32>"},uColorB:{value:[.2,.8,1],type:"vec3<f32>"}},OH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform vec3 uColorA;
uniform vec3 uColorB;
uniform float uIntensity;

float noise(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}

vec2 swirl(vec2 uv, float t) {
    vec2 center = vec2(0.5);
    vec2 diff = uv - center;
    float angle = 0.5 * t * length(diff);
    float s = sin(angle);
    float c = cos(angle);
    return center + vec2(c*diff.x - s*diff.y, s*diff.x + c*diff.y);
}

void main() {
    vec2 uv = vTextureCoord;

    vec2 uvSwirl = swirl(uv, uTime);

    vec4 base = texture2D(uTexture, uvSwirl);

    float n = noise(uv * 20.0 + uTime * 2.0);
    vec3 liquid = mix(uColorA, uColorB, n);

    vec3 colorValue = mix(base.rgb, liquid, uIntensity * n);

    gl_FragColor = vec4(colorValue, base.a);
}
`,DH={uTime:{value:0,type:"f32"},uColorA:{value:[.2,.8,1],type:"vec3<f32>"},uColorB:{value:[1,.2,.6],type:"vec3<f32>"},uIntensity:{value:.8,type:"f32"}},LH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uLineThickness;
uniform float uLineIntensity;
uniform float uNoiseIntensity;
uniform vec3 uLineColor;

float rand(vec2 p){
    return fract(sin(dot(p ,vec2(12.9898,78.233))) * 43758.5453);
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 tex = texture2D(uTexture, uv);
    vec3 base = tex.rgb;

    float line = sin(uv.y * 800.0 * uLineThickness) * 0.5 + 0.5;
    line = mix(1.0, line, uLineIntensity);

    float noise =
        (rand(vec2(uTime, uv.y * 1000.0)) - 0.5) * uNoiseIntensity;

    vec3 colorValue = base * line + noise;

    gl_FragColor = vec4(colorValue, tex.a);
}
`,NH={uTime:{value:0,type:"f32"},uLineThickness:{value:2,type:"f32"},uLineIntensity:{value:.6,type:"f32"},uNoiseIntensity:{value:.05,type:"f32"},uLineColor:{value:[.8,1,.8],type:"vec3<f32>"}},HH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uExposure;
uniform float uSaturation;
uniform float uContrast;

vec3 adjustSaturation(vec3 color, float sat) {
    float grey = dot(color, vec3(0.299, 0.587, 0.114));
    return mix(vec3(grey), color, sat);
}

vec3 adjustContrast(vec3 color, float contrast) {
    return (color - 0.5) * contrast + 0.5;
}

void main() {
    vec2 uv = vTextureCoord;

    vec4 tex = texture2D(uTexture, uv);
    vec3 color = tex.rgb;
    color *= uExposure;

    color = adjustSaturation(color, uSaturation);

    color = adjustContrast(color, uContrast);

    color = color / (color + vec3(1.0));

    gl_FragColor = vec4(color, tex.a);
}
`,GH={uExposure:{value:1.2,type:"f32"},uSaturation:{value:4.3,type:"f32"},uContrast:{value:2.2,type:"f32"}},WH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uIntensity;
uniform float uDuration;

void main() {
    vec2 uv = vTextureCoord;
    vec4 base = texture2D(uTexture, uv);

    float flash = smoothstep(0.0, uDuration * 0.5, mod(uTime, uDuration)) *
                  (1.0 - smoothstep(uDuration * 0.5, uDuration, mod(uTime, uDuration)));

    flash *= uIntensity;

    vec3 color = mix(base.rgb, vec3(0.0), flash);

    gl_FragColor = vec4(color, base.a);
}
`,VH={uTime:{value:0,type:"f32"},uIntensity:{value:.7,type:"f32"},uDuration:{value:.2,type:"f32"}},$H=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uPulseScale;  
uniform float uBlurStrength; 
uniform float uGlowBoost; 

vec4 blur3(sampler2D tex, vec2 uv, float s) {
    vec4 c = vec4(0.0);
    c += texture2D(tex, uv + vec2(-s, -s)) * 0.0625;
    c += texture2D(tex, uv + vec2( 0.0, -s)) * 0.125;
    c += texture2D(tex, uv + vec2( s, -s)) * 0.0625;
    c += texture2D(tex, uv + vec2(-s,  0.0)) * 0.125;
    c += texture2D(tex, uv) * 0.25;
    c += texture2D(tex, uv + vec2( s,  0.0)) * 0.125;
    c += texture2D(tex, uv + vec2(-s,  s)) * 0.0625;
    c += texture2D(tex, uv + vec2( 0.0,  s)) * 0.125;
    c += texture2D(tex, uv + vec2( s,  s)) * 0.0625;
    return c * uGlowBoost;
}

void main() {
    vec2 uv = vTextureCoord;

    float scale = 1.0 + uPulseScale * (0.5 + 0.5 * sin(uTime * 3.0));
    vec2 center = vec2(0.28,0.48); 
    vec2 uvScaled = (uv - center) / scale + center;
    uvScaled = clamp(uvScaled, 0.0, 1.0);
    vec4 base = texture2D(uTexture, uvScaled);
    vec4 blurred = blur3(uTexture, uvScaled, uBlurStrength);
    vec4 colorValue = mix(base, blurred, 0.8);

    gl_FragColor = colorValue;
}
`,qH={uTime:{value:0,type:"f32"},uPulseScale:{value:.2,type:"f32"},uBlurStrength:{value:.02,type:"f32"},uGlowBoost:{value:2,type:"f32"}},YH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uIntensity; // 0  original, 1  negativo completo
uniform float uContrast;  // fuerza de contraste

void main() {
    vec2 uv = vTextureCoord;
    vec4 color = texture2D(uTexture, uv);
    vec3 negative = 1.0 - color.rgb;

    vec3 contrasted = (negative - 0.5) * uContrast + 0.5;

    float maskedIntensity = uIntensity * color.a;

    vec3 colorValue =
        mix(color.rgb, contrasted, maskedIntensity);

    gl_FragColor = vec4(colorValue, color.a);
}
`,XH={uIntensity:{value:1,type:"f32"},uContrast:{value:2.5,type:"f32"}},jH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;
uniform float uIntensity;
uniform float uSpeed;

float rand(float x){
    return fract(sin(x * 12.9898) * 43758.5453);
}

vec2 shakeOffset(float time){
    float x = (rand(time * 0.7) - 0.5) * uIntensity;
    float y = (rand(time * 1.3 + 10.0) - 0.5) * uIntensity;
    return vec2(x, y);
}

void main() {
    vec2 uv = vTextureCoord;

    vec2 offset = shakeOffset(uTime * uSpeed);

    vec2 uvMoved = clamp(uv + offset, 0.0, 1.0);

    vec4 color = texture2D(uTexture, uvMoved);

    gl_FragColor = color;
}

`,KH={uTime:{value:0,type:"f32"},uIntensity:{value:1,type:"f32"},uSpeed:{value:1,type:"f32"}},ZH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uExposure;
uniform float uBloom;
uniform float uContrast;

vec3 tonemapReinhard(vec3 color){
    return color / (color + vec3(1.0));
}

void main() {
    vec2 uv = vTextureCoord;
    vec4 tex = texture2D(uTexture, uv);

    if (tex.a < 0.01) {
        gl_FragColor = tex;
        return;
    }

    vec3 color = tex.rgb;

    vec3 bright = max(color - 0.6, 0.0) * uBloom;
    bright = tonemapReinhard(bright);

    vec3 hdrColor = color + bright * 0.6;

    hdrColor *= uExposure;

    hdrColor = (hdrColor - 0.5) * uContrast + 0.5;

    hdrColor = clamp(hdrColor, 0.0, 1.0);

    gl_FragColor = vec4(hdrColor, tex.a);
}
`,JH={uExposure:{value:1,type:"f32"},uBloom:{value:1.5,type:"f32"},uContrast:{value:2,type:"f32"}},QH=`
precision highp float;

varying vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform float uTime;       
uniform float uZoomSpeed;  
uniform float uMaxZoom;    
uniform float uBlurStrength; 

vec4 blur3(sampler2D tex, vec2 uv, float s) {
    vec4 c = vec4(0.0);
    c += texture2D(tex, uv + vec2(-s, -s)) * 0.0625;
    c += texture2D(tex, uv + vec2( 0.0, -s)) * 0.125;
    c += texture2D(tex, uv + vec2( s, -s)) * 0.0625;
    c += texture2D(tex, uv + vec2(-s,  0.0)) * 0.125;
    c += texture2D(tex, uv) * 0.25;
    c += texture2D(tex, uv + vec2( s,  0.0)) * 0.125;
    c += texture2D(tex, uv + vec2(-s,  s)) * 0.0625;
    c += texture2D(tex, uv + vec2( 0.0,  s)) * 0.125;
    c += texture2D(tex, uv + vec2( s,  s)) * 0.0625;
    return c;
}

void main() {
    vec2 uv = vTextureCoord;
    vec2 center = vec2(0.28,0.48); 

    float zoom = 1.0 + (uMaxZoom - 1.0) * smoothstep(0.0, 1.0, sin(uTime * uZoomSpeed));

    vec2 uvZoomed = (uv - center) / zoom + center;

    uvZoomed = clamp(uvZoomed, 0.0, 1.0);

    vec4 color = texture2D(uTexture, uvZoomed);

    if (uBlurStrength > 0.0) {
        vec4 blurred = blur3(uTexture, uvZoomed, uBlurStrength);
        color = mix(color, blurred, 0.5);
    }

    gl_FragColor = color;
}
`,eG={uTime:{value:0,type:"f32"},uZoomSpeed:{value:5,type:"f32"},uMaxZoom:{value:2,type:"f32"},uBlurStrength:{value:.01,type:"f32"}},tG={rotationMovement:{label:"Rotation Movement",fragment:xL,uniforms:bL},redGradient:{label:"Red Gradient",fragment:_L,uniforms:wL},bubbleSparkles:{label:"Bubble Sparkles",fragment:SL,uniforms:CL},sepia:{label:"Sepia",fragment:TL,uniforms:kL},uvGradient:{label:"UV Gradient",fragment:AL,uniforms:IL},rainbow:{label:"Rainbow",fragment:PL,uniforms:EL},glitch:{label:"Glitch",fragment:ML,uniforms:FL},pixelate:{label:"Pixelate",fragment:ZS,uniforms:JS},rgbGlitch:{label:"RGB Glitch",fragment:RL,uniforms:zL},rgbShift:{label:"RGB Shift",fragment:UL,uniforms:BL},halftone:{label:"Halftone",fragment:OL,uniforms:DL},sinewave:{label:"Sinewave",fragment:LL,uniforms:NL},shine:{label:"Shine",fragment:HL,uniforms:GL},blink:{label:"Blink",fragment:WL,uniforms:VL},spring:{label:"Spring",fragment:$L,uniforms:qL},duotone:{label:"Duotone",fragment:YL,uniforms:XL},tritone:{label:"Tritone",fragment:jL,uniforms:KL},hueShift:{label:"Hue Shift",fragment:ZL,uniforms:JL},warpTransition:{label:"Warp Transition",fragment:QL,uniforms:eN},slitScan:{label:"Slit Scan",fragment:tN,uniforms:iN},slitScanGlitch:{label:"Slit Scan Glitch",fragment:sN,uniforms:rN},pixelateTransition:{label:"Pixelate Transition",fragment:nN,uniforms:oN},focusTransition:{label:"Focus Transition",fragment:aN,uniforms:lN},invert:{label:"Invert",fragment:cN,uniforms:uN},grayscale:{label:"Grayscale",fragment:hN,uniforms:dN},vignette:{label:"Vignette",fragment:fN,uniforms:pN},chromatic:{label:"Chromatic",fragment:mN,uniforms:gN},swirlMovement:{label:"Swirl Movement",fragment:yN,uniforms:vN},heartSparkles:{label:"Heart Sparkles",fragment:xN,uniforms:bN},butterflySparkles:{label:"Butterfly Sparkles",fragment:_N,uniforms:wN},distort:{label:"Distort",fragment:SN,uniforms:CN},perspectiveSingle:{label:"Perspective Single",fragment:TN,uniforms:kN},distortSpin:{label:"Distort Spin",fragment:AN,uniforms:IN},distortGrid:{label:"Distort Grid",fragment:PN,uniforms:EN},distortRip:{label:"Distort Rip",fragment:MN,uniforms:FN},twoCurtain:{label:"Two Curtain",fragment:RN,uniforms:zN},trianglePattern:{label:"Triangle Pattern",fragment:UN,uniforms:BN},mirrorTile:{label:"Mirror Tile",fragment:ON,uniforms:DN},flashLoop:{label:"Flash Loop",fragment:LN,uniforms:NN},filmStripPro:{label:"Film Strip Pro",fragment:HN,uniforms:GN},badSignal:{label:"Bad Signal",fragment:WN,uniforms:VN},omniflexion:{label:"Omniflexion",fragment:$N,uniforms:qN},inverseAperture:{label:"Inverse Aperture",fragment:YN,uniforms:XN},curtainOpen:{label:"Curtain Open",fragment:jN,uniforms:KN},curtainBlur:{label:"Curtain Blur",fragment:ZN,uniforms:JN},distortV2:{label:"Distort V2",fragment:QN,uniforms:eH},lightning:{label:"Lightning",fragment:tH,uniforms:iH},lightningVeins:{label:"Lightning Veins",fragment:sH,uniforms:rH},pixelError:{label:"Pixel Error",fragment:nH,uniforms:oH},neonFlash:{label:"Neon Flash",fragment:aH,uniforms:lH},waveDistort:{label:"Wave Distort",fragment:cH,uniforms:uH},bouncingBalls:{label:"Bouncing Balls",fragment:hH,uniforms:dH},waterReflection:{label:"Water Reflection",fragment:fH,uniforms:pH},darkError:{label:"Dark Error",fragment:mH,uniforms:gH},scaleMoveBlur:{label:"Scale Move Blur",fragment:yH,uniforms:vH},paperBreakReveal:{label:"Paper Break Reveal",fragment:xH,uniforms:bH},graffiti:{label:"Graffiti",fragment:_H,uniforms:wH},laser:{label:"Laser",fragment:SH,uniforms:CH},wave:{label:"Wave",fragment:TH,uniforms:kH},sparks:{label:"Sparks",fragment:AH,uniforms:IH},hologramScan:{label:"Hologram Scan",fragment:PH,uniforms:EH},retro70s:{label:"Retro 70s",fragment:MH,uniforms:FH},igOutline:{label:"IG Outline",fragment:RH,uniforms:zH},randomAccents:{label:"Random Accents",fragment:UH,uniforms:BH},solution:{label:"Solution",fragment:OH,uniforms:DH},tvScanlines:{label:"TV Scanlines",fragment:LH,uniforms:NH},hdr:{label:"HDR",fragment:HH,uniforms:GH},blackFlash:{label:"Black Flash",fragment:WH,uniforms:VH},brightPulse:{label:"Bright Pulse",fragment:$H,uniforms:qH},negativeDivision:{label:"Negative Division",fragment:YH,uniforms:XH},cameraMove:{label:"Camera Move",fragment:jH,uniforms:KH},hdrV2:{label:"HDR V2",fragment:ZH,uniforms:JH},fastZoom:{label:"Fast Zoom",fragment:QH,uniforms:eG}},Og={...tG};Object.entries(Og).map(([t,e])=>({key:t,label:e.label,previewStatic:`https://cdn.subgen.co/previews/effects/static/effect_${t}_static.webp`,previewDynamic:`https://cdn.subgen.co/previews/effects/dynamic/effect_${t}_dynamic.webp`}));function iG({name:t,renderer:e}){let i;const s=Object.keys(Og).find(h=>h.toLowerCase()===t.toLowerCase());s&&(i=Og[s]);const{fragment:r,uniforms:n,label:o}=i,a=new Zt,l=jt.create({width:e.width,height:e.height}),u=new mn({vertex:vL,fragment:r,name:`${o}-shader`}),c=new rc({glProgram:u,resources:{effectUniforms:{...n}}});return a.filters=[c],{filter:c,render({width:h,height:f,canvasTexture:d,progress:p}){(l.width!==h||l.height!==f)&&l.resize(h,f);const m=d instanceof jt?d:xe.from(d);a.texture=m,a.width=h,a.height=f;const g=c.resources.effectUniforms.uniforms;return g.uTime=p,e.render({container:a,target:l,clear:!0}),l}}}function sG(t,e){const{opacity:i,zIndex:s,flip:r,left:n,top:o,width:a,height:l,angle:u}=t;e.x=n,e.y=o,e.width=Math.abs(a),e.height=Math.abs(l),e.angle=u,e.alpha=i,e.zIndex=s,r==="horizontal"?e.scale.x=-Math.abs(e.scale.x):r==="vertical"&&(e.scale.y=-Math.abs(e.scale.y))}class rG{constructor(e,i,s=null){this.sprite=i,this.targetContainer=s,!s&&e&&(this.targetContainer=e.stage),this.resolution=e?.renderer?.resolution??1,this.canvas=new OffscreenCanvas(1,1);const r=this.canvas.getContext("2d");if(r==null)throw new Error("Failed to create 2d context for PixiSpriteRenderer");this.context=r,this.root=new it,this.root.visible=!1,this.targetContainer&&this.targetContainer.addChild(this.root)}pixiSprite=null;texture=null;canvas;context;root=null;strokeGraphics=null;maskGraphics=null;shadowGraphics=null;shadowContainer=null;resolution=1;destroyed=!1;async updateFrame(e){if(this.destroyed)return;if(e==null){this.root!=null&&(this.root.visible=!1,this.applySpriteTransforms());return}if(e instanceof xe||e&&typeof e.source<"u"){if(e.width===0||e.height===0){console.warn("PixiSpriteRenderer: Texture has zero dimensions",e.width,e.height);return}this.pixiSprite==null?(this.pixiSprite=new Zt(e),this.pixiSprite.label="MainSprite",this.root.addChild(this.pixiSprite),this.applySpriteTransforms()):this.pixiSprite.texture=e,this.root!=null&&(this.root.visible=!0,this.applySpriteTransforms());return}const s=e.width,r=e.height;if(typeof s!="number"||typeof r!="number"||s<=0||r<=0){console.warn("PixiSpriteRenderer: Invalid frame dimensions",s,r);return}const n=this.texture==null||this.pixiSprite==null,o=Math.floor(s),a=Math.floor(r);if(this.canvas.width!==o||this.canvas.height!==a||n){if(this.canvas.width=o,this.canvas.height=a,this.texture!=null&&(this.texture.destroy(!0),this.texture=null),this.texture=xe.from(this.canvas),!this.texture||!this.texture.source){console.error("PixiSpriteRenderer: Failed to create valid texture");return}this.pixiSprite==null?(this.pixiSprite=new Zt(this.texture),this.pixiSprite.label="MainSprite",this.root.addChild(this.pixiSprite),this.applySpriteTransforms()):this.pixiSprite.texture=this.texture}if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(e,0,0),this.texture!=null&&this.texture.source!=null){const u=this.texture.source;if(u.resource){const c=u.resource;c.update&&c.update()}typeof u.update=="function"&&u.update()}this.root!=null&&(this.root.visible=!0,this.applySpriteTransforms())}applySpriteTransforms(){if(this.pixiSprite==null||this.root==null||this.destroyed)return;const{flip:e,center:i,width:s,height:r,angle:n,opacity:o,zIndex:a}=this.sprite;this.root.x=i.x,this.root.y=i.y,this.root.angle=(e==null?1:-1)*n,this.root.alpha=o,this.root.zIndex=a,this.root.scale.set(1,1),this.pixiSprite.anchor.set(.5,.5),this.pixiSprite.position.set(0,0);const l=this.pixiSprite.texture?.width??1,u=this.pixiSprite.texture?.height??1,c=this.sprite.type==="Caption",h=!c&&s&&s!==0?Math.abs(s)/l:1,f=!c&&r&&r!==0?Math.abs(r)/u:1;e==="horizontal"?(this.pixiSprite.scale.x=-h,this.pixiSprite.scale.y=f):e==="vertical"?(this.pixiSprite.scale.x=h,this.pixiSprite.scale.y=-f):(this.pixiSprite.scale.x=h,this.pixiSprite.scale.y=f),this.applyStyle()}applyStyle(){if(this.pixiSprite==null||this.destroyed)return;const e=this.sprite.style||{},i=this.pixiSprite.texture?.width??0,s=this.pixiSprite.texture?.height??0;if(i===0||s===0)return;const r=e.borderRadius||0;r>0?(this.maskGraphics==null&&(this.maskGraphics=new dt,this.pixiSprite.addChild(this.maskGraphics),this.pixiSprite.mask=this.maskGraphics),this.maskGraphics.clear(),this.maskGraphics.roundRect(-i/2,-s/2,i,s,Math.min(r,i/2,s/2)),this.maskGraphics.fill({color:16777215,alpha:1}),this.maskGraphics.visible=!0):this.maskGraphics&&(this.maskGraphics.visible=!1,this.pixiSprite.mask=null),this.sprite.type!=="Text"&&this.sprite.type!=="Caption"?this.applyStroke(e,i,s):this.strokeGraphics&&(this.strokeGraphics.visible=!1),this.sprite.type!=="Text"&&this.sprite.type!=="Caption"?this.applyShadow(e):this.shadowContainer&&(this.shadowContainer.visible=!1,this.shadowContainer.filters=[])}applyStroke(e,i,s){const r=e.stroke;if(r&&r.width>0){this.strokeGraphics==null&&(this.strokeGraphics=new dt,this.pixiSprite.addChild(this.strokeGraphics)),this.strokeGraphics.clear();const n=ut(r.color)??16777215,o=r.width,a=e.borderRadius||0;if(this.strokeGraphics.setStrokeStyle({width:o,color:n,alignment:1}),a>0){const l=Math.min(a,i/2,s/2);this.strokeGraphics.roundRect(-i/2,-s/2,i,s,l)}else this.strokeGraphics.rect(-i/2,-s/2,i,s);this.strokeGraphics.stroke(),this.strokeGraphics.visible=!0}else this.strokeGraphics!=null&&(this.strokeGraphics.visible=!1)}applyShadow(e){const i=e.dropShadow,s=Math.abs(this.sprite.width??0),r=Math.abs(this.sprite.height??0);if(i&&s>0&&r>0&&(i.blur>0||i.distance>0)){this.shadowContainer==null&&(this.shadowContainer=new it,this.shadowContainer.label="ShadowContainer",this.shadowGraphics=new dt,this.shadowContainer.addChild(this.shadowGraphics),this.root.addChildAt(this.shadowContainer,0));const n=ut(i.color)??0,o=i.alpha??.5,a=i.blur??0,l=i.distance??0,u=i.angle??0,c=Math.cos(u)*l,h=Math.sin(u)*l;this.shadowContainer.position.set(c,h),this.shadowGraphics.clear();const f=e.borderRadius||0;if(f>0){const d=Math.min(f,s/2,r/2);this.shadowGraphics.roundRect(-s/2,-r/2,s,r,d)}else this.shadowGraphics.rect(-s/2,-r/2,s,r);if(this.shadowGraphics.fill({color:n,alpha:o}),a>0){(!this.shadowContainer.filters||this.shadowContainer.filters.length===0)&&(this.shadowContainer.filters=[new $S]);const d=this.shadowContainer.filters[0],p=this.root?Math.sqrt(this.root.worldTransform.a**2+this.root.worldTransform.b**2):1;d.strength=a*p,d.resolution=this.resolution,d.padding=Math.max(a*2*p,20)}else this.shadowContainer.filters=[];this.shadowContainer.visible=!0}else this.shadowContainer!=null&&(this.shadowContainer.visible=!1,this.shadowContainer.filters=[])}updateTransforms(){this.root!=null&&!this.destroyed&&this.applySpriteTransforms()}getSprite(){return this.pixiSprite}getRoot(){return this.root}destroy(){this.destroyed||(this.destroyed=!0,this.root!=null&&(this.root.parent&&this.root.parent.removeChild(this.root),this.root.destroy({children:!0}),this.root=null,this.pixiSprite=null),this.strokeGraphics!=null&&(this.strokeGraphics.destroy(),this.strokeGraphics=null),this.maskGraphics!=null&&(this.maskGraphics.destroy(),this.maskGraphics=null),this.shadowGraphics!=null&&(this.shadowGraphics.destroy(),this.shadowGraphics=null),this.shadowContainer!=null&&(this.shadowContainer.destroy({children:!0}),this.shadowContainer=null),this.texture!=null&&(this.texture.destroy(),this.texture=null))}}function wm(t,e=!1){return t.toJSON(e)}async function Va(t){let e,i=null;switch(t.type){case"Video":i=yi;break;case"Audio":i=gi;break;case"Image":return e=await zg.fromObject(t),e;case"Text":i=Li;break;case"Caption":i=Ns;break;case"Effect":i=Us;break;case"Transition":i=Ms;break;case"Placeholder":i=j0;break}if(i&&typeof i.fromObject=="function")return await i.fromObject(t);switch(t.type){case"Text":{const s=t.text||"",r=t.style||{},n={fontSize:r.fontSize,fontFamily:r.fontFamily,fontWeight:r.fontWeight,fontStyle:r.fontStyle,fill:r.color,align:r.align};r.stroke&&(n.stroke=r.stroke.color,n.strokeWidth=r.stroke.width),r.shadow&&(n.dropShadow={color:r.shadow.color,alpha:r.shadow.alpha,blur:r.shadow.blur,distance:r.shadow.distance,angle:r.shadow.angle}),e=new Li(s,n);break}case"Caption":{const s=t.text||"",r=t.style||{},n={fontSize:r.fontSize,fontFamily:r.fontFamily,fontWeight:r.fontWeight,fontStyle:r.fontStyle,fill:r.color,align:r.align};if(r.fontUrl!==void 0?n.fontUrl=r.fontUrl:t.fontUrl!==void 0&&(n.fontUrl=t.fontUrl),r.wordsPerLine!==void 0?n.wordsPerLine=r.wordsPerLine:t.wordsPerLine!==void 0&&(n.wordsPerLine=t.wordsPerLine),r.stroke&&(n.stroke=r.stroke.color,n.strokeWidth=r.stroke.width),r.shadow&&(n.dropShadow={color:r.shadow.color,alpha:r.shadow.alpha,blur:r.shadow.blur,distance:r.shadow.distance,angle:r.shadow.angle}),t.caption){const o=t.caption;o.words&&(n.words=o.words),o.colors&&(o.colors.appeared!==void 0&&(n.appearedColor=o.colors.appeared),o.colors.active!==void 0&&(n.activeColor=o.colors.active),o.colors.activeFill!==void 0&&(n.activeFillColor=o.colors.activeFill),o.colors.background!==void 0&&(n.backgroundColor=o.colors.background),o.colors.keyword!==void 0&&(n.isKeyWordColor=o.colors.keyword)),o.preserveKeywordColor!==void 0&&(n.preservedColorKeyWord=o.preserveKeywordColor),o.positioning&&(o.positioning.bottomOffset!==void 0&&(n.bottomOffset=o.positioning.bottomOffset),o.positioning.videoWidth!==void 0&&(n.videoWidth=o.positioning.videoWidth),o.positioning.videoHeight!==void 0&&(n.videoHeight=o.positioning.videoHeight))}else t.bottomOffset!==void 0&&(n.bottomOffset=t.bottomOffset),t.words&&(n.words=t.words),t.appearedColor!==void 0&&(n.appearedColor=t.appearedColor),t.activeColor!==void 0&&(n.activeColor=t.activeColor),t.activeFillColor!==void 0&&(n.activeFillColor=t.activeFillColor),t.backgroundColor!==void 0&&(n.backgroundColor=t.backgroundColor),t.isKeyWordColor!==void 0&&(n.isKeyWordColor=t.isKeyWordColor),t.preservedColorKeyWord!==void 0&&(n.preservedColorKeyWord=t.preservedColorKeyWord),t.videoWidth!==void 0&&(n.videoWidth=t.videoWidth),t.videoHeight!==void 0&&(n.videoHeight=t.videoHeight);t.mediaId&&(n.mediaId=t.mediaId),t.wordsPerLine&&(n.wordsPerLine=t.wordsPerLine),n.initialLayoutApplied=!0,e=new Ns(s,n);break}case"Effect":{e=new Us(t.effect.key),e.effect=t.effect;break}default:throw new Error(`Unsupported clip type: ${t.type}`)}return e.left=t.left,e.top=t.top,e.width=t.width,e.height=t.height,e.angle=t.angle,e.display.from=t.display.from,e.display.to=t.display.to,e.duration=t.duration,e.playbackRate=t.playbackRate,e.zIndex=t.zIndex,e.opacity=t.opacity,e.flip=t.flip,t.style&&(e.style={...e.style,...t.style}),t.animation&&e.setAnimation(t.animation.keyFrames,t.animation.opts),t.id&&(e.id=t.id),t.name&&(e.name=t.name),t.effects&&(e.effects=t.effects),t.trim&&(e.trim.from=t.trim.from<1e6?t.trim.from*1e6:t.trim.from,e.trim.to=t.trim.to<1e6?t.trim.to*1e6:t.trim.to),e}var Sm,Qx;function nG(){return Qx||(Qx=1,Sm=[{name:"Bounce",paramsTypes:{shadow_colour:"vec4",shadow_height:"float",bounces:"float"},defaultParams:{shadow_colour:[0,0,0,.6],shadow_height:.075,bounces:3},glsl:`// Author: Adrian Purser
// License: MIT

uniform vec4 shadow_colour; // = vec4(0.,0.,0.,.6)
uniform float shadow_height; // = 0.075
uniform float bounces; // = 3.0

const float PI = 3.14159265358;

vec4 transition (vec2 uv) {
  float time = progress;
  float stime = sin(time * PI / 2.);
  float phase = time * PI * bounces;
  float y = (abs(cos(phase))) * (1.0 - stime);
  float d = uv.y - y;
  return mix(
    mix(
      getToColor(uv),
      shadow_colour,
      step(d, shadow_height) * (1. - mix(
        ((d / shadow_height) * shadow_colour.a) + (1.0 - shadow_colour.a),
        1.0,
        smoothstep(0.95, 1., progress) // fade-out the shadow at the end
      ))
    ),
    getFromColor(vec2(uv.x, uv.y + (1.0 - y))),
    step(d, 0.0)
  );
}
`,author:"Adrian Purser",license:"MIT",createdAt:"Fri, 10 Nov 2017 17:01:45 +0000",updatedAt:"Sat, 11 Nov 2017 08:50:40 +0100"},{name:"BowTieHorizontal",paramsTypes:{},defaultParams:{},glsl:`// Author: huynx
// License: MIT

vec2 bottom_left = vec2(0.0, 1.0);
vec2 bottom_right = vec2(1.0, 1.0);
vec2 top_left = vec2(0.0, 0.0);
vec2 top_right = vec2(1.0, 0.0);
vec2 center = vec2(0.5, 0.5);

float check(vec2 p1, vec2 p2, vec2 p3)
{
  return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);
}

bool PointInTriangle (vec2 pt, vec2 p1, vec2 p2, vec2 p3)
{
    bool b1, b2, b3;
    b1 = check(pt, p1, p2) < 0.0;
    b2 = check(pt, p2, p3) < 0.0;
    b3 = check(pt, p3, p1) < 0.0;
    return ((b1 == b2) && (b2 == b3));
}

bool in_left_triangle(vec2 p){
  vec2 vertex1, vertex2, vertex3;
  vertex1 = vec2(progress, 0.5);
  vertex2 = vec2(0.0, 0.5-progress);
  vertex3 = vec2(0.0, 0.5+progress);
  if (PointInTriangle(p, vertex1, vertex2, vertex3))
  {
    return true;
  }
  return false;
}

bool in_right_triangle(vec2 p){
  vec2 vertex1, vertex2, vertex3;
  vertex1 = vec2(1.0-progress, 0.5);
  vertex2 = vec2(1.0, 0.5-progress);
  vertex3 = vec2(1.0, 0.5+progress);
  if (PointInTriangle(p, vertex1, vertex2, vertex3))
  {
    return true;
  }
  return false;
}

float blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt)
{
  vec2 lineDir = bot1 - top;
  vec2 perpDir = vec2(lineDir.y, -lineDir.x);
  vec2 dirToPt1 = bot1 - testPt;
  float dist1 = abs(dot(normalize(perpDir), dirToPt1));
  
  lineDir = bot2 - top;
  perpDir = vec2(lineDir.y, -lineDir.x);
  dirToPt1 = bot2 - testPt;
  float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);
  
  if (min_dist < 0.005) {
    return min_dist / 0.005;
  }
  else  {
    return 1.0;
  };
}


vec4 transition (vec2 uv) {
  if (in_left_triangle(uv))
  {
    if (progress < 0.1)
    {
      return getFromColor(uv);
    }
    if (uv.x < 0.5)
    {
      vec2 vertex1 = vec2(progress, 0.5);
      vec2 vertex2 = vec2(0.0, 0.5-progress);
      vec2 vertex3 = vec2(0.0, 0.5+progress);
      return mix(
        getFromColor(uv),
        getToColor(uv),
        blur_edge(vertex2, vertex3, vertex1, uv)
      );
    }
    else
    {
      if (progress > 0.0)
      {
        return getToColor(uv);
      }
      else
      {
        return getFromColor(uv);
      }
    }    
  }
  else if (in_right_triangle(uv))
  {
    if (uv.x >= 0.5)
    {
      vec2 vertex1 = vec2(1.0-progress, 0.5);
      vec2 vertex2 = vec2(1.0, 0.5-progress);
      vec2 vertex3 = vec2(1.0, 0.5+progress);
      return mix(
        getFromColor(uv),
        getToColor(uv),
        blur_edge(vertex2, vertex3, vertex1, uv)
      );  
    }
    else
    {
      return getFromColor(uv);
    }
  }
  else {
    return getFromColor(uv);
  }
}`,author:"huynx",license:"MIT",createdAt:"Sat, 24 Mar 2018 12:54:26 +0100",updatedAt:"Sat, 24 Mar 2018 12:54:26 +0100"},{name:"BowTieVertical",paramsTypes:{},defaultParams:{},glsl:`// Author: huynx\r
// License: MIT\r
\r
float check(vec2 p1, vec2 p2, vec2 p3)\r
{\r
  return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\r
}\r
\r
bool PointInTriangle (vec2 pt, vec2 p1, vec2 p2, vec2 p3)\r
{\r
    bool b1, b2, b3;\r
    b1 = check(pt, p1, p2) < 0.0;\r
    b2 = check(pt, p2, p3) < 0.0;\r
    b3 = check(pt, p3, p1) < 0.0;\r
    return ((b1 == b2) && (b2 == b3));\r
}\r
\r
bool in_top_triangle(vec2 p){\r
  vec2 vertex1, vertex2, vertex3;\r
  vertex1 = vec2(0.5, progress);\r
  vertex2 = vec2(0.5-progress, 0.0);\r
  vertex3 = vec2(0.5+progress, 0.0);\r
  if (PointInTriangle(p, vertex1, vertex2, vertex3))\r
  {\r
    return true;\r
  }\r
  return false;\r
}\r
\r
bool in_bottom_triangle(vec2 p){\r
  vec2 vertex1, vertex2, vertex3;\r
  vertex1 = vec2(0.5, 1.0 - progress);\r
  vertex2 = vec2(0.5-progress, 1.0);\r
  vertex3 = vec2(0.5+progress, 1.0);\r
  if (PointInTriangle(p, vertex1, vertex2, vertex3))\r
  {\r
    return true;\r
  }\r
  return false;\r
}\r
\r
float blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt)\r
{\r
  vec2 lineDir = bot1 - top;\r
  vec2 perpDir = vec2(lineDir.y, -lineDir.x);\r
  vec2 dirToPt1 = bot1 - testPt;\r
  float dist1 = abs(dot(normalize(perpDir), dirToPt1));\r
  \r
  lineDir = bot2 - top;\r
  perpDir = vec2(lineDir.y, -lineDir.x);\r
  dirToPt1 = bot2 - testPt;\r
  float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);\r
  \r
  if (min_dist < 0.005) {\r
    return min_dist / 0.005;\r
  }\r
  else  {\r
    return 1.0;\r
  };\r
}\r
\r
\r
vec4 transition (vec2 uv) {\r
  if (in_top_triangle(uv))\r
  {\r
    if (progress < 0.1)\r
    {\r
      return getFromColor(uv);\r
    }\r
    if (uv.y < 0.5)\r
    {\r
      vec2 vertex1 = vec2(0.5, progress);\r
      vec2 vertex2 = vec2(0.5-progress, 0.0);\r
      vec2 vertex3 = vec2(0.5+progress, 0.0);\r
      return mix(\r
        getFromColor(uv),\r
        getToColor(uv),\r
        blur_edge(vertex2, vertex3, vertex1, uv)\r
      );\r
    }\r
    else\r
    {\r
      if (progress > 0.0)\r
      {\r
        return getToColor(uv);\r
      }\r
      else\r
      {\r
        return getFromColor(uv);\r
      }\r
    }    \r
  }\r
  else if (in_bottom_triangle(uv))\r
  {\r
    if (uv.y >= 0.5)\r
    {\r
      vec2 vertex1 = vec2(0.5, 1.0-progress);\r
      vec2 vertex2 = vec2(0.5-progress, 1.0);\r
      vec2 vertex3 = vec2(0.5+progress, 1.0);\r
      return mix(\r
        getFromColor(uv),\r
        getToColor(uv),\r
        blur_edge(vertex2, vertex3, vertex1, uv)\r
      );  \r
    }\r
    else\r
    {\r
      return getFromColor(uv);\r
    }\r
  }\r
  else {\r
    return getFromColor(uv);\r
  }\r
}`,author:"huynx",license:"MIT",createdAt:"Tue, 27 Mar 2018 10:07:54 +0700",updatedAt:"Tue, 27 Mar 2018 10:07:54 +0700"},{name:"ButterflyWaveScrawler",paramsTypes:{amplitude:"float",waves:"float",colorSeparation:"float"},defaultParams:{amplitude:1,waves:30,colorSeparation:.3},glsl:`// Author: mandubian
// License: MIT
uniform float amplitude; // = 1.0
uniform float waves; // = 30.0
uniform float colorSeparation; // = 0.3
float PI = 3.14159265358979323846264;
float compute(vec2 p, float progress, vec2 center) {
vec2 o = p*sin(progress * amplitude)-center;
// horizontal vector
vec2 h = vec2(1., 0.);
// butterfly polar function (don't ask me why this one :))
float theta = acos(dot(o, h)) * waves;
return (exp(cos(theta)) - 2.*cos(4.*theta) + pow(sin((2.*theta - PI) / 24.), 5.)) / 10.;
}
vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy;
  float inv = 1. - progress;
  vec2 dir = p - vec2(.5);
  float dist = length(dir);
  float disp = compute(p, progress, vec2(0.5, 0.5)) ;
  vec4 texTo = getToColor(p + inv*disp);
  vec4 texFrom = vec4(
  getFromColor(p + progress*disp*(1.0 - colorSeparation)).r,
  getFromColor(p + progress*disp).g,
  getFromColor(p + progress*disp*(1.0 + colorSeparation)).b,
  1.0);
  return texTo*progress + texFrom*inv;
}
`,author:"mandubian",license:"MIT",createdAt:"Thu, 1 Jun 2017 11:47:17 +0200",updatedAt:"Thu, 1 Jun 2017 11:47:17 +0200"},{name:"CircleCrop",paramsTypes:{bgcolor:"vec4"},defaultParams:{bgcolor:[0,0,0,1]},glsl:`// License: MIT
// Author: fkuteken
// ported by gre from https://gist.github.com/fkuteken/f63e3009c1143950dee9063c3b83fb88

uniform vec4 bgcolor; // = vec4(0.0, 0.0, 0.0, 1.0)

vec2 ratio2 = vec2(1.0, 1.0 / ratio);
float s = pow(2.0 * abs(progress - 0.5), 3.0);

vec4 transition(vec2 p) {
  float dist = length((vec2(p) - 0.5) * ratio2);
  return mix(
    progress < 0.5 ? getFromColor(p) : getToColor(p), // branching is ok here as we statically depend on progress uniform (branching won't change over pixels)
    bgcolor,
    step(s, dist)
  );
}
`,license:"MIT",author:"fkuteken",createdAt:"Mon, 12 Jun 2017 12:52:34 +0800",updatedAt:"Mon, 12 Jun 2017 12:52:34 +0800"},{name:"ColourDistance",paramsTypes:{power:"float"},defaultParams:{power:5},glsl:`// License: MIT
// Author: P-Seebauer
// ported by gre from https://gist.github.com/P-Seebauer/2a5fa2f77c883dd661f9

uniform float power; // = 5.0

vec4 transition(vec2 p) {
  vec4 fTex = getFromColor(p);
  vec4 tTex = getToColor(p);
  float m = step(distance(fTex, tTex), progress);
  return mix(
    mix(fTex, tTex, m),
    tTex,
    pow(progress, power)
  );
}
`,license:"MIT",author:"P-Seebauer",createdAt:"Mon, 12 Jun 2017 12:57:42 +0800",updatedAt:"Mon, 12 Jun 2017 12:57:42 +0800"},{name:"CrazyParametricFun",paramsTypes:{a:"float",b:"float",amplitude:"float",smoothness:"float"},defaultParams:{a:4,b:1,amplitude:120,smoothness:.1},glsl:`// Author: mandubian
// License: MIT

uniform float a; // = 4
uniform float b; // = 1
uniform float amplitude; // = 120
uniform float smoothness; // = 0.1

vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy;
  vec2 dir = p - vec2(.5);
  float dist = length(dir);
  float x = (a - b) * cos(progress) + b * cos(progress * ((a / b) - 1.) );
  float y = (a - b) * sin(progress) - b * sin(progress * ((a / b) - 1.));
  vec2 offset = dir * vec2(sin(progress  * dist * amplitude * x), sin(progress * dist * amplitude * y)) / smoothness;
  return mix(getFromColor(p + offset), getToColor(p), smoothstep(0.2, 1.0, progress));
}
`,author:"mandubian",license:"MIT",createdAt:"Thu, 1 Jun 2017 13:03:12 +0200",updatedAt:"Thu, 1 Jun 2017 13:03:12 +0200"},{name:"CrossZoom",paramsTypes:{strength:"float"},defaultParams:{strength:.4},glsl:`// License: MIT
// Author: rectalogic
// ported by gre from https://gist.github.com/rectalogic/b86b90161503a0023231

// Converted from https://github.com/rectalogic/rendermix-basic-effects/blob/master/assets/com/rendermix/CrossZoom/CrossZoom.frag
// Which is based on https://github.com/evanw/glfx.js/blob/master/src/filters/blur/zoomblur.js
// With additional easing functions from https://github.com/rectalogic/rendermix-basic-effects/blob/master/assets/com/rendermix/Easing/Easing.glsllib

uniform float strength; // = 0.4

const float PI = 3.141592653589793;

float Linear_ease(in float begin, in float change, in float duration, in float time) {
    return change * time / duration + begin;
}

float Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {
    if (time == 0.0)
        return begin;
    else if (time == duration)
        return begin + change;
    time = time / (duration / 2.0);
    if (time < 1.0)
        return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;
    return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;
}

float Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {
    return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;
}

float rand (vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 crossFade(in vec2 uv, in float dissolve) {
    return mix(getFromColor(uv).rgb, getToColor(uv).rgb, dissolve);
}

vec4 transition(vec2 uv) {
    vec2 texCoord = uv.xy / vec2(1.0).xy;

    // Linear interpolate center across center half of the image
    vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);
    float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);

    // Mirrored sinusoidal loop. 0->strength then strength->0
    float strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);

    vec3 color = vec3(0.0);
    float total = 0.0;
    vec2 toCenter = center - texCoord;

    /* randomize the lookup values to hide the fixed number of samples */
    float offset = rand(uv);

    for (float t = 0.0; t <= 40.0; t++) {
        float percent = (t + offset) / 40.0;
        float weight = 4.0 * (percent - percent * percent);
        color += crossFade(texCoord + toCenter * percent * strength, dissolve) * weight;
        total += weight;
    }
    return vec4(color / total, 1.0);
}
`,license:"MIT",author:"rectalogic",createdAt:"Mon, 12 Jun 2017 12:33:07 +0800",updatedAt:"Mon, 12 Jun 2017 12:33:07 +0800"},{name:"Directional",paramsTypes:{direction:"vec2"},defaultParams:{direction:[0,1]},glsl:`// Author: Gatan Renaudeau
// License: MIT

uniform vec2 direction; // = vec2(0.0, 1.0)

vec4 transition (vec2 uv) {
  vec2 p = uv + progress * sign(direction);
  vec2 f = fract(p);
  return mix(
    getToColor(f),
    getFromColor(f),
    step(0.0, p.y) * step(p.y, 1.0) * step(0.0, p.x) * step(p.x, 1.0)
  );
}
`,author:"Gatan Renaudeau",license:"MIT",createdAt:"Thu, 19 Apr 2018 12:20:29 +0200",updatedAt:"Thu, 19 Apr 2018 12:20:29 +0200"},{name:"DoomScreenTransition",paramsTypes:{bars:"int",amplitude:"float",noise:"float",frequency:"float",dripScale:"float"},defaultParams:{bars:30,amplitude:2,noise:.1,frequency:.5,dripScale:.5},glsl:`// Author: Zeh Fernando
// License: MIT


// Transition parameters --------

// Number of total bars/columns
uniform int bars; // = 30

// Multiplier for speed ratio. 0 = no variation when going down, higher = some elements go much faster
uniform float amplitude; // = 2

// Further variations in speed. 0 = no noise, 1 = super noisy (ignore frequency)
uniform float noise; // = 0.1

// Speed variation horizontally. the bigger the value, the shorter the waves
uniform float frequency; // = 0.5

// How much the bars seem to "run" from the middle of the screen first (sticking to the sides). 0 = no drip, 1 = curved drip
uniform float dripScale; // = 0.5


// The code proper --------

float rand(int num) {
  return fract(mod(float(num) * 67123.313, 12.0) * sin(float(num) * 10.3) * cos(float(num)));
}

float wave(int num) {
  float fn = float(num) * frequency * 0.1 * float(bars);
  return cos(fn * 0.5) * cos(fn * 0.13) * sin((fn+10.0) * 0.3) / 2.0 + 0.5;
}

float drip(int num) {
  return sin(float(num) / float(bars - 1) * 3.141592) * dripScale;
}

float pos(int num) {
  return (noise == 0.0 ? wave(num) : mix(wave(num), rand(num), noise)) + (dripScale == 0.0 ? 0.0 : drip(num));
}

vec4 transition(vec2 uv) {
  int bar = int(uv.x * (float(bars)));
  float scale = 1.0 + pos(bar) * amplitude;
  float phase = progress * scale;
  float posY = uv.y / vec2(1.0).y;
  vec2 p;
  vec4 c;
  if (phase + posY < 1.0) {
    p = vec2(uv.x, uv.y + mix(0.0, vec2(1.0).y, phase)) / vec2(1.0).xy;
    c = getFromColor(p);
  } else {
    p = uv.xy / vec2(1.0).xy;
    c = getToColor(p);
  }

  // Finally, apply the color
  return c;
}
`,author:"Zeh Fernando",license:"MIT",createdAt:"Tue, 30 May 2017 09:39:09 -0700",updatedAt:"Tue, 30 May 2017 09:39:09 -0700"},{name:"Dreamy",paramsTypes:{},defaultParams:{},glsl:`// Author: mikolalysenko
// License: MIT

vec2 offset(float progress, float x, float theta) {
  float phase = progress*progress + progress + theta;
  float shifty = 0.03*progress*cos(10.0*(progress+x));
  return vec2(0, shifty);
}
vec4 transition(vec2 p) {
  return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);
}
`,author:"mikolalysenko",license:"MIT",createdAt:"Mon, 12 Jun 2017 12:27:38 +0800",updatedAt:"Mon, 12 Jun 2017 12:27:38 +0800"},{name:"DreamyZoom",paramsTypes:{rotation:"float",scale:"float"},defaultParams:{rotation:6,scale:1.2},glsl:`// Author: Zeh Fernando
// License: MIT

// Definitions --------
#define DEG2RAD 0.03926990816987241548078304229099 // 1/180*PI


// Transition parameters --------

// In degrees
uniform float rotation; // = 6

// Multiplier
uniform float scale; // = 1.2


// The code proper --------

vec4 transition(vec2 uv) {
  // Massage parameters
  float phase = progress < 0.5 ? progress * 2.0 : (progress - 0.5) * 2.0;
  float angleOffset = progress < 0.5 ? mix(0.0, rotation * DEG2RAD, phase) : mix(-rotation * DEG2RAD, 0.0, phase);
  float newScale = progress < 0.5 ? mix(1.0, scale, phase) : mix(scale, 1.0, phase);
  
  vec2 center = vec2(0, 0);

  // Calculate the source point
  vec2 assumedCenter = vec2(0.5, 0.5);
  vec2 p = (uv.xy - vec2(0.5, 0.5)) / newScale * vec2(ratio, 1.0);

  // This can probably be optimized (with distance())
  float angle = atan(p.y, p.x) + angleOffset;
  float dist = distance(center, p);
  p.x = cos(angle) * dist / ratio + 0.5;
  p.y = sin(angle) * dist + 0.5;
  vec4 c = progress < 0.5 ? getFromColor(p) : getToColor(p);

  // Finally, apply the color
  return c + (progress < 0.5 ? mix(0.0, 1.0, phase) : mix(1.0, 0.0, phase));
}
`,author:"Zeh Fernando",license:"MIT",createdAt:"Tue, 30 May 2017 10:44:06 -0700",updatedAt:"Tue, 30 May 2017 10:44:06 -0700"},{name:"GlitchDisplace",paramsTypes:{},defaultParams:{},glsl:`// Author: Matt DesLauriers
// License: MIT

highp float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt= dot(co.xy ,vec2(a,b));
    highp float sn= mod(dt,3.14);
    return fract(sin(sn) * c);
}
float voronoi( in vec2 x ) {
    vec2 p = floor( x );
    vec2 f = fract( x );
    float res = 8.0;
    for( float j=-1.; j<=1.; j++ )
    for( float i=-1.; i<=1.; i++ ) {
        vec2  b = vec2( i, j );
        vec2  r = b - f + random( p + b );
        float d = dot( r, r );
        res = min( res, d );
    }
    return sqrt( res );
}

vec2 displace(vec4 tex, vec2 texCoord, float dotDepth, float textureDepth, float strength) {
    float b = voronoi(.003 * texCoord + 2.0);
    float g = voronoi(0.2 * texCoord);
    float r = voronoi(texCoord - 1.0);
    vec4 dt = tex * 1.0;
    vec4 dis = dt * dotDepth + 1.0 - tex * textureDepth;

    dis.x = dis.x - 1.0 + textureDepth*dotDepth;
    dis.y = dis.y - 1.0 + textureDepth*dotDepth;
    dis.x *= strength;
    dis.y *= strength;
    vec2 res_uv = texCoord ;
    res_uv.x = res_uv.x + dis.x - 0.0;
    res_uv.y = res_uv.y + dis.y;
    return res_uv;
}

float ease1(float t) {
  return t == 0.0 || t == 1.0
    ? t
    : t < 0.5
      ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
      : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
}
float ease2(float t) {
  return t == 1.0 ? t : 1.0 - pow(2.0, -10.0 * t);
}



vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy;
  vec4 color1 = getFromColor(p);
  vec4 color2 = getToColor(p);
  vec2 disp = displace(color1, p, 0.33, 0.7, 1.0-ease1(progress));
  vec2 disp2 = displace(color2, p, 0.33, 0.5, ease2(progress));
  vec4 dColor1 = getToColor(disp);
  vec4 dColor2 = getFromColor(disp2);
  float val = ease1(progress);
  vec3 gray = vec3(dot(min(dColor2, dColor1).rgb, vec3(0.299, 0.587, 0.114)));
  dColor2 = vec4(gray, 1.0);
  dColor2 *= 2.0;
  color1 = mix(color1, dColor2, smoothstep(0.0, 0.5, progress));
  color2 = mix(color2, dColor1, smoothstep(1.0, 0.5, progress));
  return mix(color1, color2, val);
  //gl_FragColor = mix(gl_FragColor, dColor, smoothstep(0.0, 0.5, progress));
  
   //gl_FragColor = mix(texture2D(from, p), texture2D(to, p), progress);
}
`,author:"Matt DesLauriers",license:"MIT",createdAt:"Tue, 30 May 2017 14:53:04 -0400",updatedAt:"Tue, 30 May 2017 14:53:04 -0400"},{name:"GlitchMemories",paramsTypes:{},defaultParams:{},glsl:`// author: Gunnar Roth
// based on work from natewave
// license: MIT
vec4 transition(vec2 p) {
  vec2 block = floor(p.xy / vec2(16));
  vec2 uv_noise = block / vec2(64);
  uv_noise += floor(vec2(progress) * vec2(1200.0, 3500.0)) / vec2(64);
  vec2 dist = progress > 0.0 ? (fract(uv_noise) - 0.5) * 0.3 *(1.0 -progress) : vec2(0.0);
  vec2 red = p + dist * 0.2;
  vec2 green = p + dist * .3;
  vec2 blue = p + dist * .5;

  return vec4(mix(getFromColor(red), getToColor(red), progress).r,mix(getFromColor(green), getToColor(green), progress).g,mix(getFromColor(blue), getToColor(blue), progress).b,1.0);
}

`,author:"Gunnar Roth",license:"MIT",createdAt:"Wed, 21 Feb 2018 00:52:15 +0100",updatedAt:"Wed, 21 Feb 2018 19:32:02 +0100"},{name:"GridFlip",paramsTypes:{size:"ivec2",pause:"float",dividerWidth:"float",bgcolor:"vec4",randomness:"float"},defaultParams:{size:[4,4],pause:.1,dividerWidth:.05,bgcolor:[0,0,0,1],randomness:.1},glsl:`// License: MIT
// Author: TimDonselaar
// ported by gre from https://gist.github.com/TimDonselaar/9bcd1c4b5934ba60087bdb55c2ea92e5

uniform ivec2 size; // = ivec2(4)
uniform float pause; // = 0.1
uniform float dividerWidth; // = 0.05
uniform vec4 bgcolor; // = vec4(0.0, 0.0, 0.0, 1.0)
uniform float randomness; // = 0.1
 
float rand (vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

float getDelta(vec2 p) {
  vec2 rectanglePos = floor(vec2(size) * p);
  vec2 rectangleSize = vec2(1.0 / vec2(size).x, 1.0 / vec2(size).y);
  float top = rectangleSize.y * (rectanglePos.y + 1.0);
  float bottom = rectangleSize.y * rectanglePos.y;
  float left = rectangleSize.x * rectanglePos.x;
  float right = rectangleSize.x * (rectanglePos.x + 1.0);
  float minX = min(abs(p.x - left), abs(p.x - right));
  float minY = min(abs(p.y - top), abs(p.y - bottom));
  return min(minX, minY);
}

float getDividerSize() {
  vec2 rectangleSize = vec2(1.0 / vec2(size).x, 1.0 / vec2(size).y);
  return min(rectangleSize.x, rectangleSize.y) * dividerWidth;
}

vec4 transition(vec2 p) {
  if(progress < pause) {
    float currentProg = progress / pause;
    float a = 1.0;
    if(getDelta(p) < getDividerSize()) {
      a = 1.0 - currentProg;
    }
    return mix(bgcolor, getFromColor(p), a);
  }
  else if(progress < 1.0 - pause){
    if(getDelta(p) < getDividerSize()) {
      return bgcolor;
    } else {
      float currentProg = (progress - pause) / (1.0 - pause * 2.0);
      vec2 q = p;
      vec2 rectanglePos = floor(vec2(size) * q);
      
      float r = rand(rectanglePos) - randomness;
      float cp = smoothstep(0.0, 1.0 - r, currentProg);
    
      float rectangleSize = 1.0 / vec2(size).x;
      float delta = rectanglePos.x * rectangleSize;
      float offset = rectangleSize / 2.0 + delta;
      
      p.x = (p.x - offset)/abs(cp - 0.5)*0.5 + offset;
      vec4 a = getFromColor(p);
      vec4 b = getToColor(p);
      
      float s = step(abs(vec2(size).x * (q.x - delta) - 0.5), abs(cp - 0.5));
      return mix(bgcolor, mix(b, a, step(cp, 0.5)), s);
    }
  }
  else {
    float currentProg = (progress - 1.0 + pause) / pause;
    float a = 1.0;
    if(getDelta(p) < getDividerSize()) {
      a = currentProg;
    }
    return mix(bgcolor, getToColor(p), a);
  }
}
`,license:"MIT",author:"TimDonselaar",createdAt:"Mon, 12 Jun 2017 11:32:51 +0800",updatedAt:"Mon, 12 Jun 2017 11:32:51 +0800"},{name:"InvertedPageCurl",paramsTypes:{},defaultParams:{},glsl:`// author: Hewlett-Packard
// license: BSD 3 Clause
// Adapted by Sergey Kosarevsky from:
// http://rectalogic.github.io/webvfx/examples_2transition-shader-pagecurl_8html-example.html

/*
Copyright (c) 2010 Hewlett-Packard Development Company, L.P. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

   * Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.
   * Redistributions in binary form must reproduce the above
     copyright notice, this list of conditions and the following disclaimer
     in the documentation and/or other materials provided with the
     distribution.
   * Neither the name of Hewlett-Packard nor the names of its
     contributors may be used to endorse or promote products derived from
     this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
in vec2 texCoord;
*/

const float MIN_AMOUNT = -0.16;
const float MAX_AMOUNT = 1.5;
float amount = progress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;

const float PI = 3.141592653589793;

const float scale = 512.0;
const float sharpness = 3.0;

float cylinderCenter = amount;
// 360 degrees * amount
float cylinderAngle = 2.0 * PI * amount;

const float cylinderRadius = 1.0 / PI / 2.0;

vec3 hitPoint(float hitAngle, float yc, vec3 point, mat3 rrotation)
{
        float hitPoint = hitAngle / (2.0 * PI);
        point.y = hitPoint;
        return rrotation * point;
}

vec4 antiAlias(vec4 color1, vec4 color2, float distanc)
{
        distanc *= scale;
        if (distanc < 0.0) return color2;
        if (distanc > 2.0) return color1;
        float dd = pow(1.0 - distanc / 2.0, sharpness);
        return ((color2 - color1) * dd) + color1;
}

float distanceToEdge(vec3 point)
{
        float dx = abs(point.x > 0.5 ? 1.0 - point.x : point.x);
        float dy = abs(point.y > 0.5 ? 1.0 - point.y : point.y);
        if (point.x < 0.0) dx = -point.x;
        if (point.x > 1.0) dx = point.x - 1.0;
        if (point.y < 0.0) dy = -point.y;
        if (point.y > 1.0) dy = point.y - 1.0;
        if ((point.x < 0.0 || point.x > 1.0) && (point.y < 0.0 || point.y > 1.0)) return sqrt(dx * dx + dy * dy);
        return min(dx, dy);
}

vec4 seeThrough(float yc, vec2 p, mat3 rotation, mat3 rrotation)
{
        float hitAngle = PI - (acos(yc / cylinderRadius) - cylinderAngle);
        vec3 point = hitPoint(hitAngle, yc, rotation * vec3(p, 1.0), rrotation);
        if (yc <= 0.0 && (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0))
        {
            return getToColor(p);
        }

        if (yc > 0.0) return getFromColor(p);

        vec4 color = getFromColor(point.xy);
        vec4 tcolor = vec4(0.0);

        return antiAlias(color, tcolor, distanceToEdge(point));
}

vec4 seeThroughWithShadow(float yc, vec2 p, vec3 point, mat3 rotation, mat3 rrotation)
{
        float shadow = distanceToEdge(point) * 30.0;
        shadow = (1.0 - shadow) / 3.0;

        if (shadow < 0.0) shadow = 0.0; else shadow *= amount;

        vec4 shadowColor = seeThrough(yc, p, rotation, rrotation);
        shadowColor.r -= shadow;
        shadowColor.g -= shadow;
        shadowColor.b -= shadow;

        return shadowColor;
}

vec4 backside(float yc, vec3 point)
{
        vec4 color = getFromColor(point.xy);
        float gray = (color.r + color.b + color.g) / 15.0;
        gray += (8.0 / 10.0) * (pow(1.0 - abs(yc / cylinderRadius), 2.0 / 10.0) / 2.0 + (5.0 / 10.0));
        color.rgb = vec3(gray);
        return color;
}

vec4 behindSurface(vec2 p, float yc, vec3 point, mat3 rrotation)
{
        float shado = (1.0 - ((-cylinderRadius - yc) / amount * 7.0)) / 6.0;
        shado *= 1.0 - abs(point.x - 0.5);

        yc = (-cylinderRadius - cylinderRadius - yc);

        float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;
        point = hitPoint(hitAngle, yc, point, rrotation);

        if (yc < 0.0 && point.x >= 0.0 && point.y >= 0.0 && point.x <= 1.0 && point.y <= 1.0 && (hitAngle < PI || amount > 0.5))
        {
                shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / (71.0 / 100.0));
                shado *= pow(-yc / cylinderRadius, 3.0);
                shado *= 0.5;
        }
        else
        {
                shado = 0.0;
        }
        return vec4(getToColor(p).rgb - shado, 1.0);
}

vec4 transition(vec2 p) {

  const float angle = 100.0 * PI / 180.0;
        float c = cos(-angle);
        float s = sin(-angle);

        mat3 rotation = mat3( c, s, 0,
                                                                -s, c, 0,
                                                                -0.801, 0.8900, 1
                                                                );
        c = cos(angle);
        s = sin(angle);

        mat3 rrotation = mat3(	c, s, 0,
                                                                        -s, c, 0,
                                                                        0.98500, 0.985, 1
                                                                );

        vec3 point = rotation * vec3(p, 1.0);

        float yc = point.y - cylinderCenter;

        if (yc < -cylinderRadius)
        {
                // Behind surface
                return behindSurface(p,yc, point, rrotation);
        }

        if (yc > cylinderRadius)
        {
                // Flat surface
                return getFromColor(p);
        }

        float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;

        float hitAngleMod = mod(hitAngle, 2.0 * PI);
        if ((hitAngleMod > PI && amount < 0.5) || (hitAngleMod > PI/2.0 && amount < 0.0))
        {
                return seeThrough(yc, p, rotation, rrotation);
        }

        point = hitPoint(hitAngle, yc, point, rrotation);

        if (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)
        {
                return seeThroughWithShadow(yc, p, point, rotation, rrotation);
        }

        vec4 color = backside(yc, point);

        vec4 otherColor;
        if (yc < 0.0)
        {
                float shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / 0.71);
                shado *= pow(-yc / cylinderRadius, 3.0);
                shado *= 0.5;
                otherColor = vec4(0.0, 0.0, 0.0, shado);
        }
        else
        {
                otherColor = getFromColor(p);
        }

        color = antiAlias(color, otherColor, cylinderRadius - abs(yc));

        vec4 cl = seeThroughWithShadow(yc, p, point, rotation, rrotation);
        float dist = distanceToEdge(point);

        return antiAlias(color, cl, dist);
}
`,author:"Hewlett-Packard",license:"BSD 3 Clause",createdAt:"Wed, 21 Feb 2018 01:13:49 +0100",updatedAt:"Wed, 21 Feb 2018 16:00:02 +0100"},{name:"LinearBlur",paramsTypes:{intensity:"float"},defaultParams:{intensity:.1},glsl:`// author: gre
// license: MIT
uniform float intensity; // = 0.1
const int passes = 6;

vec4 transition(vec2 uv) {
    vec4 c1 = vec4(0.0);
    vec4 c2 = vec4(0.0);

    float disp = intensity*(0.5-distance(0.5, progress));
    for (int xi=0; xi<passes; xi++)
    {
        float x = float(xi) / float(passes) - 0.5;
        for (int yi=0; yi<passes; yi++)
        {
            float y = float(yi) / float(passes) - 0.5;
            vec2 v = vec2(x,y);
            float d = disp;
            c1 += getFromColor( uv + d*v);
            c2 += getToColor( uv + d*v);
        }
    }
    c1 /= float(passes*passes);
    c2 /= float(passes*passes);
    return mix(c1, c2, progress);
}
`,author:"gre",license:"MIT",createdAt:"Fri, 23 Feb 2018 15:18:22 +0100",updatedAt:"Fri, 23 Feb 2018 15:18:22 +0100"},{name:"Mosaic",paramsTypes:{endx:"int",endy:"int"},defaultParams:{endx:2,endy:-1},glsl:`// License: MIT
// Author: Xaychru
// ported by gre from https://gist.github.com/Xaychru/130bb7b7affedbda9df5

#define PI 3.14159265358979323
#define POW2(X) X*X
#define POW3(X) X*X*X
uniform int endx; // = 2
uniform int endy; // = -1

float Rand(vec2 v) {
  return fract(sin(dot(v.xy ,vec2(12.9898,78.233))) * 43758.5453);
}
vec2 Rotate(vec2 v, float a) {
  mat2 rm = mat2(cos(a), -sin(a),
                 sin(a), cos(a));
  return rm*v;
}
float CosInterpolation(float x) {
  return -cos(x*PI)/2.+.5;
}
vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy - .5;
  vec2 rp = p;
  float rpr = (progress*2.-1.);
  float z = -(rpr*rpr*2.) + 3.;
  float az = abs(z);
  rp *= az;
  rp += mix(vec2(.5, .5), vec2(float(endx) + .5, float(endy) + .5), POW2(CosInterpolation(progress)));
  vec2 mrp = mod(rp, 1.);
  vec2 crp = rp;
  bool onEnd = int(floor(crp.x))==endx&&int(floor(crp.y))==endy;
  if(!onEnd) {
    float ang = float(int(Rand(floor(crp))*4.))*.5*PI;
    mrp = vec2(.5) + Rotate(mrp-vec2(.5), ang);
  }
  if(onEnd || Rand(floor(crp))>.5) {
    return getToColor(mrp);
  } else {
    return getFromColor(mrp);
  }
}
`,license:"MIT",author:"Xaychru",createdAt:"Mon, 12 Jun 2017 10:26:51 +0800",updatedAt:"Mon, 12 Jun 2017 10:26:51 +0800"},{name:"PolkaDotsCurtain",paramsTypes:{dots:"float",center:"vec2"},defaultParams:{dots:20,center:[0,0]},glsl:`// author: bobylito
// license: MIT
const float SQRT_2 = 1.414213562373;
uniform float dots;// = 20.0;
uniform vec2 center;// = vec2(0, 0);

vec4 transition(vec2 uv) {
  bool nextImage = distance(fract(uv * dots), vec2(0.5, 0.5)) < ( progress / distance(uv, center));
  return nextImage ? getToColor(uv) : getFromColor(uv);
}
`,author:"bobylito",license:"MIT",createdAt:"Tue, 20 Feb 2018 23:41:45 +0100",updatedAt:"Tue, 20 Feb 2018 23:41:45 +0100"},{name:"Radial",paramsTypes:{smoothness:"float"},defaultParams:{smoothness:1},glsl:`// License: MIT
// Author: Xaychru
// ported by gre from https://gist.github.com/Xaychru/ce1d48f0ce00bb379750

uniform float smoothness; // = 1.0

const float PI = 3.141592653589;

vec4 transition(vec2 p) {
  vec2 rp = p*2.-1.;
  return mix(
    getToColor(p),
    getFromColor(p),
    smoothstep(0., smoothness, atan(rp.y,rp.x) - (progress-.5) * PI * 2.5)
  );
}
`,license:"MIT",author:"Xaychru",createdAt:"Mon, 12 Jun 2017 10:36:24 +0800",updatedAt:"Mon, 12 Jun 2017 10:36:24 +0800"},{name:"SimpleZoom",paramsTypes:{zoom_quickness:"float"},defaultParams:{zoom_quickness:.8},glsl:`// Author: 0gust1
// License: MIT

uniform float zoom_quickness; // = 0.8
float nQuick = clamp(zoom_quickness,0.2,1.0);

vec2 zoom(vec2 uv, float amount) {
  return 0.5 + ((uv - 0.5) * (1.0-amount));	
}

vec4 transition (vec2 uv) {
  return mix(
    getFromColor(zoom(uv, smoothstep(0.0, nQuick, progress))),
    getToColor(uv),
   smoothstep(nQuick-0.2, 1.0, progress)
  );
}`,author:"0gust1",license:"MIT",createdAt:"Tue, 6 Mar 2018 00:43:47 +0100",updatedAt:"Tue, 6 Mar 2018 00:43:47 +0100"},{name:"StereoViewer",paramsTypes:{zoom:"float",corner_radius:"float"},defaultParams:{zoom:.88,corner_radius:.22},glsl:`// Tunable parameters
// How much to zoom (out) for the effect ~ 0.5 - 1.0
uniform float zoom; // = 0.88
// Corner radius as a fraction of the image height
uniform float corner_radius;  // = 0.22

// author: Ted Schundler
// license: BSD 2 Clause
// Free for use and modification by anyone with credit

// Copyright (c) 2016, Theodore K Schundler
// All rights reserved.

// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

// 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

// 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

///////////////////////////////////////////////////////////////////////////////
// Stereo Viewer Toy Transition                                              //
//                                                                           //
// Inspired by ViewMaster / Image3D image viewer devices.                    //
// This effect is similar to what you see when you press the device's lever. //
// There is a quick zoom in / out to make the transition 'valid' for GLSL.io //
///////////////////////////////////////////////////////////////////////////////

const vec4 black = vec4(0.0, 0.0, 0.0, 1.0);
const vec2 c00 = vec2(0.0, 0.0); // the four corner points
const vec2 c01 = vec2(0.0, 1.0);
const vec2 c11 = vec2(1.0, 1.0);
const vec2 c10 = vec2(1.0, 0.0);

// Check if a point is within a given corner
bool in_corner(vec2 p, vec2 corner, vec2 radius) {
  // determine the direction we want to be filled
  vec2 axis = (c11 - corner) - corner;

  // warp the point so we are always testing the bottom left point with the
  // circle centered on the origin
  p = p - (corner + axis * radius);
  p *= axis / radius;
  return (p.x > 0.0 && p.y > -1.0) || (p.y > 0.0 && p.x > -1.0) || dot(p, p) < 1.0;
}

// Check all four corners
// return a float for v2 for anti-aliasing?
bool test_rounded_mask(vec2 p, vec2 corner_size) {
  return
      in_corner(p, c00, corner_size) &&
      in_corner(p, c01, corner_size) &&
      in_corner(p, c10, corner_size) &&
      in_corner(p, c11, corner_size);
}

// Screen blend mode - https://en.wikipedia.org/wiki/Blend_modes
// This more closely approximates what you see than linear blending
vec4 screen(vec4 a, vec4 b) {
  return 1.0 - (1.0 - a) * (1.0 -b);
}

// Given RGBA, find a value that when screened with itself
// will yield the original value.
vec4 unscreen(vec4 c) {
  return 1.0 - sqrt(1.0 - c);
}

// Grab a pixel, only if it isn't masked out by the rounded corners
vec4 sample_with_corners_from(vec2 p, vec2 corner_size) {
  p = (p - 0.5) / zoom + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return unscreen(getFromColor(p));
}

vec4 sample_with_corners_to(vec2 p, vec2 corner_size) {
  p = (p - 0.5) / zoom + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return unscreen(getToColor(p));
}

// special sampling used when zooming - extra zoom parameter and don't unscreen
vec4 simple_sample_with_corners_from(vec2 p, vec2 corner_size, float zoom_amt) {
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return getFromColor(p);
}

vec4 simple_sample_with_corners_to(vec2 p, vec2 corner_size, float zoom_amt) {
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return getToColor(p);
}

// Basic 2D affine transform matrix helpers
// These really shouldn't be used in a fragment shader - I should work out the
// the math for a translate & rotate function as a pair of dot products instead

mat3 rotate2d(float angle, float ratio) {
  float s = sin(angle);
  float c = cos(angle);
  return mat3(
    c, s ,0.0,
    -s, c, 0.0,
    0.0, 0.0, 1.0);
}

mat3 translate2d(float x, float y) {
  return mat3(
    1.0, 0.0, 0,
    0.0, 1.0, 0,
    -x, -y, 1.0);
}

mat3 scale2d(float x, float y) {
  return mat3(
    x, 0.0, 0,
    0.0, y, 0,
    0, 0, 1.0);
}

// Split an image and rotate one up and one down along off screen pivot points
vec4 get_cross_rotated(vec3 p3, float angle, vec2 corner_size, float ratio) {
  angle = angle * angle; // easing
  angle /= 2.4; // works out to be a good number of radians

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio);
  mat3 unscale_and_uncenter = scale2d(1.0, 1.0/ratio) * translate2d(0.5,0.5);
  mat3 slide_left = translate2d(-2.0,0.0);
  mat3 slide_right = translate2d(2.0,0.0);
  mat3 rotate = rotate2d(angle, ratio);

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter;
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter;

  vec4 a = sample_with_corners_from((op_a * p3).xy, corner_size);
  vec4 b = sample_with_corners_from((op_b * p3).xy, corner_size);

  return screen(a, b);
}

// Image stays put, but this time move two masks
vec4 get_cross_masked(vec3 p3, float angle, vec2 corner_size, float ratio) {
  angle = 1.0 - angle;
  angle = angle * angle; // easing
  angle /= 2.4;

  vec4 img;

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio);
  mat3 unscale_and_uncenter = scale2d(1.0 / zoom, 1.0 / (zoom * ratio)) * translate2d(0.5,0.5);
  mat3 slide_left = translate2d(-2.0,0.0);
  mat3 slide_right = translate2d(2.0,0.0);
  mat3 rotate = rotate2d(angle, ratio);

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter;
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter;

  bool mask_a = test_rounded_mask((op_a * p3).xy, corner_size);
  bool mask_b = test_rounded_mask((op_b * p3).xy, corner_size);

  if (mask_a || mask_b) {
    img = sample_with_corners_to(p3.xy, corner_size);
    return screen(mask_a ? img : black, mask_b ? img : black);
  } else {
    return black;
  }
}

vec4 transition(vec2 uv) {
  float a;
  vec2 p=uv.xy/vec2(1.0).xy;
  vec3 p3 = vec3(p.xy, 1.0); // for 2D matrix transforms

  // corner is warped to represent to size after mapping to 1.0, 1.0
  vec2 corner_size = vec2(corner_radius / ratio, corner_radius);

  if (progress <= 0.0) {
    // 0.0: start with the base frame always
    return getFromColor(p);
  } else if (progress < 0.1) {
    // 0.0-0.1: zoom out and add rounded corners
    a = progress / 0.1;
    return  simple_sample_with_corners_from(p, corner_size * a, a);
  } else if (progress < 0.48) {
    // 0.1-0.48: Split original image apart
    a = (progress - 0.1)/0.38;
    return get_cross_rotated(p3, a, corner_size, ratio);
  } else if (progress < 0.9) {
    // 0.48-0.52: black
    // 0.52 - 0.9: unmask new image
    return get_cross_masked(p3, (progress - 0.52)/0.38, corner_size, ratio);
  } else if (progress < 1.0) {
    // zoom out and add rounded corners
    a = (1.0 - progress) / 0.1;
    return simple_sample_with_corners_to(p, corner_size * a, a);
  } else {
    // 1.0 end with base frame
    return getToColor(p);
  }
}
`,author:"Ted Schundler",license:"BSD 2 Clause",createdAt:"Tue, 20 Feb 2018 23:20:29 +0100",updatedAt:"Wed, 21 Feb 2018 15:42:00 +0100"},{name:"Swirl",paramsTypes:{},defaultParams:{},glsl:`// License: MIT
// Author: Sergey Kosarevsky
// ( http://www.linderdaum.com )
// ported by gre from https://gist.github.com/corporateshark/cacfedb8cca0f5ce3f7c

vec4 transition(vec2 UV)
{
	float Radius = 1.0;

	float T = progress;

	UV -= vec2( 0.5, 0.5 );

	float Dist = length(UV);

	if ( Dist < Radius )
	{
		float Percent = (Radius - Dist) / Radius;
		float A = ( T <= 0.5 ) ? mix( 0.0, 1.0, T/0.5 ) : mix( 1.0, 0.0, (T-0.5)/0.5 );
		float Theta = Percent * Percent * A * 8.0 * 3.14159;
		float S = sin( Theta );
		float C = cos( Theta );
		UV = vec2( dot(UV, vec2(C, -S)), dot(UV, vec2(S, C)) );
	}
	UV += vec2( 0.5, 0.5 );

	vec4 C0 = getFromColor(UV);
	vec4 C1 = getToColor(UV);

	return mix( C0, C1, T );
}
`,license:"MIT",author:"Sergey Kosarevsky",createdAt:"Mon, 12 Jun 2017 12:38:27 +0800",updatedAt:"Mon, 12 Jun 2017 12:38:27 +0800"},{name:"WaterDrop",paramsTypes:{amplitude:"float",speed:"float"},defaultParams:{amplitude:30,speed:30},glsl:`// author: Pawe Pciennik
// license: MIT
uniform float amplitude; // = 30
uniform float speed; // = 30

vec4 transition(vec2 p) {
  vec2 dir = p - vec2(.5);
  float dist = length(dir);

  if (dist > progress) {
    return mix(getFromColor( p), getToColor( p), progress);
  } else {
    vec2 offset = dir * sin(dist * amplitude - progress * speed);
    return mix(getFromColor( p + offset), getToColor( p), progress);
  }
}
`,author:"Pawe Pciennik",license:"MIT",createdAt:"Wed, 21 Feb 2018 19:37:15 +0100",updatedAt:"Wed, 21 Feb 2018 19:37:15 +0100"},{name:"ZoomInCircles",paramsTypes:{},defaultParams:{},glsl:`// License: MIT
// Author: dycm8009
// ported by gre from https://gist.github.com/dycm8009/948e99b1800e81ad909a

vec2 zoom(vec2 uv, float amount) {
  return 0.5 + ((uv - 0.5) * amount);	
}

vec2 ratio2 = vec2(1.0, 1.0 / ratio);

vec4 transition(vec2 uv) {
  // TODO: some timing are hardcoded but should be one or many parameters
  // TODO: should also be able to configure how much circles
  // TODO: if() branching should be avoided when possible, prefer use of step() & other functions
  vec2 r = 2.0 * ((vec2(uv.xy) - 0.5) * ratio2);
  float pro = progress / 0.8;
  float z = pro * 0.2;
  float t = 0.0;
  if (pro > 1.0) {
    z = 0.2 + (pro - 1.0) * 5.;
    t = clamp((progress - 0.8) / 0.07, 0.0, 1.0);
  }
  if (length(r) < 0.5+z) {
    // uv = zoom(uv, 0.9 - 0.1 * pro);
  }
  else if (length(r) < 0.8+z*1.5) {
    uv = zoom(uv, 1.0 - 0.15 * pro);
    t = t * 0.5;
  }
  else if (length(r) < 1.2+z*2.5) {
    uv = zoom(uv, 1.0 - 0.2 * pro);
    t = t * 0.2;
  }
  else {
    uv = zoom(uv, 1.0 - 0.25 * pro);
  }
  return mix(getFromColor(uv), getToColor(uv), t);
}
`,license:"MIT",author:"dycm8009",createdAt:"Mon, 12 Jun 2017 11:24:34 +0800",updatedAt:"Mon, 12 Jun 2017 11:24:34 +0800"},{name:"angular",paramsTypes:{startingAngle:"float"},defaultParams:{startingAngle:90},glsl:`// Author: Fernando Kuteken
// License: MIT

#define PI 3.141592653589

uniform float startingAngle; // = 90;

vec4 transition (vec2 uv) {
  
  float offset = startingAngle * PI / 180.0;
  float angle = atan(uv.y - 0.5, uv.x - 0.5) + offset;
  float normalizedAngle = (angle + PI) / (2.0 * PI);
  
  normalizedAngle = normalizedAngle - floor(normalizedAngle);

  return mix(
    getFromColor(uv),
    getToColor(uv),
    step(normalizedAngle, progress)
    );
}
`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"burn",paramsTypes:{color:"vec3"},defaultParams:{color:[.9,.4,.2]},glsl:`// author: gre
// License: MIT
uniform vec3 color /* = vec3(0.9, 0.4, 0.2) */;
vec4 transition (vec2 uv) {
  return mix(
    getFromColor(uv) + vec4(progress*color, 1.0),
    getToColor(uv) + vec4((1.0-progress)*color, 1.0),
    progress
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"cannabisleaf",paramsTypes:{},defaultParams:{},glsl:`// Author: @Flexi23
// License: MIT

// inspired by http://www.wolframalpha.com/input/?i=cannabis+curve

vec4 transition (vec2 uv) {
  if(progress == 0.0){
    return getFromColor(uv);
  }
  vec2 leaf_uv = (uv - vec2(0.5))/10./pow(progress,3.5);
	leaf_uv.y += 0.35;
	float r = 0.18;
	float o = atan(leaf_uv.y, leaf_uv.x);
  return mix(getFromColor(uv), getToColor(uv), 1.-step(1. - length(leaf_uv)+r*(1.+sin(o))*(1.+0.9 * cos(8.*o))*(1.+0.1*cos(24.*o))*(0.9+0.05*cos(200.*o)), 1.));
}
`,author:"@Flexi23",license:"MIT",createdAt:"Thu, 1 Jun 2017 15:58:58 +0200",updatedAt:"Thu, 1 Jun 2017 15:58:58 +0200"},{name:"circle",paramsTypes:{center:"vec2",backColor:"vec3"},defaultParams:{center:[.5,.5],backColor:[.1,.1,.1]},glsl:`// Author: Fernando Kuteken
// License: MIT

uniform vec2 center; // = vec2(0.5, 0.5);
uniform vec3 backColor; // = vec3(0.1, 0.1, 0.1);

vec4 transition (vec2 uv) {
  
  float distance = length(uv - center);
  float radius = sqrt(8.0) * abs(progress - 0.5);
  
  if (distance > radius) {
    return vec4(backColor, 1.0);
  }
  else {
    if (progress < 0.5) return getFromColor(uv);
    else return getToColor(uv);
  }
}
`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"circleopen",paramsTypes:{smoothness:"float",opening:"bool"},defaultParams:{smoothness:.3,opening:!0},glsl:`// author: gre
// License: MIT
uniform float smoothness; // = 0.3
uniform bool opening; // = true

const vec2 center = vec2(0.5, 0.5);
const float SQRT_2 = 1.414213562373;

vec4 transition (vec2 uv) {
  float x = opening ? progress : 1.-progress;
  float m = smoothstep(-smoothness, 0.0, SQRT_2*distance(center, uv) - x*(1.+smoothness));
  return mix(getFromColor(uv), getToColor(uv), opening ? 1.-m : m);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"colorphase",paramsTypes:{fromStep:"vec4",toStep:"vec4"},defaultParams:{fromStep:[0,.2,.4,0],toStep:[.6,.8,1,1]},glsl:`// Author: gre
// License: MIT

// Usage: fromStep and toStep must be in [0.0, 1.0] range 
// and all(fromStep) must be < all(toStep)

uniform vec4 fromStep; // = vec4(0.0, 0.2, 0.4, 0.0)
uniform vec4 toStep; // = vec4(0.6, 0.8, 1.0, 1.0)

vec4 transition (vec2 uv) {
  vec4 a = getFromColor(uv);
  vec4 b = getToColor(uv);
  return mix(a, b, smoothstep(fromStep, toStep, vec4(progress)));
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"crosshatch",paramsTypes:{center:"vec2",threshold:"float",fadeEdge:"float"},defaultParams:{center:[.5,.5],threshold:3,fadeEdge:.1},glsl:`// License: MIT
// Author: pthrasher
// adapted by gre from https://gist.github.com/pthrasher/04fd9a7de4012cbb03f6

uniform vec2 center; // = vec2(0.5)
uniform float threshold; // = 3.0
uniform float fadeEdge; // = 0.1

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}
vec4 transition(vec2 p) {
  float dist = distance(center, p) / threshold;
  float r = progress - min(rand(vec2(p.y, 0.0)), rand(vec2(0.0, p.x)));
  return mix(getFromColor(p), getToColor(p), mix(0.0, mix(step(dist, r), 1.0, smoothstep(1.0-fadeEdge, 1.0, progress)), smoothstep(0.0, fadeEdge, progress)));    
}
`,license:"MIT",author:"pthrasher",createdAt:"Mon, 12 Jun 2017 10:02:12 +0800",updatedAt:"Mon, 12 Jun 2017 10:02:12 +0800"},{name:"crosswarp",paramsTypes:{},defaultParams:{},glsl:`// Author: Eke Pter <peterekepeter@gmail.com>
// License: MIT
vec4 transition(vec2 p) {
  float x = progress;
  x=smoothstep(.0,1.0,(x*2.0+p.x-1.0));
  return mix(getFromColor((p-.5)*(1.-x)+.5), getToColor((p-.5)*x+.5), x);
}
`,author:"Eke Pter <peterekepeter@gmail.com>",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"cube",paramsTypes:{persp:"float",unzoom:"float",reflection:"float",floating:"float"},defaultParams:{persp:.7,unzoom:.3,reflection:.4,floating:3},glsl:`// Author: gre
// License: MIT
uniform float persp; // = 0.7
uniform float unzoom; // = 0.3
uniform float reflection; // = 0.4
uniform float floating; // = 3.0

vec2 project (vec2 p) {
  return p * vec2(1.0, -1.2) + vec2(0.0, -floating/100.);
}

bool inBounds (vec2 p) {
  return all(lessThan(vec2(0.0), p)) && all(lessThan(p, vec2(1.0)));
}

vec4 bgColor (vec2 p, vec2 pfr, vec2 pto) {
  vec4 c = vec4(0.0, 0.0, 0.0, 1.0);
  pfr = project(pfr);
  // FIXME avoid branching might help perf!
  if (inBounds(pfr)) {
    c += mix(vec4(0.0), getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));
  }
  pto = project(pto);
  if (inBounds(pto)) {
    c += mix(vec4(0.0), getToColor(pto), reflection * mix(1.0, 0.0, pto.y));
  }
  return c;
}

// p : the position
// persp : the perspective in [ 0, 1 ]
// center : the xcenter in [0, 1] \\ 0.5 excluded
vec2 xskew (vec2 p, float persp, float center) {
  float x = mix(p.x, 1.0-p.x, center);
  return (
    (
      vec2( x, (p.y - 0.5*(1.0-persp) * x) / (1.0+(persp-1.0)*x) )
      - vec2(0.5-distance(center, 0.5), 0.0)
    )
    * vec2(0.5 / distance(center, 0.5) * (center<0.5 ? 1.0 : -1.0), 1.0)
    + vec2(center<0.5 ? 0.0 : 1.0, 0.0)
  );
}

vec4 transition(vec2 op) {
  float uz = unzoom * 2.0*(0.5-distance(0.5, progress));
  vec2 p = -uz*0.5+(1.0+uz) * op;
  vec2 fromP = xskew(
    (p - vec2(progress, 0.0)) / vec2(1.0-progress, 1.0),
    1.0-mix(progress, 0.0, persp),
    0.0
  );
  vec2 toP = xskew(
    p / vec2(progress, 1.0),
    mix(pow(progress, 2.0), 1.0, persp),
    1.0
  );
  // FIXME avoid branching might help perf!
  if (inBounds(fromP)) {
    return getFromColor(fromP);
  }
  else if (inBounds(toP)) {
    return getToColor(toP);
  }
  return bgColor(op, fromP, toP);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"directionalwarp",paramsTypes:{direction:"vec2"},defaultParams:{direction:[-1,1]},glsl:`// Author: pschroen
// License: MIT

uniform vec2 direction; // = vec2(-1.0, 1.0)

const float smoothness = 0.5;
const vec2 center = vec2(0.5, 0.5);

vec4 transition (vec2 uv) {
  vec2 v = normalize(direction);
  v /= abs(v.x) + abs(v.y);
  float d = v.x * center.x + v.y * center.y;
  float m = 1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d - 0.5 + progress * (1.0 + smoothness)));
  return mix(getFromColor((uv - 0.5) * (1.0 - m) + 0.5), getToColor((uv - 0.5) * m + 0.5), m);
}
`,author:"pschroen",license:"MIT",createdAt:"Wed, 13 Dec 2017 12:08:49 -0500",updatedAt:"Wed, 13 Dec 2017 12:08:49 -0500"},{name:"directionalwipe",paramsTypes:{direction:"vec2",smoothness:"float"},defaultParams:{direction:[1,-1],smoothness:.5},glsl:`// Author: gre
// License: MIT

uniform vec2 direction; // = vec2(1.0, -1.0)
uniform float smoothness; // = 0.5
 
const vec2 center = vec2(0.5, 0.5);
 
vec4 transition (vec2 uv) {
  vec2 v = normalize(direction);
  v /= abs(v.x)+abs(v.y);
  float d = v.x * center.x + v.y * center.y;
  float m =
    (1.0-step(progress, 0.0)) * // there is something wrong with our formula that makes m not equals 0.0 with progress is 0.0
    (1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d-0.5+progress*(1.+smoothness))));
  return mix(getFromColor(uv), getToColor(uv), m);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"displacement",paramsTypes:{displacementMap:"sampler2D",strength:"float"},defaultParams:{displacementMap:null,strength:.5},glsl:`// Author: Travis Fischer
// License: MIT
//
// Adapted from a Codrops article by Robin Delaporte
// https://tympanus.net/Development/DistortionHoverEffect

uniform sampler2D displacementMap;

uniform float strength; // = 0.5

vec4 transition (vec2 uv) {
  float displacement = texture2D(displacementMap, uv).r * strength;

  vec2 uvFrom = vec2(uv.x + progress * displacement, uv.y);
  vec2 uvTo = vec2(uv.x - (1.0 - progress) * displacement, uv.y);

  return mix(
    getFromColor(uvFrom),
    getToColor(uvTo),
    progress
  );
}
`,author:"Travis Fischer",license:"MIT",createdAt:"Tue, 10 Apr 2018 23:03:38 -0400",updatedAt:"Tue, 10 Apr 2018 23:03:38 -0400"},{name:"doorway",paramsTypes:{reflection:"float",perspective:"float",depth:"float"},defaultParams:{reflection:.4,perspective:.4,depth:3},glsl:`// author: gre
// License: MIT 
uniform float reflection; // = 0.4
uniform float perspective; // = 0.4
uniform float depth; // = 3

const vec4 black = vec4(0.0, 0.0, 0.0, 1.0);
const vec2 boundMin = vec2(0.0, 0.0);
const vec2 boundMax = vec2(1.0, 1.0);

bool inBounds (vec2 p) {
  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));
}

vec2 project (vec2 p) {
  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);
}

vec4 bgColor (vec2 p, vec2 pto) {
  vec4 c = black;
  pto = project(pto);
  if (inBounds(pto)) {
    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));
  }
  return c;
}


vec4 transition (vec2 p) {
  vec2 pfr = vec2(-1.), pto = vec2(-1.);
  float middleSlit = 2.0 * abs(p.x-0.5) - progress;
  if (middleSlit > 0.0) {
    pfr = p + (p.x > 0.5 ? -1.0 : 1.0) * vec2(0.5*progress, 0.0);
    float d = 1.0/(1.0+perspective*progress*(1.0-middleSlit));
    pfr.y -= d/2.;
    pfr.y *= d;
    pfr.y += d/2.;
  }
  float size = mix(1.0, depth, 1.-progress);
  pto = (p + vec2(-0.5, -0.5)) * vec2(size, size) + vec2(0.5, 0.5);
  if (inBounds(pfr)) {
    return getFromColor(pfr);
  }
  else if (inBounds(pto)) {
    return getToColor(pto);
  }
  else {
    return bgColor(p, pto);
  }
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fade",paramsTypes:{},defaultParams:{},glsl:`// author: gre
// license: MIT

vec4 transition (vec2 uv) {
  return mix(
    getFromColor(uv),
    getToColor(uv),
    progress
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fadecolor",paramsTypes:{color:"vec3",colorPhase:"float"},defaultParams:{color:[0,0,0],colorPhase:.4},glsl:`// author: gre
// License: MIT
uniform vec3 color;// = vec3(0.0)
uniform float colorPhase/* = 0.4 */; // if 0.0, there is no black phase, if 0.9, the black phase is very important
vec4 transition (vec2 uv) {
  return mix(
    mix(vec4(color, 1.0), getFromColor(uv), smoothstep(1.0-colorPhase, 0.0, progress)),
    mix(vec4(color, 1.0), getToColor(uv), smoothstep(    colorPhase, 1.0, progress)),
    progress);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fadegrayscale",paramsTypes:{intensity:"float"},defaultParams:{intensity:.3},glsl:`// Author: gre
// License: MIT

uniform float intensity; // = 0.3; // if 0.0, the image directly turn grayscale, if 0.9, the grayscale transition phase is very important
 
vec3 grayscale (vec3 color) {
  return vec3(0.2126*color.r + 0.7152*color.g + 0.0722*color.b);
}
 
vec4 transition (vec2 uv) {
  vec4 fc = getFromColor(uv);
  vec4 tc = getToColor(uv);
  return mix(
    mix(vec4(grayscale(fc.rgb), 1.0), fc, smoothstep(1.0-intensity, 0.0, progress)),
    mix(vec4(grayscale(tc.rgb), 1.0), tc, smoothstep(    intensity, 1.0, progress)),
    progress);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"flyeye",paramsTypes:{size:"float",zoom:"float",colorSeparation:"float"},defaultParams:{size:.04,zoom:50,colorSeparation:.3},glsl:`// Author: gre
// License: MIT
uniform float size; // = 0.04
uniform float zoom; // = 50.0
uniform float colorSeparation; // = 0.3

vec4 transition(vec2 p) {
  float inv = 1. - progress;
  vec2 disp = size*vec2(cos(zoom*p.x), sin(zoom*p.y));
  vec4 texTo = getToColor(p + inv*disp);
  vec4 texFrom = vec4(
    getFromColor(p + progress*disp*(1.0 - colorSeparation)).r,
    getFromColor(p + progress*disp).g,
    getFromColor(p + progress*disp*(1.0 + colorSeparation)).b,
    1.0);
  return texTo*progress + texFrom*inv;
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"heart",paramsTypes:{},defaultParams:{},glsl:`// Author: gre
// License: MIT

float inHeart (vec2 p, vec2 center, float size) {
  if (size==0.0) return 0.0;
  vec2 o = (p-center)/(1.6*size);
  float a = o.x*o.x+o.y*o.y-0.3;
  return step(a*a*a, o.x*o.x*o.y*o.y*o.y);
}
vec4 transition (vec2 uv) {
  return mix(
    getFromColor(uv),
    getToColor(uv),
    inHeart(uv, vec2(0.5, 0.4), progress)
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"hexagonalize",paramsTypes:{steps:"int",horizontalHexagons:"float"},defaultParams:{steps:50,horizontalHexagons:20},glsl:`// Author: Fernando Kuteken
// License: MIT
// Hexagonal math from: http://www.redblobgames.com/grids/hexagons/

uniform int steps; // = 50;
uniform float horizontalHexagons; //= 20;

struct Hexagon {
  float q;
  float r;
  float s;
};

Hexagon createHexagon(float q, float r){
  Hexagon hex;
  hex.q = q;
  hex.r = r;
  hex.s = -q - r;
  return hex;
}

Hexagon roundHexagon(Hexagon hex){
  
  float q = floor(hex.q + 0.5);
  float r = floor(hex.r + 0.5);
  float s = floor(hex.s + 0.5);

  float deltaQ = abs(q - hex.q);
  float deltaR = abs(r - hex.r);
  float deltaS = abs(s - hex.s);

  if (deltaQ > deltaR && deltaQ > deltaS)
    q = -r - s;
  else if (deltaR > deltaS)
    r = -q - s;
  else
    s = -q - r;

  return createHexagon(q, r);
}

Hexagon hexagonFromPoint(vec2 point, float size) {
  
  point.y /= ratio;
  point = (point - 0.5) / size;
  
  float q = (sqrt(3.0) / 3.0) * point.x + (-1.0 / 3.0) * point.y;
  float r = 0.0 * point.x + 2.0 / 3.0 * point.y;

  Hexagon hex = createHexagon(q, r);
  return roundHexagon(hex);
  
}

vec2 pointFromHexagon(Hexagon hex, float size) {
  
  float x = (sqrt(3.0) * hex.q + (sqrt(3.0) / 2.0) * hex.r) * size + 0.5;
  float y = (0.0 * hex.q + (3.0 / 2.0) * hex.r) * size + 0.5;
  
  return vec2(x, y * ratio);
}

vec4 transition (vec2 uv) {
  
  float dist = 2.0 * min(progress, 1.0 - progress);
  dist = steps > 0 ? ceil(dist * float(steps)) / float(steps) : dist;
  
  float size = (sqrt(3.0) / 3.0) * dist / horizontalHexagons;
  
  vec2 point = dist > 0.0 ? pointFromHexagon(hexagonFromPoint(uv, size), size) : uv;

  return mix(getFromColor(point), getToColor(point), progress);
  
}
`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 21:55:47 -0300",updatedAt:"Tue, 30 May 2017 21:55:47 -0300"},{name:"kaleidoscope",paramsTypes:{speed:"float",angle:"float",power:"float"},defaultParams:{speed:1,angle:1,power:1.5},glsl:`// Author: nwoeanhinnogaehr
// License: MIT

uniform float speed; // = 1.0;
uniform float angle; // = 1.0;
uniform float power; // = 1.5;

vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy;
  vec2 q = p;
  float t = pow(progress, power)*speed;
  p = p -0.5;
  for (int i = 0; i < 7; i++) {
    p = vec2(sin(t)*p.x + cos(t)*p.y, sin(t)*p.y - cos(t)*p.x);
    t += angle;
    p = abs(mod(p, 2.0) - 1.0);
  }
  abs(mod(p, 1.0));
  return mix(
    mix(getFromColor(q), getToColor(q), progress),
    mix(getFromColor(p), getToColor(p), progress), 1.0 - 2.0*abs(progress - 0.5));
}
`,author:"nwoeanhinnogaehr",license:"MIT",createdAt:"Wed, 31 May 2017 21:48:26 -0400",updatedAt:"Wed, 31 May 2017 21:48:26 -0400"},{name:"luma",paramsTypes:{luma:"sampler2D"},defaultParams:{luma:null},glsl:`// Author: gre
// License: MIT

uniform sampler2D luma;

vec4 transition(vec2 uv) {
  return mix(
    getToColor(uv),
    getFromColor(uv),
    step(progress, texture2D(luma, uv).r)
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"luminance_melt",paramsTypes:{direction:"bool",l_threshold:"float",above:"bool"},defaultParams:{direction:!0,l_threshold:.8,above:!1},glsl:`// Author: 0gust1
// License: MIT
//My own first transition  based on crosshatch code (from pthrasher), using  simplex noise formula (copied and pasted)
//-> cooler with high contrasted images (isolated dark subject on light background f.e.)
//TODO : try to rebase it on DoomTransition (from zeh)?
//optimizations :
//luminance (see http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color#answer-596241)
// Y = (R+R+B+G+G+G)/6
//or Y = (R+R+R+B+G+G+G+G)>>3 


//direction of movement :  0 : up, 1, down
uniform bool direction; // = 1 
//luminance threshold
uniform float l_threshold; // = 0.8 
//does the movement takes effect above or below luminance threshold ?
uniform bool above; // = false 


//Random function borrowed from everywhere
float rand(vec2 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}


// Simplex noise :
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : MIT  
//               2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
// 

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
		+ i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

// Simplex noise -- end

float luminance(vec4 color){
  //(0.299*R + 0.587*G + 0.114*B)
  return color.r*0.299+color.g*0.587+color.b*0.114;
}

vec2 center = vec2(1.0, direction);

vec4 transition(vec2 uv) {
  vec2 p = uv.xy / vec2(1.0).xy;
  if (progress == 0.0) {
    return getFromColor(p);
  } else if (progress == 1.0) {
    return getToColor(p);
  } else {
    float x = progress;
    float dist = distance(center, p)- progress*exp(snoise(vec2(p.x, 0.0)));
    float r = x - rand(vec2(p.x, 0.1));
    float m;
    if(above){
     m = dist <= r && luminance(getFromColor(p))>l_threshold ? 1.0 : (progress*progress*progress);
    }
    else{
     m = dist <= r && luminance(getFromColor(p))<l_threshold ? 1.0 : (progress*progress*progress);  
    }
    return mix(getFromColor(p), getToColor(p), m);    
  }
}
`,author:"0gust1",license:"MIT",createdAt:"Wed, 24 Jan 2018 19:02:32 +0100",updatedAt:"Wed, 24 Jan 2018 19:02:32 +0100"},{name:"morph",paramsTypes:{strength:"float"},defaultParams:{strength:.1},glsl:`// Author: paniq
// License: MIT
uniform float strength; // = 0.1

vec4 transition(vec2 p) {
  vec4 ca = getFromColor(p);
  vec4 cb = getToColor(p);
  
  vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);
  vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);
  vec2 oc = mix(oa,ob,0.5)*strength;
  
  float w0 = progress;
  float w1 = 1.0-w0;
  return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);
}
`,author:"paniq",license:"MIT",createdAt:"Thu, 10 Aug 2017 00:27:36 +0200",updatedAt:"Thu, 10 Aug 2017 00:32:01 +0200"},{name:"multiply_blend",paramsTypes:{},defaultParams:{},glsl:`// Author: Fernando Kuteken
// License: MIT

vec4 blend(vec4 a, vec4 b) {
  return a * b;
}

vec4 transition (vec2 uv) {
  
  vec4 blended = blend(getFromColor(uv), getToColor(uv));
  
  if (progress < 0.5)
    return mix(getFromColor(uv), blended, 2.0 * progress);
  else
    return mix(blended, getToColor(uv), 2.0 * progress - 1.0);
}

`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"perlin",paramsTypes:{scale:"float",smoothness:"float",seed:"float"},defaultParams:{scale:4,smoothness:.01,seed:12.9898},glsl:`// Author: Rich Harris
// License: MIT

#ifdef GL_ES
precision mediump float;
#endif

uniform float scale; // = 4.0
uniform float smoothness; // = 0.01

uniform float seed; // = 12.9898

// http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
float random(vec2 co)
{
    highp float a = seed;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt= dot(co.xy ,vec2(a,b));
    highp float sn= mod(dt,3.14);
    return fract(sin(sn) * c);
}

// 2D Noise based on Morgan McGuire @morgan3d
// https://www.shadertoy.com/view/4dS3Wd
float noise (in vec2 st) {
    vec2 i = floor(st);
    vec2 f = fract(st);

    // Four corners in 2D of a tile
    float a = random(i);
    float b = random(i + vec2(1.0, 0.0));
    float c = random(i + vec2(0.0, 1.0));
    float d = random(i + vec2(1.0, 1.0));

    // Smooth Interpolation

    // Cubic Hermine Curve.  Same as SmoothStep()
    vec2 u = f*f*(3.0-2.0*f);
    // u = smoothstep(0.,1.,f);

    // Mix 4 coorners porcentages
    return mix(a, b, u.x) +
            (c - a)* u.y * (1.0 - u.x) +
            (d - b) * u.x * u.y;
}

vec4 transition (vec2 uv) {
  vec4 from = getFromColor(uv);
  vec4 to = getToColor(uv);
  float n = noise(uv * scale);
  
  float p = mix(-smoothness, 1.0 + smoothness, progress);
  float lower = p - smoothness;
  float higher = p + smoothness;
  
  float q = smoothstep(lower, higher, n);
  
  return mix(
    from,
    to,
    1.0 - q
  );
}
`,author:"Rich Harris",license:"MIT",createdAt:"Tue, 23 Jan 2018 21:35:10 -0500",updatedAt:"Wed, 24 Jan 2018 07:35:04 -0500"},{name:"pinwheel",paramsTypes:{speed:"float"},defaultParams:{speed:2},glsl:`// Author: Mr Speaker
// License: MIT

uniform float speed; // = 2.0;

vec4 transition(vec2 uv) {
  
  vec2 p = uv.xy / vec2(1.0).xy;
  
  float circPos = atan(p.y - 0.5, p.x - 0.5) + progress * speed;
  float modPos = mod(circPos, 3.1415 / 4.);
  float signed = sign(progress - modPos);
  
  return mix(getToColor(p), getFromColor(p), step(signed, 0.5));
  
}
`,author:"Mr Speaker",license:"MIT",createdAt:"Tue, 30 May 2017 09:04:31 -0400",updatedAt:"Tue, 30 May 2017 09:04:31 -0400"},{name:"pixelize",paramsTypes:{squaresMin:"ivec2",steps:"int"},defaultParams:{squaresMin:[20,20],steps:50},glsl:`// Author: gre
// License: MIT
// forked from https://gist.github.com/benraziel/c528607361d90a072e98

uniform ivec2 squaresMin/* = ivec2(20) */; // minimum number of squares (when the effect is at its higher level)
uniform int steps /* = 50 */; // zero disable the stepping

float d = min(progress, 1.0 - progress);
float dist = steps>0 ? ceil(d * float(steps)) / float(steps) : d;
vec2 squareSize = 2.0 * dist / vec2(squaresMin);

vec4 transition(vec2 uv) {
  vec2 p = dist>0.0 ? (floor(uv / squareSize) + 0.5) * squareSize : uv;
  return mix(getFromColor(p), getToColor(p), progress);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Wed, 31 May 2017 10:58:26 +0200"},{name:"polar_function",paramsTypes:{segments:"int"},defaultParams:{segments:5},glsl:`// Author: Fernando Kuteken
// License: MIT

#define PI 3.14159265359

uniform int segments; // = 5;

vec4 transition (vec2 uv) {
  
  float angle = atan(uv.y - 0.5, uv.x - 0.5) - 0.5 * PI;
  float normalized = (angle + 1.5 * PI) * (2.0 * PI);
  
  float radius = (cos(float(segments) * angle) + 4.0) / 4.0;
  float difference = length(uv - vec2(0.5, 0.5));
  
  if (difference > radius * progress)
    return getFromColor(uv);
  else
    return getToColor(uv);
}
`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"randomsquares",paramsTypes:{size:"ivec2",smoothness:"float"},defaultParams:{size:[10,10],smoothness:.5},glsl:`// Author: gre
// License: MIT

uniform ivec2 size; // = ivec2(10, 10)
uniform float smoothness; // = 0.5
 
float rand (vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec4 transition(vec2 p) {
  float r = rand(floor(vec2(size) * p));
  float m = smoothstep(0.0, -smoothness, r - (progress * (1.0 + smoothness)));
  return mix(getFromColor(p), getToColor(p), m);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"ripple",paramsTypes:{amplitude:"float",speed:"float"},defaultParams:{amplitude:100,speed:50},glsl:`// Author: gre
// License: MIT
uniform float amplitude; // = 100.0
uniform float speed; // = 50.0

vec4 transition (vec2 uv) {
  vec2 dir = uv - vec2(.5);
  float dist = length(dir);
  vec2 offset = dir * (sin(progress * dist * amplitude - progress * speed) + .5) / 30.;
  return mix(
    getFromColor(uv + offset),
    getToColor(uv),
    smoothstep(0.2, 1.0, progress)
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 15:15:27 +0200",updatedAt:"Tue, 30 May 2017 15:15:27 +0200"},{name:"rotate_scale_fade",paramsTypes:{center:"vec2",rotations:"float",scale:"float",backColor:"vec4"},defaultParams:{center:[.5,.5],rotations:1,scale:8,backColor:[.15,.15,.15,1]},glsl:`// Author: Fernando Kuteken
// License: MIT

#define PI 3.14159265359

uniform vec2 center; // = vec2(0.5, 0.5);
uniform float rotations; // = 1;
uniform float scale; // = 8;
uniform vec4 backColor; // = vec4(0.15, 0.15, 0.15, 1.0);

vec4 transition (vec2 uv) {
  
  vec2 difference = uv - center;
  vec2 dir = normalize(difference);
  float dist = length(difference);
  
  float angle = 2.0 * PI * rotations * progress;
  
  float c = cos(angle);
  float s = sin(angle);
  
  float currentScale = mix(scale, 1.0, 2.0 * abs(progress - 0.5));
  
  vec2 rotatedDir = vec2(dir.x  * c - dir.y * s, dir.x * s + dir.y * c);
  vec2 rotatedUv = center + rotatedDir * dist / currentScale;
  
  if (rotatedUv.x < 0.0 || rotatedUv.x > 1.0 ||
      rotatedUv.y < 0.0 || rotatedUv.y > 1.0)
    return backColor;
    
  return mix(getFromColor(rotatedUv), getToColor(rotatedUv), progress);
}
`,author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"squareswire",paramsTypes:{squares:"ivec2",direction:"vec2",smoothness:"float"},defaultParams:{squares:[10,10],direction:[1,-.5],smoothness:1.6},glsl:`// Author: gre
// License: MIT
 
uniform ivec2 squares;// = ivec2(10,10)
uniform vec2 direction;// = vec2(1.0, -0.5)
uniform float smoothness; // = 1.6

const vec2 center = vec2(0.5, 0.5);
vec4 transition (vec2 p) {
  vec2 v = normalize(direction);
  v /= abs(v.x)+abs(v.y);
  float d = v.x * center.x + v.y * center.y;
  float offset = smoothness;
  float pr = smoothstep(-offset, 0.0, v.x * p.x + v.y * p.y - (d-0.5+progress*(1.+offset)));
  vec2 squarep = fract(p*vec2(squares));
  vec2 squaremin = vec2(pr/2.0);
  vec2 squaremax = vec2(1.0 - pr/2.0);
  float a = (1.0 - step(progress, 0.0)) * step(squaremin.x, squarep.x) * step(squaremin.y, squarep.y) * step(squarep.x, squaremax.x) * step(squarep.y, squaremax.y);
  return mix(getFromColor(p), getToColor(p), a);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"squeeze",paramsTypes:{colorSeparation:"float"},defaultParams:{colorSeparation:.04},glsl:`// Author: gre
// License: MIT
 
uniform float colorSeparation; // = 0.04
 
vec4 transition (vec2 uv) {
  float y = 0.5 + (uv.y-0.5) / (1.0-progress);
  if (y < 0.0 || y > 1.0) {
     return getToColor(uv);
  }
  else {
    vec2 fp = vec2(uv.x, y);
    vec2 off = progress * vec2(0.0, colorSeparation);
    vec4 c = getFromColor(fp);
    vec4 cn = getFromColor(fp - off);
    vec4 cp = getFromColor(fp + off);
    return vec4(cn.r, c.g, cp.b, c.a);
  }
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"swap",paramsTypes:{reflection:"float",perspective:"float",depth:"float"},defaultParams:{reflection:.4,perspective:.2,depth:3},glsl:`// Author: gre
// License: MIT
// General parameters
uniform float reflection; // = 0.4
uniform float perspective; // = 0.2
uniform float depth; // = 3.0
 
const vec4 black = vec4(0.0, 0.0, 0.0, 1.0);
const vec2 boundMin = vec2(0.0, 0.0);
const vec2 boundMax = vec2(1.0, 1.0);
 
bool inBounds (vec2 p) {
  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));
}
 
vec2 project (vec2 p) {
  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);
}
 
vec4 bgColor (vec2 p, vec2 pfr, vec2 pto) {
  vec4 c = black;
  pfr = project(pfr);
  if (inBounds(pfr)) {
    c += mix(black, getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));
  }
  pto = project(pto);
  if (inBounds(pto)) {
    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));
  }
  return c;
}
 
vec4 transition(vec2 p) {
  vec2 pfr, pto = vec2(-1.);
 
  float size = mix(1.0, depth, progress);
  float persp = perspective * progress;
  pfr = (p + vec2(-0.0, -0.5)) * vec2(size/(1.0-perspective*progress), size/(1.0-size*persp*p.x)) + vec2(0.0, 0.5);
 
  size = mix(1.0, depth, 1.-progress);
  persp = perspective * (1.-progress);
  pto = (p + vec2(-1.0, -0.5)) * vec2(size/(1.0-perspective*(1.0-progress)), size/(1.0-size*persp*(0.5-p.x))) + vec2(1.0, 0.5);

  if (progress < 0.5) {
    if (inBounds(pfr)) {
      return getFromColor(pfr);
    }
    if (inBounds(pto)) {
      return getToColor(pto);
    }  
  }
  if (inBounds(pto)) {
    return getToColor(pto);
  }
  if (inBounds(pfr)) {
    return getFromColor(pfr);
  }
  return bgColor(p, pfr, pto);
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Sun, 18 Feb 2018 17:45:50 +0100"},{name:"undulatingBurnOut",paramsTypes:{smoothness:"float",center:"vec2",color:"vec3"},defaultParams:{smoothness:.03,center:[.5,.5],color:[0,0,0]},glsl:`// License: MIT
// Author: pthrasher
// adapted by gre from https://gist.github.com/pthrasher/8e6226b215548ba12734

uniform float smoothness; // = 0.03
uniform vec2 center; // = vec2(0.5)
uniform vec3 color; // = vec3(0.0)

const float M_PI = 3.14159265358979323846;

float quadraticInOut(float t) {
  float p = 2.0 * t * t;
  return t < 0.5 ? p : -p + (4.0 * t) - 1.0;
}

float getGradient(float r, float dist) {
  float d = r - dist;
  return mix(
    smoothstep(-smoothness, 0.0, r - dist * (1.0 + smoothness)),
    -1.0 - step(0.005, d),
    step(-0.005, d) * step(d, 0.01)
  );
}

float getWave(vec2 p){
  vec2 _p = p - center; // offset from center
  float rads = atan(_p.y, _p.x);
  float degs = degrees(rads) + 180.0;
  vec2 range = vec2(0.0, M_PI * 30.0);
  vec2 domain = vec2(0.0, 360.0);
  float ratio = (M_PI * 30.0) / 360.0;
  degs = degs * ratio;
  float x = progress;
  float magnitude = mix(0.02, 0.09, smoothstep(0.0, 1.0, x));
  float offset = mix(40.0, 30.0, smoothstep(0.0, 1.0, x));
  float ease_degs = quadraticInOut(sin(degs));
  float deg_wave_pos = (ease_degs * magnitude) * sin(x * offset);
  return x + deg_wave_pos;
}

vec4 transition(vec2 p) {
  float dist = distance(center, p);
  float m = getGradient(getWave(p), dist);
  vec4 cfrom = getFromColor(p);
  vec4 cto = getToColor(p);
  return mix(mix(cfrom, cto, m), mix(cfrom, vec4(color, 1.0), 0.75), step(m, -2.0));
}
`,license:"MIT",author:"pthrasher",createdAt:"Mon, 12 Jun 2017 10:23:37 +0800",updatedAt:"Mon, 12 Jun 2017 10:23:37 +0800"},{name:"wind",paramsTypes:{size:"float"},defaultParams:{size:.2},glsl:`// Author: gre
// License: MIT

// Custom parameters
uniform float size; // = 0.2

float rand (vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec4 transition (vec2 uv) {
  float r = rand(vec2(0, uv.y));
  float m = smoothstep(0.0, -size, uv.x*(1.0-size) + size*r - (progress * (1.0 + size)));
  return mix(
    getFromColor(uv),
    getToColor(uv),
    m
  );
}
`,author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"windowblinds",paramsTypes:{},defaultParams:{},glsl:`// Author: Fabien Benetou
// License: MIT

vec4 transition (vec2 uv) {
  float t = progress;
  
  if (mod(floor(uv.y*100.*progress),2.)==0.)
    t*=2.-.5;
  
  return mix(
    getFromColor(uv),
    getToColor(uv),
    mix(t, progress, smoothstep(0.8, 1.0, progress))
  );
}
`,author:"Fabien Benetou",license:"MIT",createdAt:"Wed, 31 May 2017 14:11:48 +0200",updatedAt:"Wed, 31 May 2017 14:11:48 +0200"},{name:"windowslice",paramsTypes:{count:"float",smoothness:"float"},defaultParams:{count:10,smoothness:.5},glsl:`// Author: gre
// License: MIT

uniform float count; // = 10.0
uniform float smoothness; // = 0.5

vec4 transition (vec2 p) {
  float pr = smoothstep(-smoothness, 0.0, p.x - progress * (1.0 + smoothness));
  float s = step(pr, fract(count * p.x));
  return mix(getFromColor(p), getToColor(p), s);
}
`,author:"gre",license:"MIT",createdAt:"Wed, 28 Mar 2018 17:23:26 +0200",updatedAt:"Wed, 28 Mar 2018 17:23:26 +0200"},{name:"wipeDown",paramsTypes:{},defaultParams:{},glsl:`// Author: Jake Nelson
// License: MIT

vec4 transition(vec2 uv) {
  vec2 p=uv.xy/vec2(1.0).xy;
  vec4 a=getFromColor(p);
  vec4 b=getToColor(p);
  return mix(a, b, step(1.0-p.y,progress));
}
`,author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:26:01 -0500",updatedAt:"Thu, 2 Nov 2017 18:39:26 -0500"},{name:"wipeLeft",paramsTypes:{},defaultParams:{},glsl:`// Author: Jake Nelson
// License: MIT

vec4 transition(vec2 uv) {
  vec2 p=uv.xy/vec2(1.0).xy;
  vec4 a=getFromColor(p);
  vec4 b=getToColor(p);
  return mix(a, b, step(1.0-p.x,progress));
}
`,author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:26:28 -0500",updatedAt:"Fri, 3 Nov 2017 18:03:50 +0100"},{name:"wipeRight",paramsTypes:{},defaultParams:{},glsl:`// Author: Jake Nelson
// License: MIT

vec4 transition(vec2 uv) {
  vec2 p=uv.xy/vec2(1.0).xy;
  vec4 a=getFromColor(p);
  vec4 b=getToColor(p);
  return mix(a, b, step(0.0+p.x,progress));
}
`,author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:27:02 -0500",updatedAt:"Thu, 2 Nov 2017 18:40:22 -0500"},{name:"wipeUp",paramsTypes:{},defaultParams:{},glsl:`// Author: Jake Nelson
// License: MIT

vec4 transition(vec2 uv) {
  vec2 p=uv.xy/vec2(1.0).xy;
  vec4 a=getFromColor(p);
  vec4 b=getToColor(p);
  return mix(a, b, step(0.0+p.y,progress));
}
`,author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:24:36 -0500",updatedAt:"Thu, 2 Nov 2017 18:37:42 -0500"}]),Sm}var oG=nG();const Br=O0(oG),aG=`
	in vec2 aPosition;
	out vec2 _uv;               
	uniform mat3 projectionMatrix;
	uniform vec4 uInputSize;
	uniform vec4 uOutputFrame;
	out vec2 vTextureCoord;
	uniform vec4 uOutputTexture;

	vec4 filterVertexPosition( void )
	{
			vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

			position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
			position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

			return vec4(position, 0.0, 1.0);
	}

	vec2 filterTextureCoord( void )
	{
	return aPosition * (uOutputFrame.zw * uInputSize.zw);
	}

	void main(void)
	{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vec2 absolute = aPosition * uOutputFrame.zw + uOutputFrame.xy;
	_uv = absolute / uOutputTexture.xy;
	}
`,$e={custom:t=>{const e=t.defaultParams||{},i=t.paramsTypes||{};return Object.fromEntries(Object.entries(e).map(([s,r])=>[s,{value:r,type:lG(i[s])}]))},basics:{_fromR:{value:1,type:"f32"},_toR:{value:1,type:"f32"},ratio:{value:1,type:"f32"},progress:{value:0,type:"f32"},customUniform:{value:0,type:"f32"},center:{value:[.5,.5],type:"vec2<f32>"}}},lG=t=>t==="f32"||t==="i32"?t:t==="float"?"f32":`${t}<f32>`,cG=t=>`
	precision highp float;
	in vec2 vTextureCoord;
	in vec2 _uv; // Normalized [0,1] coordinates with center at (0.5, 0.5) for canvas-centered transitions
	uniform sampler2D from, to;
	uniform float progress, ratio, _fromR, _toR;
	uniform float customUniform;
	uniform vec2 center; // Center point of the canvas (0.5, 0.5) - NOT element centers

	vec4 getFromColor(vec2 uv){
		return texture2D(from, .5+(uv-.5)*vec2(max(ratio/_fromR,1.), max(_fromR/ratio,1.)));
	}
	vec4 getToColor(vec2 uv){
		return texture2D(to, .5+(uv-.5)*vec2(max(ratio/_toR,1.), max(_toR/ratio,1.)));
	}

	// Helper function to get distance from canvas center
	float distanceFromCenter(vec2 uv) {
		return distance(uv, center);
	}
	
	// Helper function to get angle from canvas center
	float angleFromCenter(vec2 uv) {
		vec2 centered = uv - center;
		return atan(centered.y, centered.x);
	}
	
	// Helper function to get centered coordinates relative to canvas center
	vec2 getCenteredCoord(vec2 uv) {
		return uv - center; // Coordinates relative to canvas center
	}

	// gl-transition code here
	${t}
	// gl-transition code end

	void main(){
		// Use _uv which is properly normalized to [0,1] range with center at (0.5, 0.5)
		// This ensures transitions are centered on the canvas, not element centers
		vec2 uv = _uv;
		gl_FragColor = transition(uv);
	}
`,uG=`
const float PI = 3.141592653589;

vec4 transition(vec2 p) {
  vec2 rp = p * 2.0 - 1.0;
  float angle = atan(rp.y, rp.x);
  float threshold = (progress - 0.5) * PI * 2.5;
  float mix_factor = smoothstep(0.0, 0.1, angle - threshold);
  return mix(getToColor(p), getFromColor(p), mix_factor);
}
`,hG=`
uniform vec2 gridSize;
uniform float pause;
uniform float dividerWidth;
uniform vec4 bgColor;
uniform float randomness;

float rand(vec2 co) { 
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float getDelta(vec2 p) { 
  vec2 rectanglePos = floor(gridSize * p); 
  vec2 rectangleSize = vec2(1.0 / gridSize.x, 1.0 / gridSize.y); 
  float top = rectangleSize.y * (rectanglePos.y + 1.0); 
  float bottom = rectangleSize.y * rectanglePos.y; 
  float left = rectangleSize.x * rectanglePos.x; 
  float right = rectangleSize.x * (rectanglePos.x + 1.0); 
  float minX = min(abs(p.x - left), abs(p.x - right)); 
  float minY = min(abs(p.y - top), abs(p.y - bottom)); 
  return min(minX, minY);
}

float getDividerSize() { 
  vec2 rectangleSize = vec2(1.0 / gridSize.x, 1.0 / gridSize.y); 
  return min(rectangleSize.x, rectangleSize.y) * dividerWidth;
}

vec4 transition(vec2 p) { 
  if (progress < pause) { 
    float currentProg = progress / pause; 
    float a = 1.0; 
    if (getDelta(p) < getDividerSize()) { 
      a = 1.0 - currentProg; 
    } 
    return mix(bgColor, getFromColor(p), a); 
  } 

  if (progress < 1.0 - pause) { 
    if (getDelta(p) < getDividerSize()) { 
      return bgColor; 
    } 

    float currentProg = (progress - pause) / (1.0 - pause * 2.0); 
    vec2 rectanglePos = floor(gridSize * p); 
    float r = rand(rectanglePos) - randomness; 
    float cp = smoothstep(0.0, 1.0 - r, currentProg); 
    float rectangleSize = 1.0 / gridSize.x; 
    float delta = rectanglePos.x * rectangleSize; 
    float offset = rectangleSize * 0.5 + delta; 

    vec2 warped = p; 
    warped.x = (warped.x - offset) / max(abs(cp - 0.5), 0.001) * 0.5 + offset; 

    float s = step(abs(gridSize.x * (p.x - delta) - 0.5), abs(cp - 0.5)); 
    vec4 mixColor = mix(getToColor(warped), getFromColor(warped), step(cp, 0.5)); 
    return mix(bgColor, mixColor, s); 
  } 

  float currentProg = (progress - 1.0 + pause) / pause; 
  float a = 1.0; 
  if (getDelta(p) < getDividerSize()) { 
    a = currentProg; 
  } 
  return mix(bgColor, getToColor(p), a);
}
`,dG={gridSize:{value:[4,4],type:"vec2<f32>"},pause:{value:.1,type:"f32"},dividerWidth:{value:.05,type:"f32"},bgColor:{value:[0,0,0,1],type:"vec4<f32>"},randomness:{value:.1,type:"f32"}},fG=`
uniform vec3 backColor;

vec4 transition(vec2 uv) { 
  float distance = length(uv - center); 
  float radius = sqrt(8.0) * abs(progress - 0.5); 

  if (distance > radius) { 
    return vec4(backColor, 1.0); 
  } else { 
    if (progress < 0.5) return getFromColor(uv); 
    else return getToColor(uv); 
  }
}
`,pG=`
uniform vec2 direction;

vec4 transition(vec2 uv) { 
  vec2 p = uv + progress * sign(direction); 
  vec2 f = fract(p); 
  return mix( 
    getToColor(f), 
    getFromColor(f), 
    step(0.0, p.y) * step(p.y, 1.0) * step(0.0, p.x) * step(p.x, 1.0) 
  );
}
`,mG={direction:{value:[0,1],type:"vec2<f32>"}},gG=`
uniform float smoothness;
uniform vec3 color;

const float M_PI = 3.14159265358979323846;

float quadraticInOut(float t) { 
  float p = 2.0 * t * t; 
  return t < 0.5 ? p : -p + (4.0 * t) - 1.0;
}

float getGradient(float r, float dist) { 
  float d = r - dist; 
  return mix( 
    smoothstep(-smoothness, 0.0, r - dist * (1.0 + smoothness)), 
    -1.0 - step(0.005, d), 
    step(-0.005, d) * step(d, 0.01) 
  );
}

float getWave(vec2 p){ 
  vec2 _p = p - center; // offset from center 
  float rads = atan(_p.y, _p.x); 
  float degs = degrees(rads) + 180.0; 
  vec2 range = vec2(0.0, M_PI * 30.0); 
  vec2 domain = vec2(0.0, 360.0); 
  float ratio = (M_PI * 30.0) / 360.0; 
  degs = degs * ratio; 
  float x = progress; 
  float magnitude = mix(0.02, 0.09, smoothstep(0.0, 1.0, x)); 
  float offset = mix(40.0, 30.0, smoothstep(0.0, 1.0, x)); 
  float ease_degs = quadraticInOut(sin(degs)); 
  float deg_wave_pos = (ease_degs * magnitude) * sin(x * offset); 
  return x + deg_wave_pos;
}

vec4 transition(vec2 p) { 
  float dist = distance(center, p); 
  float m = getGradient(getWave(p), dist); 
  vec4 cfrom = getFromColor(p); 
  vec4 cto = getToColor(p); 
  return mix(mix(cfrom, cto, m), mix(cfrom, vec4(color, 1.0), 0.75), step(m, -2.0));
}
`,yG={smoothness:{value:.1,type:"f32"},center:{value:[.5,.5],type:"vec2<f32>"},color:{value:[1,.5,0],type:"vec3<f32>"}},vG=`
uniform ivec2 squares;
uniform vec2 direction;
uniform float smoothness;

vec4 transition (vec2 p) { 
  vec2 v = normalize(direction); 
  v /= abs(v.x)+abs(v.y); 
  float d = v.x * center.x + v.y * center.y; 
  float offset = smoothness; 
  float pr = smoothstep(-offset, 0.0, v.x * p.x + v.y * p.y - (d-0.5+progress*(1.+offset))); 
  vec2 squarep = fract(p*vec2(squares)); 
  vec2 squaremin = vec2(pr/2.0); 
  vec2 squaremax = vec2(1.0 - pr/2.0); 
  float a = (1.0 - step(progress, 0.0)) * step(squaremin.x, squarep.x) * step(squaremin.y, squarep.y) * step(squarep.x, squaremax.x) * step(squarep.y, squaremax.y); 
  return mix(getFromColor(p), getToColor(p), a);
}
`,xG={squares:{value:[10,10],type:"vec2<i32>"},direction:{value:[1,-.5],type:"vec2<f32>"},smoothness:{value:1.6,type:"f32"}},bG=`
#define PI 3.14159265359

uniform float rotations;
uniform float scale;
uniform vec4 backColor;

vec4 transition (vec2 uv) { 
  vec2 difference = uv - center; 
  vec2 dir = normalize(difference); 
  float dist = length(difference); 

  float angle = 2.0 * PI * rotations * progress; 

  float c = cos(angle); 
  float s = sin(angle); 

  float currentScale = mix(scale, 1.0, 2.0 * abs(progress - 0.5)); 

  vec2 rotatedDir = vec2(dir.x * c - dir.y * s, dir.x * s + dir.y * c); 
  vec2 rotatedUv = center + rotatedDir * dist / currentScale; 

  if (rotatedUv.x < 0.0 || rotatedUv.x > 1.0 || 
      rotatedUv.y < 0.0 || rotatedUv.y > 1.0) 
    return backColor; 

  return mix(getFromColor(rotatedUv), getToColor(rotatedUv), progress);
}
`,_G={center:{value:[.5,.5],type:"vec2<f32>"},rotations:{value:1,type:"f32"},scale:{value:8,type:"f32"},backColor:{value:[.15,.15,.15,1],type:"vec4<f32>"}},wG=`
uniform ivec2 size;
uniform float smoothness;

float rand (vec2 co) { 
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec4 transition(vec2 p) { 
  float r = rand(floor(vec2(size) * p)); 
  float m = smoothstep(0.0, -smoothness, r - (progress * (1.0 + smoothness))); 
  return mix(getFromColor(p), getToColor(p), m);
}
`,SG={size:{value:[10,10],type:"vec2<i32>"},smoothness:{value:.5,type:"f32"}},CG=`
#define PI 3.14159265359

uniform int segments;

vec4 transition (vec2 uv) { 
  float angle = atan(uv.y - 0.5, uv.x - 0.5) - 0.5 * PI; 
  float normalized = (angle + 1.5 * PI) * (2.0 * PI); 

  float radius = (cos(float(segments) * angle) + 4.0) / 4.0; 
  float difference = length(uv - vec2(0.5, 0.5)); 

  if (difference > radius * progress) 
    return getFromColor(uv); 
  else 
    return getToColor(uv);
}
`,TG={segments:{value:5,type:"i32"}},kG=`
uniform ivec2 squaresMin;
uniform int steps;

vec4 transition(vec2 uv) { 
  float d = min(progress, 1.0 - progress);
  float dist = steps>0 ? ceil(d * float(steps)) / float(steps) : d;
  vec2 squareSize = 2.0 * dist / vec2(squaresMin);
  
  vec2 p = dist>0.0 ? (floor(uv / squareSize) + 0.5) * squareSize : uv; 
  return mix(getFromColor(p), getToColor(p), progress);
}
`,AG={squaresMin:{value:[20,20],type:"vec2<i32>"},steps:{value:50,type:"i32"}},IG=`
uniform float scale;
uniform float smoothness;
uniform float seed;

// http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
float random(vec2 co)
{ 
  float a = seed; 
  float b = 78.233; 
  float c = 43758.5453; 
  float dt = dot(co.xy, vec2(a, b)); 
  float sn = mod(dt, 3.14); 
  return fract(sin(sn) * c);
}

// 2D Noise based on Morgan McGuire @morgan3d
// https://www.shadertoy.com/view/4dS3Wd
float noise(vec2 st) { 
  vec2 i = floor(st); 
  vec2 f = fract(st); 

  // Four corners in 2D of a tile 
  float a = random(i); 
  float b = random(i + vec2(1.0, 0.0)); 
  float c = random(i + vec2(0.0, 1.0)); 
  float d = random(i + vec2(1.0, 1.0)); 

  //Smooth Interpolation 

  // Cubic Hermine Curve. Same as SmoothStep() 
  vec2 u = f*f*(3.0-2.0*f); 
  // u = smoothstep(0.,1.,f); 

  // Mix 4 coorners percentages 
  return mix(a, b, u.x) + 
         (c - a)* u.y * (1.0 - u.x) + 
         (d - b) * u.x * u.y;
}

vec4 transition (vec2 uv) { 
  vec4 from = getFromColor(uv); 
  vec4 to = getToColor(uv); 
  float n = noise(uv * scale); 

  float p = mix(-smoothness, 1.0 + smoothness, progress); 
  float lower = p - smoothness; 
  float higher = p + smoothness; 

  float q = smoothstep(lower, higher, n); 

  return mix( 
    from, 
    to, 
    1.0 - q 
  );
}
`,PG={scale:{value:4,type:"f32"},smoothness:{value:.01,type:"f32"},seed:{value:12.9898,type:"f32"}},EG=`

#define PI 3.14159265358979323846

uniform float spiralTurns;
uniform float spiralWidth;

vec4 transition(vec2 uv) {

    vec2 p = uv - center;

    float r = length(p);
    float angle = atan(p.y, p.x);

    float normalizedAngle = (angle + PI) / (2.0 * PI);

    float spiral = normalizedAngle + r * spiralTurns;
    spiral = fract(spiral);

    float factor = smoothstep(
        progress - spiralWidth,
        progress + spiralWidth,
        spiral
    );
    return mix(
        getToColor(uv),       // ahora aparece primero
        getFromColor(uv),     // aparece despus
        factor
    );
}


`,MG={spiralTurns:{value:1.5,type:"f32"},spiralWidth:{value:.02,type:"f32"}},FG=`
//direction of movement : 0 : up, 1, down
uniform float direction; // = 1.0 (using float instead of bool for WebGPU)

//luminance threshold
uniform float l_threshold; // = 0.8

//does the movement take effect above or below luminance threshold ?
uniform float above; // = 0.0 (false) (using float instead of bool for WebGPU)

//Random function borrowed from everywhere
float rand(vec2 co){ 
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// Simplex noise:
// Description : Array and textureless GLSL 2D simplex noise function.
// Author: Ian McEwan, Ashima Arts.
// Maintainer : ijm
// Lastmod: 20110822 (ijm)
// License: MIT
// 2011 Ashima Arts. All rights reserved.
// Distributed under the MIT License. See LICENSE file.
// https://github.com/ashima/webgl-noise

vec3 mod289(vec3 x) { 
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) { 
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) { 
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) 
{ 
  const vec4 C = vec4(0.211324865405187, // (3.0-sqrt(3.0))/6.0 
                      0.366025403784439, // 0.5*(sqrt(3.0)-1.0) 
                      -0.577350269189626, // -1.0 + 2.0 * C.x 
                      0.024390243902439); // 1.0 / 41.0
  // First corner 
  vec2 i = floor(v + dot(v, C.yy) ); 
  vec2 x0 = v - i + dot(i, C.xx);

  // Other corners 
  vec2 i1; 
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0 
  //i1.y = 1.0 - i1.x; 
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0); 
  // x0 = x0 - 0.0 + 0.0 * C.xx ; 
  // x1 = x0 - i1 + 1.0 * C.xx ; 
  // x2 = x0 - 1.0 + 2.0 * C.xx ; 
  vec4 x12 = x0.xyxy + C.xxzz; 
  x12.xy -= i1;

  //Permutations 
  i = mod289(i); // Avoid truncation effects in permutation 
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) 
                    + i.x + vec3(0.0, i1.x, 1.0 )); 

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0); 
  m = m*m ; 
  m = m*m ;

  // Gradients: 41 points uniformly over a line, mapped onto a diamond.
  // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287) 

  vec3 x = 2.0 * fract(p * C.www) - 1.0; 
  vec3 h = abs(x) - 0.5; 
  vec3 ox = floor(x + 0.5); 
  vec3 a0 = x - ox;

  // Normalize gradients implicitly by scaling m
  // Approximation of: m *= inversesqrt( a0*a0 + h*h ); 
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

  // Compute final noise value at P 
  vec3 g; 
  g.x = a0.x * x0.x + h.x * x0.y; 
  g.yz = a0.yz * x12.xz + h.yz * x12.yw; 
  return 130.0 * dot(m, g);
}

// Simplex noise -- end

float luminance(vec4 color){ 
  //(0.299*R + 0.587*G + 0.114*B) 
  return color.r*0.299+color.g*0.587+color.b*0.114;
}

vec4 transition(vec2 uv) { 
  vec2 p = uv.xy / vec2(1.0).xy; 
  vec2 center = vec2(1.0, direction);
  
  if (progress == 0.0) { 
    return getFromColor(p); 
  } else if (progress == 1.0) { 
    return getToColor(p); 
  } else { 
    float x = progress; 
    float dist = distance(center, p) - progress*exp(snoise(vec2(p.x, 0.0))); 
    float r = x - rand(vec2(p.x, 0.1)); 
    float m; 
    if(above > 0.5){ 
      m = dist <= r && luminance(getFromColor(p))>l_threshold ? 1.0 : (progress*progress*progress); 
    } 
    else{ 
      m = dist <= r && luminance(getFromColor(p))<l_threshold ? 1.0 : (progress*progress*progress); 
    } 
    return mix(getFromColor(p), getToColor(p), m); 
  }
}
`,RG={direction:{value:1,type:"f32"},l_threshold:{value:.8,type:"f32"},above:{value:0,type:"f32"}},zG=`
uniform int steps; // = 50
uniform float horizontalHexagons; // = 20.0

struct Hexagon { 
  float q; 
  float r; 
  float s;
};

Hexagon createHexagon(float q, float r){ 
  Hexagon hex; 
  hex.q = q; 
  hex.r = r; 
  hex.s = -q - r; 
  return hex;
}

Hexagon roundHexagon(Hexagon hex){ 
  float q = floor(hex.q + 0.5); 
  float r = floor(hex.r + 0.5); 
  float s = floor(hex.s + 0.5); 

  float deltaQ = abs(q - hex.q); 
  float deltaR = abs(r - hex.r); 
  float deltaS = abs(s - hex.s); 

  if (deltaQ > deltaR && deltaQ > deltaS) 
    q = -r - s; 
  else if (deltaR > deltaS) 
    r = -q - s; 
  else 
    s = -q - r; 

  return createHexagon(q, r);
}

Hexagon hexagonFromPoint(vec2 point, float size) { 
  point.y /= ratio; 
  point = (point - 0.5) / size; 

  float q = (sqrt(3.0) / 3.0) * point.x + (-1.0 / 3.0) * point.y; 
  float r = 0.0 * point.x + 2.0/3.0 * point.y; 

  Hexagon hex = createHexagon(q, r); 
  return roundHexagon(hex);
}

vec2 pointFromHexagon(Hexagon hex, float size) { 
  float x = (sqrt(3.0) * hex.q + (sqrt(3.0) / 2.0) * hex.r) * size + 0.5; 
  float y = (0.0 * hex.q + (3.0/2.0) * hex.r) * size + 0.5; 

  return vec2(x, y * ratio);
}

vec4 transition (vec2 uv) { 
  float dist = 2.0 * min(progress, 1.0 - progress); 
  dist = steps > 0 ? ceil(dist * float(steps)) / float(steps) : dist; 

  float size = (sqrt(3.0) / 3.0) * dist / horizontalHexagons; 

  vec2 point = dist > 0.0 ? pointFromHexagon(hexagonFromPoint(uv, size), size) : uv; 

  return mix(getFromColor(point), getToColor(point), progress);
}
`,UG={steps:{value:50,type:"i32"},horizontalHexagons:{value:20,type:"f32"}},BG=`
float inHeart (vec2 p, vec2 center, float size) { 
  if (size==0.0) return 0.0; 
  vec2 o = (p-center)/(1.6*size); 
  o.y = -o.y;
  float a = o.x*o.x+o.y*o.y-0.3; 
  return step(a*a*a, o.x*o.x*o.y*o.y*o.y);
}

vec4 transition (vec2 uv) { 
  return mix( 
    getFromColor(uv), 
    getToColor(uv), 
    inHeart(uv, vec2(0.5, 0.5), progress) 
  );
}
`,OG={},DG=`
uniform sampler2D displacementMap;
uniform float strength; // = 0.5

vec4 transition (vec2 uv) { 
  float displacement = texture2D(displacementMap, uv).r * strength; 

  vec2 uvFrom = vec2(uv.x + progress * displacement, uv.y); 
  vec2 uvTo = vec2(uv.x - (1.0 - progress) * displacement, uv.y); 

  return mix( 
    getFromColor(uvFrom), 
    getToColor(uvTo), 
    progress 
  );
}
`,LG={strength:{value:.5,type:"f32"}},NG=`
uniform vec2 direction; // = vec2(1.0, -1.0)
uniform float smoothness; // = 0.5

// Note: center is already defined as a uniform in the fragment wrapper

vec4 transition (vec2 uv) {
  vec2 v = normalize(direction);
  v /= abs(v.x)+abs(v.y);
  float d = v.x * center.x + v.y * center.y;
  float m = 
    (1.0-step(progress, 0.0)) * // there is something wrong with our formula that makes m not equals 0.0 with progress is 0.0 
    (1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d-0.5+progress*(1.+smoothness)))); 
  return mix(getFromColor(uv), getToColor(uv), m);
}
`,HG={direction:{value:[1,-1],type:"vec2<f32>"},smoothness:{value:.5,type:"f32"}},GG=`
uniform vec2 direction; // = vec2(-1.0, 1.0)

const float smoothness = 0.5;
// Note: center is already defined as a uniform in the fragment wrapper

vec4 transition (vec2 uv) { 
  vec2 v = normalize(direction); 
  v /= abs(v.x) + abs(v.y); 
  float d = v.x * center.x + v.y * center.y; 
  float m = 1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d - 0.5 + progress * (1.0 + smoothness))); 
  return mix(getFromColor((uv - 0.5) * (1.0 - m) + 0.5), getToColor((uv - 0.5) * m + 0.5), m);
}
`,WG={direction:{value:[-1,1],type:"vec2<f32>"}},VG=`
uniform float threshold; // = 3.0
uniform float fadeEdge; // = 0.1

// Note: center is already defined as a uniform in the fragment wrapper

float rand(vec2 co) { 
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec4 transition(vec2 p) { 
  float dist = distance(center, p) / threshold; 
  float r = progress - min(rand(vec2(p.y, 0.0)), rand(vec2(0.0, p.x))); 
  return mix(getFromColor(p), getToColor(p), mix(0.0, mix(step(dist, r), 1.0, smoothstep(1.0-fadeEdge, 1.0, progress)), smoothstep(0.0, fadeEdge, progress)));
}
`,$G={threshold:{value:3,type:"f32"},fadeEdge:{value:.1,type:"f32"}},qG=`
uniform float smoothness; // = 0.3
uniform float opening; // = 1.0 (using float instead of bool for WebGPU: 1.0 = true, 0.0 = false)

// Note: center is already defined as a uniform in the fragment wrapper
const float SQRT_2 = 1.414213562373;

vec4 transition (vec2 uv) { 
  float x = opening > 0.5 ? progress : 1.0 - progress; 
  float m = smoothstep(-smoothness, 0.0, SQRT_2*distance(center, uv) - x*(1.0+smoothness)); 
  return mix(getFromColor(uv), getToColor(uv), opening > 0.5 ? 1.0 - m : m);
}
`,eb={smoothness:{value:.3,type:"f32"},opening:{value:1,type:"f32"}},YG=`
vec4 transition (vec2 uv) {
  if(progress == 0.0){
    return getFromColor(uv);
  }
  vec2 leaf_uv = (uv - vec2(0.5))/10.0/pow(progress,3.5);
  leaf_uv.y = -leaf_uv.y;
  leaf_uv.y += 0.35;
  float r = 0.18;
  float o = atan(leaf_uv.y, leaf_uv.x);
  return mix(getFromColor(uv), getToColor(uv), 1.0-step(1.0 - length(leaf_uv)+r*(1.0+sin(o))*(1.0+0.9 * cos(8.0*o))*(1.0+0.1*cos(24.0*o))*(0.9+0.05*cos(200.0*o)), 1.0));
}
`,XG={},jG=`
uniform float zoom; // = 0.88
uniform float corner_radius; // = 0.22

const vec4 black = vec4(0.0, 0.0, 0.0, 1.0);
const vec2 c00 = vec2(0.0, 0.0);
const vec2 c01 = vec2(0.0, 1.0);
const vec2 c11 = vec2(1.0, 1.0);
const vec2 c10 = vec2(1.0, 0.0);

bool in_corner(vec2 p, vec2 corner, vec2 radius) { 
  vec2 axis = (c11 - corner) - corner; 
  p = p - (corner + axis * radius); 
  p *= axis / radius; 
  return (p.x > 0.0 && p.y > -1.0) || (p.y > 0.0 && p.x > -1.0) || dot(p, p) < 1.0;
}

bool test_rounded_mask(vec2 p, vec2 corner_size) { 
  return 
    in_corner(p, c00, corner_size) && 
    in_corner(p, c01, corner_size) && 
    in_corner(p, c10, corner_size) && 
    in_corner(p, c11, corner_size);
}

vec4 screen(vec4 a, vec4 b) { 
  return 1.0 - (1.0 - a) * (1.0 - b);
}

vec4 unscreen(vec4 c) { 
  return 1.0 - sqrt(1.0 - c);
}

vec4 sample_with_corners_from(vec2 p, vec2 corner_size) { 
  p = (p - 0.5) / zoom + 0.5; 
  if (!test_rounded_mask(p, corner_size)) { 
    return black; 
  } 
  return unscreen(getFromColor(p));
}

vec4 sample_with_corners_to(vec2 p, vec2 corner_size) { 
  p = (p - 0.5) / zoom + 0.5; 
  if (!test_rounded_mask(p, corner_size)) { 
    return black; 
  } 
  return unscreen(getToColor(p));
}

vec4 simple_sample_with_corners_from(vec2 p, vec2 corner_size, float zoom_amt) { 
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5; 
  if (!test_rounded_mask(p, corner_size)) { 
    return black; 
  } 
  return getFromColor(p);
}

vec4 simple_sample_with_corners_to(vec2 p, vec2 corner_size, float zoom_amt) { 
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5; 
  if (!test_rounded_mask(p, corner_size)) { 
    return black; 
  } 
  return getToColor(p);
}

mat3 rotate2d(float angle, float ratio) { 
  float s = sin(angle); 
  float c = cos(angle); 
  return mat3( 
    c, s, 0.0, 
    -s, c, 0.0, 
    0.0, 0.0, 1.0);
}

mat3 translate2d(float x, float y) { 
  return mat3( 
    1.0, 0.0, 0.0, 
    0.0, 1.0, 0.0, 
    -x, -y, 1.0);
}

mat3 scale2d(float x, float y) { 
  return mat3( 
    x, 0.0, 0.0, 
    0.0, y, 0.0, 
    0.0, 0.0, 1.0);
}

// Split an image and rotate one up and one down along off screen pivot points
vec4 get_cross_rotated(vec3 p3, float angle, vec2 corner_size, float ratio) { 
  angle = angle * angle; // easing 
  angle /= 2.4; // works out to be a good number of radians 

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio); 
  mat3 unscale_and_uncenter = scale2d(1.0, 1.0/ratio) * translate2d(0.5, 0.5); 
  mat3 slide_left = translate2d(-2.0, 0.0); 
  mat3 slide_right = translate2d(2.0, 0.0); 
  mat3 rotate = rotate2d(angle, ratio); 

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter; 
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter; 

  vec4 a = sample_with_corners_from((op_a * p3).xy, corner_size); 
  vec4 b = sample_with_corners_from((op_b * p3).xy, corner_size); 

  return screen(a, b);
}

// Image stays put, but this time moves two masks
vec4 get_cross_masked(vec3 p3, float angle, vec2 corner_size, float ratio) { 
  angle = 1.0 - angle; 
  angle = angle * angle; // easing 
  angle /= 2.4; 

  vec4 img; 

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio); 
  mat3 unscale_and_uncenter = scale2d(1.0 / zoom, 1.0 / (zoom * ratio)) * translate2d(0.5, 0.5); 
  mat3 slide_left = translate2d(-2.0, 0.0); 
  mat3 slide_right = translate2d(2.0, 0.0); 
  mat3 rotate = rotate2d(angle, ratio); 

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter; 
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter; 

  bool mask_a = test_rounded_mask((op_a * p3).xy, corner_size); 
  bool mask_b = test_rounded_mask((op_b * p3).xy, corner_size); 

  if (mask_a || mask_b) { 
    img = sample_with_corners_to(p3.xy, corner_size); 
    return screen(mask_a ? img : black, mask_b ? img : black); 
  } else { 
    return black; 
  }
}

vec4 transition(vec2 uv) { 
  float a; 
  vec2 p = uv.xy / vec2(1.0).xy; 
  vec3 p3 = vec3(p.xy, 1.0); 

  vec2 corner_size = vec2(corner_radius / ratio, corner_radius); 

  if (progress <= 0.0) { 
    return getFromColor(p); 
  } else if (progress < 0.1) { 
    a = progress / 0.1; 
    return simple_sample_with_corners_from(p, corner_size * a, a); 
  } else if (progress < 0.48) { 
    a = (progress - 0.1) / 0.38; 
    return get_cross_rotated(p3, a, corner_size, ratio); 
  } else if (progress < 0.9) { 
    return get_cross_masked(p3, (progress - 0.52) / 0.38, corner_size, ratio); 
  } else if (progress < 1.0) { 
    a = (1.0 - progress) / 0.1; 
    return simple_sample_with_corners_to(p, corner_size * a, a); 
  } else { 
    return getToColor(p); 
  }
}
`,KG={zoom:{value:.88,type:"f32"},corner_radius:{value:.22,type:"f32"}},ZG=`
float random(vec2 co) { 
  float a = 12.9898; 
  float b = 78.233; 
  float c = 43758.5453; 
  float dt = dot(co.xy, vec2(a, b)); 
  float sn = mod(dt, 3.14); 
  return fract(sin(sn) * c);
}

float voronoi(vec2 x) { 
  vec2 p = floor(x); 
  vec2 f = fract(x); 
  float res = 8.0; 
  for(float j = -1.; j <= 1.; j++) 
    for(float i = -1.; i <= 1.; i++) { 
      vec2 b = vec2(i, j); 
      vec2 r = b - f + random(p + b); 
      float d = dot(r, r); 
      res = min(res, d); 
    } 
  return sqrt(res);
}

vec2 displace(vec4 tex, vec2 texCoord, float dotDepth, float textureDepth, float strength) { 
  float b = voronoi(.003 * texCoord + 2.0); 
  float g = voronoi(0.2 * texCoord); 
  float r = voronoi(texCoord - 1.0); 
  vec4 dt = tex * 1.0; 
  vec4 dis = dt * dotDepth + 1.0 - tex * textureDepth; 

  dis.x = dis.x - 1.0 + textureDepth * dotDepth; 
  dis.y = dis.y - 1.0 + textureDepth * dotDepth; 
  dis.x *= strength; 
  dis.y *= strength; 
  vec2 res_uv = texCoord; 
  res_uv.x = res_uv.x + dis.x - 0.0; 
  res_uv.y = res_uv.y + dis.y; 
  return res_uv;
}

float ease1(float t) { 
  return t == 0.0 || t == 1.0 
    ? t 
    : t < 0.5 
    ? +0.5 * pow(2.0, (20.0 * t) - 10.0) 
    : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
}

float ease2(float t) { 
  return t == 1.0 ? t : 1.0 - pow(2.0, -10.0 * t);
}

vec4 transition(vec2 uv) { 
  vec2 p = uv.xy / vec2(1.0).xy; 
  vec4 color1 = getFromColor(p); 
  vec4 color2 = getToColor(p); 
  vec2 disp = displace(color1, p, 0.33, 0.7, 1.0 - ease1(progress)); 
  vec2 disp2 = displace(color2, p, 0.33, 0.5, ease2(progress)); 
  vec4 dColor1 = getToColor(disp); 
  vec4 dColor2 = getFromColor(disp2); 
  float val = ease1(progress); 
  vec3 gray = vec3(dot(min(dColor2, dColor1).rgb, vec3(0.299, 0.587, 0.114))); 
  dColor2 = vec4(gray, 1.0); 
  dColor2 *= 2.0; 
  color1 = mix(color1, dColor2, smoothstep(0.0, 0.5, progress)); 
  color2 = mix(color2, dColor1, smoothstep(1.0, 0.5, progress)); 
  return mix(color1, color2, val); 
}
`,JG=`
uniform float strength; // = 0.4

const float PI = 3.141592653589793;

float Linear_ease(float begin, float change, float duration, float time) { 
  return change * time / duration + begin;
}

float Exponential_easeInOut(float begin, float change, float duration, float time) { 
  if (time == 0.0) 
    return begin; 
  else if (time == duration) 
    return begin + change; 
  time = time / (duration / 2.0); 
  if (time < 1.0) 
    return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin; 
  return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;
}

float Sine_easeInOut(float begin, float change, float duration, float time) { 
  return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;
}

float rand(vec2 co) { 
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 crossFade(vec2 uv, float dissolve) { 
  return mix(getFromColor(uv).rgb, getToColor(uv).rgb, dissolve);
}

vec4 transition(vec2 uv) { 
  vec2 texCoord = uv.xy / vec2(1.0).xy; 

  // Linear interpolate center across center half of the image 
  vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5); 
  float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress); 

  // Mirrored sine loop. 0->strength then strength->0 
  float strengthValue = Sine_easeInOut(0.0, strength, 0.5, progress); 

  vec3 color = vec3(0.0); 
  float total = 0.0; 
  vec2 toCenter = center - texCoord; 

  /* randomize the lookup values to hide the fixed number of samples */ 
  float offset = rand(uv); 

  for (float t = 0.0; t <= 40.0; t++) { 
    float percent = (t + offset) / 40.0; 
    float weight = 4.0 * (percent - percent * percent); 
    color += crossFade(texCoord + toCenter * percent * strengthValue, dissolve) * weight; 
    total += weight; 
  } 
  return vec4(color / total, 1.0);
}
`,QG={strength:{value:.4,type:"f32"}},e7=`
uniform float a; // = 4
uniform float b; // = 1
uniform float amplitude; // = 120
uniform float smoothness; // = 0.1

vec4 transition(vec2 uv) { 
  vec2 p = uv.xy / vec2(1.0).xy; 
  vec2 dir = p - vec2(.5); 
  float dist = length(dir); 
  float x = (a - b) * cos(progress) + b * cos(progress * ((a / b) - 1.)); 
  float y = (a - b) * sin(progress) - b * sin(progress * ((a / b) - 1.)); 
  vec2 offset = dir * vec2(sin(progress * dist * amplitude * x), sin(progress * dist * amplitude * y)) / smoothness; 
  return mix(getFromColor(p + offset), getToColor(p), smoothstep(0.2, 1.0, progress));
}
`,t7={a:{value:4,type:"f32"},b:{value:1,type:"f32"},amplitude:{value:120,type:"f32"},smoothness:{value:.1,type:"f32"}},i7=`
// License: MIT

vec2 bottom_left = vec2(0.0, 1.0);
vec2 bottom_right = vec2(1.0, 1.0);
vec2 top_left = vec2(0.0, 0.0);
vec2 top_right = vec2(1.0, 0.0);

float check(vec2 p1, vec2 p2, vec2 p3)
{
  return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);
}

bool PointInTriangle (vec2 pt, vec2 p1, vec2 p2, vec2 p3)
{
    bool b1, b2, b3;
    b1 = check(pt, p1, p2) < 0.0;
    b2 = check(pt, p2, p3) < 0.0;
    b3 = check(pt, p3, p1) < 0.0;
    return ((b1 == b2) && (b2 == b3));
}

bool in_left_triangle(vec2 p){
  vec2 vertex1, vertex2, vertex3;
  vertex1 = vec2(progress, 0.5);
  vertex2 = vec2(0.0, 0.5-progress);
  vertex3 = vec2(0.0, 0.5+progress);
  if (PointInTriangle(p, vertex1, vertex2, vertex3))
  {
    return true;
  }
  return false;
}

bool in_right_triangle(vec2 p){
  vec2 vertex1, vertex2, vertex3;
  vertex1 = vec2(1.0-progress, 0.5);
  vertex2 = vec2(1.0, 0.5-progress);
  vertex3 = vec2(1.0, 0.5+progress);
  if (PointInTriangle(p, vertex1, vertex2, vertex3))
  {
    return true;
  }
  return false;
}

float blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt)
{
  vec2 lineDir = bot1 - top;
  vec2 perpDir = vec2(lineDir.y, -lineDir.x);
  vec2 dirToPt1 = bot1 - testPt;
  float dist1 = abs(dot(normalize(perpDir), dirToPt1));
  
  lineDir = bot2 - top;
  perpDir = vec2(lineDir.y, -lineDir.x);
  dirToPt1 = bot2 - testPt;
  float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);
  
  if (min_dist < 0.005) {
    return min_dist / 0.005;
  }
  else  {
    return 1.0;
  };
}


vec4 transition (vec2 uv) {
  if (in_left_triangle(uv))
  {
    if (progress < 0.1)
    {
      return getFromColor(uv);
    }
    if (uv.x < 0.5)
    {
      vec2 vertex1 = vec2(progress, 0.5);
      vec2 vertex2 = vec2(0.0, 0.5-progress);
      vec2 vertex3 = vec2(0.0, 0.5+progress);
      return mix(
        getFromColor(uv),
        getToColor(uv),
        blur_edge(vertex2, vertex3, vertex1, uv)
      );
    }
    else
    {
      if (progress > 0.0)
      {
        return getToColor(uv);
      }
      else
      {
        return getFromColor(uv);
      }
    }    
  }
  else if (in_right_triangle(uv))
  {
    if (uv.x >= 0.5)
    {
      vec2 vertex1 = vec2(1.0-progress, 0.5);
      vec2 vertex2 = vec2(1.0, 0.5-progress);
      vec2 vertex3 = vec2(1.0, 0.5+progress);
      return mix(
        getFromColor(uv),
        getToColor(uv),
        blur_edge(vertex2, vertex3, vertex1, uv)
      );  
    }
    else
    {
      return getFromColor(uv);
    }
  }
  else {
    return getFromColor(uv);
  }
}
`,s7=`

const float SQRT_2 = 1.414213562373;
uniform float dots;// = 20.0;

vec4 transition(vec2 uv) {
  bool nextImage = distance(fract(uv * dots), vec2(0.5, 0.5)) < ( progress / distance(uv, center));
  return nextImage ? getToColor(uv) : getFromColor(uv);
}
`,r7={radialSwipe:{label:"Radial Swipe",fragment:uG}},Or={...Br.reduce((t,e)=>(t[e.name]={label:e.name,fragment:e.glsl,uniforms:e.defaultParams,previewDynamic:`transition: ${e.name}`},t),{}),...r7};Object.entries(Or).map(([t,e])=>({key:t,label:e.label,previewStatic:`https://cdn.subgen.co/previews/static/transition_${t}_static.webp`,previewDynamic:`https://cdn.subgen.co/previews/dynamic/transition_${t}_dynamic.webp`}));function n7({name:t,renderer:e}){let i=Br.find(J=>J.name===t);if(!i){const J=Object.keys(Or).find(j=>j.toLowerCase()===t.toLowerCase());J&&(i=Or[J])}if(i||(i=Br.find(J=>J.name.toLowerCase()===t.toLowerCase())),!i){const J=[t,t.toLowerCase(),t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),t.replace(/([A-Z])/g,"_$1").toLowerCase().replace(/^_/,""),t.replace(/_/g,"")];for(const j of J){if(i=Br.find(we=>we.name.toLowerCase()===j.toLowerCase()),i)break;const ce=Object.keys(Or).find(we=>we.toLowerCase()===j.toLowerCase());if(ce){i=Or[ce];break}}}if(!i){const J=Br.length,j=Br.slice(0,5).map(we=>we.name).join(", "),ce=Object.keys(Or).slice(0,3).join(", ");throw console.error(`Transition not found: "${t}". Available in gl-transitions (${J} total):`,j+"..."),console.error("Available locally:",ce+"..."),new Error(`Transition "${t}" not found in gl-transitions library or local definitions`)}const s=new Zt(xe.WHITE),r=jt.create({width:e.width,height:e.height}),n=new zs({}),o=new zs({}),a=i.name==="displacement"||t.toLowerCase()==="displacement"||i.label==="displacement",l=a?new zs({}):void 0;let u=null;if(a){u=document.createElement("canvas"),u.width=256,u.height=256;const J=u.getContext("2d");if(J){const j=J.createImageData(256,256);for(let ce=0;ce<j.data.length;ce+=4){const we=Math.random();j.data[ce]=we*255,j.data[ce+1]=we*255,j.data[ce+2]=we*255,j.data[ce+3]=255}J.putImageData(j,0,0)}}let c=i.glsl||i.fragment;if(!c)throw new Error(`Transition "${t}" has no glsl or fragment code`);let h={...$e.basics,...$e.custom(i)};Object.entries(h).forEach(([,J])=>{J.type==="int<f32>"&&(J.type="i32",typeof J.value=="number"&&(J.value=Math.trunc(J.value))),J.type==="ivec2<f32>"&&(J.type="vec2<f32>")});const f=i.name==="GridFlip"||t.toLowerCase()==="gridflip"||i.label==="gridflip",d=i.name==="circle"||t.toLowerCase()==="circle"||i.label==="circle",p=i.name==="directional"||t.toLowerCase()==="directional"||i.label==="directional",m=i.name==="UndulatingBurnOut"||t.toLowerCase()==="undulatingburnout"||i.label==="undulatingBurnOut",g=i.name==="SquaresWire"||t.toLowerCase()==="squareswire"||i.label==="squaresWire",y=i.name==="rotate_scale_fade"||t.toLowerCase()==="rotatescalefade"||i.label==="rotateScaleFade",b=i.name==="RandomSquares"||t.toLowerCase()==="randomsquares"||i.label==="randomSquares",v=i.name==="polar_function"||t.toLowerCase()==="polar_function"||i.label==="polar_function",x=i.name==="pixelate"||t.toLowerCase()==="pixelate"||i.label==="pixelate",_=i.name==="perlin"||t.toLowerCase()==="perlin"||i.label==="perlin",S=i.name==="luma"||t.toLowerCase()==="luma"||i.label==="luma",T=i.name==="luminance_melt"||t.toLowerCase()==="luminance_melt"||t.toLowerCase()==="luminancemelt"||i.label==="luminance_melt",A=i.name==="hexagonalize"||t.toLowerCase()==="hexagonalize"||i.label==="hexagonalize",w=i.name==="heart"||t.toLowerCase()==="heart"||i.label==="heart",k=i.name==="displacement"||t.toLowerCase()==="displacement"||i.label==="displacement",F=i.name==="directionalwipe"||t.toLowerCase()==="directionalwipe"||t.toLowerCase()==="directional_wipe"||i.label==="directionalwipe",O=i.name==="directionalwarp"||t.toLowerCase()==="directionalwarp"||t.toLowerCase()==="directional_warp"||i.label==="directionalwarp",V=i.name==="crosshatch"||t.toLowerCase()==="crosshatch"||i.label==="crosshatch",W=i.name==="circleopen"||t.toLowerCase()==="circleopen"||t.toLowerCase()==="circle_open"||i.label==="circleopen",ie=i.name==="cannabisleaf"||t.toLowerCase()==="cannabisleaf"||t.toLowerCase()==="cannabis_leaf"||i.label==="cannabisleaf",R=i.name==="StereoViewer"||t.toLowerCase()==="stereoviewer"||t.toLowerCase()==="stereo_viewer"||i.label==="StereoViewer",I=i.name==="GlitchDisplace"||t.toLowerCase()==="glitchDisplace"||i.label==="GlitchDisplace",E=i.name==="CrossZoom"||t.toLowerCase()==="crosszoom"||i.label==="CrossZoom",U=i.name==="CrazyParametricFun"||t.toLowerCase()==="crazyparametricfun"||i.label==="CrazyParametricFun",Z=i.name==="BowTieHorizontal"||t.toLowerCase()==="bowtiehorizontal"||i.label==="BowTieHorizontal",se=i.name==="PolkaDotsCurtain"||t.toLowerCase()==="polkadotscurtain"||i.label==="PolkaDotsCurtain",te=i.name==="Pixelize"||t.toLowerCase()==="pixelize"||i.label==="Pixelize";f&&(c=hG,h={...$e.basics,...dG}),d&&(c=fG,h={...$e.basics,...eb}),p&&(c=pG,h={...$e.basics,...mG}),m&&(c=gG,h={...$e.basics,...yG}),g&&(c=vG,h={...$e.basics,...xG}),y&&(c=bG,h={...$e.basics,..._G}),b&&(c=wG,h={...$e.basics,...SG}),v&&(c=CG,h={...$e.basics,...TG}),x&&(c=ZS,h={...$e.basics,...JS}),_&&(c=IG,h={...$e.basics,...PG}),S&&(c=EG,h={...$e.basics,...MG}),T&&(c=FG,h={...$e.basics,...RG}),A&&(c=zG,h={...$e.basics,...UG}),w&&(c=BG,h={...$e.basics,...OG}),k&&(c=DG,h={...$e.basics,...LG}),F&&(c=NG,h={...$e.basics,...HG}),O&&(c=GG,h={...$e.basics,...WG}),V&&(c=VG,h={...$e.basics,...$G}),W&&(c=qG,h={...$e.basics,...eb}),ie&&(c=YG,h={...$e.basics,...XG}),R&&(c=jG,h={...$e.basics,...KG}),I&&(c=ZG),E&&(c=JG,h={...$e.basics,...QG}),U&&(c=e7,h={...$e.basics,...t7}),Z&&(c=i7),se&&(c=s7),te&&(c=kG,h={...$e.basics,...AG});const q={from:n,to:o,uniforms:h};a&&l&&(q.displacementMap=l,u&&(l.resource=u,l.update()));const he=new rc({glProgram:new mn({vertex:aG,fragment:cG(c)}),resources:q});return s.filters=[he],{render({width:J,height:j,from:ce,to:we,progress:ke}){if((s.width!==J||s.height!==j)&&(s.setSize({width:J,height:j}),r.resize(J,j)),ce instanceof xe?he.resources.from=ce.source:(n.resource=ce,n.update(),he.resources.from=n),we instanceof xe?he.resources.to=we.source:(o.resource=we,o.update(),he.resources.to=o),a&&l&&u){if(u.width!==J||u.height!==j){u.width=J,u.height=j;const Ue=u.getContext("2d");if(Ue){const Xe=Ue.createImageData(J,j);for(let Ee=0;Ee<Xe.data.length;Ee+=4){const C=Math.random();Xe.data[Ee]=C*255,Xe.data[Ee+1]=C*255,Xe.data[Ee+2]=C*255,Xe.data[Ee+3]=255}Ue.putImageData(Xe,0,0)}}l.resource=u,l.update()}return he.resources.uniforms.uniforms.progress=ke,e.render({container:s,target:r,clear:!0,width:J,height:j}),r},destroy(){r.destroy(),s.destroy({children:!0})}}}class o7 extends dt{constructor(){super(),this.eventMode="static",this.cursor="move"}draw(e,i=1){const r=1.5*i;this.clear(),this.setStrokeStyle({width:r,color:165063}).rect(e.x,e.y,e.width,e.height).stroke(),this.hitArea=e}}class ji extends dt{#e=!1;handle;cursor;callbacks;constructor(e,i,s){super(),this.handle=e,this.cursor=i,this.callbacks=s,this.eventMode="static",this.#l(),this.on("pointerdown",this.#i),this.on("globalpointermove",this.#r),this.on("pointerup",this.#c),this.on("pointerupoutside",this.#c)}#l(){this.clear();const e=165063;if(this.handle==="rot")this.circle(0,0,8),this.fill({color:"#ffffff"}),this.stroke({width:1,color:13421772}),this.moveTo(0,-4),this.arc(0,0,4,-Math.PI/2,Math.PI,!1),this.stroke({width:1,color:0}),this.moveTo(0,-8),this.lineTo(-3,-5),this.lineTo(0,-2),this.stroke({width:1,color:0,cap:"round",join:"round"}),this.hitArea=new oc(0,0,24);else if(["ml","mr","mt","mb"].includes(this.handle)){const i=this.handle==="ml"||this.handle==="mr",s=i?6:24,r=i?24:6;this.roundRect(-s/2,-r/2,s,r,3),this.fill({color:"#ffffff"}),this.stroke({width:1,color:e}),this.hitArea=new Se(-15,-15,30,30)}else this.rect(-4,-4,8,8),this.fill({color:"#ffffff"}),this.stroke({width:1,color:e}),this.hitArea=new Se(-15,-15,30,30)}#i=e=>{this.#e=!0,this.cursor="grabbing",this.callbacks.beginDrag(this.handle,e.global),e.stopPropagation()};#r=e=>{this.#e&&(this.callbacks.updateDrag(this.handle,e.global),e.stopPropagation())};#c=e=>{this.#e&&(this.#e=!1,this.cursor="pointer",this.callbacks.endDrag(),e.stopPropagation())}}class wl{constructor(e,i,s=1){this.artboardWidth=e,this.artboardHeight=i,this.scale=s}static SNAP_THRESHOLD=5;updateContext(e,i,s){this.artboardWidth=e,this.artboardHeight=i,this.scale=s}snapMove(e){const i=[];let s=0,r=0;const n=wl.SNAP_THRESHOLD/this.scale,o=[{value:this.artboardWidth/2,label:"center"},{value:0,label:"start"},{value:this.artboardWidth,label:"end"}],a=[{value:e.x,type:"start"},{value:e.x+e.width/2,type:"center"},{value:e.x+e.width,type:"end"}];let l=!1;for(const f of o){if(l)break;for(const d of a){const p=f.value-d.value;if(Math.abs(p)<n){s=p,l=!0,i.push({type:"vertical",position:f.value,start:Math.min(0,e.y),end:Math.max(this.artboardHeight,e.y+e.height)});break}}}const u=[{value:this.artboardHeight/2,label:"center"},{value:0,label:"start"},{value:this.artboardHeight,label:"end"}],c=[{value:e.y,type:"start"},{value:e.y+e.height/2,type:"center"},{value:e.y+e.height,type:"end"}];let h=!1;for(const f of u){if(h)break;for(const d of c){const p=f.value-d.value;if(Math.abs(p)<n){r=p,h=!0,i.push({type:"horizontal",position:f.value,start:Math.min(0,e.x),end:Math.max(this.artboardWidth,e.x+e.width)});break}}}return{dx:s,dy:r,guides:i}}snapResize(e){const i=e.clone(),{dx:s,dy:r,guides:n}=this.snapMove(i);return i.x+=s,i.y+=r,{corrected:i,guides:n}}snapPoint(e){const i=wl.SNAP_THRESHOLD/this.scale,s=[],r=e.clone(),n=[0,this.artboardWidth/2,this.artboardWidth];for(const a of n)if(Math.abs(a-e.x)<i){r.x=a,s.push({type:"vertical",position:a,start:0,end:this.artboardHeight});break}const o=[0,this.artboardHeight/2,this.artboardHeight];for(const a of o)if(Math.abs(a-e.y)<i){r.y=a,s.push({type:"horizontal",position:a,start:0,end:this.artboardWidth});break}return{p:r,guides:s}}}const tb={delta:new Ie};class a7 extends it{group;wireframe=new o7;selectionOutlines=new dt;isDragging=!1;lastPointer=new Ae;activeHandle=null;#e;#l=new Map;#i=new Ae;#r=0;#c=0;#u=new Se;#s=new Ae;#n=new Se;#t=[new Ae,new Ae,new Ae,new Ae];#o=1;#a=1;#h;#d=new dt;#m=new Ae;opts;constructor(e){super(),this.opts=e,this.group=e.group,this.eventMode="static",this.#h=new wl(e.artboardWidth??1920,e.artboardHeight??1080),this.addChild(this.#d);const i={beginDrag:(s,r)=>this.#T(s,r),updateDrag:(s,r)=>this.#k(s,r),endDrag:()=>this.#y()};this.#e={tl:new ji("tl","nwse-resize",i),tr:new ji("tr","nesw-resize",i),bl:new ji("bl","nesw-resize",i),br:new ji("br","nwse-resize",i),ml:new ji("ml","ew-resize",i),mr:new ji("mr","ew-resize",i),mt:new ji("mt","ns-resize",i),mb:new ji("mb","ns-resize",i),rot:new ji("rot","crosshair",{beginDrag:(s,r)=>this.#P(r),updateDrag:(s,r)=>this.#E(r),endDrag:()=>this.#y()})},this.addChild(this.selectionOutlines,this.wireframe,...Object.values(this.#e)),this.#_(),this.visible=!1,Gn.shared.addOnce(()=>{!this.destroyed&&this.parent&&(this.#f(),this.visible=!0)})}#_(){this.on("pointerdown",this.#w),this.on("pointerup",this.#v),this.on("pointerupoutside",this.#v),this.on("globalpointermove",this.#S)}#f(){if(this.group.length===1){const e=this.group[0];this.#r=e.rotation;const i=this.#g(e);let s,r;this.opts.clip?(s=this.opts.clip.width,r=this.opts.clip.height):(s=i.width,r=i.height);const n=e.toGlobal(new Ae(0,0));this.#i.set(n.x,n.y),this.#n.copyFrom(new Se(-s/2,-r/2,s,r))}else{let e=1/0,i=1/0,s=-1/0,r=-1/0;if(this.parent)for(const u of this.group){const c=this.#g(u);this.#t[0].set(c.x,c.y),this.#t[1].set(c.x+c.width,c.y),this.#t[2].set(c.x+c.width,c.y+c.height),this.#t[3].set(c.x,c.y+c.height);for(const h of this.#t)u.toGlobal(h,h),this.toLocal(h,void 0,h),e=Math.min(e,h.x),i=Math.min(i,h.y),s=Math.max(s,h.x),r=Math.max(r,h.y)}const n=s-e,o=r-i,a=e+n/2,l=i+o/2;if(this.#n.copyFrom(new Se(-n/2,-o/2,n,o)),this.parent){const u=this.toGlobal(new Ae(a,l));this.#i.set(u.x,u.y)}}this.#p()}#g(e){const i=e.children.filter(l=>l.label!=="ShadowContainer");if(i.length===0){const l=e.getLocalBounds();return new Se(l.minX,l.minY,l.maxX-l.minX,l.maxY-l.minY)}const s=i.find(l=>l.label==="MainSprite");if(s){const l=s.getLocalBounds(),u=s.localTransform,c=u.apply(new Ae(l.x,l.y)),h=u.apply(new Ae(l.x+l.width,l.y)),f=u.apply(new Ae(l.x+l.width,l.y+l.height)),d=u.apply(new Ae(l.x,l.y+l.height)),p=Math.min(c.x,h.x,f.x,d.x),m=Math.max(c.x,h.x,f.x,d.x),g=Math.min(c.y,h.y,f.y,d.y),y=Math.max(c.y,h.y,f.y,d.y);return new Se(p,g,m-p,y-g)}let r=1/0,n=1/0,o=-1/0,a=-1/0;for(const l of i){const u=l.getBounds(),c=e.toLocal(new Ae(u.minX,u.minY)),h=e.toLocal(new Ae(u.maxX,u.maxY));r=Math.min(r,c.x,h.x),n=Math.min(n,c.y,h.y),o=Math.max(o,c.x,h.x),a=Math.max(a,c.y,h.y)}return new Se(r,n,o-r,a-n)}updateBounds(){this.#f()}#w=e=>{this.#f(),this.#m.copyFrom(this.#i),this.isDragging=!0,this.lastPointer.copyFrom(e.global),this.cursor="grabbing"};#v=()=>{this.isDragging&&this.#y(),this.cursor="default"};#S=e=>{if(!this.isDragging||this.activeHandle||!this.parent)return;const{moveDx:i,moveDy:s,newPivotWorld:r}=this.#C(e);for(const n of this.group)n.x+=i,n.y+=s;this.#i.copyFrom(r),this.lastPointer.copyFrom(e.global),this.#p(),this.emit("transforming")};#C(e){const i=Math.abs(this.parent.worldTransform.a);this.#h.updateContext(this.opts.artboardWidth??1920,this.opts.artboardHeight??1080,i);const s=e.global.x-this.lastPointer.x,r=e.global.y-this.lastPointer.y;this.#m.x+=s,this.#m.y+=r;const n=this.parent.toLocal(this.#m),o=new Se(n.x+this.#n.x,n.y+this.#n.y,this.#n.width,this.#n.height),{dx:a,dy:l,guides:u}=this.#h.snapMove(o);this.#x(u,i);const c=n.x+a,h=n.y+l,f=this.parent.toLocal(this.#i),d=c-f.x,p=h-f.y,m=this.parent.toGlobal(new Ae(c,h));return{moveDx:d,moveDy:p,newPivotWorld:m}}#T(e,i){this.#f(),this.isDragging=!0,this.activeHandle=e,this.#l.clear();for(const s of this.group)this.#l.set(s,s.localTransform.clone());this.rotation=this.#r,this.#u.copyFrom(this.#n),this.#F(e)}#k(e,i){this.#A(e,i)}async#A(e,i){const{proposed:s,sx:r,sy:n,pivotWorld:o}=await this.#I(e,i),a=this.opts.clip&&this.opts.clip.type==="Text",l=this.opts.clip&&this.opts.clip.type==="Caption";a||l?this.emit("textClipResize",{handle:e,newWidth:s.width,newHeight:s.height,pivotWorld:o,proposed:s,sx:r,sy:n}):this.#b(this.#z(o,this.#r,r,n)),this.#n.copyFrom(s),this.#p(),this.emit("transforming")}async#I(e,i){const s=this.#s,r=this.#R(e,this.toLocal(i),s),n=this.parent?Math.abs(this.parent.worldTransform.a):1;this.#h.updateContext(this.opts.artboardWidth??1920,this.opts.artboardHeight??1080,n);const{dx:o,dy:a,guides:l}=this.#h.snapMove(r);r.x+=o,r.y+=a,this.#x(l,n);const u=r.width/this.#u.width,c=r.height/this.#u.height,h=this.toGlobal(s);return{proposed:r,sx:u,sy:c,pivotWorld:h}}#P(e){this.#f(),this.isDragging=!0,this.activeHandle="rot",this.#l.clear();for(const i of this.group)this.#l.set(i,i.localTransform.clone());this.#c=Math.atan2(e.y-this.#i.y,e.x-this.#i.x)}#E(e){const s=Math.atan2(e.y-this.#i.y,e.x-this.#i.x)-this.#c,r=this.#r+s;this.#b(this.#U(this.#i,s)),this.rotation=r,this.#p(r),this.emit("transforming")}#y(){this.isDragging=!1,this.#r=this.rotation,this.activeHandle=null,this.#d.clear(),this.#p(this.#r),this.emit("transformEnd")}#x(e,i){if(this.#d.clear(),!(!e.length||!this.parent)){this.#d.stroke({width:1/i,color:4774907});for(const s of e){let r,n;s.type==="vertical"?(r=new Ae(s.position,s.start),n=new Ae(s.position,s.end)):(r=new Ae(s.start,s.position),n=new Ae(s.end,s.position)),this.toLocal(r,this.parent,r),this.toLocal(n,this.parent,n),this.#d.moveTo(r.x,r.y).lineTo(n.x,n.y).stroke({width:1/i,color:4774907})}}}#p(e=this.#r){this.parent&&this.position.copyFrom(this.parent.toLocal(this.#i)),this.rotation=e;const s=1/((this.parent?Math.abs(this.parent.worldTransform.a):1)||1),r=this.#n;this.wireframe.draw(r,s);const n=r.x+r.width/2,o=r.y+r.height/2,a=this.opts.clip?.getVisibleHandles?.()??["tl","tr","bl","br","ml","mr","mt","mb","rot"],l=[this.#e.tl,this.#e.tr,this.#e.bl,this.#e.br,this.#e.ml,this.#e.mr,this.#e.mt,this.#e.mb,this.#e.rot];for(const u of l)u.scale.set(s);this.#e.tl.visible=a.includes("tl"),this.#e.tr.visible=a.includes("tr"),this.#e.bl.visible=a.includes("bl"),this.#e.br.visible=a.includes("br"),this.#e.ml.visible=a.includes("ml"),this.#e.mr.visible=a.includes("mr"),this.#e.mt.visible=a.includes("mt"),this.#e.mb.visible=a.includes("mb"),this.#e.rot.visible=a.includes("rot"),this.#e.tl.position.set(r.x,r.y),this.#e.tr.position.set(r.x+r.width,r.y),this.#e.bl.position.set(r.x,r.y+r.height),this.#e.br.position.set(r.x+r.width,r.y+r.height),this.#e.ml.position.set(r.x,o),this.#e.mr.position.set(r.x+r.width,o),this.#e.mt.position.set(n,r.y),this.#e.mb.position.set(n,r.y+r.height),this.#e.rot.position.set(n,r.y-30*s),this.#M(s)}#M(e){if(this.selectionOutlines.clear(),this.group.length<=1||!this.parent)return;const i={width:1*e,color:43775,alpha:1};for(const s of this.group){const r=this.#g(s);this.#t[0].set(r.x,r.y),this.#t[1].set(r.x+r.width,r.y),this.#t[2].set(r.x+r.width,r.y+r.height),this.#t[3].set(r.x,r.y+r.height);for(const n of this.#t)s.toGlobal(n,n),this.toLocal(n,void 0,n);this.selectionOutlines.moveTo(this.#t[0].x,this.#t[0].y).lineTo(this.#t[1].x,this.#t[1].y).lineTo(this.#t[2].x,this.#t[2].y).lineTo(this.#t[3].x,this.#t[3].y).closePath().stroke(i)}}#F(e){const i=this.#u;if(this.opts.centeredScaling){this.#s.set(i.x+i.width/2,i.y+i.height/2);return}e==="tl"?this.#s.set(i.x+i.width,i.y+i.height):e==="tr"?this.#s.set(i.x,i.y+i.height):e==="bl"?this.#s.set(i.x+i.width,i.y):e==="br"?this.#s.set(i.x,i.y):e==="ml"?this.#s.set(i.x+i.width,i.y+i.height/2):e==="mr"?this.#s.set(i.x,i.y+i.height/2):e==="mt"?this.#s.set(i.x+i.width/2,i.y+i.height):e==="mb"&&this.#s.set(i.x+i.width/2,i.y)}#R(e,i,s){if(this.opts.centeredScaling){const n=Math.max(this.#o,Math.abs(i.x-s.x)*2),o=Math.max(this.#a,Math.abs(i.y-s.y)*2);return new Se(s.x-n/2,s.y-o/2,n,o)}if(e==="tl"){const n=Math.min(i.x,s.x-this.#o),o=Math.min(i.y,s.y-this.#a);return new Se(n,o,s.x-n,s.y-o)}if(e==="tr"){const n=Math.max(i.x,s.x+this.#o),o=Math.min(i.y,s.y-this.#a);return new Se(s.x,o,n-s.x,s.y-o)}if(e==="bl"){const n=Math.min(i.x,s.x-this.#o),o=Math.max(i.y,s.y+this.#a);return new Se(n,s.y,s.x-n,o-s.y)}if(e==="br"){const n=Math.max(i.x,s.x+this.#o),o=Math.max(i.y,s.y+this.#a);return new Se(s.x,s.y,n-s.x,o-s.y)}const r=this.#u;if(e==="ml"){const n=Math.min(i.x,s.x-this.#o);return new Se(n,r.y,s.x-n,r.height)}if(e==="mr"){const n=Math.max(i.x,s.x+this.#o);return new Se(s.x,r.y,n-s.x,r.height)}if(e==="mt"){const n=Math.min(i.y,s.y-this.#a);return new Se(r.x,n,r.width,s.y-n)}if(e==="mb"){const n=Math.max(i.y,s.y+this.#a);return new Se(r.x,s.y,r.width,n-s.y)}return new Se(s.x,s.y,this.#o,this.#a)}#z(e,i,s,r){return tb.delta.identity().translate(-e.x,-e.y).rotate(-i).scale(s,r).rotate(i).translate(e.x,e.y)}#U(e,i){return tb.delta.identity().translate(-e.x,-e.y).rotate(i).translate(e.x,e.y)}#b(e){for(const i of this.group){const s=this.#l.get(i),r=i.parent;if(!s||!r)continue;const n=r.worldTransform.clone().invert(),o=r.worldTransform.clone().append(s),a=e.clone().append(o),l=n.clone().append(a);i.setFromMatrix(l)}}}class l7{constructor(e){this.studio=e}selectedClips=new Set;activeTransformer=null;interactiveClips=new Set;selectionGraphics=null;isDragSelecting=!1;dragSelectionStart=new Ae;isUpdatingTextRealtime=!1;textClipResizedWidth=null;textClipResizeHandle=null;textClipResizedSx=null;textClipResizedSy=null;init(e,i){this.selectionGraphics=new dt,this.selectionGraphics.visible=!1,this.selectionGraphics.zIndex=1e3,i.addChild(this.selectionGraphics),e.stage.eventMode="static",e.stage.hitArea=e.screen,e.stage.on("pointerdown",s=>this.onStagePointerDown(s)),e.stage.on("globalpointermove",s=>this.onStagePointerMove(s)),e.stage.on("pointerup",()=>this.onStagePointerUp()),e.stage.on("pointerupoutside",()=>this.onStagePointerUp())}onStagePointerDown(e){e.target===this.studio.pixiApp?.stage&&(e.shiftKey||this.deselectClip(),this.isDragSelecting=!0,this.studio.artboard?.toLocal(e.global,void 0,this.dragSelectionStart),this.selectionGraphics&&(this.selectionGraphics.clear(),this.selectionGraphics.visible=!0))}onStagePointerMove(e){if(this.isDragSelecting&&this.selectionGraphics&&this.studio.artboard){const i=this.studio.artboard.toLocal(e.global),s=Math.min(this.dragSelectionStart.x,i.x),r=Math.min(this.dragSelectionStart.y,i.y),n=Math.abs(i.x-this.dragSelectionStart.x),o=Math.abs(i.y-this.dragSelectionStart.y);this.selectionGraphics.clear(),this.selectionGraphics.rect(s,r,n,o).fill({color:703971,alpha:.3}),this.selectionGraphics.rect(s,r,n,o).stroke({width:2,color:703971})}}onStagePointerUp(){if(this.isDragSelecting&&this.selectionGraphics&&this.studio.artboard){const e=this.selectionGraphics.getBounds(),i=[],s=new Se(e.x,e.y,e.width,e.height);if(s.width>2||s.height>2){for(const r of this.studio.clips){const n=this.studio.spriteRenderers.get(r);if(!n)continue;const o=n.getRoot();if(!o||!o.visible)continue;const a=o.getBounds();s.x<a.x+a.width&&s.x+s.width>a.x&&s.y<a.y+a.height&&s.y+s.height>a.y&&i.push(r)}if(i.length>0)for(const r of i)this.selectClip(r,!0)}this.selectionGraphics.clear(),this.selectionGraphics.visible=!1,this.isDragSelecting=!1}}setupSpriteInteractivity(e){if(this.interactiveClips.has(e))return;const i=this.studio.spriteRenderers.get(e);if(i==null)return;const s=i.getRoot();s!=null&&(s.eventMode="static",s.cursor="pointer",s.on("pointerdown",r=>{const n=this.getTopmostClipAtPoint(r.global);n&&this.selectClip(n,r.shiftKey)}),this.interactiveClips.add(e))}getTopmostClipAtPoint(e){if(!this.studio.pixiApp)return null;let i=null,s=-1/0;for(const r of this.interactiveClips){const n=this.studio.spriteRenderers.get(r);if(!n)continue;const o=n.getRoot();if(!o||!o.visible)continue;const a=o.toLocal(e),l=o.getLocalBounds();a.x>=l.minX&&a.x<=l.maxX&&a.y>=l.minY&&a.y<=l.maxY&&r.zIndex>s&&(s=r.zIndex,i=r)}return i}selectClip(e,i=!1){if(!(this.studio.destroyed||this.studio.pixiApp==null)){if(i||this.deselectClip(),i&&this.selectedClips.has(e)){this.selectedClips.delete(e),this.recreateTransformer(),this.studio.emit("selection:updated",{selected:Array.from(this.selectedClips)});return}this.selectedClips.add(e),this.recreateTransformer(),i?this.studio.emit("selection:updated",{selected:Array.from(this.selectedClips)}):this.studio.emit("selection:created",{selected:Array.from(this.selectedClips)})}}selectClipsByIds(e){const i=this.studio.clips.filter(s=>e.includes(s.id));this.setSelection(i)}setSelection(e){if(!(this.studio.destroyed||this.studio.pixiApp==null)&&!(this.selectedClips.size===e.length&&e.every(i=>this.selectedClips.has(i)))){for(const i of this.selectedClips)this.syncSpriteToClipProperties(i);this.destroyTransformer(),this.selectedClips.clear();for(const i of e)this.selectedClips.add(i);this.selectedClips.size>0?(this.createTransformer(),this.studio.emit("selection:updated",{selected:Array.from(this.selectedClips)})):this.studio.emit("selection:cleared",{deselected:[]})}}deselectClip(){if(this.selectedClips.size>0)for(const i of this.selectedClips)this.syncSpriteToClipProperties(i);this.destroyTransformer();const e=Array.from(this.selectedClips);this.selectedClips.clear(),e.length>0&&this.studio.emit("selection:cleared",{deselected:e})}async move(e,i){if(this.selectedClips.size===0)return;const s=[];for(const r of this.selectedClips)s.push({id:r.id,updates:{left:(r.left??0)+e,top:(r.top??0)+i}});await this.studio.updateClips(s),this.activeTransformer&&this.activeTransformer.updateBounds()}clear(){this.deselectClip(),this.interactiveClips.clear()}recreateTransformer(){this.destroyTransformer(),this.selectedClips.size>0&&this.createTransformer()}destroyTransformer(){this.activeTransformer!=null&&(this.activeTransformer.parent!=null&&this.activeTransformer.parent.removeChild(this.activeTransformer),this.activeTransformer.destroy(),this.activeTransformer=null)}createTransformer(){if(this.studio.destroyed||this.studio.artboard==null||this.selectedClips.size===0)return;const e=[];let i=null;for(const r of this.selectedClips){const n=this.studio.spriteRenderers.get(r);if(n==null)continue;const o=n.getRoot();o!=null&&(e.push(o),this.selectedClips.size===1&&(i=r))}if(e.length===0){console.warn("Cannot create transformer: no sprites found");return}this.activeTransformer=new a7({group:e,clip:i,artboardWidth:this.studio.opts.width,artboardHeight:this.studio.opts.height});let s=null;this.activeTransformer.on("transforming",()=>{s===null&&(s=requestAnimationFrame(()=>{s=null,this.syncSelectedClipsTransformsRealtime()}))}),this.activeTransformer.on("textClipResize",r=>{this.textClipResizedWidth=r.newWidth,this.textClipResizeHandle=r.handle,this.textClipResizedSx=r.sx,this.textClipResizedSy=r.sy}),this.activeTransformer.on("transformEnd",async()=>{s!==null&&(cancelAnimationFrame(s),s=null),await this.syncSelectedClipsTransforms();for(const r of this.selectedClips)this.studio.emit("clip:updated",{clip:r})}),this.activeTransformer.on("pointerdown",r=>{const n=this.getTopmostClipAtPoint(r.global);n&&!this.selectedClips.has(n)&&(this.selectClip(n,r.shiftKey),r.stopPropagation())}),this.studio.artboard.addChild(this.activeTransformer)}async syncSelectedClipsTransformsRealtime(){if(!(this.selectedClips.size===0||this.activeTransformer==null)&&!this.isUpdatingTextRealtime){this.isUpdatingTextRealtime=!0;try{const e=this.activeTransformer.activeHandle;if(e!=="mr"&&e!=="ml")return;for(const i of this.selectedClips){if(!(i instanceof Li))continue;const s=this.studio.spriteRenderers.get(i);if(s==null)continue;const r=s.getRoot(),n=s.getSprite();if(r==null||n==null||n.texture==null)continue;const o=Math.abs(r.scale.x*n.scale.x);if(o===1)continue;const a=i.left,l=i.top,u=i.width,c=n.texture.width,h=o*c;await i.updateStyle({wordWrap:!0,wordWrapWidth:h});const f=await i.getTexture();f&&(await s.updateFrame(f),n.scale.set(1,1),r.scale.set(1,1),e==="ml"?i.left=a+u-i.width:i.left=a,i.top=l,r.x=i.left+i.width/2,r.y=i.top+i.height/2,this.activeTransformer.updateBounds())}}finally{this.isUpdatingTextRealtime=!1}}}async syncSelectedClipsTransforms(){if(!(this.selectedClips.size===0||this.activeTransformer==null)){for(const e of this.selectedClips){const i=this.studio.spriteRenderers.get(e);if(i==null)continue;const s=i.getRoot(),r=i.getSprite();if(s==null||r==null||r.texture==null)continue;const n=r.texture.width,o=r.texture.height,a=Math.abs(s.scale.x*r.scale.x)*n,l=Math.abs(s.scale.y*r.scale.y)*o,u=(e instanceof Li||e instanceof Ns)&&this.textClipResizedWidth!==null?this.textClipResizedWidth:a,c=e.width,f=(e.style?.fontSize??16)*Math.max(this.textClipResizedSx||1,this.textClipResizedSy||1);let d=s.x;if((e instanceof Li||e instanceof Ns)&&this.textClipResizedWidth!==null){const m={wordWrap:!0,wordWrapWidth:u};this.textClipResizeHandle==="mr"?(d=e.left+u/2,s.x=d):this.textClipResizeHandle==="ml"?(d=e.left+u/2-(u-c),s.x=d):["br","tr"].includes(this.textClipResizeHandle)?(d=e.left+u/2,m.fontSize=f):["bl","tl"].includes(this.textClipResizeHandle)&&(d=e.left+u/2-(u-c),m.fontSize=f),await e.updateStyle(m);const g=await e.getTexture();g&&(await i.updateFrame(g),e.width=u,e.height=g.height,this.textClipResizedWidth=null,e.left=d-e.width/2,e.top=s.y-e.height/2,r.scale.set(1,1),s.scale.set(1,1))}else{let m=a,g=l;e.left=s.x-m/2,e.top=s.y-g/2,e.width=m,e.height=g;const y=e.flip==null?1:-1;e.angle=y*s.angle}}this.activeTransformer!=null&&this.activeTransformer.updateBounds();for(const e of this.selectedClips){const i=this.studio.spriteRenderers.get(e);i?.updateTransforms()}}}syncSpriteToClipProperties(e){const i=this.studio.spriteRenderers.get(e);if(i!=null){const s=i.getRoot(),r=i.getSprite();if(s!=null&&r!=null&&r.texture!=null){const n=r.texture.width,o=r.texture.height,a=Math.abs(s.scale.x*r.scale.x)*n,l=Math.abs(s.scale.y*r.scale.y)*o;let u=a,c=l;const h=s.x-u/2,f=s.y-c/2;e.left=h,e.top=f,e.width=u,e.height=c;const d=e.flip==null?1:-1;e.angle=d*s.angle,i.updateTransforms(),this.studio.emit("clip:updated",{clip:e})}}}async deleteSelected(){return this.studio.deleteSelected()}}class c7{constructor(e){this.studio=e}isPlaying=!1;currentTime=0;maxDuration=0;playStartTime=0;playStartTimestamp=0;rafId=null;playbackElements=new Map;setMaxDuration(e){this.maxDuration=e}async play(){if(!(this.isPlaying||this.studio.destroyed)){if(this.maxDuration<=0||this.maxDuration===1/0||isNaN(this.maxDuration)){console.warn("Cannot play: invalid duration",this.maxDuration);return}this.isPlaying||(this.isPlaying=!0),this.playStartTime=this.currentTime,this.playStartTimestamp=performance.now();for(const[e,{element:i}]of this.playbackElements.entries()){if(!(this.currentTime>=e.display.from&&(e.display.to===0||this.currentTime<=e.display.to))){this.isPlaybackCapable(e)&&e.pause(i);continue}const r=(this.currentTime-e.display.from)/1e6;this.isPlaybackCapable(e)&&await e.play(i,r)}this.renderLoop(),this.studio.emit("play",{isPlaying:!0})}}pause(){this.isPlaying=!1,this.rafId!=null&&(cancelAnimationFrame(this.rafId),this.rafId=null);for(const[e,{element:i}]of this.playbackElements.entries())this.isPlaybackCapable(e)&&e.pause(i);this.studio.emit("pause",{isPlaying:!1})}async stop(){this.pause(),await this.seek(0)}async seek(e){if(this.studio.destroyed)return;const i=this.isPlaying;this.playStartTime=Math.max(0,Math.min(e,this.maxDuration)),this.playStartTimestamp=performance.now(),this.currentTime=this.playStartTime;for(const[s,{element:r}]of this.playbackElements.entries()){if(!(this.currentTime>=s.display.from&&(s.display.to===0||this.currentTime<=s.display.to))){this.isPlaybackCapable(s)&&s.pause(r);continue}const o=(this.currentTime-s.display.from)/1e6;this.isPlaybackCapable(s)&&await s.seek(r,o)}if(await this.studio.updateFrame(this.currentTime),this.studio.emit("currentTime",{currentTime:this.currentTime}),i){this.isPlaying=!0;for(const[s,{element:r}]of this.playbackElements.entries()){if(!(this.currentTime>=s.display.from&&(s.display.to===0||this.currentTime<=s.display.to)))continue;const o=(this.currentTime-s.display.from)/1e6;this.isPlaybackCapable(s)&&await s.play(r,o)}}}async frameNext(){const i=1e6/(this.studio.opts.fps||30),s=Math.min(this.currentTime+i,this.maxDuration);await this.seek(s)}async framePrev(){const i=1e6/(this.studio.opts.fps||30),s=Math.max(0,this.currentTime-i);await this.seek(s)}async renderLoop(){if(!this.isPlaying||this.studio.destroyed||this.studio.pixiApp==null)return;if(this.maxDuration<=0||this.maxDuration===1/0||isNaN(this.maxDuration)){this.pause();return}const e=async()=>{if(!this.isPlaying||this.studio.destroyed||this.studio.pixiApp==null)return;if(this.currentTime>=this.maxDuration){this.currentTime=this.maxDuration,this.pause();return}const s=(performance.now()-this.playStartTimestamp)*1e3;this.currentTime=Math.min(this.playStartTime+s,this.maxDuration),this.studio.emit("currentTime",{currentTime:this.currentTime});try{await this.studio.updateFrame(this.currentTime)}catch(r){console.warn("Error updating frame:",r)}this.isPlaying&&(this.rafId=requestAnimationFrame(e))};e()}isPlaybackCapable(e){return"play"in e&&"pause"in e&&"seek"in e}}class Wr{static instance;fonts=new Map;constructor(){}static getInstance(){return Wr.instance||(Wr.instance=new Wr),Wr.instance}async addFont(e){if(!this.fonts.has(e.name))try{const s=await new FontFace(e.name,`url(${e.url})`).load();document.fonts.add(s),this.fonts.set(e.name,s)}catch(i){console.error(`Failed to load font ${e.name}:`,i)}}async loadFonts(e){await Promise.all(e.map(i=>this.addFont(i)))}removeFont(e){const i=this.fonts.get(e);i&&(document.fonts.delete(i),this.fonts.delete(e))}clear(){this.fonts.forEach(e=>{document.fonts.delete(e)}),this.fonts.clear()}getLoadedFonts(){return Array.from(this.fonts.keys())}}const QS=Wr.getInstance();class u7{constructor(e){this.studio=e}tracks=[];clips=[];getTrackById(e){return this.tracks.find(i=>i.id===e)}getClipById(e){return this.clips.find(i=>i.id===e)}findTrackIdByClipId(e){for(const i of this.tracks)if(i.clipIds.includes(e))return i.id}getTrackIndex(e){return this.tracks.findIndex(i=>i.id===e)}addTrack(e,i){const s={id:e.id||`track_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e.name,type:e.type,clipIds:[]};return typeof i=="number"?this.tracks.splice(i,0,s):this.tracks.unshift(s),this.studio.emit("track:added",{track:s,index:i??0}),this.studio.emit("track:order-changed",{tracks:this.tracks}),s}async removeTrack(e){const i=this.tracks.findIndex(n=>n.id===e);if(i===-1)return;const r=[...this.tracks[i].clipIds];for(const n of r)await this.removeClipById(n);this.tracks.splice(i,1),this.studio.emit("track:removed",{trackId:e}),this.studio.emit("track:order-changed",{tracks:this.tracks})}async moveTrack(e,i){const s=this.tracks.findIndex(n=>n.id===e);if(s===-1)return;const r=this.tracks[s];this.tracks.splice(s,1),this.tracks.splice(i,0,r),this.studio.emit("track:order-changed",{tracks:this.tracks}),await this.studio.updateFrame(this.studio.currentTime)}async setTrackOrder(e){const i=[],s=new Map(this.tracks.map(r=>[r.id,r]));for(const r of e){const n=s.get(r);n&&i.push(n)}i.length!==this.tracks.length&&console.warn("[Studio] setTrackOrder: invalid track IDs provided, order not updated fully"),this.tracks=i,this.studio.emit("track:order-changed",{tracks:this.tracks}),await this.studio.updateFrame(this.studio.currentTime)}async addTransition(e,i=2e6,s,r){if(this.studio.destroyed)return;let n=null,o=null;if(s&&r&&(n=this.getClipById(s)??null,o=this.getClipById(r)??null),!n||!o){console.warn("[Studio] Invalid fromClipId or toClipId",{fromClipId:s,toClipId:r});return}await Promise.all([n.ready,o.ready]);const a=i,l=o.display.from-a/2,u=l+a,c={key:e,name:e,duration:a,fromClipId:n.id,toClipId:o.id,start:Math.max(0,l),end:u},h=this.findTrackIdByClipId(o.id);if(h){const p=this.tracks.find(m=>m.id===h);if(p){const m=p.clipIds.map(g=>this.getClipById(g)).filter(g=>{if(!g||g.type!=="Transition")return!1;const y=g;return y.fromClipId===n.id&&y.toClipId===o.id});for(const g of m)await this.removeClip(g)}}const f=`${n.id}_${o.id}`;this.studio.transitionRenderers.has(f)&&(this.studio.transitionRenderers.get(f)?.destroy(),this.studio.transitionRenderers.delete(f)),n.transition={...c},o.transition={...c};const d=new Ms(e);d.duration=a,d.fromClipId=Math.max(0,l)===0?null:n.id,d.toClipId=o.id,d.fromClipId===null&&n&&(d.fromClipId=n.id),d.display.from=Math.max(0,l),d.display.to=u,await this.addClip(d,{trackId:h}),this.studio.seek(this.studio.currentTime)}async addClip(e,i){const s=Array.isArray(e)?e:[e];if(s.length===0)return;const{trackId:r,audioSource:n}=this.normalizeAddClipOptions(i);if(this.studio.destroyed)return;if(this.studio.pixiApp==null)throw new Error("Failed to initialize Pixi.js Application");const o=[];for(const a of s)await this.prepareClipForTimeline(a,r),o.push(a);await this.recalculateMaxDuration();for(const a of o)await this.setupClipVisuals(a,n);await this.studio.updateFrame(this.studio.currentTime),this.emitAddClipEvents(o,r)}normalizeAddClipOptions(e){let i,s;if(e&&(typeof e=="string"||e instanceof File||e instanceof Blob))i=e;else if(typeof e=="object"&&e!==null&&!("size"in e)){const r=e;i=r.audioSource,s=r.trackId}return{trackId:s,audioSource:i}}async prepareClipForTimeline(e,i){e.id||(e.id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),this.clips.includes(e)||this.clips.push(e),this.addClipToTrack(e,i);const s=async()=>{await this.studio.updateFrame(this.studio.currentTime);const r=this.studio.selection;r.activeTransformer!=null&&r.selectedClips.has(e)&&typeof r.activeTransformer.updateBounds=="function"&&r.activeTransformer.updateBounds()};e.on("propsChange",s),this.studio.clipListeners.set(e,s),this.studio.pixiApp!=null&&typeof e.setRenderer=="function"&&e.setRenderer(this.studio.pixiApp.renderer),await e.ready}addClipToTrack(e,i){if(i){const s=this.tracks.find(r=>r.id===i);if(s)s.clipIds.includes(e.id)||s.clipIds.push(e.id);else{const r={id:i,name:`Track ${this.tracks.length+1}`,type:e.type,clipIds:[e.id]};this.tracks.unshift(r),this.studio.emit("track:added",{track:r,index:0}),this.studio.emit("track:order-changed",{tracks:this.tracks})}}else{const r={id:`track_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:`Track ${this.tracks.length+1}`,type:e.type,clipIds:[e.id]};this.tracks.unshift(r),this.studio.emit("track:added",{track:r,index:0}),this.studio.emit("track:order-changed",{tracks:this.tracks})}}async setupClipVisuals(e,i){const s=this.studio.spriteRenderers.get(e);if(s){const n=this.studio.clipsNormalContainer,o=s.getRoot();o&&!o.parent&&n.addChild(o);return}const r=await e.ready;if(await this.setupPlaybackForClip(e,i),r.width>0&&r.height>0){const n=this.studio.clipsNormalContainer,o=e.type==="Video"&&this.isPlaybackCapable(e);if(!o||o&&e.tickInterceptor!=null){const a=new rG(this.studio.pixiApp,e,n);this.studio.spriteRenderers.set(e,a)}}this.studio.opts.interactivity&&this.studio.selection.setupSpriteInteractivity(e)}emitAddClipEvents(e,i){if(e.length!==0)if(e.length===1){const s=e[0],r=i||this.tracks.find(n=>n.clipIds.includes(s.id))?.id||"";this.studio.emit("clip:added",{clip:s,trackId:r})}else this.studio.emit("clips:added",{clips:e,trackId:i})}async removeClip(e,i={permanent:!0}){const{permanent:s}=i,r=this.clips.findIndex(c=>c===e);if(r===-1)return;if(e instanceof Ms){if(e.fromClipId){const c=this.getClipById(e.fromClipId);c&&"transition"in c&&delete c.transition}if(e.toClipId){const c=this.getClipById(e.toClipId);c&&"transition"in c&&delete c.transition}}this.studio.selection.selectedClips.has(e)&&this.studio.selection.deselectClip(),this.clips.splice(r,1);const n=[];for(const c of this.tracks){const h=c.clipIds.indexOf(e.id);h!==-1&&(c.clipIds.splice(h,1),n.push(c.id))}for(const c of n){const h=this.tracks.findIndex(f=>f.id===c);h!==-1&&this.tracks[h].clipIds.length===0&&(this.tracks.splice(h,1),this.studio.emit("track:removed",{trackId:c}))}this.studio.selection.interactiveClips.delete(e);const o=this.studio.clipListeners.get(e);o&&(e.off("propsChange",o),this.studio.clipListeners.delete(e));const a=this.studio.spriteRenderers.get(e);if(a!=null)if(s)a.destroy(),this.studio.spriteRenderers.delete(e);else{const c=a.getRoot();c&&c.parent&&c.parent.removeChild(c)}const l=this.studio.transport.playbackElements.get(e);l!=null&&s&&this.isPlaybackCapable(e)&&(e.cleanupPlayback(l.element,l.objectUrl),this.studio.transport.playbackElements.delete(e));const u=this.studio.videoSprites.get(e);u!=null&&this.studio.pixiApp!=null&&(u.parent&&u.parent.removeChild(u),s&&(u.destroy(),this.studio.videoSprites.delete(e))),await this.recalculateMaxDuration(),this.studio.emit("clip:removed",{clipId:e.id})}async removeClips(e,i={permanent:!0}){if(e.length!==0){for(const s of e){const r=this.clips.findIndex(u=>u===s);if(r===-1)continue;if(s instanceof Ms){if(s.fromClipId){const u=this.getClipById(s.fromClipId);u&&"transition"in u&&delete u.transition}if(s.toClipId){const u=this.getClipById(s.toClipId);u&&"transition"in u&&delete u.transition}}this.studio.selection.selectedClips.has(s)&&this.studio.selection.deselectClip(),this.clips.splice(r,1);for(const u of this.tracks){const c=u.clipIds.indexOf(s.id);c!==-1&&u.clipIds.splice(c,1)}this.studio.selection.interactiveClips.delete(s);const n=this.studio.clipListeners.get(s);n&&(s.off("propsChange",n),this.studio.clipListeners.delete(s));const o=this.studio.spriteRenderers.get(s);if(o!=null)if(i.permanent)o.destroy(),this.studio.spriteRenderers.delete(s);else{const u=o.getRoot();u&&u.parent&&u.parent.removeChild(u)}const a=this.studio.transport.playbackElements.get(s);a!=null&&i.permanent&&this.isPlaybackCapable(s)&&(s.cleanupPlayback(a.element,a.objectUrl),this.studio.transport.playbackElements.delete(s));const l=this.studio.videoSprites.get(s);l!=null&&this.studio.pixiApp!=null&&(l.parent&&l.parent.removeChild(l),i.permanent&&(l.destroy(),this.studio.videoSprites.delete(s)))}for(let s=this.tracks.length-1;s>=0;s--)if(this.tracks[s].clipIds.length===0){const r=this.tracks[s].id;this.tracks.splice(s,1),this.studio.emit("track:removed",{trackId:r})}await this.recalculateMaxDuration(),this.studio.emit("clips:removed",{clipIds:e.map(s=>s.id)})}}async removeClipById(e){const i=this.clips.find(s=>s.id===e);i&&await this.removeClip(i)}async updateClip(e,i){const s=this.clips.find(r=>r.id===e);s&&(await this.applyClipUpdate(s,i),await this.recalculateMaxDuration(),await this.studio.updateFrame(this.studio.currentTime),this.updateTransformer(s),this.studio.emit("clip:updated",{clip:s}))}async updateClips(e){const i=[];for(const{id:s,updates:r}of e){const n=this.clips.find(o=>o.id===s);n&&(await this.applyClipUpdate(n,r),i.push(n))}if(i.length!==0){await this.recalculateMaxDuration(),await this.studio.updateFrame(this.studio.currentTime);for(const s of i)this.updateTransformer(s),this.studio.emit("clip:updated",{clip:s})}}async replaceClipsBySource(e,i){const s=this.clips.filter(r=>r.src===e);if(s.length!==0){this.studio.suspendRendering();for(const r of s){if(!this.clips.includes(r))continue;const n=this.findTrackIdByClipId(r.id);if(!n)continue;const o=this.getTrackById(n);if(!o)continue;const a=await i(r),l=async()=>{await this.studio.updateFrame(this.studio.currentTime),this.updateTransformer(a)};a.on("propsChange",l),this.studio.clipListeners.set(a,l),this.studio.pixiApp!=null&&typeof a.setRenderer=="function"&&a.setRenderer(this.studio.pixiApp.renderer),await a.ready;const u=this.clips.indexOf(r);u!==-1&&(this.clips[u]=a);const c=o.clipIds.indexOf(r.id);c!==-1&&(o.clipIds[c]=a.id),await this.setupClipVisuals(a);const h=this.studio.spriteRenderers.get(r);h&&(h.destroy(),this.studio.spriteRenderers.delete(r));const f=this.studio.videoSprites.get(r);f&&(f.parent&&f.parent.removeChild(f),f.destroy(),this.studio.videoSprites.delete(r));const d=this.studio.clipListeners.get(r);d&&(r.off("propsChange",d),this.studio.clipListeners.delete(r)),this.studio.selection.selectedClips.has(r)&&(this.studio.selection.selectedClips.delete(r),this.studio.selection.selectedClips.add(a)),this.studio.emit("clip:replaced",{oldClip:r,newClip:a,trackId:n})}await this.recalculateMaxDuration(),this.studio.resumeRendering(),await this.studio.updateFrame(this.studio.currentTime)}}async applyClipUpdate(e,i){if(e instanceof Li&&(await e.updateStyle(i),"style"in i&&delete i.style),Object.assign(e,i),i.display&&!i.duration?e.duration=i.display.to-i.display.from:i.duration&&(!i.display||!i.display.to)&&(e.display||(e.display={from:0,to:i.duration}),e.display.to=e.display.from+i.duration),i.display&&i.duration){const s=i.display.to-i.display.from;s!==i.duration&&(e.duration=s)}else e.display&&(e.display.to=e.display.from+e.duration)}updateTransformer(e){const i=this.studio.selection;i.selectedClips.has(e)&&i.activeTransformer&&i.activeTransformer.updateBounds()}exportToJSON(){const e=this.clips.map(r=>wm(r,!1)),i=this.tracks.map(r=>({id:r.id,name:r.name,type:r.type,clipIds:[...r.clipIds]})),s=[];return this.clips.forEach(r=>{if(r.transition){const n=this.tracks.find(o=>o.clipIds.includes(r.id));if(n){const o=n.clipIds.indexOf(r.id);if(o>0){const a=n.clipIds[o-1];s.push({key:r.transition.name,duration:r.transition.duration,clips:[a,r.id]})}}}}),{tracks:i,clips:e,settings:{width:this.studio.opts.width,height:this.studio.opts.height,fps:this.studio.opts.fps,bgColor:this.studio.opts.bgColor}}}async loadFromJSON(e){if(await this.clear(),e.settings){const s=e.settings.width&&e.settings.width!==this.studio.opts.width||e.settings.height&&e.settings.height!==this.studio.opts.height;if(e.settings.width&&(this.studio.opts.width=e.settings.width),e.settings.height&&(this.studio.opts.height=e.settings.height),e.settings.fps&&(this.studio.opts.fps=e.settings.fps),e.settings.bgColor&&(this.studio.opts.bgColor=e.settings.bgColor),s&&this.studio.pixiApp!=null){const r=this.studio.opts.width,n=this.studio.opts.height;this.studio.pixiApp.renderer.resize(r,n),this.studio.opts.canvas&&(this.studio.opts.canvas.width=r,this.studio.opts.canvas.height=n)}}const i=[];if(e.clips){await this.ensureFontsForClips(e.clips);const s=e.clips.map(o=>o.src).filter(o=>o&&o.trim()!=="");await this.studio.resourceManager.preload(s);const r=new Map;if(e.tracks){for(const o of e.tracks)if(o.clipIds)for(const a of o.clipIds)r.set(a,o.id)}if(e.tracks)for(const o of e.tracks)this.tracks.push({id:o.id,name:o.name,type:o.type,clipIds:[]});for(const o of e.clips)i.push((async()=>{try{let a=o.id?r.get(o.id):void 0;if(o.type==="Transition"){const u=o,c=u.toClipId||u.fromClipId;c&&(a=r.get(c))}if(o.type!=="Text"&&o.type!=="Caption"&&o.type!=="Effect"&&o.type!=="Transition"&&(!o.src||o.src.trim()===""))return console.warn(`Skipping clip ${o.type} with empty source`,o),{clip:null};const l=await Va(o);return(l.type==="Video"||l.type==="Image")&&(!o.width||!o.height)&&this.studio.opts.width&&this.studio.opts.height&&(typeof l.scaleToFit=="function"&&await l.scaleToFit(this.studio.opts.width,this.studio.opts.height),typeof l.centerInScene=="function"&&l.centerInScene(this.studio.opts.width,this.studio.opts.height)),{clip:l,intendedTrackId:a}}catch(a){return console.error(`Failed to load clip ${o.id||"unknown"}:`,a),{clip:null}}})());const n=await Promise.all(i);for(const{clip:o,intendedTrackId:a}of n)o&&(o.id||(o.id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),this.clips.push(o),this.addClipToTrack(o,a))}this.studio.pixiApp&&await Promise.all(this.clips.map(async s=>{const r=async()=>{await this.studio.updateFrame(this.studio.currentTime);const n=this.studio.selection;n.activeTransformer!=null&&n.selectedClips.has(s)&&typeof n.activeTransformer.updateBounds=="function"&&n.activeTransformer.updateBounds()};s.on("propsChange",r),this.studio.clipListeners.set(s,r),typeof s.setRenderer=="function"&&s.setRenderer(this.studio.pixiApp.renderer),await s.ready,await this.setupClipVisuals(s)}));for(const s of this.clips){const r=s.effects;if(Array.isArray(r))for(const n of r)this.studio.globalEffects.has(n.id)||this.studio.globalEffects.set(n.id,{id:n.id,key:n.key,startTime:n.startTime,duration:n.duration})}for(const s of this.clips)if(s instanceof Ms){const r={name:s.transitionEffect.key,key:s.transitionEffect.key,duration:s.duration,fromClipId:s.fromClipId,toClipId:s.toClipId,start:s.display.from,end:s.display.to};if(s.fromClipId){const n=this.getClipById(s.fromClipId);n&&(n.transition={...r})}if(s.toClipId){const n=this.getClipById(s.toClipId);n&&(n.transition={...r})}}await this.recalculateMaxDuration();try{await this.studio.updateFrame(this.studio.currentTime)}catch(s){console.error("[Studio] Failed to update initial frame:",s)}this.studio.emit("studio:restored",{clips:this.clips,tracks:this.tracks,settings:this.studio.opts})}async deleteSelected(){const e=this.studio.selection.selectedClips,i=Array.from(e);if(i.length!==0)for(const s of i)await this.removeClip(s)}async duplicateSelected(){const e=this.studio.selection.selectedClips,i=Array.from(e);if(i.length===0)return;const s=[];for(const r of i){const n=this.findTrackIdByClipId(r.id);if(!n)continue;const o=this.tracks.find(h=>h.id===n);if(!o)continue;const a=wm(r,!1),l=await Va(a);l.id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const u=`track_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=`${o.name} (Copy)`;this.addTrack({id:u,name:c,type:o.type}),await this.addClip(l,{trackId:u}),s.push(l.id)}s.length>0&&this.studio.selection.selectClipsByIds(s)}async splitSelected(e){const i=Array.from(this.studio.selection.selectedClips);if(i.length!==1){console.warn("[Studio] Split requires exactly one selected clip");return}const s=i[0],r=e??this.studio.currentTime;if(r<=s.display.from||s.display.to>0&&r>=s.display.to){console.warn("[Studio] Split time is outside clip bounds");return}const n=wm(s,!1),o=r-s.display.from,a=s.playbackRate||1,l=o*a,u={duration:o,display:{from:s.display.from,to:r}};s.trim&&(u.trim={from:s.trim.from,to:s.trim.from+l}),await this.updateClip(s.id,u);const c={...n};c.display={from:r,to:n.display.to},c.duration=n.duration-o,c.trim&&(c.trim={from:c.trim.from+l,to:c.trim.to});const h=await Va(c);h.id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const f=this.findTrackIdByClipId(s.id);f&&(await this.addClip(h,{trackId:f}),this.studio.selection.selectClipsByIds([h.id]))}async trimSelected(e){const i=Array.from(this.studio.selection.selectedClips);if(i.length!==1){console.warn("[Studio] Trim requires exactly one selected clip");return}const s=i[0],r=e*1e6,n=s.playbackRate||1,o=r*n;if(r>=s.duration){console.warn("[Studio] Trim amount exceeds clip duration");return}const a=s.duration-r,l=s.display.from+r,u=s.display.to,c={duration:a,display:{from:l,to:u}};if(s.trim)c.trim={from:s.trim.from+o,to:s.trim.to};else{const h=s.sourceDuration||s.duration;c.trim={from:o,to:h}}await this.updateClip(s.id,c)}async updateSelected(e){const i=Array.from(this.studio.selection.selectedClips);if(i.length!==0)for(const s of i)await this.updateClip(s.id,e)}async setTracks(e){this.tracks=JSON.parse(JSON.stringify(e)),await this.recalculateMaxDuration(),await this.studio.updateFrame(this.studio.currentTime)}async ensureFontsForClips(e){const i=new Map;for(const s of e){if(s.type==="Text"){const r=s.style?.fontUrl||s.fontUrl;r&&i.set(r,{name:s.style?.fontFamily||s.fontFamily||"CustomFont",url:r})}if(s.type==="Caption"){const r=s.style?.fontUrl||s.fontUrl;r&&i.set(r,{name:s.style?.fontFamily||s.fontFamily||"CustomFont",url:r})}}if(i.size>0)try{await QS.loadFonts(Array.from(i.values()))}catch(s){console.warn("Failed to load some fonts:",s)}}async recalculateMaxDuration(){let e=0;for(const i of this.clips){i.display.to===0&&i.duration!==1/0&&!isNaN(i.duration)&&i.duration>0;const s=i.duration>0?i.duration:0;if(s===1/0)continue;const r=i.display.to>0?i.display.to:i.display.from+s;r>e&&(e=r)}this.studio.maxDuration=e}async setupPlaybackForClip(e,i){if(this.studio.pixiApp!=null&&this.isPlaybackCapable(e))try{const s=e;if(e.type==="Audio"&&i&&typeof i!="string"){const o=URL.createObjectURL(i);e.src=o}const{element:r,objectUrl:n}=await s.createPlaybackElement();if(e.type==="Video"){const o=xe.from(r),a=new Zt(o);a.visible=!1,this.studio.clipsNormalContainer&&this.studio.clipsNormalContainer.addChild(a),this.studio.videoSprites.set(e,a)}this.studio.transport.playbackElements.set(e,{element:r,objectUrl:n})}catch(s){console.warn(`Failed to setup playback for ${e.constructor.name}`,s)}}isPlaybackCapable(e){return"createPlaybackElement"in e&&"play"in e&&"pause"in e&&"seek"in e&&"syncPlayback"in e&&"cleanupPlayback"in e}async clear(){this.studio.selection.deselectClip(),this.studio.selection.interactiveClips.clear();for(const[e,i]of this.studio.clipListeners)e.off("propsChange",i);this.studio.clipListeners.clear(),this.studio.globalEffects.clear(),this.studio.effectFilters.clear(),this.studio.transitionRenderers.forEach(e=>e.destroy()),this.studio.transitionRenderers.clear(),this.studio.transitionSprites.forEach(e=>{e.parent&&e.parent.removeChild(e),e.destroy()}),this.studio.transitionSprites.clear(),this.studio.spriteRenderers.forEach(e=>e.destroy()),this.studio.spriteRenderers.clear();for(const[e,i]of this.studio.transport.playbackElements)this.isPlaybackCapable(e)&&e.cleanupPlayback(i.element,i.objectUrl);this.studio.transport.playbackElements.clear();for(const e of this.studio.videoSprites.values())e.destroy();this.studio.videoSprites.clear(),this.tracks=[],this.clips=[],this.studio.maxDuration=0,this.studio.currentTime=0,this.studio.emit("reset")}async rippleDelete(e,i){if(e>=i)return;const s=i-e,r=[...this.clips];for(const n of r){const o=n.display.from,a=n.display.to;if(!(a<=e)){if(o>=i){await this.updateClip(n.id,{display:{from:n.display.from-s,to:n.display.to-s}});continue}if(o>=e&&a<=i){await this.removeClip(n);continue}if(o<e&&a>i){const l=await n.clone();l.id=`clip_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const u=e,c=e+(a-i),h=n.trim.from+(i-o)*n.playbackRate,f=n.trim.to,d=this.tracks.find(p=>p.clipIds.includes(n.id));d&&(await this.addClip(l,{trackId:d.id}),await this.updateClip(l.id,{display:{from:u,to:c},trim:{from:h,to:f}})),await this.updateClip(n.id,{display:{from:n.display.from,to:e},trim:{from:n.trim.from,to:n.trim.from+(e-o)*n.playbackRate}});continue}if(o<e&&a<=i){await this.updateClip(n.id,{display:{from:n.display.from,to:e},trim:{from:n.trim.from,to:n.trim.from+(e-o)*n.playbackRate}});continue}if(o>=e&&a>i){await this.updateClip(n.id,{display:{from:e,to:e+(a-i)},trim:{from:n.trim.from+(i-o)*n.playbackRate,to:n.trim.to}});continue}}}await this.recalculateMaxDuration(),await this.studio.updateFrame(this.studio.currentTime)}}const h7={Date:!0,RegExp:!0,String:!0,Number:!0};function eC(t,e,i={cyclesFix:!0},s=[]){let r=[];const n=Array.isArray(t);for(const a in t){const l=t[a],u=n?+a:a;if(!(a in e)){r.push({type:"REMOVE",path:[u],oldValue:t[a]});continue}const c=e[a],h=typeof l=="object"&&typeof c=="object"&&Array.isArray(l)===Array.isArray(c);l&&c&&h&&!h7[Object.getPrototypeOf(l)?.constructor?.name]&&(!i.cyclesFix||!s.includes(l))?r.push.apply(r,eC(l,c,i,i.cyclesFix?s.concat([l]):[]).map(f=>(f.path.unshift(u),f))):l!==c&&!(Number.isNaN(l)&&Number.isNaN(c))&&!(h&&(isNaN(l)?l+""==c+"":+l==+c))&&r.push({path:[u],type:"CHANGE",value:c,oldValue:l})}const o=Array.isArray(e);for(const a in e)a in t||r.push({type:"CREATE",path:[o?+a:a],value:e[a]});return r}class d7{past=[];future=[];lastState=null;maxSize;constructor(e={}){this.maxSize=e.maxSize||50}projectToHistoryState(e){const i={},s=JSON.parse(JSON.stringify(e.tracks||[]));return e.clips.forEach(r=>{r.id&&(i[r.id]=JSON.parse(JSON.stringify(r)))}),{clips:i,tracks:s,settings:JSON.parse(JSON.stringify(e.settings||{}))}}init(e){this.lastState=this.projectToHistoryState(JSON.parse(JSON.stringify(e))),this.past=[],this.future=[]}push(e){if(!this.lastState){this.init(e);return}const i=this.projectToHistoryState(JSON.parse(JSON.stringify(e))),s=eC(this.lastState,i);s.length!==0&&(this.past.push(s),this.past.length>this.maxSize&&this.past.shift(),this.future=[],this.lastState=i)}undo(e){const i=this.past.pop();if(!i)return null;const s=this.projectToHistoryState(JSON.parse(JSON.stringify(e))),r=this.applyPatches(s,i,!0);return this.future.push(i),this.lastState=r,{patches:i,state:r}}redo(e){const i=this.future.pop();if(!i)return null;const s=this.projectToHistoryState(JSON.parse(JSON.stringify(e))),r=this.applyPatches(s,i,!1);return this.past.push(i),this.lastState=r,{patches:i,state:r}}applyPatches(e,i,s){const r=JSON.parse(JSON.stringify(e)),n=s?[...i].reverse():i;for(const o of n){const{type:a,path:l}=o,u=o.value,c=o.oldValue;let h=r,f=!1;for(let p=0;p<l.length-1;p++){if(h[l[p]]===void 0||h[l[p]]===null){f=!0;break}h=h[l[p]]}if(f)continue;const d=l[l.length-1];if(s)switch(a){case"CREATE":Array.isArray(h)?h.splice(d,1):delete h[d];break;case"REMOVE":h[d]=c&&typeof c=="object"?JSON.parse(JSON.stringify(c)):c;break;case"CHANGE":h[d]=c&&typeof c=="object"?JSON.parse(JSON.stringify(c)):c;break}else switch(a){case"CREATE":h[d]=u&&typeof u=="object"?JSON.parse(JSON.stringify(u)):u;break;case"REMOVE":Array.isArray(h)?h.splice(d,1):delete h[d];break;case"CHANGE":h[d]=u&&typeof u=="object"?JSON.parse(JSON.stringify(u)):u;break}}return r}canUndo(){return this.past.length>0}canRedo(){return this.future.length>0}}class f7 extends _2{selection;transport;timeline;history;resourceManager;pixiApp=null;get tracks(){return this.timeline.tracks}get clips(){return this.timeline.clips}spriteRenderers=new Map;artboard=null;clipContainer=null;artboardMask=null;artboardBg=null;get activeTransformer(){return this.selection.activeTransformer}set activeTransformer(e){this.selection.activeTransformer=e}get selectedClips(){return this.selection.selectedClips}set selectedClips(e){this.selection.selectedClips=e}get interactiveClips(){return this.selection.interactiveClips}set interactiveClips(e){this.selection.interactiveClips=e}get playbackElements(){return this.transport.playbackElements}videoSprites=new Map;clipListeners=new Map;get isPlaying(){return this.transport.isPlaying}set isPlaying(e){this.transport.isPlaying=e}get currentTime(){return this.transport.currentTime}set currentTime(e){this.transport.currentTime=e}get maxDuration(){return this.transport.maxDuration}set maxDuration(e){this.transport.maxDuration=e}opts;destroyed=!1;renderingSuspended=!1;historyPaused=!1;processingHistory=!1;historyGroupDepth=0;clipCache=new Map;_isUpdatingLayout=!1;globalEffects=new Map;activeGlobalEffect=null;currentGlobalEffectSprite=null;effectFilters=new Map;transitionRenderers=new Map;transitionSprites=new Map;transFromTexture=null;transToTexture=null;transBgGraphics=null;clipsNormalContainer=null;clipsEffectContainer=null;videoTextureCache=new WeakMap;lastFromFrame=null;lastToFrame=null;hexToNumber(e){const i=e.startsWith("#")?e.slice(1):e;return parseInt(i,16)}ready;constructor(e){super(),this.opts={fps:30,bgColor:"#000000",interactivity:!0,spacing:0,...e},this.selection=new l7(this),this.transport=new c7(this),this.timeline=new u7(this),this.history=new d7,this.resourceManager=new sn,this.ready=this.initPixiApp().then(()=>{this.history.init(this.exportToJSON())}),this.on("clip:removed",this.handleClipRemoved),this.on("clips:removed",this.handleClipsRemoved),this.on("clip:updated",this.handleTimelineChange),this.on("clip:added",this.handleTimelineChange),this.on("clips:added",this.handleTimelineChange),this.on("track:removed",this.handleTimelineChange),this.on("track:added",this.handleTimelineChange)}handleTimelineChange=()=>{this.updateFrame(this.currentTime),this.saveHistory()};saveHistory(){this.historyPaused||this.processingHistory||(this.history.push(this.exportToJSON()),this.emit("history:changed",{canUndo:this.history.canUndo(),canRedo:this.history.canRedo()}))}beginHistoryGroup(){this.historyGroupDepth++,this.historyPaused=!0}endHistoryGroup(){this.historyGroupDepth=Math.max(0,this.historyGroupDepth-1),this.historyGroupDepth===0&&(this.historyPaused=!1,this.saveHistory())}setPath(e,i,s){let r=e;for(let n=0;n<i.length-1;n++){const o=i[n];r[o]||(r[o]=typeof i[n+1]=="number"?[]:{}),r=r[o]}r[i[i.length-1]]=s}async applyHistoryPatches(e,i,s){const r=new Map,n=new Map,o=new Set;for(const a of e){const{type:l,path:u}=a,c=a.value,h=a.oldValue;if(u[0]==="clips"){const f=u[1];s?l==="CREATE"?o.add(f):l==="REMOVE"?n.set(f,h):l==="CHANGE"&&(r.has(f)||r.set(f,{}),this.setPath(r.get(f),u.slice(2),h)):l==="CREATE"?n.set(f,c):l==="REMOVE"?o.add(f):l==="CHANGE"&&(r.has(f)||r.set(f,{}),this.setPath(r.get(f),u.slice(2),c))}else u[0]==="settings"&&(s?this.setPath(this.opts,u.slice(1),h):this.setPath(this.opts,u.slice(1),c))}for(const a of o){const l=this.timeline.getClipById(a);l&&await this.removeClip(l)}for(const[a,l]of n){let u=this.clipCache.get(a);u||(u=await Va(l),this.clipCache.set(a,u));let c;for(const h of i.tracks)if(h.clipIds.includes(a)){c=h.id;break}await this.addClip(u,{trackId:c})}for(const[a,l]of r)await this.updateClip(a,l);this.timeline.setTracks(i.tracks),this.emit("studio:restored",{clips:this.clips,tracks:this.tracks,settings:this.opts})}async undo(){if(!(!this.history.canUndo()||this.processingHistory)){this.processingHistory=!0,this.historyPaused=!0;try{const e=this.history.undo(this.exportToJSON());e&&await this.applyHistoryPatches(e.patches,e.state,!0),this.emit("history:changed",{canUndo:this.history.canUndo(),canRedo:this.history.canRedo()})}finally{this.historyPaused=!1,this.processingHistory=!1}}}async redo(){if(!(!this.history.canRedo()||this.processingHistory)){this.processingHistory=!0,this.historyPaused=!0;try{const e=this.history.redo(this.exportToJSON());e&&await this.applyHistoryPatches(e.patches,e.state,!1),this.emit("history:changed",{canUndo:this.history.canUndo(),canRedo:this.history.canRedo()})}finally{this.historyPaused=!1,this.processingHistory=!1}}}cleanupClipVisuals=e=>{for(const[r,n]of this.spriteRenderers)if(r.id===e){const o=n.getRoot();o&&o.parent&&o.parent.removeChild(o),n.destroy(),this.spriteRenderers.delete(r);break}const i=this.transitionSprites.get(e);i&&(i.parent&&i.parent.removeChild(i),i.destroy(),this.transitionSprites.delete(e)),this.transitionRenderers.get(e)&&this.transitionRenderers.delete(e);for(const[r,n]of this.videoSprites)if(r.id===e){n.parent&&n.parent.removeChild(n),n.destroy(),this.videoSprites.delete(r);break}for(const[r]of this.clipListeners)if(r.id===e){this.clipListeners.delete(r);break}};handleClipRemoved=({clipId:e})=>{this.cleanupClipVisuals(e),this.updateFrame(this.currentTime),this.saveHistory()};handleClipsRemoved=({clipIds:e})=>{for(const i of e)this.cleanupClipVisuals(i);this.updateFrame(this.currentTime),this.saveHistory()};async initPixiApp(){if(this.destroyed)return;const e=this.opts.canvas||document.createElement("canvas");e.width=this.opts.width,e.height=this.opts.height;const i=new xS,s=e.parentElement||window;await i.init({canvas:e,resizeTo:s,backgroundColor:this.hexToNumber(this.opts.bgColor),antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0}),this.pixiApp=i,i.stage.eventMode="static",i.stage.hitArea=i.screen,this.artboard=new it,this.artboard.label="ArtboardRoot",i.stage.addChild(this.artboard),this.selection.init(i,this.artboard),this.artboardBg=new dt,this.artboardBg.rect(0,0,this.opts.width,this.opts.height).fill({color:0}),this.artboard.addChild(this.artboardBg),this.clipContainer=new it,this.clipContainer.label="ClipContainer",this.artboard.addChild(this.clipContainer),this.artboardMask=new dt,this.artboardMask.rect(0,0,this.opts.width,this.opts.height).fill({color:16777215}),this.clipContainer.addChild(this.artboardMask),this.clipContainer.mask=this.artboardMask,this.clipsEffectContainer=new it,this.clipsEffectContainer.label="ClipsEffect",this.clipsEffectContainer.visible=!1,this.clipsEffectContainer.zIndex=1,this.clipsEffectContainer.sortableChildren=!0,this.clipContainer.addChild(this.clipsEffectContainer),this.clipsNormalContainer=new it,this.clipsNormalContainer.label="ClipsNormal",this.clipsNormalContainer.zIndex=10,this.clipsNormalContainer.sortableChildren=!0,this.clipContainer.addChild(this.clipsNormalContainer),this.transFromTexture=jt.create({width:this.opts.width,height:this.opts.height}),this.transToTexture=jt.create({width:this.opts.width,height:this.opts.height}),this.transBgGraphics=new dt,this.transBgGraphics.rect(0,0,this.opts.width,this.opts.height).fill({color:0,alpha:0}),this.clipContainer.sortableChildren=!0,this.updateArtboardLayout(),i.renderer.on("resize",()=>{this.handleResize()})}getOptions(){return this.opts}setSize(e,i){this.updateDimensions(e,i)}updateDimensions(e,i){this.opts.width=e,this.opts.height=i,this.artboardBg&&this.artboardBg.clear().rect(0,0,e,i).fill({color:0}),this.artboardMask&&this.artboardMask.clear().rect(0,0,e,i).fill({color:16777215}),this.transFromTexture&&this.transFromTexture.resize(e,i),this.transToTexture&&this.transToTexture.resize(e,i),this.transBgGraphics&&this.transBgGraphics.clear().rect(0,0,e,i).fill({color:0,alpha:0}),this.updateArtboardLayout(),this.updateFrame(this.currentTime)}handleResize=()=>{this.destroyed||!this.pixiApp||this._isUpdatingLayout||this.updateArtboardLayout()};updateArtboardLayout(){if(!(!this.pixiApp||!this.artboard||this._isUpdatingLayout)){this._isUpdatingLayout=!0;try{this.pixiApp.resize();const i=this.pixiApp.canvas.parentElement,s=i?i.getBoundingClientRect().width:this.pixiApp.screen.width,r=i?i.getBoundingClientRect().height:this.pixiApp.screen.height,n=this.opts.width,o=this.opts.height,a=this.opts.spacing||0,l=Math.max(0,s-a*2),u=Math.max(0,r-a*2),c=l/n,h=u/o,f=Math.min(c,h);this.artboard.scale.set(f),this.artboard.x=(s-n*f)/2,this.artboard.y=(r-o*f)/2}finally{this._isUpdatingLayout=!1}}}getCanvas(){if(this.opts.canvas)return this.opts.canvas;if(this.pixiApp?.canvas)return this.pixiApp.canvas;throw new Error("Canvas not initialized yet. Wait for initPixiApp to complete.")}async addTransition(e,i=2e6,s,r){return this.timeline.addTransition(e,i,s,r)}findTrackIdByClipId(e){return this.timeline.findTrackIdByClipId(e)}async addClip(e,i){(Array.isArray(e)?e:[e]).forEach(r=>this.clipCache.set(r.id,r)),this.beginHistoryGroup();try{return await this.timeline.addClip(e,i)}finally{this.endHistoryGroup()}}addTrack(e,i){return this.timeline.addTrack(e,i)}async setTracks(e){return this.timeline.setTracks(e)}async moveTrack(e,i){return this.timeline.moveTrack(e,i)}async setTrackOrder(e){return this.timeline.setTrackOrder(e)}async removeTrack(e){return this.timeline.removeTrack(e)}getClipById(e){return this.timeline.getClipById(e)}async updateClip(e,i){return this.timeline.updateClip(e,i)}async centerClip(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i)return;const s=(this.opts.width-i.width)/2,r=(this.opts.height-i.height)/2;if(this.getClipById(i.id))return this.updateClip(i.id,{left:s,top:r});i.left=s,i.top=r}async centerClipH(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i)return;const s=(this.opts.width-i.width)/2;if(this.getClipById(i.id))return this.updateClip(i.id,{left:s});i.left=s}async centerClipV(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i)return;const s=(this.opts.height-i.height)/2;if(this.getClipById(i.id))return this.updateClip(i.id,{top:s});i.top=s}async scaleToFit(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i)return;const s=await i.ready,{width:r,height:n}=s;if(r===0||n===0)return;const o=Math.min(this.opts.width/r,this.opts.height/n),a=r*o,l=n*o;if(this.getClipById(i.id))return this.updateClip(i.id,{width:a,height:l});i.width=a,i.height=l}async scaleToCover(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i)return;const s=await i.ready,{width:r,height:n}=s;if(r===0||n===0)return;const o=Math.max(this.opts.width/r,this.opts.height/n),a=r*o,l=n*o;if(this.getClipById(i.id))return this.updateClip(i.id,{width:a,height:l});i.width=a,i.height=l}async updateClips(e){this.suspendRendering(),await this.timeline.updateClips(e),this.resumeRendering(),this.updateFrame(this.currentTime)}suspendRendering(){this.renderingSuspended=!0}resumeRendering(){this.renderingSuspended=!1}getTracks(){return this.timeline.tracks}getClip(e){return this.timeline.getClipById(e)}findClip(e){return this.timeline.getClipById(e)}setupSpriteInteractivity(e){this.selection.setupSpriteInteractivity(e)}async removeClip(e){const i=typeof e=="string"?this.getClipById(e):e;if(!i){console.warn("[Studio] removeClip: Clip not found",e);return}this.beginHistoryGroup();try{return this.clipCache.set(i.id,i),this.timeline.removeClip(i,{permanent:!this.processingHistory})}finally{this.endHistoryGroup()}}async removeClips(e){this.beginHistoryGroup();try{return e.forEach(i=>this.clipCache.set(i.id,i)),this.timeline.removeClips(e,{permanent:!this.processingHistory})}finally{this.endHistoryGroup()}}async removeClipById(e){const i=this.timeline.getClipById(e);if(i)return this.removeClip(i)}async removeClipsById(e){const i=e.map(s=>this.timeline.getClipById(s)).filter(Boolean);return this.removeClips(i)}async deleteSelected(){const e=this.selection.selectedClips;if(e.size!==0){this.beginHistoryGroup();try{await this.removeClips(Array.from(e))}finally{this.endHistoryGroup()}}}async duplicateSelected(){this.beginHistoryGroup();try{return await this.timeline.duplicateSelected()}finally{this.endHistoryGroup()}}async splitSelected(e){this.beginHistoryGroup();try{return await this.timeline.splitSelected(e)}finally{this.endHistoryGroup()}}async trimSelected(e){return this.timeline.trimSelected(e)}async updateSelected(e){return this.timeline.updateSelected(e)}async clear(){await this.timeline.clear(),this.transFromTexture&&(this.transFromTexture.destroy(!0),this.transFromTexture=null),this.transToTexture&&(this.transToTexture.destroy(!0),this.transToTexture=null),this.transBgGraphics&&(this.transBgGraphics.destroy(!0),this.transBgGraphics=null),this.transitionRenderers.forEach(e=>e.destroy()),this.transitionRenderers.clear(),this.transitionSprites.forEach(e=>e.destroy()),this.transitionSprites.clear(),this.emit("reset")}async play(){return this.transport.play()}pause(){this.transport.pause()}async stop(){return this.transport.stop()}async seek(e){return this.transport.seek(e)}async frameNext(){return this.transport.frameNext()}async framePrev(){return this.transport.framePrev()}getCurrentTime(){return this.transport.currentTime}getMaxDuration(){return this.transport.maxDuration}getIsPlaying(){return this.transport.isPlaying}getSelectedClips(){return Array.from(this.selectedClips)}getVideoTexture(e){let i=this.videoTextureCache.get(e);return i||(i=xe.from(e),this.videoTextureCache.set(e,i)),i}isPlaybackCapable(e){return"createPlaybackElement"in e&&"play"in e&&"pause"in e&&"seek"in e&&"syncPlayback"in e&&"cleanupPlayback"in e}async updateFrame(e){if(this.destroyed||this.pixiApp==null||this.renderingSuspended)return;this.updateActiveGlobalEffect(e);const i=new Set,s=new Set,r=this.tracks.length;for(const o of this.clips){const a=this.getTrackIndex(o.id);if(a!==-1){const l=(r-a)*10;o.zIndex=l;const u=this.spriteRenderers.get(o);if(u){const c=u.getRoot();c&&(c.zIndex=l)}}}const n=[...this.clips].sort((o,a)=>o.zIndex-a.zIndex);for(const o of n){if(e<o.display.from){const y=this.spriteRenderers.get(o);y!=null&&await y.updateFrame(null);const b=this.playbackElements.get(o);b!=null&&this.isPlaybackCapable(o)&&o.pause(b.element);continue}if(o.display.to>0&&e>=o.display.to){const y=this.spriteRenderers.get(o);y!=null&&await y.updateFrame(null);const b=this.playbackElements.get(o);b!=null&&this.isPlaybackCapable(o)&&o.pause(b.element);continue}const a=e-o.display.from,l=a*o.playbackRate;o.animate(l);const u=await o.ready,c=o.duration||u.duration;if(c>0&&a>=c){const y=this.spriteRenderers.get(o);y!=null&&await y.updateFrame(null);const b=this.playbackElements.get(o);b!=null&&this.isPlaybackCapable(o)&&o.pause(b.element);continue}const h=this.playbackElements.get(o),f=o.type==="Video"||o.type==="Image",d=o.transition?o.transition.start:0,p=o.transition?o.transition.end:0,m=f&&o.transition&&e>=d&&e<p;if(h!=null&&this.isPlaybackCapable(o)){const y=a/1e6;if(o.syncPlayback(h.element,this.isPlaying,y),o.type==="Video"&&this.isPlaybackCapable(o)){const b=this.videoSprites.get(o);if(b!=null){const v=o.meta.duration/1e6;if(this.spriteRenderers.has(o))b.visible=!1;else if(b.visible=!m&&y>=0&&y<v,b.visible&&sG(o,b),!m)continue}}else continue}if(m){const y=o?.transition?.fromClipId,b=o?.transition?.toClipId,v=`${y}_${b}`;if(s.has(v)){const A=this.spriteRenderers.get(o);A?.getRoot()&&(A.getRoot().visible=!1);const w=this.videoSprites.get(o);w&&(w.visible=!1);continue}s.add(v),this.transFromTexture||(this.transFromTexture=jt.create({width:this.opts.width,height:this.opts.height})),this.transToTexture||(this.transToTexture=jt.create({width:this.opts.width,height:this.opts.height})),this.transBgGraphics||(this.transBgGraphics=new dt,this.transBgGraphics.rect(0,0,this.opts.width,this.opts.height).fill({color:0,alpha:0}));const x=y?this.getClipById(y):null,_=b?this.getClipById(b):null;let S=null,T=null;if(x){const A=Math.max(0,e-x.display.from),{video:w}=await x.getFrame(A);w instanceof HTMLVideoElement?S=this.getVideoTexture(w):S=w,S&&(this.lastFromFrame=S)}if(_){const A=Math.max(0,e-_.display.from),{video:w}=await _.getFrame(A);w instanceof HTMLVideoElement?T=this.getVideoTexture(w):T=w,T&&(this.lastToFrame=T)}if(S||(S=this.lastFromFrame),T||(T=this.lastToFrame),!S||!T)continue;if(S&&T&&this.pixiApp&&this.transFromTexture&&this.transToTexture){const A=(e-d)/o?.transition?.duration;x&&S&&this.renderClipToTransitionTexture(x,S,this.transFromTexture),_&&T&&this.renderClipToTransitionTexture(_,T,this.transToTexture);let w=this.transitionRenderers.get(v);if(!w)try{w=n7({name:o?.transition?.name,renderer:this.pixiApp.renderer}),this.transitionRenderers.set(v,w)}catch(k){console.error("[Studio] Failed to create transition renderer:",k)}if(w){const k=w.render({width:this.opts.width,height:this.opts.height,from:this.transFromTexture,to:this.transToTexture,progress:A});let F=this.transitionSprites.get(v);F||(F=new Zt,F.label=`TransitionSprite_${v}`,this.transitionSprites.set(v,F),this.clipsNormalContainer&&this.clipsNormalContainer.addChild(F)),F.texture=k,F.visible=!0,F.x=0,F.y=0,F.width=this.opts.width,F.height=this.opts.height,F.anchor.set(0,0),F.zIndex=o.zIndex,i.add(v);const O=this.spriteRenderers.get(o);O?.getRoot()&&(O.getRoot().visible=!1);const V=this.videoSprites.get(o);if(V&&(V.visible=!1),x){const W=this.spriteRenderers.get(x);W?.getRoot()&&(W.getRoot().visible=!1);const ie=this.videoSprites.get(x);ie&&(ie.visible=!1)}if(_){const W=this.spriteRenderers.get(_);W?.getRoot()&&(W.getRoot().visible=!1);const ie=this.videoSprites.get(_);ie&&(ie.visible=!1)}continue}}}const g=this.spriteRenderers.get(o);if(g!=null){const y=this.selectedClips.has(o);if(o.type!=="Text"&&o.type!=="Caption"&&typeof o.getTexture=="function"&&o.getTexture()!=null){const v=o.getTexture();if(v!=null){await g.updateFrame(v),y||g.updateTransforms(),this.opts.interactivity&&this.selection.setupSpriteInteractivity(o);continue}}if(o.type==="Text"){const v=o;this.pixiApp?.renderer&&typeof v.setRenderer=="function"&&v.setRenderer(this.pixiApp.renderer);const x=await v.getTexture();if(x!=null){await g.updateFrame(x),y||g.updateTransforms(),this.opts.interactivity&&this.selection.setupSpriteInteractivity(o);continue}}if(o.type==="Caption"){o.updateState(a);const v=o;this.pixiApp?.renderer&&typeof v.setRenderer=="function"&&v.setRenderer(this.pixiApp.renderer);const x=await v.getTexture();if(x!=null){await g.updateFrame(x),y||g.updateTransforms(),this.opts.interactivity&&this.selection.setupSpriteInteractivity(o);continue}}const{video:b}=await o.getFrame(a);await g.updateFrame(b),y||g.updateTransforms(),this.opts.interactivity&&this.selection.setupSpriteInteractivity(o)}}if(this.activeGlobalEffect&&this.clipsNormalContainer&&this.clipsEffectContainer){const{startTime:o,duration:a}=this.activeGlobalEffect,l=e-o,u=Math.min(Math.max(l/a,0),1);if(u>0&&u<1){try{for(const h of this.clips)this.moveClipToEffectContainer(h,!1);const c=this.clips.some(h=>h.id===this.activeGlobalEffect.id&&h instanceof Us);for(const h of this.clips){let f=!1;if(c){const d=this.activeGlobalEffect.trackIndex??-1,p=this.getTrackIndex(h.id);f=h.id!==this.activeGlobalEffect.id&&!(h instanceof Us)&&p>d}else{const d=h.effects;f=Array.isArray(d)&&d.some(p=>p&&p.id===this.activeGlobalEffect.id)}f&&this.moveClipToEffectContainer(h,!0)}}catch(c){console.warn("Failed to reparent clips for effect; falling back to full-scene render",c)}this.clipsNormalContainer.visible=!0,await this.applyGlobalEffectIfNeeded(e)}else{for(const c of this.clips)try{this.moveClipToEffectContainer(c,!1)}catch{}this.clipsNormalContainer.visible=!0,this.currentGlobalEffectSprite&&(this.currentGlobalEffectSprite.parent&&this.currentGlobalEffectSprite.parent.removeChild(this.currentGlobalEffectSprite),this.currentGlobalEffectSprite.destroy(),this.currentGlobalEffectSprite=null)}}else if(this.clipsNormalContainer){for(const o of this.clips)try{this.moveClipToEffectContainer(o,!1)}catch{}this.clipsNormalContainer.visible=!0,this.currentGlobalEffectSprite&&(this.currentGlobalEffectSprite.parent&&this.currentGlobalEffectSprite.parent.removeChild(this.currentGlobalEffectSprite),this.currentGlobalEffectSprite.destroy(),this.currentGlobalEffectSprite=null)}for(const[o,a]of this.transitionSprites.entries())i.has(o)||(a.visible=!1);this.pixiApp!=null&&this.pixiApp.render()}moveClipToEffectContainer(e,i=!0){if(!this.clipsNormalContainer||!this.clipsEffectContainer)return;const s=i?this.clipsEffectContainer:this.clipsNormalContainer,r=this.spriteRenderers.get(e);if(r){const o=r.getRoot();if(o&&o.parent!==s){try{o.parent&&o.parent.removeChild&&o.parent.removeChild(o)}catch(a){console.warn("moveClipToEffectContainer: could not remove root from parent",a)}s.addChild(o)}}const n=this.transitionSprites.get(e.id);if(n&&n.parent!==s){try{n.parent&&n.parent.removeChild&&n.parent.removeChild(n)}catch(o){console.warn("moveClipToEffectContainer: could not remove transSprite from parent",o)}s.addChild(n)}}applyGlobalEffect(e,i,s){const r=i.id||`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={id:r,key:e,startTime:i.startTime,duration:i.duration??1e6};for(const o of s)o instanceof zg&&o.addEffect(n),o instanceof yi&&o.addEffect(n),o instanceof Li&&o.addEffect(n),o instanceof Ns&&o.addEffect(n);return this.globalEffects.set(r,n),r}getTrackIndex(e){return this.tracks.findIndex(i=>i.clipIds.includes(e))}async getTransitionFromFrame(e,i){let s=null;if(e.transition?.prevClipId&&(s=this.clips.find(a=>a.id===e.transition.prevClipId)||null),s||(s=this.getPreviousClipOnTrack(e)),!s)return null;const r=s.duration>0?s.duration:0,n=Math.max(0,Math.min(i-s.display.from,r)),{video:o}=await s.getFrame(n);return o}getPreviousClipOnTrack(e){const i=this.getTrackIndex(e.id);return i===-1?null:this.clips.filter(s=>s.id!==e.id&&this.getTrackIndex(s.id)===i&&s.display.from<e.display.from&&(s instanceof yi||s instanceof zg)).sort((s,r)=>r.display.to-s.display.to)[0]||null}renderClipToTransitionTexture(e,i,s){if(!this.pixiApp)return;const r=new Zt(i instanceof xe?i:xe.from(i));r.x=e.center.x,r.y=e.center.y,r.anchor.set(.5,.5);const n=r.texture.width||1,o=r.texture.height||1,a=e.width&&e.width!==0?Math.abs(e.width)/n:1,l=e.height&&e.height!==0?Math.abs(e.height)/o:1;e.flip==="horizontal"?(r.scale.x=-a,r.scale.y=l):e.flip==="vertical"?(r.scale.x=a,r.scale.y=-l):(r.scale.x=a,r.scale.y=l),r.rotation=(e.flip==null?1:-1)*e.angle,r.alpha=e.opacity,this.pixiApp.renderer.render({container:r,target:s,clear:!0}),i instanceof xe||r.texture.destroy(!0),r.destroy()}removeGlobalEffect(e){this.globalEffects.delete(e)}clearGlobalEffects(){this.globalEffects.clear()}updateActiveGlobalEffect(e){let i=null;for(const s of this.clips)if(s instanceof Us&&e>=s.display.from&&(s.display.to===0||e<s.display.to)){i={id:s.id,key:s.effect.key,startTime:s.display.from,duration:s.duration>0?s.duration:s.display.to-s.display.from,trackIndex:this.getTrackIndex(s.id)};break}if(!i)for(const s of this.globalEffects.values()){const r=s.startTime+s.duration;if(e>=s.startTime&&e<r){i={id:s.id,key:s.key,startTime:s.startTime,duration:s.duration,trackIndex:-1};break}}this.activeGlobalEffect=i}async applyGlobalEffectIfNeeded(e){if(this.currentGlobalEffectSprite&&(this.currentGlobalEffectSprite.parent&&this.currentGlobalEffectSprite.parent.removeChild(this.currentGlobalEffectSprite),this.currentGlobalEffectSprite.destroy(),this.currentGlobalEffectSprite=null),!this.activeGlobalEffect||!this.pixiApp||!this.clipContainer||!this.artboard||!this.clipsNormalContainer||!this.clipsEffectContainer)return;const{key:i,startTime:s,duration:r}=this.activeGlobalEffect,n=e-s,o=Math.min(Math.max(n/r,0),1);if(o<=0||o>=1)return;this.clipsEffectContainer.visible=!0;let a=this.effectFilters.get(i);if(!a)try{if(a=iG({name:i.toLowerCase(),renderer:this.pixiApp.renderer}),a)this.effectFilters.set(i,a);else return}catch(d){console.error(d);return}const l=this.opts.width,u=this.opts.height,c=jt.create({width:l,height:u});this.pixiApp.renderer.render({container:this.clipsEffectContainer,target:c,clear:!0}),this.clipsEffectContainer.visible=!1;const h=a.render({canvasTexture:c,progress:o,width:l,height:u}),f=new Zt(h);f.x=0,f.y=0,f.width=l,f.height=u,f.scale.set(1),f.zIndex=5,this.clipContainer.addChild(f),this.currentGlobalEffectSprite=f,c.destroy(!0)}destroy(){if(!this.destroyed){window.removeEventListener("resize",this.handleResize),this.destroyed=!0,this.stop(),this.clear(),this.transitionRenderers.clear(),this.transFromTexture&&(this.transFromTexture.destroy(!0),this.transFromTexture=null),this.transToTexture&&(this.transToTexture.destroy(!0),this.transToTexture=null),this.transBgGraphics&&(this.transBgGraphics.destroy(!0),this.transBgGraphics=null);for(const e of this.transitionSprites.values())e.destroy();this.transitionSprites.clear(),this.pixiApp&&(this.pixiApp.destroy(!0,{children:!0,texture:!0}),this.pixiApp=null)}}selectClip(e,i=!1){this.selection.selectClip(e,i)}setSelection(e){this.selection.setSelection(e)}selectClipsByIds(e){this.selection.selectClipsByIds(e)}deselectClip(){this.selection.deselectClip()}exportToJSON(){return this.timeline.exportToJSON()}async loadFromJSON(e){return this.timeline.loadFromJSON(e)}}const p7="$s";function m7(...t){const e=typeof t[t.length-1]=="string"?t.pop():void 0;typeof t[0]!="string"&&t.unshift(e);const[i,s]=t;if(!i||typeof i!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+i);if(s!==void 0&&typeof s!="function")throw new Error("[nuxt] [useState] init must be a function: "+s);const r=p7+i,n=xt(),o=qg(n.payload.state,r);if(o.value===void 0&&s){const a=s();if(je(a))return n.payload.state[r]=a,a;o.value=a}return o}const g7=()=>{const t=m7("studio-store",()=>({studio:null,selectedClips:[]}));return{state:t,setStudio:s=>{t.value.studio=s},setSelectedClips:s=>{t.value.selectedClips=s}}},y7="https://cdn.designcombo.dev/fonts/Geist-SemiBold.ttf",v7="geist-regular",ib={fontFamily:v7,fontUrl:y7},x7={class:"h-full w-full flex flex-col min-h-0 min-w-0 bg-card rounded-sm relative"},b7={style:{flex:"1",position:"relative",overflow:"hidden"}},_7=be({__name:"CanvasPanel",props:{onReady:{type:Function}},setup(t){const e={width:1080,height:1920},i={fps:30,bgColor:"#181818",interactivity:!0,spacing:20},s=t,r=K(null),n=K(null),{setStudio:o}=g7();let a=null;const l=async()=>{if(!r.value)return;n.value=new f7({...e,...i,canvas:r.value});try{await Promise.all([QS.loadFonts([{name:ib.fontFamily,url:ib.fontUrl}]),n.value.ready]),s.onReady?.()}catch(h){console.error("Failed to initialize studio:",h)}o(n.value);const c=r.value.parentElement;c&&(a=new ResizeObserver(()=>{n.value&&n.value.updateArtboardLayout&&n.value.updateArtboardLayout()}),a.observe(c))};return br(()=>{l()}),_r(()=>{a&&(a.disconnect(),a=null),n.value&&(n.value.destroy(),n.value=null,o(null))}),(u,c)=>(fe(),dr("div",x7,[nt("div",b7,[nt("canvas",{ref_key:"canvasRef",ref:r,style:{display:"block",width:"100%",height:"100%"}},null,512)])]))}}),w7=Object.assign(_7,{__name:"EditorCanvasPanel"}),S7={class:"h-screen w-screen flex flex-col bg-background overflow-hidden space-y-1.5"},C7={class:"flex-1 min-h-0 min-w-0 px-2 pb-2"},T7=be({__name:"Editor",setup(t){const e=K(15),i=K(0),s=K(75),r=K(25),n=K(!1),o=c=>{e.value=c},a=c=>{i.value=c},l=c=>{s.value=c},u=c=>{r.value=c};return(c,h)=>(fe(),dr("div",S7,[oe(XF),nt("div",C7,[oe(M(Sv),{direction:"horizontal",class:"h-full w-full gap-0"},{default:ae(()=>[oe(M(Sn),{"default-size":e.value,"min-size":15,"max-size":40,onResize:o,class:"max-w-7xl relative overflow-visible! bg-card min-w-0 border-r"},{default:ae(()=>[...h[0]||(h[0]=[nt("div",{class:"h-full w-full p-4"}," Media Panel ",-1)])]),_:1},8,["default-size"]),oe(M(Rc),{class:"bg-transparent w-1.5"}),oe(M(Sn),{"default-size":n.value?100-i.value-e.value:100-e.value,"min-size":40,class:"min-w-0 min-h-0"},{default:ae(()=>[oe(M(Sv),{direction:"vertical",class:"h-full w-full gap-0"},{default:ae(()=>[oe(M(Sn),{"default-size":s.value,"min-size":30,"max-size":85,onResize:l,class:"min-h-0 border-b"},{default:ae(()=>[oe(w7)]),_:1},8,["default-size"]),oe(M(Rc),{class:"bg-transparent !h-1.5"}),oe(M(Sn),{"default-size":r.value,"min-size":15,"max-size":70,onResize:u,class:"min-h-0"},{default:ae(()=>[...h[1]||(h[1]=[nt("div",{class:"h-full w-full p-4"}," Timeline Panel ",-1)])]),_:1},8,["default-size"])]),_:1})]),_:1},8,["default-size"]),n.value?(fe(),dr(pt,{key:0},[oe(M(Rc),{class:"bg-transparent w-1.5"}),oe(M(Sn),{"default-size":i.value,"min-size":15,"max-size":40,onResize:a,class:"max-w-7xl relative overflow-visible! bg-card min-w-0 border-l"},{default:ae(()=>[...h[2]||(h[2]=[nt("div",{class:"h-full w-full p-4"}," Copilot Panel ",-1)])]),_:1},8,["default-size"])],64)):i0("",!0)]),_:1})])]))}}),k7=Object.assign(T7,{__name:"Editor"}),A7=be({__name:"app",setup(t){return(e,i)=>(fe(),_e(k7))}}),I7={__name:"nuxt-error-page",props:{error:Object},setup(t){const i=t.error,s=Number(i.statusCode||500),r=s===404,n=i.statusMessage??(r?"Page Not Found":"Internal Server Error"),o=i.message||i.toString(),a=void 0,c=r?cy(()=>rn(()=>import("./BF8-Ztvu.js"),__vite__mapDeps([6,7,8]),import.meta.url)):cy(()=>rn(()=>import("./DXNJEFAP.js"),__vite__mapDeps([9,7,10]),import.meta.url));return(h,f)=>(fe(),_e(M(c),Ni(cs({statusCode:M(s),statusMessage:M(n),description:M(o),stack:M(a)})),null,16))}},P7={key:0},sb={__name:"nuxt-root",setup(t){const e=()=>null,i=xt(),s=i.deferHydration();if(i.isHydrating){const u=i.hooks.hookOnce("app:error",s);pr().beforeEach(u)}const r=!1;Rl(q_,Y_()),i.hooks.callHookWith(u=>u.map(c=>c()),"vue:setup");const n=c0(),o=!1,a=/bot\b|chrome-lighthouse|facebookexternalhit|google\b/i;Xb((u,c,h)=>{if(i.hooks.callHook("vue:error",u,c,h).catch(f=>console.error("[nuxt] Error in `vue:error` hook",f)),a.test(navigator.userAgent))return i.hooks.callHook("app:error",u),console.error(`[nuxt] Not rendering error page for bot with user agent \`${navigator.userAgent}\`:`,u),!1;if(Qk(u)&&(u.fatal||u.unhandled))return i.runWithContext(()=>Zk(u)),!1});const l=!1;return(u,c)=>(fe(),_e(OT,{onResolve:M(s)},{default:ae(()=>[M(o)?(fe(),dr("div",P7)):M(n)?(fe(),_e(M(I7),{key:1,error:M(n)},null,8,["error"])):M(l)?(fe(),_e(M(e),{key:2,context:M(l)},null,8,["context"])):M(r)?(fe(),_e(hT(M(r)),{key:3})):(fe(),_e(M(A7),{key:4}))]),_:1},8,["onResolve"]))}};let rb;{let t;rb=async function(){if(t)return t;const i=!!(window.__NUXT__?.serverRendered??document.getElementById("__NUXT_DATA__")?.dataset.ssr==="true"),s=i?I3(sb):A3(sb),r=Bk({vueApp:s});async function n(o){await r.callHook("app:error",o),r.payload.error||=u0(o)}s.config.errorHandler=n,r.hook("app:suspense:resolve",()=>{s.config.errorHandler===n&&(s.config.errorHandler=void 0)}),!i&&By.id&&r.hook("app:suspense:resolve",()=>{document.getElementById(By.id)?.remove()});try{await Lk(r,iI)}catch(o){n(o)}try{await r.hooks.callHook("app:created",s),await r.hooks.callHook("app:beforeMount",s),s.mount(Rk),await r.hooks.callHook("app:mounted",s),await Rt()}catch(o){n(o)}return s},t=rb().catch(e=>{throw console.error("Error while mounting app:",e),e})}export{fi as $,po as A,Nm as B,P_ as C,F7 as D,oe as E,ae as F,el as G,fO as H,Ge as I,Ti as J,gt as K,di as L,it as M,YD as N,wx as O,Ae as P,li as Q,KD as R,uD as S,Gn as T,xg as U,Ot as V,Co as W,Ga as X,H0 as Y,dS as Z,$2 as _,nt as a,nS as a0,Rg as a1,Ie as a2,C8 as a3,k8 as a4,R8 as a5,E8 as a6,sc as a7,xe as a8,mS as a9,jt as aA,gS as aB,ve as aC,Ne as aD,UD as aE,o8 as aF,QD as aG,T8 as aH,A8 as aI,z8 as aJ,F8 as aK,U8 as aL,yl as aM,hr as aN,Ig as aO,Xx as aP,ES as aQ,Sx as aR,_x as aS,HS as aT,NS as aU,qt as aV,dt as aW,QB as aX,Mt as aY,RS as aZ,bo as aa,rc as ab,JB as ac,gn as ad,mn as ae,B8 as af,ai as ag,F2 as ah,wi as ai,on as aj,sx as ak,Zt as al,tD as am,dD as an,zo as ao,tt as ap,Se as aq,ED as ar,nx as as,tm as at,ox as au,FO as av,vl as aw,st as ax,EO as ay,U2 as az,xt as b,dr as c,Q_ as d,pr as e,be as f,br as g,Xg as h,Rs as i,f0 as j,Jg as k,z7 as l,Oe as m,E7 as n,fe as o,o0 as p,K as q,Xy as r,uo as s,fC as t,R7 as u,Kk as v,jk as w,me as x,Dl as y,cn as z};
